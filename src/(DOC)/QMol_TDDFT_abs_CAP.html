<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2024a"><title>QMol_TDDFT_abs_CAP</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S3 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.S4 { margin: 10px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 15px; font-weight: 700; text-align: left;  }
.S5 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S6 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block }
.S7 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0.555556px solid rgb(217, 217, 217); border-bottom: 0.555556px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S9 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0.555556px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S10 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0.555556px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S11 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S12 { border-left: 0px none rgb(33, 33, 33); border-right: 0px none rgb(33, 33, 33); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px; line-height: 15.6px; min-height: 16px; white-space: pre; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span style=' font-family: monospace;'>QMol_TDDFT_abs_CAP</span></h1><div  class = 'S1'><span>Absorbing boundaries using a complex absorbing potential (CAP) at the edges of the discretization domain </span></div><h2  class = 'S2'><span>Description</span></h2><div  class = 'S1'><span>Use </span><span style=' font-family: monospace;'>QMol_TDDFT_abs_CAP</span><span> to describe absorbing boundaries with a CAP. During the </span><a href = "./TDDFT.html"><span>TDDFT</span></a><span> propagation, the CAP is added to the Kohn-Sham potential. </span></div><h2  class = 'S2'><span>Class properties</span></h2><h3  class = 'S3' id = 'H_9E118FF3' ><span>Complex absorbing potential (CAP)</span></h3><div  class = 'S1'><span>The </span><span style=' font-family: monospace;'>QMol_TDDFT_abs_CAP</span><span> class defines the following public get-access properties; each can be changed using the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method:</span></div><h4  class = 'S4' id = 'H_AF6C7188' ><span style=' font-family: monospace;'>amplitude (V0)</span></h4><div  class = 'S1'><span>Amplitude of the CAP </span><span style=' font-family: monospace;'>[ positive scalar (default 0.5) ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>When constructing the CAP, the selected </span><a href = "#H_5F9A3AF5"><span style=' font-family: monospace;'>shape</span></a><span> is multiplied by the specified </span><span style=' font-family: monospace;'>amplitude</span><span> (including for user-defined shapes).</span></li></ul><h4  class = 'S4' id = 'H_802F3E68' ><span style=' font-family: monospace;'>length (L)</span></h4><div  class = 'S1'><span>Length of the absorbing region at the edges of the domain discretization </span><span style=' font-family: monospace;'>[ positive scalar (default 10) | positive two-vector ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>Scalar </span><span style=' font-family: monospace;'>length</span><span> defines a CAP with the same length on both sides of the discretization domain.</span></li><li  class = 'S6'><span style=' font-family: monospace;'>length = [L_left, L_right]</span><span> independently specifies the CAP length on each side of the domain.</span></li><li  class = 'S6'><span>Note: The CAP is defined inward from the two ends of the </span><a href = "./DFT.html"><span>DFT model</span></a><span> discretization domain, which should therefore budget for this.</span></li></ul><h4  class = 'S4' id = 'H_5F9A3AF5' ><span style=' font-family: monospace;'>shape</span></h4><div  class = 'S1'><span>Shape of the CAP </span><span style=' font-family: monospace;'>[ 'sin^1/8' (default) | 'sin' | 'sin^2' | function handle ]</span></div><ul  class = 'S5'><li  class = 'S6'><span style=' font-family: monospace;'>'sin^1/8'</span><span> uses a </span><span texencoding="\sin^{1/8}" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="34" height="20" /></span><span>-shaped CAP.</span></li><li  class = 'S6'><span style=' font-family: monospace;'>'sin'</span><span> uses a </span><span style="font-family: STIXGeneral-webfont, serif; font-style: normal; font-weight: 400; color: rgb(33, 33, 33);">sin</span><span>-shaped CAP.</span></li><li  class = 'S6'><span style=' font-family: monospace;'>'sin^2'</span><span> uses a </span><span texencoding="\sin^{2}" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAoCAYAAABTsMJyAAAAAXNSR0IArs4c6QAABL9JREFUaEPtmGtoHFUUx/9ndjbZVesLJRqTeblYjOAHFRT8YEDUFIORQqmxVaQYlaTaiIqtUPshAR+oWKxFjY+Sgoq1LYpCrQ8iBVGpUj+41ri5cyeJsWKRFKVhs7v3yA0zMmyyNAkhbELm4+69Z+7v/O89/3OHsIweWkYsWIGpVjVXlFlRZp4ZcF3XZuZniKgFwAXM/AMzbw+C4DMAKh62qrdZJpO5qlQqfQjgJyL6lZmvBXBrCHC/7/v9SwImk8nUKqVeBvC9EGIPAAZAnufdx8yvAziaSCTacrncXxFQ1Spj27ZrGEZ3Pp/fNjY2djpacENDw4Wmae4josuVUmuCIPil6mGamppqxsfHzTiIXnR9ff1ZNTU1fUTUVCgUWkdHR3+vephK9cJxnPOJ6ANmHjFNszOXy+UXFMbzvFZm7mPmrwzD6BRCnJpn8TrjNNd1r2bmA4ZhPCiE+HJBC0BM9rt1YGZullJ+fcZVzWNAc3OzOTw8/AKAU5Zl9QwMDBQXFEYHWyxlHMe5jYjWpdPp7mw2+295Pqq2mpUv1HGc64noYaXUE0EQ/DGTsEsCJjTPp5VS3ZVANFzVw1QC0ecnCIJupdT+IAj8ijB1dXVnp9PpjUS0BkAOQKMGJ6IBAMNCiE9mkNmwbXt1Mpk8GXfl8NBeqZRqJ6KL8/n8ltra2lUAugBsBHApgE+ZuVdKeSwe13Xd1QD6mTlnGIZex/9P2Noct217a1QIpimjq1MqlXoVQCqVSnVEBy3cs/1E9JwQ4u0wKrmuaxFROzN3auh4NfM873Zm3gZA91QpZn4XwF4ieomIpioeM68PG8ifTdPU7clQWFSscPyNFQrfP4ZhtAwNDX1T0Wccx7mJiD4noodii55S0XXdzUR0mRBiq/7BcZwbiOgKABuiBrC8NGsnn5iY2AWgA8BpIjpcKBS6RkZGxsIYukLtA7CKiLqEELvnUbWnpkxTxvO8Tcz8FhHttCzr8Xgt14YFoM33/Z74Cz3Pu5mZv6jkM57nPcvMT+r2HUCrlPJEND9ydAC3AOhLp9Obs9ns5HyApsE4jtNCRB+HwR5NJBJvRi1D2MlaQojf4i8L1dTnaUbTjGAAfJdMJlsHBwdPRvPjpqu31eTkZEd5PzZbsJmUOQ/AHma+MwxyhIgeE0IcDdvwabGrFkavNGy/9wKIDl8BwBsAenzf/7Ocpqph9GIzmcy5pVJpBwBdpVIhQADgHt/3jyyJbVaedcuyPNM0X4xtu0FmbpNSHo8dYl0Bq/LMrC2VSjIIgh9jYIbnedpLXgk9oVtKuXMpwGzS26q83oftgwbQ267X9/3tSwJGKbWhWCyuGx0d/TumjjbN5wFsYeY7pJSHlgSMNk2d/UQi0RvzGP3Z5wARHTQMY0f8uuo4zl1E9F7oM+1SyvcjUO1NxWJxNxFpxY+V39sbGxvrTdP8CMB1+qY6QxJnazMzdgBrmdkjonOYuYmIfKXURURUR0SvWZZ1KOoKbNu+JpFIrGfmewFcEr71BBHp71k6IdpEHwHwAIBk+P9hZn7HNM2DxWJRt0NPxb6FaQvQ9/tdUspvZ00RDqz6K8BcgFZg5pKtxRy7osxiZnsu71pRZi7ZWsyxy0qZ/wCUrA5WE80pLAAAAABJRU5ErkJggg==" width="25.5" height="20" /></span><span>-shaped CAP.</span></li><li  class = 'S6'><span>A function handle enables user-defined CAPs, with the signature </span><span style=' font-family: monospace;'>@(x) fun(x)</span><span>, where </span><span style=' font-family: monospace;'>fun(0)=0</span><span> and </span><span style=' font-family: monospace;'>fun(1)=V_max</span><span> returns the values for the CAP at the beginning and end of the absorbing domain, respectively (the absorbing domain at the two ends of the discretization domain are linearly mapped to the segment </span><span style=' font-family: monospace;'>[0 1]</span><span> when calling the CAP function). </span><span style=' text-decoration: underline; font-family: monospace;'>fun</span><span style=' text-decoration: underline;'> must be real valued and positive</span><span>; the sign and complex coefficients are properly assigned when the object is </span><a href = "#H_09FAB436"><span style=' font-family: monospace;'>initialize</span></a><span>d. We recommend setting </span><span style=' font-family: monospace;'>V_max</span><span> to </span><span style=' font-family: monospace;'>1</span><span> and using the </span><a href = "#H_AF6C7188"><span style=' font-family: monospace;'>amplitude</span></a><span> property to control the CAP height.</span></li></ul><h3  class = 'S3'><span>Other properties</span></h3><div  class = 'S1'><span>These properties cannot be edited with the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method.</span></div><h4  class = 'S4'><span style=' font-family: monospace;'>isCAP (=true)</span></h4><div  class = 'S1'><span>This constant property can be used to distinguist CAP from mask (</span><span style=' font-family: monospace;'>isCAP = false</span><span>) absorbing boundary conditions at run time.</span></div><h4  class = 'S4' id = 'H_11930D30' ><span style=' font-family: monospace;'>isInitialized (isInit)</span></h4><div  class = 'S1'><span>Whether the absorbing-boundary CAP object is properly initialized. This is used throughout the QMol-grid package to check that the absorber object holds meaningful information and is ready for use. Changing its </span><span style=' font-family: monospace;'>isSpinPol</span><span> may cause simulations to fail or produce erroneous results.</span></div><h2  class = 'S2'><span>Class methods</span></h2><h3  class = 'S3'><span>Creation</span></h3><h4  class = 'S4'><span>constructor</span></h4><div  class = 'S1'><span>Create an absorbing-boundary CAP object with empty class properties.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj = QMol_TDDFT_abs_CAP;</span></span></div></div></div><div  class = 'S8'><span>Create an absorbing-boundary CAP object with the </span><span style=' font-family: monospace;'>name</span><span> properties set to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_9E118FF3"><span>CAP</span></a><span> properties and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj = QMol_TDDFT_abs_CAP(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj = QMol_TDDFT_abs_CAP(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><h3  class = 'S3'><span>Changing class properties</span></h3><h4  class = 'S4' id = 'H_4405B79D' ><span style=' font-family: monospace;'>set</span></h4><div  class = 'S1'><span>Update the </span><span style=' font-family: monospace;'>name</span><span> properties of an absorbing-boundary CAP object to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_9E118FF3"><span>CAP</span></a><span> properties and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj.set(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.set(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S8'><span>This is the common name-value pair assignment method used throughout the QMol-grid package. The </span><span style=' font-family: monospace;'>set</span><span> method also </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the class. After running, the </span><span style=' font-family: monospace;'>set</span><span> property updates the </span><a href = "#H_11930D30"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to a </span><span style=' font-family: monospace;'>false</span><span> value.</span></div><h4  class = 'S4' id = 'H_BF84FCE7' ><span style=' font-family: monospace;'>reset</span></h4><div  class = 'S1'><span>Reset the object by deleting/re-initializing all run-time properties of the class and updating the </span><a href = "#H_11930D30"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to </span><span style=' font-family: monospace;'>false</span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.reset;</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>This is the common </span><span style=' font-family: monospace;'>reset</span><span> method available to all classes throughout the QMol-grid package.</span></li></ul><h4  class = 'S4' id = 'H_C729A888' ><span style=' font-family: monospace;'>clear</span></h4><div  class = 'S1'><span>Clear all class properties</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.clear;</span></span></div></div></div><div  class = 'S8'><span>Clear a specific set of the class properties. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_9E118FF3"><span>CAP</span></a><span> properties and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.clear(name1,name2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S8'><span>This is the common </span><span style=' font-family: monospace;'>clear</span><span> method available to all classes throughout the QMol-grid package. The </span><span style=' font-family: monospace;'>clear</span><span> method also </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the class. The </span><span style=' font-family: monospace;'>clear</span><span> method can be used to delete specific properties before saving an instance of the </span><span style=' font-family: monospace;'>QMol_TDDFT_abs_CAP</span><span> class.</span></div><h3  class = 'S3'><span>Initializing the object</span></h3><h4  class = 'S4' id = 'H_09FAB436' ><span style=' font-family: monospace;'>initialize</span></h4><div  class = 'S1'><span>Initialize a </span><span style=' font-family: monospace;'>QMol_TDDFT_abs_CAP</span><span> object and set the </span><a href = "#H_11930D30"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to </span><span style=' font-family: monospace;'>true</span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.initialize(DFT,isForward);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span style=' font-family: monospace;'>DFT</span><span> is the </span><a href = "./DFT.html"><span>DFT-model</span></a><span> handle object, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "./QMol_DFT_spinPol.html"><span style=' font-family: monospace;'>QMol_DFT_spinPol</span></a><span style=' font-family: monospace;'> </span><span>or </span><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span>, being propagated in the </span><a href = "./TDDFT.html"><span>TDDFT</span></a><span> simulation.</span></li><li  class = 'S6'><span style=' font-family: monospace;'>isForward</span><span> specifies whether the TDDFT propagation is forward (</span><span style=' font-family: monospace;'>true</span><span>) or backward (</span><span style=' font-family: monospace;'>false</span><span>) in time.</span></li><li  class = 'S6'><span>To avoid any mismatch in internal properties, </span><span style=' font-family: monospace;'>initialize</span><span> first </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the object before performing the initialization.</span></li></ul><h3  class = 'S3'><span style=' font-family: monospace;'>Run-time documentation</span></h3><h4  class = 'S4' id = 'H_E3988947' ><span style=' font-family: monospace;'>getMemoryProfile</span></h4><div  class = 'S1'><span>Get an estimate of the memory held by a </span><span style=' font-family: monospace;'>QMol_TDDFT_abs_CAP</span><span> object with either</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >mem = obj.getMemoryProfile;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >mem = obj.getMemoryProfile(false);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>The object must be properly </span><a href = "#H_09FAB436"><span style=' font-family: monospace;'>initialize</span></a><span>d.</span></li><li  class = 'S6'><span>The estimate only includes the discretization of the CAP on the domain grid and ignores other (small) properties.</span></li><li  class = 'S6'><span>The output </span><span style=' font-family: monospace;'>mem</span><span> is the estimated size in bytes.</span></li></ul><div  class = 'S1'><span>Additionally display the detail of the memory footprint with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >mem = obj.getMemoryProfile(true);</span></span></div></div></div><h4  class = 'S4' id = 'H_4D7CFC3D' ><span style=' font-family: monospace;'>showDocumentation</span></h4><div  class = 'S1'><span>Display the run-time documentation for the specific configuration of a </span><span style=' font-family: monospace;'>QMol_TDDFT_abs_CAP</span><span> object.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >ref = obj.showDocumentation;</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>The output </span><span style=' font-family: monospace;'>ref</span><span> is a cell vector containing the list of references to be included in the bibliography.</span></li></ul><h3  class = 'S3'><span>CAP function</span></h3><div  class = 'S1'><span>To use the CAP, the </span><span style=' font-family: monospace;'>QMol_TDDFT_abs_CAP</span><span> object must be properly </span><a href = "#H_09FAB436"><span style=' font-family: monospace;'>initialize</span></a><span>d.</span></div><h4  class = 'S4'><span style=' font-family: monospace;'>getPotential</span></h4><div  class = 'S1'><span>Apply the mask function to a set of Kohn-Sham orbitals.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.getPotential(Vks);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>This adds the CAP to the Kohn-Sham potential object </span><span style=' font-family: monospace;'>Vks</span><span>, by performing the in-place operation </span><span texencoding="\mathcal{V}_{\rm KS}\leftarrow\mathcal{V}_{\rm KS}+\mathcal{V}_{\rm CAP}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="131.5" height="19.5" /></span><span>.</span></li><li  class = 'S6'><span>For developers: For similarity with other </span><span style=' font-family: monospace;'>getPotential</span><span> methods in the QMol-grid package, the full signature is </span><span style=' font-family: monospace;'>Vks = getPotential(obj,Vks)</span><span>. Note that </span><span style=' font-family: monospace;'>getPotential</span><span> does not perform any Kohn-Sham potential allocation and calling the function without a valid potential object will cause an error.</span></li></ul><h2  class = 'S2'><span>Examples</span></h2><div  class = 'S1'><span>Create a discretization domain and minimal </span><a href = "./DFT.html"><span style=' font-family: monospace;'>DFT</span><span>-model</span></a><span> object </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >disc = QMol_disc(</span><span style="color: #a709f5;">'xspan'</span><span >,-20:.1:25);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >DFT  = QMol_DFT_spinRes(</span><span style="color: #a709f5;">'discretization'</span><span >,disc);</span></span></div></div></div><div  class = 'S8'><span>Create the CAP absorber and display the run-time documentation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >ABC  = QMol_TDDFT_abs_CAP(</span><span style="color: #a709f5;">'length'</span><span >,5);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >ABC.initialize(DFT,true);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >ABC.showDocumentation;</span></span></div></div></div><div  class = 'S8'><span>yielding</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S12'><span style="white-space: pre"><span >  * Absorbing boundaries                       complex absorbing potential</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Length = 5 a.u. on both ends</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Amplitude = 0.5 a.u.    Shape  = sin^1/8</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    V-01.21.000 (06/17/2024)                                     F. Maug</span></span></div></div><div  class = 'S1'><span>Display the estimated memory footprint for the object</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >ABC.getMemoryProfile(true);</span></span></div></div></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S12'><span style="white-space: pre"><span >  * Absorbing boundaries (mask)                                     7.0 KB</span></span></div></div><h2  class = 'S2'><span>Test suite</span></h2><div  class = 'S1'><span>Run the test suite for the class in normal or </span><a href = "./Test_suite.html"><span>summary mode</span></a><span> respectively with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'TDDFT_abs_CAP'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'-summary'</span><span >,</span><span style="color: #a709f5;">'TDDFT_abs_CAP'</span><span >);</span></span></div></div></div><div  class = 'S8'><span>See </span><a href = "./QMol_test,html"><span style=' font-family: monospace;'>QMol_test</span></a><span> for details regarding how to create a test suite for new classes.</span></div><h2  class = 'S2'><span>For developers</span></h2><h3  class = 'S3'><span>Other hidden class properties</span></h3><div  class = 'S1'><span style=' font-family: monospace;'>QMol_TDDFT_abs_CAP</span><span> defines a handful of additional transient/constant and hidden properties to facilitate and speed up computations. These properties cannot be edited with the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method, nor by any function outisde of the object (</span><span style=' font-family: monospace;'>SetAccess=private</span><span> attribute).</span></div><h4  class = 'S4' id = 'H_37454CF9' ><span style=' font-family: monospace;'>DFT</span></h4><div  class = 'S1'><span>DFT-model object </span><span style=' font-family: monospace;'>[ [] (default) | </span><a href = "./QMol_DFT_spinPol.html"><span style=' font-family: monospace;'>QMol_DFT_spinPol</span></a><span style=' font-family: monospace;'> handle object | </span><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span style=' font-family: monospace;'> handle object ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>This is a copy of the </span><a href = "./DFT.html"><span>DFT-model</span></a><span> handle object passed to </span><a href = "#H_09FAB436"><span style=' font-family: monospace;'>initialize</span></a><span>. </span></li><li  class = 'S6'><span>Un-initialized </span><span style=' font-family: monospace;'>QMol_TDDFT_abs_CAP</span><span> objects, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "#H_11930D30"><span style=' font-family: monospace;'>isInitialized</span></a><span style=' font-family: monospace;'> == false</span><span>, have empty </span><span style=' font-family: monospace;'>DFT.</span></li><li  class = 'S6'><span>For practical reasons, </span><span style=' font-family: monospace;'>DFT</span><span> is editable by </span><a href = "./QMol_TDDFT.html"><span style=' font-family: monospace;'>QMol_TDDFT</span></a><span> classes.</span></li></ul><h4  class = 'S4'><span style=' font-family: monospace;'>V</span></h4><div  class = 'S1'><span>Discretization of the CAP on the domain grid </span><span style=' font-family: monospace;'>[ [] (default) | vector ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>Un-initialized </span><span style=' font-family: monospace;'>QMol_TDDFT_abs_CAP</span><span> objects, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "#H_11930D30"><span style=' font-family: monospace;'>isInitialized</span></a><span style=' font-family: monospace;'> == false</span><span>, have empty </span><span style=' font-family: monospace;'>V.</span></li></ul><h4  class = 'S4'><span style=' font-family: monospace;'>nKSO</span></h4><div  class = 'S1'><span>Number of Kohn-Sham orbitals in the </span><a href = "./DFT.html"><span>DFT model</span></a><span> </span><span style=' font-family: monospace;'>[ [] (default) | integer | two-integer vector ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>For spin-polarized models, </span><span style=' font-family: monospace;'>nKSO = [N_up, N_down]</span><span> specifies the number of up- and down-spin Kohn-Sham orbitals, respectively.</span></li></ul><h2  class = 'S2'><span>Notes</span></h2><div  class = 'S1'><span>The results displayed in this documentation page were generated using version 01.21 of the QMol-grid package.</span></div><ul  class = 'S5'><li  class = 'S6'><span style=' font-family: monospace;'>QMol_TDDFT_abs_CAP</span><span> was introduced in version 01.10.</span></li></ul>
<br>
<!-- 
##### SOURCE BEGIN #####
%% |QMol_TDDFT_abs_CAP|
% Absorbing boundaries using a complex absorbing potential (CAP) at the edges 
% of the discretization domain 
%% Description
% Use |QMol_TDDFT_abs_CAP| to describe absorbing boundaries with a CAP. During 
% the <./TDDFT.html TDDFT> propagation, the CAP is added to the Kohn-Sham potential. 
%% Class properties
% Complex absorbing potential (CAP)
% The |QMol_TDDFT_abs_CAP| class defines the following public get-access properties; 
% each can be changed using the |set| method:
% |amplitude (V0)|
% Amplitude of the CAP |[ positive scalar (default 0.5) ]|
%% 
% * When constructing the CAP, the selected |shape| is multiplied by the specified 
% |amplitude| (including for user-defined shapes).
% |length (L)|
% Length of the absorbing region at the edges of the domain discretization |[ 
% positive scalar (default 10) | positive two-vector ]|
%% 
% * Scalar |length| defines a CAP with the same length on both sides of the 
% discretization domain.
% * |length = [L_left, L_right]| independently specifies the CAP length on each 
% side of the domain.
% * Note: The CAP is defined inward from the two ends of the <./DFT.html DFT 
% model> discretization domain, which should therefore budget for this.
% |shape|
% Shape of the CAP |[ 'sin^1/8' (default) | 'sin' | 'sin^2' | function handle 
% ]|
%% 
% * |'sin^1/8'| uses a $\sin^{1/8}$-shaped CAP.
% * |'sin'| uses a $\sin$-shaped CAP.
% * |'sin^2'| uses a $\sin^{2}$-shaped CAP.
% * A function handle enables user-defined CAPs, with the signature |@(x) fun(x)|, 
% where |fun(0)=0| and |fun(1)=V_max| returns the values for the CAP at the beginning 
% and end of the absorbing domain, respectively (the absorbing domain at the two 
% ends of the discretization domain are linearly mapped to the segment |[0 1]| 
% when calling the CAP function). |fun| must be real valued and positive; the 
% sign and complex coefficients are properly assigned when the object is |initialize|d. 
% We recommend setting |V_max| to |1| and using the |amplitude| property to control 
% the CAP height.
% Other properties
% These properties cannot be edited with the |set| method.
% |isCAP (=true)|
% This constant property can be used to distinguist CAP from mask (|isCAP = 
% false|) absorbing boundary conditions at run time.
% |isInitialized (isInit)|
% Whether the absorbing-boundary CAP object is properly initialized. This is 
% used throughout the QMol-grid package to check that the absorber object holds 
% meaningful information and is ready for use. Changing its |isSpinPol| may cause 
% simulations to fail or produce erroneous results.
%% Class methods
% Creation
% constructor
% Create an absorbing-boundary CAP object with empty class properties.

obj = QMol_TDDFT_abs_CAP;
%% 
% Create an absorbing-boundary CAP object with the |name| properties set to 
% the specified |value|. Several |name-value| pairs can be specified consecutively. 
% Suitable |name| is any of the CAP properties and is case insensitive.

obj = QMol_TDDFT_abs_CAP(name1,value1);
obj = QMol_TDDFT_abs_CAP(name1,value1,name2,value2,___);
% Changing class properties
% |set|
% Update the |name| properties of an absorbing-boundary CAP object to the specified 
% |value|. Several |name-value| pairs can be specified consecutively. Suitable 
% |name| is any of the CAP properties and is case insensitive.

obj.set(name1,value1);
obj.set(name1,value1,name2,value2,___);
%% 
% This is the common name-value pair assignment method used throughout the QMol-grid 
% package. The |set| method also |reset| the class. After running, the |set| property 
% updates the |isInitialized| flag to a |false| value.
% |reset|
% Reset the object by deleting/re-initializing all run-time properties of the 
% class and updating the |isInitialized| flag to |false|.

obj.reset;
%% 
% * This is the common |reset| method available to all classes throughout the 
% QMol-grid package.
% |clear|
% Clear all class properties

obj.clear;
%% 
% Clear a specific set of the class properties. Suitable |name| is any of the 
% CAP properties and is case insensitive.

obj.clear(name1,name2,___);
%% 
% This is the common |clear| method available to all classes throughout the 
% QMol-grid package. The |clear| method also |reset| the class. The |clear| method 
% can be used to delete specific properties before saving an instance of the |QMol_TDDFT_abs_CAP| 
% class.
% Initializing the object
% |initialize|
% Initialize a |QMol_TDDFT_abs_CAP| object and set the |isInitialized| flag 
% to |true|.

obj.initialize(DFT,isForward);
%% 
% * |DFT| is the <./DFT.html DFT-model> handle object, _i.e._, <./QMol_DFT_spinPol.html 
% |QMol_DFT_spinPol|> or <./QMol_DFT_spinRes.html |QMol_DFT_spinRes|>, being propagated 
% in the <./TDDFT.html TDDFT> simulation.
% * |isForward| specifies whether the TDDFT propagation is forward (|true|) 
% or backward (|false|) in time.
% * To avoid any mismatch in internal properties, |initialize| first |reset| 
% the object before performing the initialization.
% |Run-time documentation|
% |getMemoryProfile|
% Get an estimate of the memory held by a |QMol_TDDFT_abs_CAP| object with either

mem = obj.getMemoryProfile;
mem = obj.getMemoryProfile(false);
%% 
% * The object must be properly |initialize|d.
% * The estimate only includes the discretization of the CAP on the domain grid 
% and ignores other (small) properties.
% * The output |mem| is the estimated size in bytes.
%% 
% Additionally display the detail of the memory footprint with

mem = obj.getMemoryProfile(true);
% |showDocumentation|
% Display the run-time documentation for the specific configuration of a |QMol_TDDFT_abs_CAP| 
% object.

ref = obj.showDocumentation;
%% 
% * The output |ref| is a cell vector containing the list of references to be 
% included in the bibliography.
% CAP function
% To use the CAP, the |QMol_TDDFT_abs_CAP| object must be properly |initialize|d.
% |getPotential|
% Apply the mask function to a set of Kohn-Sham orbitals.

obj.getPotential(Vks);
%% 
% * This adds the CAP to the Kohn-Sham potential object |Vks|, by performing 
% the in-place operation $\mathcal{V}_{\rm KS}\leftarrow\mathcal{V}_{\rm KS}+\mathcal{V}_{\rm 
% CAP}$.
% * For developers: For similarity with other |getPotential| methods in the 
% QMol-grid package, the full signature is |Vks = getPotential(obj,Vks)|. Note 
% that |getPotential| does not perform any Kohn-Sham potential allocation and 
% calling the function without a valid potential object will cause an error.
%% Examples
% Create a discretization domain and minimal <./DFT.html |DFT|-model> object 

disc = QMol_disc('xspan',-20:.1:25);
DFT  = QMol_DFT_spinRes('discretization',disc);
%% 
% Create the CAP absorber and display the run-time documentation

ABC  = QMol_TDDFT_abs_CAP('length',5);
ABC.initialize(DFT,true);
ABC.showDocumentation;
%% 
% yielding
%%
% 
%    * Absorbing boundaries                       complex absorbing potential
%      Length = 5 a.u. on both ends
%      Amplitude = 0.5 a.u.    Shape  = sin^1/8
%      V-01.21.000 (06/17/2024)                                     F. Maug
%
%% 
% Display the estimated memory footprint for the object

ABC.getMemoryProfile(true);
%%
% 
%    * Absorbing boundaries (mask)                                     7.0 KB
%
%% Test suite
% Run the test suite for the class in normal or <./Test_suite.html summary mode> 
% respectively with

QMol_test.test('TDDFT_abs_CAP');
QMol_test.test('-summary','TDDFT_abs_CAP');
%% 
% See <./QMol_test,html |QMol_test|> for details regarding how to create a test 
% suite for new classes.
%% For developers
% Other hidden class properties
% |QMol_TDDFT_abs_CAP| defines a handful of additional transient/constant and 
% hidden properties to facilitate and speed up computations. These properties 
% cannot be edited with the |set| method, nor by any function outisde of the object 
% (|SetAccess=private| attribute).
% |DFT|
% DFT-model object |[ [] (default) || <./QMol_DFT_spinPol.html |QMol_DFT_spinPol|> 
% |handle object || <./QMol_DFT_spinRes.html |QMol_DFT_spinRes|> |handle object 
% ]|
%% 
% * This is a copy of the <./DFT.html DFT-model> handle object passed to |initialize|. 
% * Un-initialized |QMol_TDDFT_abs_CAP| objects, _i.e._, |isInitialized| |== 
% false|, have empty |DFT.|
% * For practical reasons, |DFT| is editable by <./QMol_TDDFT.html |QMol_TDDFT|> 
% classes.
% |V|
% Discretization of the CAP on the domain grid |[ [] (default) | vector ]|
%% 
% * Un-initialized |QMol_TDDFT_abs_CAP| objects, _i.e._, |isInitialized| |== 
% false|, have empty |V.|
% |nKSO|
% Number of Kohn-Sham orbitals in the <./DFT.html DFT model> |[ [] (default) 
% | integer | two-integer vector ]|
%% 
% * For spin-polarized models, |nKSO = [N_up, N_down]| specifies the number 
% of up- and down-spin Kohn-Sham orbitals, respectively.
%% Notes
% The results displayed in this documentation page were generated using version 
% 01.21 of the QMol-grid package.
%% 
% * |QMol_TDDFT_abs_CAP| was introduced in version 01.10.
##### SOURCE END #####
-->
</div></body></html>