<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2024a"><title>QMol_TDSE</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S3 { margin-bottom: 20px; padding-bottom: 4px;  }
.S4 { margin: 0px; padding: 10px 0px 10px 5px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 700; text-align: start;  }
.S5 { margin: -1px 0px 0px; padding: 10px 0px 10px 7px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: start;  }
.S6 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.S7 { margin: 10px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 15px; font-weight: 700; text-align: left;  }
.S8 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S9 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block }
.S10 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0.666667px solid rgb(217, 217, 217); border-bottom: 0.666667px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S11 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S12 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0.666667px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S13 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0.666667px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S14 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0' id = 'T_474FB08F' ><span style=' font-family: monospace;'>QMol_TDSE</span></h1><div  class = 'S1'><span>Parent class for time-dependent Schrodinger-equation theory (TDSE) model objects.</span></div><h2  class = 'S2' id = 'H_ED346F2A' ><span>Description</span></h2><div  class = 'S1'><span style=' font-family: monospace;'>QMol_TDSE</span><span> defines an abstract class for the time propagation of Schrodinger-equation (SE) models. It is designed to be agnostic of (i) the model dimension and (ii) the chosen discretization (Cartesian grid or basis). These are to be handled by the specific TDSE-implementation classes and their components.</span></div><div  class = 'S1'><span style=' font-family: monospace;'>QMol_TDSE</span><span> defines many peoperties and methods. Here we only document the ones visible to end users and implementation-specific overloading classes (public or protected access attributes). We provide a </span><a href = "#H_2FB9B214"><span>quick overview</span></a><span> of the requirements of implementation-specific classes for defining actual TDSE propagation schemes.</span></div><div  class = 'S3'><div  class = 'S4'><span style=' font-weight: bold;'>Table of Contents</span></div><div  class = 'S5'><a href = "#H_ED346F2A"><span>Description
</span></a><a href = "#H_24F205D3"><span>Class properties
</span></a><span>    </span><a href = "#H_5B03CB4B"><span>Time propagation
</span></a><span>        </span><a href = "#H_D8AAEC21"><span>display (disp)
</span></a><span>        </span><a href = "#H_3B6C8431"><span>time (T)
</span></a><span>        </span><a href = "#H_3CC0FE7C"><span>timeStep (dt)
</span></a><span>        </span><a href = "#H_85007098"><span>absorbingBoundary (ABC)
</span></a><span>        </span><a href = "#H_2EA3F8EC"><span>externalField (EF)
</span></a><span>    </span><a href = "#H_A211A946"><span>Save the Schrodinger-equation object into individual files
</span></a><span>        </span><a href = "#H_7A5FDD1F"><span>saveSE (sSE)
</span></a><span>        </span><a href = "#H_4D9A3574"><span>saveSEFileName (sSEF)
</span></a><span>        </span><a href = "#H_772A678B"><span>saveSETime (sSET)
</span></a><span>    </span><a href = "#H_A90EE811"><span>Save the dipole, dipole velocity, and dipole acceleration signals
</span></a><span>        </span><a href = "#H_E30347CB"><span>saveDipole (sDip)
</span></a><span>        </span><a href = "#H_9D21E9DE"><span>saveDipoleWaveFunctionIndex (sDipI)
</span></a><span>        </span><a href = "#H_CCC421C5"><span>saveDipoleTime (sDipT)
</span></a><span>        </span><a href = "#H_2978977D"><span>saveDipoleVelocity (sVel)
</span></a><span>        </span><a href = "#H_E363B1E2"><span>saveDipoleVelocityWaveFunctionIndex (sVelI)
</span></a><span>        </span><a href = "#H_FD864729"><span>saveDipoleVelocityTime (sVelT)
</span></a><span>        </span><a href = "#H_CB35D0D0"><span>saveDipoleAcceleration (sAcc)
</span></a><span>        </span><a href = "#H_F7D56BC9"><span>saveDipoleAccelerationOrbitalIndex (sAccI)
</span></a><span>        </span><a href = "#H_267F59C7"><span>saveDipoleAccelerationTime (sAccT)
</span></a><span>    </span><a href = "#H_FB7F0C94"><span>Save Schrodinger-equation and wave function energies
</span></a><span>        </span><a href = "#H_CB527D7D"><span>saveEnergySE (sESE)
</span></a><span>        </span><a href = "#H_D15EFD11"><span>saveEnergySETime (sESET)
</span></a><span>        </span><a href = "#H_6190C681"><span>saveEnergyWaveFunction (sEWfcn)
</span></a><span>        </span><a href = "#H_98DA6C1A"><span>saveEnergyWaveFunctionTime (sEWfcnT)
</span></a><span>    </span><a href = "#H_48DDF558"><span>Save the external field information
</span></a><span>        </span><a href = "#H_10596868"><span>saveExternalField (sEF)
</span></a><span>    </span><a href = "#H_65D2E853"><span>Save the ionization signal
</span></a><span>        </span><a href = "#H_6B566C83"><span>saveIonization (sIon)
</span></a><span>        </span><a href = "#H_07FC104D"><span>saveIonizationWaveFunctionIndex (sIWfcnI)
</span></a><span>        </span><a href = "#H_01E66AA1"><span>saveIonizationTime (sIonT)
</span></a><span>    </span><a href = "#H_E89C839B"><span>Save the wave functions and their projection on a basis
</span></a><span>        </span><a href = "#H_2A78E237"><span>saveWaveFunction (sWfcn)
</span></a><span>        </span><a href = "#H_F26B9668"><span>saveWaveFunctionIndex (sWfcnI)
</span></a><span>        </span><a href = "#H_A93BF65C"><span>saveWaveFunctionTime (sWfcnT)
</span></a><span>        </span><a href = "#H_0A85DA1C"><span>saveWaveFunctionProjection (sWfcnP)
</span></a><span>        </span><a href = "#H_6BFEE12B"><span>saveWaveFunctionProjectionBasis (sWfcnB)
</span></a><span>        </span><a href = "#H_44353F0D"><span>saveWaveFunctionProjectionIndex (sWfcnPI)
</span></a><span>        </span><a href = "#H_71646414"><span>saveWaveFunctionProjectionTime (sWfcnPT)
</span></a><span>    </span><a href = "#H_236395D1"><span>Save the output of a functions of the wave function
</span></a><span>        </span><a href = "#H_13D0EA88"><span>saveOutputFunction (sF)
</span></a><span>        </span><a href = "#H_B72B0D00"><span>saveOutputFunctionTime (sFT)
</span></a><span>    </span><a href = "#H_5CD2979A"><span>Save restart data file
</span></a><span>        </span><a href = "#H_06F9031D"><span>saveRestart (sRest)
</span></a><span>        </span><a href = "#H_AE8821C0"><span>saveRestartFileName (sRestF)
</span></a><span>        </span><a href = "#H_5668813B"><span>saveRestartTime (sRestT)
</span></a><span>    </span><a href = "#H_D533B953"><span>Output results
</span></a><span>        </span><a href = "#H_28F8C3A4"><span>outSE (oSE)
</span></a><span>        </span><a href = "#H_F65810AA"><span>outDipole (oDip)
</span></a><span>        </span><a href = "#H_95407807"><span>outDipoleVelocity (oVel)
</span></a><span>        </span><a href = "#H_02629977"><span>outDipoleAcceleration (oAcc)
</span></a><span>        </span><a href = "#H_B6B04F7C"><span>outEnergySE (oESE)
</span></a><span>        </span><a href = "#H_71BECE2C"><span>outEnergyWaveFunction (oEKSO)
</span></a><span>        </span><a href = "#H_E1C662FA"><span>outIonization (oIon)
</span></a><span>        </span><a href = "#H_371940E8"><span>outWaveFunction (oWfcn)
</span></a><span>        </span><a href = "#H_5096ABA5"><span>outWaveFunctionProjection (oWfcnP)
</span></a><span>        </span><a href = "#H_25C1C7F6"><span>outOutputFunction (oF)
</span></a><span>        </span><a href = "#H_B2980914"><span>outRestart (oRest)
</span></a><span>    </span><a href = "#H_C8F30381"><span>Other hidden class properties
</span></a><span>        </span><a href = "#H_37454CF9"><span>SE
</span></a><span>        </span><a href = "#H_110A8982"><span>tspan
</span></a><span>        </span><a href = "#H_8882E7D7"><span>iref
</span></a><span>        </span><a href = "#H_4F8B0111"><span>restart
</span></a><a href = "#H_444F9B6D"><span>Class methods
</span></a><span>    </span><a href = "#H_A7EA7D3E"><span>Creation
</span></a><span>        </span><a href = "#H_0783E8B1"><span>constructor
</span></a><span>    </span><a href = "#H_87F4F901"><span>Changing class properties
</span></a><span>        </span><a href = "#H_4405B79D"><span>set
</span></a><span>        </span><a href = "#H_C729A888"><span>clear
</span></a><span>    </span><a href = "#H_686ACD09"><span>Initializing the object
</span></a><span>        </span><a href = "#H_85EFED0A"><span>initialize
</span></a><span>        </span><a href = "#H_3FFF1372"><span>initializeChildren
</span></a><span>        </span><a href = "#H_63C6DA3F"><span>getOutputIndex
</span></a><span>        </span><a href = "#H_D3F27113"><span>setOutputChildren
</span></a><span>        </span><a href = "#H_12E03134"><span>setOutputSE
</span></a><span>        </span><a href = "#H_5D387730"><span>setOutputDipole
</span></a><span>        </span><a href = "#H_C32F9472"><span>setOutputEnergy
</span></a><span>        </span><a href = "#H_C219079B"><span>setOutputFunction
</span></a><span>        </span><a href = "#H_EA0844B5"><span>setOutputIonization
</span></a><span>        </span><a href = "#H_D7894DE5"><span>setOutputWaveFunction
</span></a><span>        </span><a href = "#H_C640DA93"><span>setOutputRestart
</span></a><span>        </span><a href = "#H_5904178E"><span>finalize
</span></a><span>    </span><a href = "#H_B2D31FE3"><span>Run-time documentation
</span></a><span>        </span><a href = "#H_E3988947"><span>getMemoryProfile
</span></a><span>        </span><a href = "#H_ABD08C91"><span>showDocumentation
</span></a><span>    </span><a href = "#H_AEFB66DB"><span>TDSE propagation
</span></a><span>        </span><a href = "#H_5CD9DA16"><span>propagate
</span></a><span>        </span><a href = "#H_DC96BD5E"><span>saveOutputSE
</span></a><span>        </span><a href = "#H_9ED0647B"><span>setOutputEnergy
</span></a><span>        </span><a href = "#H_1C92546A"><span>saveOutputFunction
</span></a><a href = "#H_2FB9B214"><span>Overloading the class
</span></a><span>    </span><a href = "#H_B9A8411A"><span>Methods that must be overloaded
</span></a><span>        </span><a href = "#H_884CFDF5"><span>propertyNames
</span></a><span>        </span><a href = "#H_D8A9FEA5"><span>showDoc
</span></a><span>        </span><a href = "#H_CBF28755"><span>setOutputWaveFunction
</span></a><span>        </span><a href = "#H_8328AE09"><span>setTimeStep
</span></a><span>        </span><a href = "#H_BE45A424"><span>applyTimeStep
</span></a><span>        </span><a href = "#H_3FBF0B69"><span>saveOutputDipole
</span></a><span>        </span><a href = "#H_FDA44F8F"><span>getExternalFieldEnergy
</span></a><span>        </span><a href = "#H_4BB23773"><span>saveOutputIonization
</span></a><span>        </span><a href = "#H_24EF3880"><span>saveOutputWaveFunction
</span></a><span>    </span><a href = "#H_C9A49DFA"><span>Additional optional methods to overload
</span></a><span>        </span><a href = "#H_DC4E9FF3"><span>getMemoryProfilePropagator
</span></a><span>        </span><a href = "#H_483AC36A"><span>getMemoryProfileWaveFunction
</span></a><span>        </span><a href = "#H_A5C2DE6E"><span>getMemoryProfileChildren
</span></a><span>        </span><a href = "#H_B96633C8"><span>docOutputChildren
</span></a><span>        </span><a href = "#H_675447D6"><span>setOutputChildren
</span></a><span>        </span><a href = "#H_DF38E3D0"><span>setOutputExternalField
</span></a><span>        </span><a href = "#H_F3159701"><span>setRestartChildren
</span></a><span>        </span><a href = "#H_E5FC9CB8"><span>saveOutputChildren
</span></a><span>        </span><a href = "#H_B478C7F5"><span>addOutputExternalField
</span></a><span>        </span><a href = "#H_9D80AD2B"><span>saveRestartChildren
</span></a><a href = "#H_8CAFC83D"><span>Bourdary absorber
</span></a><span>    </span><a href = "#H_CA02FC07"><span>Mask function
</span></a><span>    </span><a href = "#H_64DC68BD"><span>Complex absorbing potential (CAP)
</span></a><a href = "#H_D431B55B"><span>Test suite
</span></a><a href = "#H_2E204287"><span>Notes</span></a></div></div><h2  class = 'S2' id = 'H_24F205D3' ><span>Class properties</span></h2><h3  class = 'S6' id = 'H_5B03CB4B' ><span>Time propagation</span></h3><h4  class = 'S7' id = 'H_D8AAEC21' ><span style=' font-family: monospace;'>display (disp)</span></h4><div  class = 'S1'><span>Whether to display progress of the TDSE calculations as they go on </span><span style=' font-family: monospace;'>[ true (default) | false ]</span></div><h4  class = 'S7' id = 'H_3B6C8431' ><span style=' font-family: monospace;'>time (T)</span></h4><div  class = 'S1'><span>Time propagation vector </span><span style=' font-family: monospace;'>[ vector (default []) ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>In all TDSE propagation simulations </span><span style=' font-family: monospace;'>T(1)</span><span> specifies the starting time and </span><span style=' font-family: monospace;'>T(end)</span><span> the ending time.</span></li><li  class = 'S9'><span>In forward time propagation simulations (</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'> &gt; 0</span><span>) time values in </span><span style=' font-family: monospace;'>T</span><span> must be all increasing, while for backward time propagation (</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'> &lt; 0</span><span>) they must be all decreasing. Time increments in the vector </span><span style=' font-family: monospace;'>T</span><span> need not be equally spaced.</span></li><li  class = 'S9'><span>When </span><a href = "#H_D8AAEC21"><span style=' font-family: monospace;'>display</span></a><span> is activated, </span><span style=' font-family: monospace;'>T</span><span> specifies the intermediary times for the time-propagation progress display.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>T</span><span> is also the default time sampling for saved results that do not define their own.</span></li><li  class = 'S9'><span>Note that the time step used in TDSE propagations is set independently of </span><span style=' font-family: monospace;'>T</span><span>.</span></li></ul><h4  class = 'S7' id = 'H_3CC0FE7C' ><span style=' font-family: monospace;'>timeStep (dt)</span></h4><div  class = 'S1'><span>Time step used for the time propagation </span><span style=' font-family: monospace;'> [ scalar (default 0.01) ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Positive (resp. negative) </span><span style=' font-family: monospace;'>timeStep</span><span> define forward (resp. ackward) time propagation.</span></li></ul><h4  class = 'S7' id = 'H_85007098' ><span style=' font-family: monospace;'>absorbingBoundary (ABC)</span></h4><div  class = 'S1'><span>Absorber at the edges of the domain </span><span style=' font-family: monospace;'>[ [] (default) | mask object | CAP object ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>The boundary absorber aims at eliminating outgoing wave packets from the discretization domain and avoid spurious reflections at the edges of the domain.</span></li><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>absorbingBoundary</span><span> does not implement any absorbing boundary method and any part of the wave packet reaching the edges of the domain will be reflected (or articifially reappears on the other side of the domain through periodic effects).</span></li><li  class = 'S9'><span>Mask absorbers are applied at the end of each propagation step. They are the easiest to use and implement but are first order, irrespective of the order of the time propagation scheme. See </span><a href = "#H_CA02FC07"><span>below</span></a><span> for details on the required interface for absorbing mask classes.</span></li><li  class = 'S9'><span>Complex absorbing potentials (CAPs) are integrated within the propagation scheme, as an imaginary potential term that causes exponential decay of the wave packet at the edges. Under the right circumstances, CAPs can preserve the order of the propagation schemes. See </span><a href = "#H_64DC68BD"><span>below</span></a><span> for details on the required interface for CAP classes.</span></li></ul><h4  class = 'S7' id = 'H_2EA3F8EC' ><span style=' font-family: monospace;'>externalField (EF)</span></h4><div  class = 'S1'><span>External driving field </span><span style=' font-family: monospace;'>[ [] (default) | field object ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>externalField</span><span> performs field-free TDSE simulations.</span></li><li  class = 'S9'><span>The specific type and interface for compatible field objects is left to the implementation-specific TDSE propagator -- see the corresponding documentation for details.</span></li></ul><h3  class = 'S6' id = 'H_A211A946' ><span>Save the Schrodinger-equation object into individual files</span></h3><div  class = 'S1'><span>During the time propagation, copies of the Schrodinger-equation object can be saved in separate MATLAB files.</span></div><h4  class = 'S7' id = 'H_7A5FDD1F' ><span style=' font-family: monospace;'>saveSE (sSE)</span></h4><div  class = 'S1'><span>Activate saving the Schrodinger-equation object into separate files </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S7' id = 'H_4D9A3574' ><span style=' font-family: monospace;'>saveSEFileName (sSEF)</span></h4><div  class = 'S1'><span>Name for the files in which the Schrodinger-equation objects are saved </span><span style=' font-family: monospace;'>[ chracter array (default 'QMolGrid--TDSE--SE') ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>The Schrodinger-equation objects saved at different times are put in separate MATLAB (.mat.) file, with names starting with </span><span style=' font-family: monospace;'>saveSEFileName</span><span> to which the iteration index is appended. Each file produced also contains a scalar variable </span><span style=' font-family: monospace;'>t</span><span> with the time information.</span></li><li  class = 'S9'><span>One may specify a location where to create the files by indicating the folder path in </span><span style=' font-family: monospace;'>saveSEFileName</span></li><li  class = 'S9'><span style=' font-family: monospace;'>saveSEFileName</span><span> is irrelevant when </span><a href = "#H_7A5FDD1F"><span style=' font-family: monospace;'>saveSE</span></a><span style=' font-family: monospace;'> == false</span></li></ul><h4  class = 'S7' id = 'H_772A678B' ><span style=' font-family: monospace;'>saveSETime (sSET)</span></h4><div  class = 'S1'><span>Times at which to save the Schrodinger-equation object into a file </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveSETime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to save the Schrodinger-equation object into MATLAB files.</span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step when to save the Schrodinger-equation object into MATLAB files. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveSETime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveSETime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between saves. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveSETime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveSETime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to save the Schrodinger-equation object to a MATLAB file.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> saves the Schrodinger-equation object into a MATLAB file after every time step. Warning: this is slow and may result in a very large number of file and/or large disk usage.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDSE propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h3  class = 'S6' id = 'H_A90EE811' ><span>Save the dipole, dipole velocity, and dipole acceleration signals</span></h3><h4  class = 'S7' id = 'H_E30347CB' ><span style=' font-family: monospace;'>saveDipole (sDip)</span></h4><div  class = 'S1'><span>Whether to calculate and save the dipole signal during the TDSE propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S7' id = 'H_9D21E9DE' ><span style=' font-family: monospace;'>saveDipoleWaveFunctionIndex (sDipI)</span></h4><div  class = 'S1'><span>Index of the wave functions for which to compute the orbital-resolved dipole signal </span><span style=' font-family: monospace;'>[ [] (default) | index vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>This is irrelevant if </span><a href = "#H_E30347CB"><span style=' font-family: monospace;'>saveDipole</span></a><span> is </span><span style=' font-family: monospace;'>false</span></li><li  class = 'S9'><span>Specify the indexes of the wave functions for which to compute the orbital-resolved dipole signal in an index vector</span></li><li  class = 'S9'><span>Empty or </span><span style=' font-family: monospace;'>'all'</span><span> </span><span style=' font-family: monospace;'>saveDipoleWaveFunctionIndex</span><span> computes the orbital-resolved dipole for all wave functions</span></li></ul><h4  class = 'S7' id = 'H_CCC421C5' ><span style=' font-family: monospace;'>saveDipoleTime (sDipT)</span></h4><div  class = 'S1'><span>Times at which to compute and save the dipole signal </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveDipoleTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to compute and save the dipole signal.</span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step between successive computations of the dipole signal. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveDipoleTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveDipoleTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between dipole-signal computations. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveDipoleTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveDipoleTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to compute and save the dipole signal.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> computes and saves the dipole signal after every time step. Warning: this is may be slow.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDSE propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h4  class = 'S7' id = 'H_2978977D' ><span style=' font-family: monospace;'>saveDipoleVelocity (sVel)</span></h4><div  class = 'S1'><span>Whether to calculate and save the dipole velocity signal during the TDSE propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S7' id = 'H_E363B1E2' ><span style=' font-family: monospace;'>saveDipoleVelocityWaveFunctionIndex (sVelI)</span></h4><div  class = 'S1'><span>Index of the wave functions for which to compute the orbital-resolved dipole velocity signal </span><span style=' font-family: monospace;'>[ [] (default) | index vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>This is irrelevant if </span><a href = "#H_2978977D"><span style=' font-family: monospace;'>saveDipoleVelocity</span></a><span> is </span><span style=' font-family: monospace;'>false</span></li><li  class = 'S9'><span>Specify the indexes of the wave functions for which to compute the dipole velocity signal in an index vector</span></li><li  class = 'S9'><span>Empty or </span><span style=' font-family: monospace;'>'all'</span><span> </span><span style=' font-family: monospace;'>saveDipoleVelocityWaveFunctionIndex</span><span> computes the dipole velocity for all wave functions</span></li></ul><h4  class = 'S7' id = 'H_FD864729' ><span style=' font-family: monospace;'>saveDipoleVelocityTime (sVelT)</span></h4><div  class = 'S1'><span>Times at which to compute and save the dipole velocity signal </span><span style=' font-family: monospace;'>[ 'dipole' (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>'dipole'</span><span> </span><span style=' font-family: monospace;'>saveDipoleVelocityTime</span><span> uses the same times as for </span><a href = "#H_CCC421C5"><span style=' font-family: monospace;'>saveDipoleTime</span></a><span> </span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step between successive computations of the dipole velocity signal. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveDipoleVelocityTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveDipoleVelocityTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between dipole-velocity-signal computations. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveDipoleVelocityTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveDipoleVelocityTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to compute and save the dipole velocity signal.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> computes and saves the dipole velocity signal after every time step. Warning: this is may be slow.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDSE propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h4  class = 'S7' id = 'H_CB35D0D0' ><span style=' font-family: monospace;'>saveDipoleAcceleration (sAcc)</span></h4><div  class = 'S1'><span>Whether to calculate and save the dipole acceleration signal during the TDSE propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S7' id = 'H_F7D56BC9' ><span style=' font-family: monospace;'>saveDipoleAccelerationOrbitalIndex (sAccI)</span></h4><div  class = 'S1'><span>Index of the Kohn-Sham orbitals for which to compute the orbital-resolved dipole acceleration signal </span><span style=' font-family: monospace;'>[ [] (default) | index vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>This is irrelevant if </span><a href = "#H_CB35D0D0"><span style=' font-family: monospace;'>saveDipoleAcceleration</span></a><span> is </span><span style=' font-family: monospace;'>false</span></li><li  class = 'S9'><span>Specify the indexes of the wave functions for which to compute the dipole acceleration signal in an index vector</span></li><li  class = 'S9'><span>Empty or </span><span style=' font-family: monospace;'>'all'</span><span> </span><span style=' font-family: monospace;'>saveDipoleAccelerationWaveFunctionIndex</span><span> computes the dipole acceleration for all wave functions</span></li></ul><h4  class = 'S7' id = 'H_267F59C7' ><span style=' font-family: monospace;'>saveDipoleAccelerationTime (sAccT)</span></h4><div  class = 'S1'><span>Times at which to compute and save the dipole acceleration signal </span><span style=' font-family: monospace;'>[ 'dipole' (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>'dipole'</span><span> </span><span style=' font-family: monospace;'>saveDipoleAccelerationTime</span><span> uses the same times as for </span><a href = "#H_CCC421C5"><span style=' font-family: monospace;'>saveDipoleTime</span></a><span> </span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step between successive computations of the dipole acceleration signal. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveDipoleAccelerationTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveDipoleAccelerationTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between dipole-acceleration-signal computations. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveDipoleAccelerationTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveDipoleAccelerationTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to compute and save the dipole acceleration signal.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> computes and saves the dipole acceleration signal after every time step. Warning: this is may be slow.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDSE propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h3  class = 'S6' id = 'H_FB7F0C94' ><span>Save </span><span style=' font-weight: bold;'>Schrodinger-equation and wave function </span><span>energies</span></h3><h4  class = 'S7' id = 'H_CB527D7D' ><span style=' font-family: monospace;'>saveEnergySE (sESE)</span></h4><div  class = 'S1'><span>Whether to track the Schrodinger-equation energy during the TDSE propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S7' id = 'H_D15EFD11' ><span style=' font-family: monospace;'>saveEnergySETime (sESET)</span></h4><div  class = 'S1'><span>Times at which to compute and save the Schrodinger-equation energy </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveEnergySETime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to compute and save the Schrodinger-equation energy</span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step between successive computations of the Schrodinger-equation energy. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveEnergySETime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveEnergySETime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between Schrodinger-equation-energy computations. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveEnergySETime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveEnergySETime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to compute and save the Schrodinger-equation energy.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> computes and saves the Schrodinger-equation energy after every time step. Warning: this is may be slow.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDSE propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h4  class = 'S7' id = 'H_6190C681' ><span style=' font-family: monospace;'>saveEnergyWaveFunction (sEWfcn)</span></h4><div  class = 'S1'><span>Whether to track the wave function energies during the TDSE propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S7' id = 'H_98DA6C1A' ><span style=' font-family: monospace;'>saveEnergyWaveFunctionTime (sEWfcnT)</span></h4><div  class = 'S1'><span>Times at which to compute and save the wave function energies </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>For a wave function </span><span texencoding="|\psi\rangle" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAAkCAYAAAD2IghRAAAAAXNSR0IArs4c6QAABM5JREFUWEftWFtoHFUY/v6Z2dVdLai0pMSkM7O7JjaWWgUpKmh8EJK2NAi2FrVqG6pQ460vYhV9sVVf4qU2oNFCFWpFfUiNbaEPRvCOaBFMTd3MJdkE4h2qu92d2fnlwEwYl012N5eaYPdpOXPOP9/5zv//33eGsEh/tEhx4zzwc31y5xn/XzKuadqVRLTMcZxvMplMrhoSyqZKc3Pzknw+3ylJUsxxnIOjo6Pj1QSb6ZxkMnmD53nHmfl+y7IOVxOnLPCmpqaljuP0A1jueV67bdunqgk20zktLS0XZ7PZg2J9PB6/d3Bw8K9KsRYEcAFS07QtRPQWM2+0LOv4ogHe0NBweSQS6WfmbxVF2ZlOp/PTgV8wjLe2tiq2bb8AYBszr7Ms68tFAVyADIoUQK+qqo8PDAy4U4FfMIwLgEGREtEqWZbXpdPp4UUBPFSk7wB4yjTNvQC4HPiaGE8kEtcx8z4A1wL4GMDDpmkOhQOrqnqbLMtrmPnXbDZ7YGJi4m//Oamqeg0RPUhEbUT0dbFY3GXbthle39jYWK8oSp8Yc123YyoNqQm4CJZKpZLFYvEogCYAPbFY7LHBwcGCeCaEq1AovA2gA8A+VVV3+XlKuq5vBfAagBwzb7Ms68gUbIq5uwE8KzZpGEbPrBkXAerr6+PRaLSXiO4E8JnjOBszmczv4pmqqislSTom/gLYZJrm+6XjzPyMpml7pys8XddXAzjGzD+6rrspiB/eQM2MTwdc1/XbAbwHwA4p7iSDAE5XKjr/VC9wXbeHiMQp3WWapoj5r1/NwFOp1LJisShy8HoAQukesCzrrN+HuwE8BKAvGo1uHRoaOlMyvzcWi3UFqTVdn9Y0TdTBEWb+sJwNqBm4pmlriegEgCUAnvQrX+R+eEOT4+H5RNRpGMaBSnLud5flAPqJaGk5v1QzcF3XdwB4XQQnog2GYXzkvyjY0IXMfKtlWZ/4448Q0UsAzvjjX1UJfO4Yb2lpieZyuVcBCPCjsiy3p9PpH0oAnnQcZ0MmkxlLpVJBrm4H8IUsyx3pdPqXSsBD6+YmxxsaGi6LRCKijd0Y7iglBTuZxyWts7uSjAcbmvOuEvLpa5n5UKFQ2DE+Pp5VVVWXJEmkzMpQHotu0gXgFQB/VGOcAqEK9fEpa6KmHK+rq7soHo+/CeAOAO9ms9lOoYyJRGI9M4uLx8+e57XZtv2dYNt13T4iuoqZn9M07enpenfA9rwpZyKR2MnM+0M92dA0bQ8RPQHgBDNvVhTFKxaLYs7dRHQ4n893jY2N/VYpt8NeRcQzDEPY3Nl7FRFYOLhcLidA3eP38RclSepm5lsA7BdAmVmYoyuIaLckSYcqXQqCDc27OxRiY5rmalmWrwZwEzPf57/8Dc/zjkYikdPRaPSnaoQmfArn1I8nEontzCzy/pTneetL3V416SHmhG5AWwC0m6b5/XRrayrO0kDhvh7uMtWCDc8LWiczfzrvd87gggtA+O9HLct6eSagxRq/6J+XJKlteHj480pxZsW4pmk3+77lbC1yXgpKCJuiKMIB/jmr7yrVfsnyhWJPLXJejknfCX5ARJsD7zMjxistCoppZGRkDYBLBFMrVqw4WY3AlIudTCZXeZ536ay/HVYD/L+e8w9hgLlSy86goQAAAABJRU5ErkJggg==" width="23" height="18" /></span><span>, the orbital energy is defined as </span><span texencoding="\langle\psi|\hat{\mathcal{H}}|\psi\rangle" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="58" height="23" /></span><span> with </span><span texencoding="\hat{\mathcal{H}}" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="18" height="23" /></span><span> the Schrodinger-equation Hamiltonian operator.</span></li><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveEnergyWaveFunctionTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to compute and save the wave function energies</span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step between successive computations of the wave function energies. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveEnergyWaveFunctionTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveEnergyWaveFunctionTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between wave function energy computations. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveEnergyWaveFunctionTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveEnergyWaveFunctionTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to compute and save the wave function energies.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> computes and saves the wave function energies after every time step. Warning: this is may be slow.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDSE propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h3  class = 'S6' id = 'H_48DDF558' ><span>Save the external field information</span></h3><h4  class = 'S7' id = 'H_10596868' ><span style=' font-family: monospace;'>saveExternalField (sEF)</span></h4><div  class = 'S1'><span>For TDSE simulation with and </span><a href = "#H_2EA3F8EC"><span>external driving field</span></a><span>, save the external field in output structures </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>When activated (</span><span style=' font-family: monospace;'>saveExternalField = true</span><span>), the information about the external driving field at the sampled times is added to each of the </span><a href = "#H_D533B953"><span>output structures</span></a><span> (except </span><a href = "#H_28F8C3A4"><span style=' font-family: monospace;'>outSE</span></a><span>).</span></li><li  class = 'S9'><span>For practical reasons, the values for the external driving field may be slightly different than that of </span><a href = "#H_2EA3F8EC"><span style=' font-family: monospace;'>externalField</span></a><span>. This features enables keeping the actual external-field values used throughout the propagation.</span></li></ul><h3  class = 'S6' id = 'H_65D2E853' ><span>Save the ionization signal</span></h3><div  class = 'S1'><span>The ionization signal tracks how much density leaves the simulation domain by being </span><a href = "#H_8CAFC83D"><span>absorbed at the boundaries</span></a><span>.</span></div><h4  class = 'S7' id = 'H_6B566C83' ><span style=' font-family: monospace;'>saveIonization (sIon)</span></h4><div  class = 'S1'><span>Whether to calculate and save the ionization signal during the TDSE propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S7' id = 'H_07FC104D' ><span style=' font-family: monospace;'>saveIonizationWaveFunctionIndex (sIWfcnI)</span></h4><div  class = 'S1'><span>Index of the wave functions for which to compute the orbital-resolved ionization signal </span><span style=' font-family: monospace;'>[ [] (default) | index vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>This is irrelevant if </span><a href = "#H_6B566C83"><span style=' font-family: monospace;'>saveIonization</span></a><span> is </span><span style=' font-family: monospace;'>false</span></li><li  class = 'S9'><span>Specify the indexes of the wave functions for which to compute the ionization signal in an index vector</span></li><li  class = 'S9'><span>Empty or </span><span style=' font-family: monospace;'>'all'</span><span> </span><span style=' font-family: monospace;'>saveIonizationWaveFunctionIndex</span><span> computes the ionization for all wave functions</span></li></ul><h4  class = 'S7' id = 'H_01E66AA1' ><span style=' font-family: monospace;'>saveIonizationTime (sIonT)</span></h4><div  class = 'S1'><span>Times at which to compute and save the ionization signal </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveIonizationTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to compute and save the ionization signal.</span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step between successive computations of the ionization signal. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveIonizationTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveIonizationTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between ionization-signal computations. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveIonizationTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveIonizationTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to compute and save the ionization signal.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> computes and saves the ionization signal after every time step. Warning: this is may be slow.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDSE propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h3  class = 'S6' id = 'H_E89C839B' ><span>Save the </span><span style=' font-weight: bold;'>wave functions and their projection on a basis</span></h3><div  class = 'S1' id = 'M_5BAA8F46' ><span style=' text-decoration: underline;'>Warning:</span><span> The memory requirements for saving the wave function throughout the TDSE propagation may grow very fast and trigger an error (if MATLAB runs out of memory). Instead, if the full wave function is required consider </span><a href = "#H_A211A946"><span>saving the Schrodinger-equation object in separate files</span></a><span>, or if only the result of a specify calculation on the wave function is required consider consider using an installabe </span><a href = "#H_236395D1"><span>output function</span></a><span>.</span></div><h4  class = 'S7' id = 'H_2A78E237' ><span style=' font-family: monospace;'>saveWaveFunction (sWfcn)</span></h4><div  class = 'S1'><span>Whether to save the wave functions during the TDSE propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S7' id = 'H_F26B9668' ><span style=' font-family: monospace;'>saveWaveFunctionIndex (sWfcnI)</span></h4><div  class = 'S1'><span>Index of the wave functions to save </span><span style=' font-family: monospace;'>[ [] (default) | index vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>This is irrelevant if </span><a href = "#H_2A78E237"><span style=' font-family: monospace;'>saveWaveFunction</span></a><span> is </span><span style=' font-family: monospace;'>false</span></li><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveWaveFunctionIndex</span><span> disables saving of the wave functions and is technically equivalent to </span><a href = "#H_2A78E237"><span style=' font-family: monospace;'>saveWaveFunction</span></a><span style=' font-family: monospace;'>= false</span></li><li  class = 'S9'><span>Specify the indexes of the wave functions to save in an index vector</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> saves all the wave functions</span></li></ul><h4  class = 'S7' id = 'H_A93BF65C' ><span style=' font-family: monospace;'>saveWaveFunctionTime (sWfcnT)</span></h4><div  class = 'S1'><span>Times at which to save the wave functions </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveWaveFunctionTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to save the wave functions.</span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step between successive saving of the wave functions. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveWaveFunctionTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveWaveFunctionTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between saving wave functions. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveWaveFunctionTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveWaveFunctionTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to save the wave functions.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> saves the wave functions after every time step. Warning: generally discouraged as it likely results in very large memory requirements or cause an out-of-memory error -- see the </span><a href = "#M_5BAA8F46"><span>warning above</span></a><span>.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDSE propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h4  class = 'S7' id = 'H_0A85DA1C' ><span style=' font-family: monospace;'>saveWaveFunctionProjection (sWfcnP)</span></h4><div  class = 'S1'><span>Whether to save the projection of the wave functions onto a specific basis during the TDSE propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S7' id = 'H_6BFEE12B' ><span style=' font-family: monospace;'>saveWaveFunctionProjectionBasis (sWfcnB)</span></h4><div  class = 'S1'><span>Projection basis </span><span style=' font-family: monospace;'>[ [] (default) | basis ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveWaveFunctionProjectionBasis</span><span> uses the initial wave functions as the projection basis</span></li><li  class = 'S9'><span>User-defined </span><span style=' font-family: monospace;'>basis</span><span> is implementation dependent -- see the respective documentations for details</span></li></ul><h4  class = 'S7' id = 'H_44353F0D' ><span style=' font-family: monospace;'>saveWaveFunctionProjectionIndex (sWfcnPI)</span></h4><div  class = 'S1'><span>Index of the wave functions for which to perform the projection </span><span style=' font-family: monospace;'>[ [] (default) | index vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>This is irrelevant if </span><a href = "#H_0A85DA1C"><span style=' font-family: monospace;'>saveWaveFunctionProjection</span></a><span> is </span><span style=' font-family: monospace;'>false</span></li><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveWaveFunctionProjectionIndex</span><span> disables saving of the wave functions and is technically equivalent to </span><a href = "#H_0A85DA1C"><span style=' font-family: monospace;'>saveWaveFunctionProjection</span></a><span> </span><span style=' font-family: monospace;'>= false</span></li><li  class = 'S9'><span>Specify the indexes of the wave functions for which to perform the projection in an index vector</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> saves the projection for all the wave functions</span></li></ul><h4  class = 'S7' id = 'H_71646414' ><span style=' font-family: monospace;'>saveWaveFunctionProjectionTime (sWfcnPT)</span></h4><div  class = 'S1'><span>Times at which to save the projection of the wave functions </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveWaveFunctionProjectionTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to save the projection of the wave functions.</span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step between successive saving of the wave functions' projection. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveWaveFunctionProjectionTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveWaveFunctionProjectionTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between saving wave functions' projection. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveWaveFunctionProjectionTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveWaveFunctionProjectionTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to save the wave functions' projection.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> saves the wave functions' projection after every time step. Warning: this may be slow.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDSE propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h3  class = 'S6' id = 'H_236395D1' ><span>Save </span><span style=' font-weight: bold;'>the output of a functions of the wave function</span></h3><h4  class = 'S7' id = 'H_13D0EA88' ><span style=' font-family: monospace;'>saveOutputFunction (sF)</span></h4><div  class = 'S1'><span>Installable output function of the wave functions </span><span style=' font-family: monospace;'>[ [] (default) | function handle ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Leave empty to disable the feature</span></li><li  class = 'S9'><span>Provide a function handle to enable the feature. The signature for the function is </span><span style=' font-family: monospace;'>fun(wfcn,t)</span><span> where </span><span style=' font-family: monospace;'>wfcn</span><span> is a wave function object and </span><span style=' font-family: monospace;'>t</span><span> is the time (scalar). The function handle may return an array of arbitrary size and shape, but must return at least a scalar and the shape of the output must remain constant throughout the TDSE propagation.</span></li><li  class = 'S9'><span style=' text-decoration: underline;'>Warning:</span><span> The Schrodinger-equation model wave functions are passed by reference to the output function. Thus modifying the wave functions in the output function will also modify them for the Schrodinger-equation model (and thus TDSE propagation) and will likely result in erroneous results or produce an error.</span></li></ul><h4  class = 'S7' id = 'H_B72B0D00' ><span style=' font-family: monospace;'>saveOutputFunctionTime (sFT)</span></h4><div  class = 'S1'><span>Times at which to evaluate and save the installable output function of the wave functions </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveOutputFunctionTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to evaluate and save the output function.</span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step between successive evaluation and saving of the output function. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveOutputFunctionTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveOutputFunctionTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between evaluations and saving of the output function. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveOutputFunctionTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveOutputFunctionTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to evaluate and save the output function.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> evaluates and saves the output function after every time step. Warning: this may be slow.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDSE propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h3  class = 'S6' id = 'H_5CD2979A' ><span>Save restart data file</span></h3><div  class = 'S1'><span>During the time propagation, a restart file can be generated to enable resuming the simulation if it is cut short. Stopping the TDSE simulation while it writes the restart info may lead to a corrupted file from which restart will not be possible. The restart file contains a copy of the TDSE-propagator and Schrodinger-equation-model objects, respectively called </span><span style=' font-family: monospace;'>TDSE</span><span> and </span><span style=' font-family: monospace;'>SE</span><span> in the MATLAB restart file.</span></div><h4  class = 'S7' id = 'H_06F9031D' ><span style=' font-family: monospace;'>saveRestart (sRest)</span></h4><div  class = 'S1'><span>Activate the generation of a restart file </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S7' id = 'H_AE8821C0' ><span style=' font-family: monospace;'>saveRestartFileName (sRestF)</span></h4><div  class = 'S1'><span>Name for the restart file </span><span style=' font-family: monospace;'>[ chracter array (default 'QMolGrid--TDSE--Restart.mat') ]</span></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>saveRestartFileName</span><span> must be a valid MATLAB file name ('.mat' extension).</span></li><li  class = 'S9'><span style=' font-family: monospace;'>saveRestartFileName</span><span> is irrelevant when </span><a href = "#H_06F9031D"><span style=' font-family: monospace;'>saveRestart</span></a><span style=' font-family: monospace;'> == false</span></li></ul><h4  class = 'S7' id = 'H_5668813B' ><span style=' font-family: monospace;'>saveRestartTime (sRestT)</span></h4><div  class = 'S1'><span>Times at which to generate or update the restart file </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveRestartTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to generate and update the restart file.</span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step when to generate and update the restart file. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveRestartTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveRestartTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between the generation and update of the restart file. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveRestartTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveRestartTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to generate and update the restart file.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> generates and updates the restart file after each time step. Warning: this is very slow and is strongly discouraged.</span></li><li  class = 'S9'><span style=' text-decoration: underline;'>Note:</span><span> In all cases no restart file is generated for the initial time and final propagation time-step.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDSE propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h3  class = 'S6' id = 'H_D533B953' ><span>Output results</span></h3><div  class = 'S1' id = 'M_16F59492' ><span>During a TDSE propagation, the results of on-the-fly calculations are strored in structures in the </span><span style=' font-family: monospace;'>QMol_TDSE</span><span> object. Note that </span><span style=' font-family: monospace;'>QMol_TDSE</span><span> does </span><span style=' text-decoration: underline;'>not</span><span> interpolate its time propagation to fit user-supplied sample times, Insatead, the results are saved at the closest propagation time steps, excluding duplicate times. This may result in sampled times that are different, or have a different (smaller) number of elements, than the ones specified above. Notably, using a sampling time that is not a multiple of the propagation time step may result in uneven saved time sampling. The actual times at with output are saved is included in each of the output structure.</span></div><div  class = 'S1'><span>In </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>, each output structure in the </span><span style=' font-family: monospace;'>QMol_TDSE</span><span> object contains the fields </span><span style=' font-family: monospace;'>ind</span><span> and </span><span style=' font-family: monospace;'>n</span><span>, respectively with the propagation time indexes at which to save the associated results and the next index in </span><span style=' font-family: monospace;'>ind</span><span> at which saving should be performed. These two fields are </span><a href = "#H_5904178E"><span>removed</span></a><span> from each output structure upon completion of the TDSE propagation.</span></div><h4  class = 'S7' id = 'H_28F8C3A4' ><span style=' font-family: monospace;'>outSE (oSE)</span></h4><div  class = 'S1'><span>Support for </span><a href = "#H_A211A946"><span>saving the Schrodinger-equation object into individual MATLAB files</span></a><span> during propagation </span><span style=' font-family: monospace;'>[ [] (default) | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>outSE</span><span> is only relevant during TDSE time propagation and in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>. It is automatically cleared at the end of the propagation.</span></li></ul><h4  class = 'S7' id = 'H_F65810AA' ><span style=' font-family: monospace;'>outDipole (oDip)</span></h4><div  class = 'S1'><span>Result of dipole-signal calculations during the TDSE propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>TDSE propagation that do not compute the dipole signal (</span><a href = "#H_E30347CB"><span style=' font-family: monospace;'>saveDipole</span></a><span style=' font-family: monospace;'> = false</span><span>) leave </span><span style=' font-family: monospace;'>outDipole</span><span> empty. Otherwise</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outDipole.time</span><span> defines the precise times at which the dipole signal is computed</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outDipole.waveFunction_x</span><span> contains the dipole signal for selected wave functions. The indexes of the wave functions associated with each of these are included in </span><span style=' font-family: monospace;'>outDipole.indexWaveFunction</span></li><li  class = 'S9'><span>In </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>, </span><span style=' font-family: monospace;'>outDipole</span><span> also contains a handful of additional fields relevant for run-time calculations. These fields are saved in the MATALB restart file but </span><a href = "#H_5904178E"><span>removed</span></a><span> upon completion of the TDSE propagation.</span></li></ul><h4  class = 'S7' id = 'H_95407807' ><span style=' font-family: monospace;'>outDipoleVelocity (oVel)</span></h4><div  class = 'S1'><span>Result of dipole-velocity-signal calculations during the TDSE propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>TDSE propagation that do not compute the dipole signal (</span><a href = "#H_2978977D"><span style=' font-family: monospace;'>saveDipoleVelocity</span></a><span style=' font-family: monospace;'> = false</span><span>) leave </span><span style=' font-family: monospace;'>outDipoleVelocity</span><span> empty. Otherwise</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outDipoleVelocity.time</span><span> defines the precise times at which the dipole velocity signal is computed</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outDipoleVelocity.waveFunction_x</span><span> contains the dipole signal for selected wave functions. The indexes of the wave functions associated with each of these are included in </span><span style=' font-family: monospace;'>outDipoleVelocity.indexWaveFunction</span></li><li  class = 'S9'><span>In </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>, </span><span style=' font-family: monospace;'>outDipoleVelocity</span><span> also contains a handful of additional fields relevant for run-time calculations. These fields are saved in the MATALB restart file but </span><a href = "#H_5904178E"><span>removed</span></a><span> upon completion of the TDSE propagation.</span></li></ul><h4  class = 'S7' id = 'H_02629977' ><span style=' font-family: monospace;'>outDipoleAcceleration (oAcc)</span></h4><div  class = 'S1'><span>Result of dipole-acceleration-signal calculations during the TDSE propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>TDSE propagation that do not compute the dipole signal (</span><a href = "#H_CB35D0D0"><span style=' font-family: monospace;'>saveDipoleAcceleration</span></a><span style=' font-family: monospace;'> = false</span><span>) leave </span><span style=' font-family: monospace;'>outDipoleAcceleration</span><span> empty. Otherwise</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outDipoleAcceleration.time</span><span> defines the precise times at which the dipole acceleration signal is computed</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outDipoleVelocity.waveFunction_x</span><span> contains the dipole signal for selected wave functions. The indexes of the wave functions associated with each of these are included in </span><span style=' font-family: monospace;'>outDipoleAcceleration.indexWaveFunction</span></li><li  class = 'S9'><span>In </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>, </span><span style=' font-family: monospace;'>outDipoleAcceleration</span><span> also contains a handful of additional fields relevant for run-time calculations. These fields are saved in the MATALB restart file but </span><a href = "#H_5904178E"><span>removed</span></a><span> upon completion of the TDSE propagation.</span></li></ul><h4  class = 'S7' id = 'H_B6B04F7C' ><span style=' font-family: monospace;'>outEnergySE (oESE)</span></h4><div  class = 'S1'><span>Result of the Schrodinger-equation-energy calculations during the TDSE propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>TDSE propagation that do track the Schrodinger-equation energy (</span><a href = "#H_CB527D7D"><span style=' font-family: monospace;'>saveEnergySE</span></a><span style=' font-family: monospace;'> = false</span><span>) leave </span><span style=' font-family: monospace;'>outEnergySE</span><span> empty. Otherwise</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outEnergySE.time</span><span> defines the precise times at which the Schrodinger-equation energies are computed</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outEnergySE.total</span><span> contains the total Schrodinger-equation energy, which should be constant (within the precision of the propagation scheme)</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outEnergySE.kinetic</span><span> contains the kinetic-energy component, including the driving-field potential vector in the velocity gauge. </span></li><li  class = 'S9'><span style=' font-family: monospace;'>outEnergySE.potential</span><span> contains the potential-energy component. </span></li><li  class = 'S9'><span style=' font-family: monospace;'>outEnergySE.externalField</span><span> contains the energy contribution from the driving electric field in the length gauge.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outEnergySE.autonomization</span><span> contains the energy brought in and out of the system by the </span><a href = "#H_2EA3F8EC"><span>external driving field</span></a><span> (if any).</span></li><li  class = 'S9'><span>In </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>, </span><span style=' font-family: monospace;'>outEnergySE</span><span> also contains a handful of additional fields relevant for run-time calculations. These fields are saved in the MATALB restart file but </span><a href = "#H_5904178E"><span>removed</span></a><span> upon completion of the TDSE propagation.</span></li></ul><h4  class = 'S7' id = 'H_71BECE2C' ><span style=' font-family: monospace;'>outEnergyWaveFunction (oEKSO)</span></h4><div  class = 'S1'><span>Result of the wave function energy calculations during the TDSE propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>TDSE propagation that do track the Schrodinger-equation energy (</span><a href = "#H_6190C681"><span style=' font-family: monospace;'>saveEnergyWaveFunction</span></a><span style=' font-family: monospace;'> = false</span><span>) leave </span><span style=' font-family: monospace;'>outEnergyWaveFunction</span><span> empty. Otherwise</span></li><li  class = 'S9'><span>For a wave function </span><span texencoding="|\psi\rangle" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAAkCAYAAAD2IghRAAAAAXNSR0IArs4c6QAABM5JREFUWEftWFtoHFUY/v6Z2dVdLai0pMSkM7O7JjaWWgUpKmh8EJK2NAi2FrVqG6pQ460vYhV9sVVf4qU2oNFCFWpFfUiNbaEPRvCOaBFMTd3MJdkE4h2qu92d2fnlwEwYl012N5eaYPdpOXPOP9/5zv//33eGsEh/tEhx4zzwc31y5xn/XzKuadqVRLTMcZxvMplMrhoSyqZKc3Pzknw+3ylJUsxxnIOjo6Pj1QSb6ZxkMnmD53nHmfl+y7IOVxOnLPCmpqaljuP0A1jueV67bdunqgk20zktLS0XZ7PZg2J9PB6/d3Bw8K9KsRYEcAFS07QtRPQWM2+0LOv4ogHe0NBweSQS6WfmbxVF2ZlOp/PTgV8wjLe2tiq2bb8AYBszr7Ms68tFAVyADIoUQK+qqo8PDAy4U4FfMIwLgEGREtEqWZbXpdPp4UUBPFSk7wB4yjTNvQC4HPiaGE8kEtcx8z4A1wL4GMDDpmkOhQOrqnqbLMtrmPnXbDZ7YGJi4m//Oamqeg0RPUhEbUT0dbFY3GXbthle39jYWK8oSp8Yc123YyoNqQm4CJZKpZLFYvEogCYAPbFY7LHBwcGCeCaEq1AovA2gA8A+VVV3+XlKuq5vBfAagBwzb7Ms68gUbIq5uwE8KzZpGEbPrBkXAerr6+PRaLSXiO4E8JnjOBszmczv4pmqqislSTom/gLYZJrm+6XjzPyMpml7pys8XddXAzjGzD+6rrspiB/eQM2MTwdc1/XbAbwHwA4p7iSDAE5XKjr/VC9wXbeHiMQp3WWapoj5r1/NwFOp1LJisShy8HoAQukesCzrrN+HuwE8BKAvGo1uHRoaOlMyvzcWi3UFqTVdn9Y0TdTBEWb+sJwNqBm4pmlriegEgCUAnvQrX+R+eEOT4+H5RNRpGMaBSnLud5flAPqJaGk5v1QzcF3XdwB4XQQnog2GYXzkvyjY0IXMfKtlWZ/4448Q0UsAzvjjX1UJfO4Yb2lpieZyuVcBCPCjsiy3p9PpH0oAnnQcZ0MmkxlLpVJBrm4H8IUsyx3pdPqXSsBD6+YmxxsaGi6LRCKijd0Y7iglBTuZxyWts7uSjAcbmvOuEvLpa5n5UKFQ2DE+Pp5VVVWXJEmkzMpQHotu0gXgFQB/VGOcAqEK9fEpa6KmHK+rq7soHo+/CeAOAO9ms9lOoYyJRGI9M4uLx8+e57XZtv2dYNt13T4iuoqZn9M07enpenfA9rwpZyKR2MnM+0M92dA0bQ8RPQHgBDNvVhTFKxaLYs7dRHQ4n893jY2N/VYpt8NeRcQzDEPY3Nl7FRFYOLhcLidA3eP38RclSepm5lsA7BdAmVmYoyuIaLckSYcqXQqCDc27OxRiY5rmalmWrwZwEzPf57/8Dc/zjkYikdPRaPSnaoQmfArn1I8nEontzCzy/pTneetL3V416SHmhG5AWwC0m6b5/XRrayrO0kDhvh7uMtWCDc8LWiczfzrvd87gggtA+O9HLct6eSagxRq/6J+XJKlteHj480pxZsW4pmk3+77lbC1yXgpKCJuiKMIB/jmr7yrVfsnyhWJPLXJejknfCX5ARJsD7zMjxistCoppZGRkDYBLBFMrVqw4WY3AlIudTCZXeZ536ay/HVYD/L+e8w9hgLlSy86goQAAAABJRU5ErkJggg==" width="23" height="18" /></span><span>, the wave function energy is defined as </span><span texencoding="\langle\psi|\hat{\mathcal{H}}|\psi\rangle" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="58" height="23" /></span><span> with </span><span texencoding="\hat{\mathcal{H}}" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="18" height="23" /></span><span> the Schrodinger-equation Hamiltonian operator. In the velocity gauge, the external potential vector is accounted for in the kinetic-operator of </span><span texencoding="\hat{\mathcal{H}}" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="18" height="23" /></span><span> while, in the length gauge, the external electric field is ignored.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outEnergyWaveFunction.time</span><span> defines the precise times at which the wave function energies are computed</span></li><li  class = 'S9'><span>Each row of </span><span style=' font-family: monospace;'>outEnergyWaveFunction.waveFunction</span><span> contains the energies of the corresponding wave functions</span></li><li  class = 'S9'><span>In </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>, </span><span style=' font-family: monospace;'>outEnergyWaveFunction</span><span> also contains a handful of additional fields relevant for run-time calculations. These fields are saved in the MATALB restart file but </span><a href = "#H_5904178E"><span>removed</span></a><span> upon completion of the TDSE propagation.</span></li></ul><h4  class = 'S7' id = 'H_E1C662FA' ><span style=' font-family: monospace;'>outIonization (oIon)</span></h4><div  class = 'S1'><span>Result of the ionization calculations during the TDSE propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>TDSE propagation that do track ionization (</span><a href = "#H_6B566C83"><span style=' font-family: monospace;'>saveIonization</span></a><span style=' font-family: monospace;'> = false</span><span>) leave </span><span style=' font-family: monospace;'>outIonization</span><span> empty. Otherwise</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outIonization.time</span><span> defines the precise times at which the ionization is computed</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outIonization.waveFunction</span><span> contains the ionization for the selected wave functions. The indexes of the wave functions associated with each of these are included in </span><span style=' font-family: monospace;'>outIonization.indexWaveFunction</span></li><li  class = 'S9'><span>In </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>, </span><span style=' font-family: monospace;'>outIonization</span><span> also contains a handful of additional fields relevant for run-time calculations. These fields are saved in the MATALB restart file but </span><a href = "#H_5904178E"><span>removed</span></a><span> upon completion of the TDSE propagation.</span></li></ul><h4  class = 'S7' id = 'H_371940E8' ><span style=' font-family: monospace;'>outWaveFunction (oWfcn)</span></h4><div  class = 'S1'><span>Wave functions during the TDSE propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>TDSE propagation that do not save the wave function (</span><a href = "#H_2A78E237"><span style=' font-family: monospace;'>saveWaveFunction</span></a><span style=' font-family: monospace;'> = false</span><span>) leave </span><span style=' font-family: monospace;'>outWaveFunction</span><span> empty. Otherwise</span></li><li  class = 'S9'><span>The specific shape of the saved wave functions is implementation dependent -- see the corresponding documentation for details. At minimum, each implementation defines</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outWaveFunction.time</span><span> defines the precise times at which the wave functions are saved</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outWaveFunction.waveFunction</span><span> contains the saved wave functions and </span><span style=' font-family: monospace;'>outWaveFunction.indexWaveFunction</span><span> the corresponding wave-function indexes</span></li><li  class = 'S9'><span>In </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>, </span><span style=' font-family: monospace;'>outWaveFunction</span><span> also contains a handful of additional fields relevant for run-time calculations. These fields are saved in the MATALB restart file but </span><a href = "#H_5904178E"><span>removed</span></a><span> upon completion of the TDSE propagation.</span></li></ul><h4  class = 'S7' id = 'H_5096ABA5' ><span style=' font-family: monospace;'>outWaveFunctionProjection (oWfcnP)</span></h4><div  class = 'S1'><span>Projection of the wave functions during the TDSE propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>TDSE propagation that do not save the projection of the wave functions (</span><a href = "#H_0A85DA1C"><span style=' font-family: monospace;'>saveWaveFunctionProjection</span></a><span style=' font-family: monospace;'> = false</span><span>) leave </span><span style=' font-family: monospace;'>outWaveFunctionProjection</span><span> empty. Otherwise</span></li><li  class = 'S9'><span>The specific shape of the saved wave functions' projection is implementation dependent -- see the corresponding documentation for details. At minimum, each implementation defines</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outWaveFunctionProjection.time</span><span> defines the precise times at which the wave function projections are saved</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outWaveFunctionProjection.waveFunction</span><span> contains the saved wave functions' projection and </span><span style=' font-family: monospace;'>outWaveFunctionProjection.indexWaveFunction</span><span> the corresponding wave function indexes</span></li><li  class = 'S9'><span>The structure also retains a copy of the projection basis as </span><a href = "./QMol_disc_basis.html"><span style=' font-family: monospace;'>QMol_disc_basis</span></a><span> object(s)</span></li><li  class = 'S9'><span>In </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>, </span><span style=' font-family: monospace;'>outWaveFunctionProjection</span><span> also contains a handful of additional fields relevant for run-time calculations. These fields are saved in the MATALB restart file but </span><a href = "#H_5904178E"><span>removed</span></a><span> upon completion of the TDSE propagation.</span></li></ul><h4  class = 'S7' id = 'H_25C1C7F6' ><span style=' font-family: monospace;'>outOutputFunction (oF)</span></h4><div  class = 'S1'><span>Result of the installable output function of the wave functions </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>TDSE propagation that do not define an installabe output function of the orbitals (</span><a href = "#H_13D0EA88"><span style=' font-family: monospace;'>saveOutputFunction</span></a><span style=' font-family: monospace;'> = []</span><span>) leave </span><span style=' font-family: monospace;'>outOutputFunction</span><span> empty. Otherwise</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outOutputFunction.time</span><span> defines the precise times at which the result of the output function is saved</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outOutputFunction.result</span><span> contains the results of the output function. If the installable function returns a scalar or a column vector, </span><span style=' font-family: monospace;'>outOutputFunction.result</span><span> is a </span><span style=' font-family: monospace;'>N-by-numel(outOutputFunction.time)</span><span> matrix with </span><span style=' font-family: monospace;'>N</span><span> the numer of elements in the output. Otherwise, </span><span style=' font-family: monospace;'>outOutputFunction.result</span><span> is an </span><span style=' font-family: monospace;'>M-by-numel(outOutputFunction.time)</span><span> array with </span><span style=' font-family: monospace;'>M</span><span> the size of the output.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outOutputFunction.shape</span><span> contains the shape of the output function (</span><span style=' font-family: monospace;'>N</span><span> or </span><span style=' font-family: monospace;'>M</span><span>, as defined in the previous bullet point).</span></li></ul><h4  class = 'S7' id = 'H_B2980914' ><span style=' font-family: monospace;'>outRestart (oRest)</span></h4><div  class = 'S1'><span>Support for enabling </span><a href = "#H_5CD2979A"><span>restart of the TDSE propagation</span></a><span> </span><span style=' font-family: monospace;'>[ [] (default) | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>outRestart</span><span> is only relevant during TDSE time propagation and in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>. It is automatically cleared at the end of the propagation.</span></li></ul><h3  class = 'S6' id = 'H_C8F30381' ><span>Other hidden class properties</span></h3><div  class = 'S1'><span style=' font-family: monospace;'>QMol_TDSE</span><span> defines a handful of additional hidden properties used for the time propagation. These properties cannot be edited with the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method, nor by any function outisde of the object (</span><span style=' font-family: monospace;'>SetAccess=protected</span><span> attribute).</span></div><h4  class = 'S7' id = 'H_37454CF9' ><span style=' font-family: monospace;'>SE</span></h4><div  class = 'S1'><span>Schrodinger-equation-model object </span><span style=' font-family: monospace;'>[ [] (default) | </span><a href = "./QMol_SE.html"><span style=' font-family: monospace;'>QMol_SE</span></a><span style=' font-family: monospace;'> handle object ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>This is a copy of the </span><a href = "./SE.html"><span>Schrodinger-equation-model</span></a><span> handle object passed to </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>. </span></li></ul><h4  class = 'S7' id = 'H_110A8982' ><span style=' font-family: monospace;'>tspan</span></h4><div  class = 'S1'><span>Propagation time vector </span><span style=' font-family: monospace;'>[ [] (default) | vector ]</span><span> </span></div><ul  class = 'S8'><li  class = 'S9'><span>After the class is </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d, it is defined as </span><span style=' font-family: monospace;'>uniquetol([obj.</span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>T</span></a><span style=' font-family: monospace;'>(1):obj.</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>dt</span></a><span style=' font-family: monospace;'>:obj.</span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>T</span></a><span style=' font-family: monospace;'>(end), obj.</span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>T</span></a><span style=' font-family: monospace;'>(end)],1e-10,'DataScale',1)</span></li></ul><h4  class = 'S7' id = 'H_8882E7D7' ><span style=' font-family: monospace;'>iref</span></h4><div  class = 'S1'><span>Indexes of </span><a href = "#H_110A8982"><span style=' font-family: monospace;'>tspan</span></a><span> matching the input time vector </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>T</span></a><span> </span><span style=' font-family: monospace;'>[ [] (default) | index vector ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>After the class is </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d, it is defined as </span><a href = "#H_63C6DA3F"><span style=' font-family: monospace;'>getOutputIndex</span></a><span style=' font-family: monospace;'>(</span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>T</span></a><span style=' font-family: monospace;'>)</span></li></ul><h4  class = 'S7' id = 'H_4F8B0111' ><span style=' font-family: monospace;'>restart</span></h4><div  class = 'S1'><span>Restart structure </span><span style=' font-family: monospace;'>[ [] (default) | restart ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Collect all the variables and information required for the </span><a href = "#H_5CD2979A"><span>restart mode</span></a></li><li  class = 'S9'><span style=' font-family: monospace;'>QMol_TDSE</span><span> uses the following fields (therefore not available for implementation-specific TDSE propagators overloading the class): </span><span style=' font-family: monospace;'>kstart</span><span>, </span><span style=' font-family: monospace;'>ndisp</span><span>, and </span><span style=' font-family: monospace;'>idp</span></li></ul><h2  class = 'S2' id = 'H_444F9B6D' ><span>Class methods</span></h2><h3  class = 'S6' id = 'H_A7EA7D3E' ><span>Creation</span></h3><h4  class = 'S7' id = 'H_0783E8B1' ><span>constructor</span></h4><div  class = 'S1'><span>Create a TDSE-model object with empty class properties.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj = QMol_TDSE;</span></span></div></div></div><div  class = 'S11'><span>Create a TDSE-model object with the </span><span style=' font-family: monospace;'>name</span><span> properties set to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the TDSE </span><a href = "#H_24F205D3"><span>class properties</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >obj = QMol_TDSE(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span >obj = QMol_TDSE(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><h3  class = 'S6' id = 'H_87F4F901' ><span>Changing class properties</span></h3><h4  class = 'S7' id = 'H_4405B79D' ><span style=' font-family: monospace;'>set</span></h4><div  class = 'S1'><span>Update the </span><span style=' font-family: monospace;'>name</span><span> properties of a TDSE-model object to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the TDSE </span><a href = "#H_24F205D3"><span>class properties</span></a><span> and is case insensitive. In restart mode, </span><a href = "#H_D533B953"><span>output results</span></a><span> structures can also be edited with </span><span style=' font-family: monospace;'>set</span><span>. </span><span style=' font-family: monospace;'>QMol_TDSE</span><span> does not check the integrity of its input/output component during a restart and this feature should only be considered by advanced users.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >obj.set(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span >obj.set(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S11'><span>This is the common name-value pair assignment method used throughout the QMol-grid package.</span></div><h4  class = 'S7' id = 'H_C729A888' ><span style=' font-family: monospace;'>clear</span></h4><div  class = 'S1'><span>Clear all class properties</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.clear;</span></span></div></div></div><div  class = 'S11'><span>Clear a specific set of the class properties. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the TDSE </span><a href = "#H_24F205D3"><span>class properties</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.clear(name1,name2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S11'><span>This is the common </span><span style=' font-family: monospace;'>clear</span><span> method available to all classes throughout the QMol-grid package. The </span><span style=' font-family: monospace;'>clear</span><span> method can be used to delete specific properties before saving an instance of the </span><span style=' font-family: monospace;'>QMol_TDSE</span><span> class.</span></div><h3  class = 'S6' id = 'H_686ACD09' ><span>Initializing the object</span></h3><div  class = 'S1'><span style=' font-family: monospace;'>QMol_TDSE</span><span> defines a main </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span> interface (with public access attribute) and a suite of individual initaialization properties (with protected access attributes) for each of the </span><a href = "#H_D533B953"><span>output results</span></a><span>.</span></div><h4  class = 'S7' id = 'H_85EFED0A' ><span style=' font-family: monospace;'>initialize</span></h4><div  class = 'S1'><span>Initialize a TDSE-model object without allocating the </span><a href = "#H_D533B953"><span>output-result</span></a><span> structures</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.initialize(SE);</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>SE</span><span> is the </span><a href = "./SE.html"><span>Schrodinger-equation-model</span></a><span> handle object, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "./QMol_SE.html"><span style=' font-family: monospace;'>QMol_SE</span></a><span>, that describes the Schrodinger-equation systems to propagate.</span></li><li  class = 'S9'><span style=' text-decoration: underline;'>For developers:</span><span> </span><span style=' font-family: monospace;'>initialize</span><span> also has a specific interface when called from the </span><a href = "#H_5CD9DA16"><span style=' font-family: monospace;'>propagate</span></a><span> method that initializes the </span><a href = "#H_8CAFC83D"><span>absorbing boundaries</span></a><span> (if any) and determines whether the </span><a href = "#H_D533B953"><span>output-result</span></a><span> structures should be initialized too. Overloading classes should avoid redefining </span><span style=' font-family: monospace;'>initialize</span><span>; If the overloading class needs to perform some initialization (at the beginning of a TDSE propagation or upon restart), overload the </span><a href = "#H_3FFF1372"><span style=' font-family: monospace;'>initializeChildren</span></a><span> method instead.</span></li></ul><h4  class = 'S7' id = 'H_3FFF1372' ><span style=' font-family: monospace;'>initializeChildren</span></h4><div  class = 'S1'><span>Initialize implementation-specific part of overloading class at the beginning of a TDSE propagation (from scratch)</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.initializeChildren(false);</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>QMol_TDSE</span><span> calls the </span><span style=' font-family: monospace;'>initializeChildren</span><span> method </span><span style=' text-decoration: underline;'>after</span><span> having initialized all its member properties (including the </span><span style=' font-family: monospace;'>SE</span><span> object being propagated).</span></li><li  class = 'S9'><span>This should </span><span style=' text-decoration: underline;'>not</span><span> initialize implementation-specific additional output, which are initialized with </span><a href = "#H_D3F27113"><span style=' font-family: monospace;'>setOutputChildren</span></a></li></ul><div  class = 'S1'><span>Initialize implementation-specific part of overloading class in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.initializeChildren(true);</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>QMol_TDSE</span><span> calls the </span><span style=' font-family: monospace;'>initializeChildren</span><span> method </span><span style=' text-decoration: underline;'>after</span><span> having reinitialized all its member properties (including the </span><span style=' font-family: monospace;'>SE</span><span> object being propagated).</span></li><li  class = 'S9'><span>Note that the </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span> does not call </span><a href = "#H_8328AE09"><span style=' font-family: monospace;'>setTimeStep</span></a><span> during the initialization. All relevant time step information should be stored with the class of in the </span><a href = "#H_4F8B0111"><span style=' font-family: monospace;'>restart</span></a><span> structure and </span><span style=' font-family: monospace;'>initializeChildren</span><span> should bring them back to a working configuration.</span></li></ul><h4  class = 'S7' id = 'H_63C6DA3F' ><span style=' font-family: monospace;'>getOutputIndex</span></h4><div  class = 'S1'><span>Get the time-propagation index for when to save a given result.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >ind = obj.getOutputIndex(t);</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>Vector </span><span style=' font-family: monospace;'>t = [t_1, t_2, ___ ]</span><span>  returns the indexes of the iteration time steps closest to the listed times </span><span style=' font-family: monospace;'>t_1</span><span>, </span><span style=' font-family: monospace;'>t_2</span><span>, ... </span></li><li  class = 'S9'><span>Scalar </span><span style=' font-family: monospace;'>t</span><span> &gt; 0 returns the indexes of the iteration time steps closest to the time sampling </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)</span><span>, </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)+t</span><span>, </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)+2*t</span><span>, ... for forward time propagations and </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)</span><span>, </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)-t</span><span>, </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)-2*t</span><span>, ... for backward ones</span></li><li  class = 'S9'><span>Integer </span><span style=' font-family: monospace;'>t</span><span> &lt; 0 returns the indexes of the iteration time steps of </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)</span><span>, </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)-</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>*t</span><span>, </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)-2*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>*t</span><span>, ... for forward time propagations and </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)</span><span>, </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)+</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>*t</span><span>, </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)+2*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>*t</span><span>, ... for backward ones</span></li></ul><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >ind = obj.getOutputIndex(</span><span style="color: #a709f5;">'all'</span><span >);</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>Returns the indexes associated with all the iteration time steps</span></li></ul><h4  class = 'S7' id = 'H_D3F27113' ><span style=' font-family: monospace;'>setOutputChildren</span></h4><div  class = 'S1'><span>Initialize additional output results defined in an specific implementation of the TDSE propagator (the children class should then </span><a href = "#H_675447D6"><span>overload this method</span></a><span>)</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputChildren(</span><span style="color: #a709f5;">'init'</span><span >);</span></span></div></div></div><div  class = 'S11'><span>Cleanup the additional output results defined in an specific implementation of the TDSE propagator at the end of the computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputChildren(</span><span style="color: #a709f5;">'clean'</span><span >);</span></span></div></div></div><div  class = 'S11'><span style=' font-family: monospace;'>setOutputChildren</span><span> should not be called in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span> (all relevant parameters should be saved with the QMol_TDSE object in the restart MATLAB file).</span></div><h4  class = 'S7' id = 'H_12E03134' ><span style=' font-family: monospace;'>setOutputSE</span></h4><div  class = 'S1'><span>Initialize the </span><a href = "#H_28F8C3A4"><span style=' font-family: monospace;'>outSE</span></a><span> structure before running a TDSE computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputSE(</span><span style="color: #a709f5;">'init'</span><span >);</span></span></div></div></div><div  class = 'S11'><span>Cleanup the </span><a href = "#H_28F8C3A4"><span style=' font-family: monospace;'>outSE</span></a><span> structure at the end of the TDSE computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputSE(</span><span style="color: #a709f5;">'clean'</span><span >);</span></span></div></div></div><div  class = 'S11'><span style=' font-family: monospace;'>setOutputSE</span><span> should not be called in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span> (all relevant parameters should be saved with the </span><span style=' font-family: monospace;'>QMol_TDSE</span><span> object in the restart MATLAB file).</span></div><h4  class = 'S7' id = 'H_5D387730' ><span style=' font-family: monospace;'>setOutputDipole</span></h4><div  class = 'S1'><span>Initialize the </span><a href = "#H_F65810AA"><span style=' font-family: monospace;'>outDipole</span></a><span>, </span><a href = "#H_95407807"><span style=' font-family: monospace;'>outDipoleVelocity</span></a><span>, and </span><a href = "#H_02629977"><span style=' font-family: monospace;'>outDipoleAcceleration</span></a><span>  structures before running a TDSE computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputDipole(</span><span style="color: #a709f5;">'init'</span><span >);</span></span></div></div></div><div  class = 'S11'><span>Cleanup the </span><a href = "#H_F65810AA"><span style=' font-family: monospace;'>outDipole</span></a><span>, </span><a href = "#H_95407807"><span style=' font-family: monospace;'>outDipoleVelocity</span></a><span>, and </span><a href = "#H_02629977"><span style=' font-family: monospace;'>outDipoleAcceleration</span></a><span> structures at the end of the TDSE computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputDipole(</span><span style="color: #a709f5;">'clean'</span><span >);</span></span></div></div></div><div  class = 'S11'><span style=' font-family: monospace;'>setOutputDipole</span><span> should not be called in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span> (all relevant parameters should be saved with the </span><span style=' font-family: monospace;'>QMol_TDSE</span><span> object in the restart MATLAB file).</span></div><h4  class = 'S7' id = 'H_C32F9472' ><span style=' font-family: monospace;'>setOutputEnergy</span></h4><div  class = 'S1'><span>Initialize the </span><a href = "#H_B6B04F7C"><span style=' font-family: monospace;'>outEnergySE</span></a><span> and </span><a href = "#H_02629977"><span style=' font-family: monospace;'>outEnergyWaveFunction</span></a><span>  structures before running a TDSE computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputEnergy(</span><span style="color: #a709f5;">'init'</span><span >);</span></span></div></div></div><div  class = 'S11'><span>Cleanup the </span><a href = "#H_B6B04F7C"><span style=' font-family: monospace;'>outEnergySE</span></a><span> and </span><a href = "#H_02629977"><span style=' font-family: monospace;'>outEnergyWaveFunction</span></a><span> structures at the end of the TDSE computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputEnergy(</span><span style="color: #a709f5;">'clean'</span><span >);</span></span></div></div></div><div  class = 'S11'><span style=' font-family: monospace;'>setOutputEnergy</span><span> should not be called in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span> (all relevant parameters should be saved with the </span><span style=' font-family: monospace;'>QMol_TDSE</span><span> object in the restart MATLAB file).</span></div><h4  class = 'S7' id = 'H_C219079B' ><span style=' font-family: monospace;'>setOutputFunction</span></h4><div  class = 'S1'><span>Initialize the </span><a href = "#H_25C1C7F6"><span style=' font-family: monospace;'>outOutputFunction</span></a><span> structure before running a TDSE computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputFunction(</span><span style="color: #a709f5;">'init'</span><span >);</span></span></div></div></div><div  class = 'S11'><span>Cleanup the </span><a href = "#H_25C1C7F6"><span style=' font-family: monospace;'>outOutputFunction</span></a><span> structure at the end of the TDSE computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputFunction(</span><span style="color: #a709f5;">'clean'</span><span >);</span></span></div></div></div><div  class = 'S11'><span style=' font-family: monospace;'>setOutputFunction</span><span> should not be called in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span> (all relevant parameters should be saved with the </span><span style=' font-family: monospace;'>QMol_TDSE</span><span> object in the restart MATLAB file).</span></div><h4  class = 'S7' id = 'H_EA0844B5' ><span style=' font-family: monospace;'>setOutputIonization</span></h4><div  class = 'S1'><span>Initialize the </span><a href = "#H_E1C662FA"><span style=' font-family: monospace;'>outIonization</span></a><span> structure before running a TDSE computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputIonization(</span><span style="color: #a709f5;">'init'</span><span >);</span></span></div></div></div><div  class = 'S11'><span>Cleanup the </span><a href = "#H_E1C662FA"><span style=' font-family: monospace;'>outIonization</span></a><span> structure at the end of the TDSE computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputIonization(</span><span style="color: #a709f5;">'clean'</span><span >);</span></span></div></div></div><div  class = 'S11'><span style=' font-family: monospace;'>setOutputIonization</span><span> should not be called in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span> (all relevant parameters should be saved with the </span><span style=' font-family: monospace;'>QMol_TDSE</span><span> object in the restart MATLAB file).</span></div><h4  class = 'S7' id = 'H_D7894DE5' ><span style=' font-family: monospace;'>setOutputWaveFunction</span></h4><div  class = 'S1'><span>Initialize the </span><a href = "#H_371940E8"><span style=' font-family: monospace;'>outWaveFunction</span></a><span> and </span><a href = "#H_5096ABA5"><span style=' font-family: monospace;'>outWaveFunctionProjection</span></a><span> structures before running a TDSE computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputWaveFunction(</span><span style="color: #a709f5;">'init'</span><span >);</span></span></div></div></div><div  class = 'S11'><span>Cleanup the </span><a href = "#H_371940E8"><span style=' font-family: monospace;'>outWaveFunction</span></a><span> and </span><a href = "#H_5096ABA5"><span style=' font-family: monospace;'>outWaveFunctionProjection</span></a><span> structures at the end of the TDSE computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputWaveFunction(</span><span style="color: #a709f5;">'clean'</span><span >);</span></span></div></div></div><div  class = 'S11'><span>setOutputWaveFunction should not be called in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span> (all relevant parameters should be saved with the </span><span style=' font-family: monospace;'>QMol_TDSE</span><span> object in the restart MATLAB file).</span></div><div  class = 'S1'><span>setOutputWaveFunction is implementation dependent and must be defined by each overloading TDSE propagation classes -- see the </span><a href = "#H_CBF28755"><span>required signature and behavior</span></a><span> below.</span></div><h4  class = 'S7' id = 'H_C640DA93' ><span style=' font-family: monospace;'>setOutputRestart</span></h4><div  class = 'S1'><span>Initialize the </span><a href = "#H_B2980914"><span style=' font-family: monospace;'>outRestart</span></a><span> structure before running a TDSE computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputRestart(</span><span style="color: #a709f5;">'init'</span><span >);</span></span></div></div></div><div  class = 'S11'><span>Cleanup the </span><a href = "#H_B2980914"><span style=' font-family: monospace;'>outRestart</span></a><span> structure and delete the restart file at the end of the TDSE computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputRestart(</span><span style="color: #a709f5;">'clean'</span><span >);</span></span></div></div></div><div  class = 'S11'><span style=' font-family: monospace;'>setOutputRestart</span><span> should not be called in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span> (all relevant parameters should be saved with the </span><span style=' font-family: monospace;'>QMol_TDSE</span><span> object in the restart MATLAB file).</span></div><h4  class = 'S7' id = 'H_5904178E' ><span style=' font-family: monospace;'>finalize</span></h4><div  class = 'S1'><span>At the end of a TDSE propagation, performs the appropriate finalization, including cleanup of the output structures.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.finalize;</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>This calls the </span><span style=' font-family: monospace;'>'clean'</span><span> mode for </span><a href = "#H_D3F27113"><span style=' font-family: monospace;'>setOutputChildren</span></a><span>, </span><a href = "#H_12E03134"><span style=' font-family: monospace;'>setOutputSE</span></a><span>, </span><a href = "#H_5D387730"><span style=' font-family: monospace;'>setOutputDipole</span></a><span>, </span><a href = "#H_C32F9472"><span style=' font-family: monospace;'>setOutputEnergy</span></a><span>, </span><a href = "#H_EA0844B5"><span style=' font-family: monospace;'>setOutputIonization</span></a><span>, </span><a href = "#H_D7894DE5"><span style=' font-family: monospace;'>setOutputWaveFunction</span></a><span>, </span><a href = "#H_C219079B"><span style=' font-family: monospace;'>setOutputFunction</span></a><span>, and </span><a href = "#H_C640DA93"><span style=' font-family: monospace;'>setOutputRestart</span></a><span>.</span></li></ul><h3  class = 'S6' id = 'H_B2D31FE3' ><span>Run-time documentation</span></h3><h4  class = 'S7' id = 'H_E3988947' ><span style=' font-family: monospace;'>getMemoryProfile</span></h4><div  class = 'S1'><span>Get an estimate of the memory help by a </span><span style=' font-family: monospace;'>QMol_TDSE</span><span> object with either</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >mem = obj.getMemoryProfile;</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span >mem = obj.getMemoryProfile(false);</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>The object must be </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d for the memory footprint evaluation. If not arleady, </span><span style=' font-family: monospace;'>getMemoryProfile</span><span> initializes the </span><a href = "#H_37454CF9"><span style=' font-family: monospace;'>SE</span></a><span> model object.</span></li><li  class = 'S9'><span>The estimate includes (1) </span><a href = "#H_37454CF9"><span style=' font-family: monospace;'>SE</span></a><span> model, (2) TDSE propagator, and (3) </span><a href = "#H_D533B953"><span>output results</span></a><span>. Note that all these components may not be used in actual simulations and the memory estimate tries to be conservative. On the other hand, it only includes the discretization of member components on the domain grid and ignores other (small) properties.</span></li><li  class = 'S9'><span>The output </span><span style=' font-family: monospace;'>mem</span><span> is the estimated size in bytes.</span></li></ul><div  class = 'S1'><span>Additionally display the detail of the memory footprint with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >mem = obj.getMemoryProfile(true);</span></span></div></div></div><h4  class = 'S7' id = 'H_ABD08C91' ><span style=' font-family: monospace;'>showDocumentation</span></h4><div  class = 'S1'><span>Display the run-time documentation for the specific configuration of a </span><span style=' font-family: monospace;'>QMol_TDSE</span><span> object, wich must have been </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d beforehand</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.showDocumentation;</span></span></div></div></div><div  class = 'S11'><span>The run-time documentation performs the following steps</span></div><ul  class = 'S8'><li  class = 'S9'><span>Display the QMol-grid package header (showing the kernel, external component versions)</span></li><li  class = 'S9'><span>Call the TDSE-propagator implementation-specific run-time documentation with the propety </span><span style=' font-family: monospace;'>showDoc</span><span>.</span></li><li  class = 'S9'><span>Display the time-propagation information</span></li><li  class = 'S9'><span>Display the list of output calculated and saved during the TDSE propagation</span></li><li  class = 'S9'><span>Display the bibliography associated with the list of cited references (from the previous steps)</span></li><li  class = 'S9'><span>Display the funding information</span></li><li  class = 'S9'><span>Display the QMol-grid package footer</span></li></ul><h3  class = 'S6' id = 'H_AEFB66DB' ><span>TDSE propagation</span></h3><h4  class = 'S7' id = 'H_5CD9DA16' ><span style=' font-family: monospace;'>propagate</span></h4><div  class = 'S1'><span>Propagate the TDSE dynamics starting from a Schrodinger-equation model object (from scratch)</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.propagate(SE);</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>SE</span><span> is the </span><a href = "./SE.html"><span>Schrodinger-equation-model</span></a><span> handle object, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "./QMol_SE.html"><span style=' font-family: monospace;'>QMol_SE</span></a><span>, that describes the Schrodinger-equation systems to propagate.</span></li></ul><div  class = 'S1'><span>Restart a TDSE propagation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.propagate(</span><span style="color: #a709f5;">'restart'</span><span >);</span></span></div></div></div><h4  class = 'S7' id = 'H_DC96BD5E' ><span style=' font-family: monospace;'>saveOutputSE</span></h4><div  class = 'S1'><span>Trigger the saving of the </span><a href = "#H_37454CF9"><span>SE</span></a><span> object into a separate MATLAB file</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.saveOutputSE(obj,t);</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>t</span><span> is the current time when the saving is performed</span></li><li  class = 'S9'><span>Each output file contains </span><span style=' font-family: monospace;'>SE</span><span> (Schrodinger-equation-model object), </span><span style=' font-family: monospace;'>t</span><span> (current time), and </span><span style=' font-family: monospace;'>externalField</span><span> (</span><a href = "#H_2EA3F8EC"><span>external field</span></a><span> object)</span></li><li  class = 'S9'><span>For developers: </span><span style=' font-family: monospace;'>saveOutputSE</span><span> is also responsible for updating the counter </span><span style=' font-family: monospace;'>obj.oSE.n</span><span> when it is called</span></li></ul><h4  class = 'S7' id = 'H_9ED0647B' ><span style=' font-family: monospace;'>setOutputEnergy</span></h4><div  class = 'S1'><span>Trigger the saving of the Schrodinger-equation and wave function energies</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.saveOutputEnergy(k,t);</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>k</span><span> is the current time-propagation step index</span></li><li  class = 'S9'><span style=' font-family: monospace;'>t</span><span> is the current time when the saving is performed</span></li><li  class = 'S9'><span>If requested, the Schrodinger equation energy calls </span><a href = "#H_FDA44F8F"><span>getExternalFieldEnergy</span></a><span> to get the contribution from any external field and autonomization variable</span></li></ul><h4  class = 'S7' id = 'H_1C92546A' ><span style=' font-family: monospace;'>saveOutputFunction</span></h4><div  class = 'S1'><span>Trigger the computation and saving of the installable </span><a href = "#H_236395D1"><span>output function</span></a></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.saveOutputFunction(obj,k,t);</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>k</span><span> is the current time-propagation step index</span></li><li  class = 'S9'><span style=' font-family: monospace;'>t</span><span> is the current time when the saving is performed</span></li><li  class = 'S9'><span>For developers: saveOutputFunction is also responsible for updating the counter </span><span style=' font-family: monospace;'>obj.oFRho.n</span><span> and </span><span style=' font-family: monospace;'>obj.oFKSO.n</span><span> when it is called</span></li></ul><h2  class = 'S2' id = 'H_2FB9B214' ><span>Overloading the class</span></h2><div  class = 'S1'><span style=' font-family: monospace;'>QMol_TDSE</span><span> is an abstract class and only define the common steps and features for all TDSE propagators. Implementation-specific propagators must define specific methods and additional optional methods overload</span></div><h3  class = 'S6' id = 'H_B9A8411A' ><span>Methods that must be overloaded</span></h3><div  class = 'S1'><span>To define a specific implementation of a TDSE propagation scheme, overloading classes must define the following methods with the specified signature and attributes</span></div><h4  class = 'S7' id = 'H_884CFDF5' ><span style=' font-family: monospace;'>propertyNames</span></h4><div  class = 'S1'><span>To enable name-value pair </span><a href = "#H_0783E8B1"><span>constructor</span></a><span>, name-value pair </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span>, and the </span><a href = "#H_C729A888"><span style=' font-family: monospace;'>clear</span></a><span> methods</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Static=true,Access=?QMol_suite)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >[ClassName,PropNames] = propertyNames()</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%propertyNames returns the names of member properties that can be set</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%   through name-value assignment</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Parent-class components</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    [~,PropNames]       =   QMol_TDSE.propertyNames;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    ClassName           =   </span><span style="color: #a709f5;">'QMol_child_class'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    PropNames           =   [PropNames,{</span><span style="color: #a709f5;">'property1'</span><span >,</span><span style="color: #a709f5;">'property2'</span><span >}];</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><h4  class = 'S7' id = 'H_D8A9FEA5' ><span style=' font-family: monospace;'>showDoc</span></h4><div  class = 'S1'><span>Display the </span><a href = "#H_ABD08C91"><span>run-time documentation</span></a><span> for the specific implementation of the TDSE propagator</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >ref = showDoc(obj)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%showDoc displays the documentation reflecting the specific implementation</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%   of the TDSE propagator</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Add specific documentation here</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>If no reference is cited, return </span><span style=' font-family: monospace;'>ref = {}</span><span> otherwise </span><span style=' font-family: monospace;'>ref = {'ref 1','ref 2',___}</span><span>, where each of the </span><span style=' font-family: monospace;'>ref</span><span> corresponds to the bibliographic code for the reference (generally of the form </span><span style=' font-family: monospace;'>'name_of_first_author publication_year'</span><span>) and is case insensitive -- see the </span><a href = "./Documentation.html"><span>documentation page</span></a><span> for a list of citable references.</span></li><li  class = 'S9'><span>Note that only implementation-specific properties should be covered here. All properties common to all TDSE propagators (</span><span style=' font-style: italic;'>e.g.</span><span>, time step) are handled in the parent </span><span style=' font-family: monospace;'>QMol_TDSE</span><span> class run-time documentation.</span></li><li  class = 'S9'><span>Only document the TDSE propagator. If additional ouput are implemented, document those with the </span><a href = "#H_B96633C8"><span style=' font-family: monospace;'>docOutputChildren</span></a><span> method</span></li></ul><h4  class = 'S7' id = 'H_CBF28755' ><span style=' font-family: monospace;'>setOutputWaveFunction</span></h4><div  class = 'S1'><span>Initialize the </span><a href = "#H_371940E8"><span style=' font-family: monospace;'>outWaveFunction</span></a><span> and </span><a href = "#H_5096ABA5"><span style=' font-family: monospace;'>outWaveFunctionProjection</span></a><span> structures before running a TDSE computation and clean them up at the end of the computation. The method should have the following signature and features</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >setOutputWaveFunction(obj,opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%setOutputOrbitalDensity</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">switch </span><span >lower(opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">case </span><span >{</span><span style="color: #a709f5;">'init'</span><span >,</span><span style="color: #a709f5;">'initialize'</span><span >,</span><span style="color: #a709f5;">'initialization'</span><span >} </span><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span > </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Clean up any old data ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    obj.oWfcn           =   [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    obj.oWfcnP          =   [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Wave functions ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >obj.sWfcn</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% When to save the wave functions</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oWfcn.ind   =   [obj.getOutputIndex(obj.sWfcnT),NaN];</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oWfcn.time  =   obj.tspan(obj.oWfcn.ind(1:end-1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oWfcn.n     =   1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">if </span><span >obj.sEF,         obj.setOutputExternalField(</span><span style="color: #a709f5;">'oWfcn'</span><span >,</span><span style="color: #a709f5;">'init'</span><span >);  </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        S               =   obj.SE.disc.SE_sizeWaveFunction;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">if </span><span >numel(S) &gt; 1   &amp;&amp;   S(end) == 1,     S   =   S(1:end-1);     </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Indexes</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">if </span><span >isempty(obj.sWfcnI),         obj.oWfcn.indexWaveFunction =   [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">elseif </span><span >ischar(obj.sWfcnI),                                                                  </span><span style="color: #0e00ff;">if </span><span >strcmpi(obj.sWfcnI,</span><span style="color: #a709f5;">'all'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >                                        obj.oWfcn.indexWaveFunction =   1:obj.SE.N;                 </span><span style="color: #0e00ff;">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >                                        obj.oWfcn.indexWaveFunction =   [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >                                        warning(</span><span style="color: #a709f5;">'QMol:TDSE:saveWfcn'</span><span >, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >                                            [</span><span style="color: #a709f5;">'Unknown option for the saving of the wave functions ' </span><span >obj.sKSOI </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >                                            </span><span style="color: #a709f5;">'. No orbitals saved.'</span><span >]);                               </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">else</span><span >,                           obj.oWfcn.indexWaveFunction =   obj.sWfcnI;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Allocate output</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oWfcn.shape         =   [S numel(obj.oWfcn.indexWaveFunction)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oWfcn.waveFunction  =   NaN([obj.oWfcn.shape numel(obj.oWfcn.time)],</span><span style="color: #a709f5;">'like'</span><span >,1i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oWfcn.shape =   [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oWfcn.ind   =   NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oWfcn.n     =   1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Wave functions' projection ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >obj.sWfcnP</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% When to save the wave function projections</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oWfcnP.ind  =   [obj.getOutputIndex(obj.sWfcnPT),NaN];</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oWfcnP.time =   obj.tspan(obj.oWfcnP.ind(1:end-1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oWfcnP.n    =   1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">if </span><span >obj.sEF,         obj.setOutputExternalField(</span><span style="color: #a709f5;">'oWfcnP'</span><span >,</span><span style="color: #a709f5;">'init'</span><span >);    </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Projection basis</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">if </span><span >isempty(obj.sWfcnB)  </span><span style="color: #008013;">% Project on initial wave functions</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >            obj.oWfcnP.basis    =   QMol_disc_basis(</span><span style="color: #a709f5;">'x'</span><span >,obj.SE.disc.x,</span><span style="color: #a709f5;">'v'</span><span >,obj.SE.wfcn.wfcn);</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >            obj.oWfcnP.basis.initialize;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >            obj.oWfcnP.basis    =   obj.sWfcnB;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >            obj.oWfcnP.basis.initialize;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Indexes </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        S               =   obj.oWfcnP.basis.SE_sizeWaveFunction;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">if </span><span >numel(S) &gt; 1   &amp;&amp;   S(end) == 1,     S   =   S(1:end-1);   </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">if </span><span >isempty(obj.sWfcnPI),        obj.oWfcnP.indexWaveFunction    =   [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">elseif </span><span >ischar(obj.sWfcnPI),                                                     </span><span style="color: #0e00ff;">if </span><span >strcmpi(obj.sWfcnPI,</span><span style="color: #a709f5;">'all'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >                                        obj.oWfcnP.indexWaveFunction    =   1:obj.SE.N; </span><span style="color: #0e00ff;">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >                                        obj.oWfcnP.indexWaveFunction    =   [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >                                        warning(</span><span style="color: #a709f5;">'QMol:TDSE:saveWfcnProjection'</span><span >, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >                                            [</span><span style="color: #a709f5;">'Unknown option for the saving of the wave functions'' projection ' </span><span >obj.sWfcnPI </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >                                            </span><span style="color: #a709f5;">'. No wave function projections saved.'</span><span >]);  </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">else</span><span >,                           obj.oWfcnP.indexWaveFunction    =   obj.sWfcnPI;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >            </span><span style="color: #008013;">% Allocate output</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >            obj.oWfcnP.shape        =   [S numel(obj.oWfcnP.indexWaveFunction)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >            obj.oWfcnP.waveFunction =   NaN([obj.oWfcnP.shape numel(obj.oWfcnP.time)],</span><span style="color: #a709f5;">'like'</span><span >,1i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oWfcnP.shape    =   [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oWfcnP.ind      =   NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oWfcnP.n        =   1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">case </span><span >{</span><span style="color: #a709f5;">'clean'</span><span >,</span><span style="color: #a709f5;">'finalize'</span><span >,</span><span style="color: #a709f5;">'finalization'</span><span >} </span><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >obj.sWfcn,   obj.oWfcn   =   rmfield(obj.oWfcn,{</span><span style="color: #a709f5;">'ind'</span><span >,</span><span style="color: #a709f5;">'n'</span><span >,</span><span style="color: #a709f5;">'shape'</span><span >}); </span><span style="color: #0e00ff;">if </span><span >obj.sEF </span><span style="color: #008013;">%#ok&lt;ALIGN&gt; </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >                    obj.setOutputExternalField(</span><span style="color: #a709f5;">'oWfcn' </span><span >,</span><span style="color: #a709f5;">'clean'</span><span >);           </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">else</span><span >,           obj.oWfcn   =   [];                                     </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >obj.sWfcnP,  obj.oWfcnP  =   rmfield(obj.oWfcnP,{</span><span style="color: #a709f5;">'ind'</span><span >,</span><span style="color: #a709f5;">'n'</span><span >,</span><span style="color: #a709f5;">'shape'</span><span >});</span><span style="color: #0e00ff;">if </span><span >obj.sEF </span><span style="color: #008013;">%#ok&lt;ALIGN&gt; </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >                    obj.setOutputExternalField(</span><span style="color: #a709f5;">'oWfcnP'</span><span >,</span><span style="color: #a709f5;">'clean'</span><span >);           </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">else</span><span >,           obj.oWfcnP   =   [];                                    </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span > </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">otherwise </span><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Unexpected option</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    error(</span><span style="color: #a709f5;">'QMol:TDSE:setOutputWaveFunction'</span><span >,[</span><span style="color: #a709f5;">'Unknown option ' </span><span >opt]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><div  class = 'S11'><span>At minimum, the method should initialize</span></div><ul  class = 'S8'><li  class = 'S9'><span>In obj.</span><span style=' font-family: monospace;'>oWfcn</span><span>, </span><span style=' font-family: monospace;'>outWaveFunction.time</span><span>, </span><span style=' font-family: monospace;'>outWaveFunction.waveFunction</span><span>, and </span><span style=' font-family: monospace;'>outWaveFunction.indexWaveFunction</span><span> </span></li><li  class = 'S9'><span>In </span><span style=' font-family: monospace;'>sWfcnP</span><span>, </span><span style=' font-family: monospace;'>outWaveFunctionProjection.time</span><span>, </span><span style=' font-family: monospace;'>outWaveFunctionProjection.waveFunction</span><span>, and </span><span style=' font-family: monospace;'>outWaveFunctionProjection.indexWaveFunction</span><span>. The structure should also retain a copy of the projection basis.</span></li></ul><h4  class = 'S7' id = 'H_8328AE09' ><span style=' font-family: monospace;'>setTimeStep</span></h4><div  class = 'S1'><span>(Re)set the time step to be used in the TDSE propagation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >setTimeStep(obj,dt,t)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%setTimeStep</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Perform the proper (re)initialization </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>dt</span><span> is the value of the time step to be used and </span><span style=' font-family: monospace;'>t</span><span> the current time. Impementation-specific TDSE propagators will often need to keep a copy of </span><span style=' font-family: monospace;'>dt</span><span> (as it may vady from </span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span>).</span></li><li  class = 'S9'><span style=' font-family: monospace;'>setTimeStep</span><span> is called at the very beginning of the TDSE propagation and</span></li><li  class = 'S9'><span style=' font-family: monospace;'>setTimeStep</span><span> may also be called before performing the last iteration if a rescaling is required to reach the requested final time</span></li></ul><h4  class = 'S7' id = 'H_BE45A424' ><span style=' font-family: monospace;'>applyTimeStep</span></h4><div  class = 'S1'><span>Propagate the TDSE dynamics for exactly one time step</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >applyTimeStep(obj,t)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%setTimeStep</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Perform the time propagation</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>t</span><span> is the current time, from which to perform the one-time-step propagation</span></li></ul><h4  class = 'S7' id = 'H_3FBF0B69' ><span style=' font-family: monospace;'>saveOutputDipole</span></h4><div  class = 'S1'><span>Save the dipole, dipole velocity, and/or dipole acceleration signal</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >saveOutputDipole(obj,k,t)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%setTimeStep</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Save the dipole signal</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >k == obj.oDip.ind(obj.oDip.n)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Total dipole</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Orbital-resolved dipole (if any)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Add external field</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">if </span><span >obj.sEF,         obj.addOutputExternalField(</span><span style="color: #a709f5;">'oDip'</span><span >,k,t);         </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Update counter</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oDip.n      =   obj.oDip.n + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Save the dipole-velocity signal</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >k == obj.oVel.ind(obj.oVel.n)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Total dipole velocity</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Orbital-resolved dipole velocity (if any)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Add external field</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">if </span><span >obj.sEF,         obj.addOutputExternalField(</span><span style="color: #a709f5;">'oVel'</span><span >,k,t);         </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Update counter</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oVel.n      =   obj.oVel.n + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Save the dipole acceleration signal</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >k == obj.oAcc.ind(obj.oAcc.n)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Total dipole acceleration</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Orbital-resolved dipole acceleration (if any)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Add external field</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">if </span><span >obj.sEF,         obj.addOutputExternalField(</span><span style="color: #a709f5;">'oAcc'</span><span >,k,t);         </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Update counter</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oAcc.n      =   obj.oAcc.n + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>saveOutputDipole</span><span> is called is any of the dipole, dipole velocity, or dipole acceleration needs to be computed and saved. It must therefore determine which one(s) actually need to be.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>saveOutputDipole</span><span> is also responsible for updating the counters in </span><a href = "#H_F65810AA"><span style=' font-family: monospace;'>obj.oDip</span></a><span>, </span><a href = "#H_95407807"><span style=' font-family: monospace;'>obj.oVel</span></a><span> and </span><a href = "#H_02629977"><span style=' font-family: monospace;'>obj.oAcc</span></a><span> (see their respective documentation entry for the name convention in what/how each should be saved).</span></li></ul><h4  class = 'S7' id = 'H_FDA44F8F' ><span style=' font-family: monospace;'>getExternalFieldEnergy</span></h4><div  class = 'S1'><span>Compute the contributions from any external field and autonomization variable</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >[E,DE] = getExternalFieldEnergy(obj,t)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%getExternalFieldEnergy </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% External field energy</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Autonomization variable</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>E</span><span> is the contribution to the Schrodinger-equation-functional energy from any external field. If not field is applied, or it does not contribute an explicit terms to the Schrodinger-equation energy (</span><span style=' font-style: italic;'>e.g.</span><span>, velocity Gauge dipole approximation), return </span><span style=' font-family: monospace;'>E = [0;0]</span></li><li  class = 'S9'><span style=' font-family: monospace;'>DE</span><span> is the autonomization energy variable, which tracks how much energy is put into or withdrawn from the Schrodinger-equation system</span></li></ul><h4  class = 'S7' id = 'H_4BB23773' ><span style=' font-family: monospace;'>saveOutputIonization</span></h4><div  class = 'S1'><span>Compute the ionization statistics</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >saveOutputIonization(obj,k,t)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%saveOutputIonization </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Total ionization signal</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Orbital-resolved ionization signal</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Add external field</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >obj.sEF,         obj.addOutputExternalField(</span><span style="color: #a709f5;">'oIon'</span><span >,k,t);         </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Update counter</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    obj.oIon.n      =   obj.oIon.n + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>saveOutputIonization</span><span> is also responsible for updating the counters in </span><a href = "#H_E1C662FA"><span style=' font-family: monospace;'>obj.oIon</span></a><span> (see the documentation entry for the name convention in what/how each should be saved).</span></li></ul><h4  class = 'S7' id = 'H_24EF3880' ><span style=' font-family: monospace;'>saveOutputWaveFunction</span></h4><div  class = 'S1'><span>Save the Wave functions (projection) and one-body density</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >saveOutputWaveFunction(obj,k,t)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%setTimeStep</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Save wave functions</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >k == obj.oWfcn.ind(obj.oWfcn.n)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Wave functions</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Add external field</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">if </span><span >obj.sEF,         obj.addOutputExternalField(</span><span style="color: #a709f5;">'oWfcn'</span><span >,k,t);         </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Update counter</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oWfcn.n     =   obj.oWfcn.n + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Save the projection of the Kohn-Sham orbitals</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >k == obj.oWfcnP.ind(obj.oWfcnP.n)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Kohn-Sham orbitals' projection</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Add external field</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">if </span><span >obj.sEF,         obj.addOutputExternalField(</span><span style="color: #a709f5;">'oWfcnP'</span><span >,k,t);        </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Update counter</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oWfcnP.n    =   obj.oWfcnP.n + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>saveOutputWaveFunction</span><span> is called is any of the wave functions or their projection needs to be saved. It must therefore determine which one(s) actually need to be.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>saveOutputWaveFunction</span><span> is also responsible for updating the counters in </span><a href = "#H_371940E8"><span style=' font-family: monospace;'>obj.oWfcn</span></a><span> and </span><a href = "#H_5096ABA5"><span style=' font-family: monospace;'>obj.oWfcnP</span></a><span> (see their respective documentation entry for the name convention in what/how each should be saved).</span></li></ul><h3  class = 'S6' id = 'H_C9A49DFA' ><span>Additional optional methods to overload</span></h3><h4  class = 'S7' id = 'H_DC4E9FF3' ><span style=' font-family: monospace;'>getMemoryProfilePropagator</span></h4><div  class = 'S1'><span>Estimate the memory footprint of the implementation-specific part of the TDSE propagator</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >mem = getMemoryProfilePropagator(obj,opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%getMemoryProfilePropagator </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Initialization</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >nargin &lt; 2,  opt     =   false;  </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Estimate of the memory footprint</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>Use </span><a href = "./QMol_SE_profiler.html"><span style=' font-family: monospace;'>QMol_SE_profiler</span></a><span style=' font-family: monospace;'>.showMemoryFootprint</span><span> to display the memory foorprint of the propagator's components (when </span><span style=' font-family: monospace;'>opt == true</span><span>)</span></li><li  class = 'S9'><span style=' font-family: monospace;'>getMemoryProfilePropagator</span><span> should only list the memory footprint of the propagation part of the implementation-specific class. Estimate of the memory footprint for the output results is handled with the </span><a href = "#H_483AC36A"><span style=' font-family: monospace;'>getMemoryProfileWaveFunction</span></a><span> and </span><a href = "#H_A5C2DE6E"><span style=' font-family: monospace;'>getMemoryProfileChildren</span></a><span> properties.</span></li><li  class = 'S9'><span>The </span><a href = "#H_37454CF9"><span style=' font-family: monospace;'>SE</span></a><span> object is initialized when </span><span style=' font-family: monospace;'>getMemoryProfilePropagator</span><span> is called</span></li></ul><h4  class = 'S7' id = 'H_483AC36A' ><span style=' font-family: monospace;'>getMemoryProfileWaveFunction</span></h4><div  class = 'S1'><span>Estimate the memory footprint for saving of the wave functions in the implementation-specific TDSE propagator</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >mem = getMemoryProfileWaveFunction(obj,opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%getMemoryProfileOrbitalDensity</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Initialization</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >nargin &lt; 2,  opt     =   false;  </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Estimate of the memory footprint</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>Use </span><a href = "./QMol_SE_profiler.html"><span style=' font-family: monospace;'>QMol_SE_profiler</span></a><span style=' font-family: monospace;'>.showMemoryFootprint</span><span> to display the memory foorprint of saving the wave functions (when </span><span style=' font-family: monospace;'>opt == true</span><span>)</span></li><li  class = 'S9'><span style=' font-family: monospace;'>getMemoryProfileWaveFunction</span><span> should only list the memory footprint of the requested wave functions. Estimate of the memory footprint for any additional implementation-specific output results with </span><a href = "#H_A5C2DE6E"><span style=' font-family: monospace;'>getMemoryProfileChildren</span></a><span>.</span></li><li  class = 'S9'><span>The </span><a href = "#H_37454CF9"><span style=' font-family: monospace;'>SE</span></a><span> object is initialized when </span><span style=' font-family: monospace;'>getMemoryProfileOrbitalDensity</span><span> is called</span></li></ul><h4  class = 'S7' id = 'H_A5C2DE6E' ><span style=' font-family: monospace;'>getMemoryProfileChildren</span></h4><div  class = 'S1'><span>Estimate the memory footprint of additional output defined by the implementation-specific part of the TDSE propagator</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >mem = getMemoryProfileChildren(obj,opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%getMemoryProfilePropagator </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Initialization</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >nargin &lt; 2,  opt     =   false;  </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Estimate of the memory footprint</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>Use </span><a href = "./QMol_SE_profiler.html"><span style=' font-family: monospace;'>QMol_SE_profiler</span></a><span style=' font-family: monospace;'>.showMemoryFootprint</span><span> to display the memory foorprint of the additional outputs (when </span><span style=' font-family: monospace;'>opt == true</span><span>)</span></li><li  class = 'S9'><span style=' font-family: monospace;'>getMemoryProfileChildren</span><span> should only list the memory footprint of additional output defined by the implementation-specific TDSE propagator. Estimate of the memory footprint for the wave function output results is handled with </span><a href = "#H_483AC36A"><span style=' font-family: monospace;'>getMemoryProfileOrbitalDensity</span></a></li><li  class = 'S9'><span>The </span><a href = "#H_37454CF9"><span style=' font-family: monospace;'>SE</span></a><span> object is initialized when </span><span style=' font-family: monospace;'>getMemoryProfileChildren</span><span> is called</span></li></ul><h4  class = 'S7' id = 'H_B96633C8' ><span style=' font-family: monospace;'>docOutputChildren</span></h4><div  class = 'S1'><span>Run-time documentation for additional implementation-specific output variables</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >ref = docOutputChildren(obj)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%docOutputChildren </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Add specific documentation</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>If no reference is cited, return </span><span style=' font-family: monospace;'>ref = {}</span><span> otherwise </span><span style=' font-family: monospace;'>ref = {'ref 1','ref 2',___}</span><span>, where each of the </span><span style=' font-family: monospace;'>ref</span><span> corresponds to the bibliographic code for the reference (generally of the form </span><span style=' font-family: monospace;'>'name_of_first_author publication_year'</span><span>) and is case insensitive -- see the </span><a href = "./Documentation.html"><span>documentation page</span></a><span> for a list of citable references.</span></li><li  class = 'S9'><span>For consistency with the other output available to all TDSE propagators, only list the additional output that are being calculated during the TDSE propagation (following user-defined properties).</span></li><li  class = 'S9'><span>Only implementation-specific additional properties should be covered here. All properties common to all TDSE propagators (</span><span style=' font-style: italic;'>e.g.</span><span>, time step) are handled in the parent </span><span style=' font-family: monospace;'>QMol_TDSE</span><span> class run-time documentation.</span></li><li  class = 'S9'><span>Run-time documentation for the implementation-specific TDSE propagator is handled with </span><a href = "#H_D8A9FEA5"><span style=' font-family: monospace;'>showDoc</span></a><span> and therefore should not be included here.</span></li></ul><h4  class = 'S7' id = 'H_675447D6' ><span style=' font-family: monospace;'>setOutputChildren</span></h4><div  class = 'S1'><span>Implementation-specific TDSE propagation classes that overload </span><span style=' font-family: monospace;'>QMol_TDSE</span><span> may define additional run-time results to save during the propagation. Those are initialized with the </span><span style=' font-family: monospace;'>setOutputChildren</span><span> method with the following signature (see also the example </span><a href = "#H_CBF28755"><span>above</span></a><span> for a more fleshed out template)</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >setOutputChildren(obj,opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%setOutputChildren</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">switch </span><span >lower(opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">case </span><span >{</span><span style="color: #a709f5;">'init'</span><span >,</span><span style="color: #a709f5;">'initialize'</span><span >,</span><span style="color: #a709f5;">'initialization'</span><span >} </span><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Clean up any old data ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Initialize output structure(s) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">case </span><span >{</span><span style="color: #a709f5;">'clean'</span><span >,</span><span style="color: #a709f5;">'finalize'</span><span >,</span><span style="color: #a709f5;">'finalization'</span><span >} </span><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Clean output structures at the end of the TDSE propagation</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">otherwise </span><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Unexpected option</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    error(</span><span style="color: #a709f5;">'QMol:TDSE:setOutputChildren'</span><span >,[</span><span style="color: #a709f5;">'Unknown option ' </span><span >opt]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><h4  class = 'S7' id = 'H_DF38E3D0' ><span style=' font-family: monospace;'>setOutputExternalField</span></h4><div  class = 'S1'><span>Enable saving of the </span><a href = "#H_48DDF558"><span>external-field information</span></a><span> in a given </span><a href = "#H_D533B953"><span>output structure</span></a></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >setOutputExternalField(obj,structName,opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%setOutputExternalField</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">switch </span><span >lower(opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">case </span><span >{</span><span style="color: #a709f5;">'init'</span><span >,</span><span style="color: #a709f5;">'initialize'</span><span >,</span><span style="color: #a709f5;">'initialization'</span><span >} </span><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Add proper field for external field information</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">case </span><span >{</span><span style="color: #a709f5;">'clean'</span><span >,</span><span style="color: #a709f5;">'finalize'</span><span >,</span><span style="color: #a709f5;">'finalization'</span><span >} </span><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Clean output structures at the end of the TDSE propagation</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% (for the external-field information only)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">otherwise </span><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Unexpected option</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    error(</span><span style="color: #a709f5;">'QMol:TDSE:setOutputExternalField'</span><span >,[</span><span style="color: #a709f5;">'Unknown option ' </span><span >opt]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>setOutputExternalField</span><span> is called in the initialization and cleanup of each of the </span><a href = "#H_5D387730"><span style=' font-family: monospace;'>setOutputDipole</span></a><span>, </span><a href = "#H_C32F9472"><span style=' font-family: monospace;'>setOutputEnergy</span></a><span>, </span><a href = "#H_C219079B"><span style=' font-family: monospace;'>setOutputFunction</span></a><span>, </span><a href = "#H_EA0844B5"><span style=' font-family: monospace;'>setOutputIonization</span></a><span>, and </span><a href = "#H_D7894DE5"><span style=' font-family: monospace;'>setOutputWaveFunction</span></a></li><li  class = 'S9'><span style=' font-family: monospace;'>structName</span><span> is the name of the </span><a href = "#H_D533B953"><span>output structure</span></a><span> to which the external field info are to be initialized. </span><span style=' font-family: monospace;'>obj.(structName)</span><span> gives access to the corresponding property in the class.</span></li></ul><h4  class = 'S7' id = 'H_F3159701' ><span style=' font-family: monospace;'>setRestartChildren</span></h4><div  class = 'S1'><span>Perform the necessary initialization of the implementation-specific TDSE propagator in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span> </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >setRestartChildren(obj)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%setRestartChildren</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Initialize upon restart</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>setRestartChildren</span><span> is called </span><span style=' text-decoration: underline;'>after</span><span> the </span><span style=' font-family: monospace;'>QMol_TDSE</span><span> has performed its own reinitialization, notably </span><a href = "#H_37454CF9"><span style=' font-family: monospace;'>SE</span></a><span> object has been initialized </span></li></ul><h4  class = 'S7' id = 'H_E5FC9CB8' ><span style=' font-family: monospace;'>saveOutputChildren</span></h4><div  class = 'S1'><span>Save additional implementation-specific output</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >saveOutputChildren(obj,k,t)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%saveOutputChildren</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Save additional output</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>k</span><span> is the current time-propagation step index</span></li><li  class = 'S9'><span style=' font-family: monospace;'>t</span><span> is the current time when the saving is performed</span></li><li  class = 'S9'><span style=' font-family: monospace;'>saveOutputChildren</span><span> is called for every time step (including the starting and final times) of the TDSE propagation. The class is responsible for checking which additional data must be saved, if any, and doing the actual saving.</span></li></ul><h4  class = 'S7' id = 'H_B478C7F5' ><span style=' font-family: monospace;'>addOutputExternalField</span></h4><div  class = 'S1'><span>Adds the </span><a href = "#H_48DDF558"><span>external-field information</span></a><span> to a given </span><a href = "#H_D533B953"><span>output structure</span></a></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >addOutputExternalField(obj,structName,k,t)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%addOutputExternalField</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Add external-field information to output structure</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>addOutputExternalField is called by </span><a href = "#H_3FBF0B69"><span style=' font-family: monospace;'>saveOutputDipole</span></a><span>, </span><a href = "#H_9ED0647B"><span style=' font-family: monospace;'>saveOutputEnergy</span></a><span>, </span><a href = "#H_1C92546A"><span style=' font-family: monospace;'>saveOutputFunction</span></a><span>, </span><a href = "#H_4BB23773"><span style=' font-family: monospace;'>saveOutputIonization</span></a><span>, and </span><a href = "#H_24EF3880"><span style=' font-family: monospace;'>saveOutputWaveFunction</span></a></li><li  class = 'S9'><span style=' font-family: monospace;'>structName</span><span> is the name of the </span><a href = "#H_D533B953"><span>output structure</span></a><span> to which the external field info are to be saved. </span><span style=' font-family: monospace;'>obj.(structName)</span><span> gives access to the corresponding property in the class.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>k</span><span> is the current time-propagation step index</span></li><li  class = 'S9'><span style=' font-family: monospace;'>t</span><span> is the current time when the saving is performed</span></li></ul><h4  class = 'S7' id = 'H_9D80AD2B' ><span style=' font-family: monospace;'>saveRestartChildren</span></h4><div  class = 'S1'><span>Save implementation-specific info needed for restarting a TDSE calculation to the </span><a href = "#H_4F8B0111"><span style=' font-family: monospace;'>restart</span></a><span> structure</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >saveRestartChildren(obj,k,t)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%saveOutputChildren</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Save additional output</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>k</span><span> is the current time-propagation step index</span></li><li  class = 'S9'><span style=' font-family: monospace;'>t</span><span> is the current time when the saving is performed</span></li><li  class = 'S9'><span style=' font-family: monospace;'>saveRestartChildren</span><span> is called at the end of a time-step propagation (and the index </span><span style=' font-family: monospace;'>k</span><span> and time </span><span style=' font-family: monospace;'>t</span><span> have been updated accordingly before calling the function)</span></li></ul><h2  class = 'S2' id = 'H_8CAFC83D' ><span>Bourdary absorber</span></h2><div  class = 'S1'><span>TDSE propagators support both mask and complex absorbing bondary conditions. The template for absorbing boundayr classes is</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span style="color: #0e00ff;">classdef</span><span style="color: #0e00ff;"> </span><span >QMol_SE_absorber &lt; QMol_suite</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%QMol_SE_absorber </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%% Documentation %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">methods </span><span >(Static,Access=private)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >version</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    QMol_doc.showVersion(</span><span style="color: #a709f5;">'##.##.###'</span><span >,</span><span style="color: #a709f5;">'##/##/####'</span><span >,</span><span style="color: #a709f5;">'Author Name'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">methods </span><span >(Static,Access={?QMol_doc,?QMol_SE_absorber})</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >showInfo</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    fprintf( </span><span style="color: #a709f5;">'  * QMol_SE_absorber:\n'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    fprintf([</span><span style="color: #a709f5;">'      &gt; Absorbing boundaries\n'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >             </span><span style="color: #a709f5;">'      &gt; Type of absorber\n'</span><span >]); </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    QMol_SE_absorber.version;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">methods </span><span >(Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >ref = showDocumentation(obj)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%showDocumentation displays the documentation reflecting member property </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%   values</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Initialization</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    ref                 =   {};</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Header</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    fprintf(</span><span style="color: #a709f5;">'  * Absorbing boundaries                                  type of absorber\n'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Details of the absorber</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Version</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    obj.version;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >mem = getMemoryProfile(obj,opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%getMemoryProfile computes and returns an estimate of the total memory</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%   footprint (in bytes) of the absorber with all its components</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%   initialized and used.</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Initialization</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >nargin &lt; 2,  opt =   false;  </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Evaluate (and display) estimate of memory footprint</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%% Properties %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">properties </span><span >(Transient,Hidden,GetAccess=?QMol_suite,SetAccess={?QMol_TDSE_abs_mask,?QMol_TDSE})</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Linked objects</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    SE                              </span><span style="color: #008013;">% SE.disc always defines the domain</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Other properties of the class</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%% Alias handling %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Mapping between user-facing long variable names and internal's short</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%% Initialization %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">methods </span><span >(Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >reset(obj)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%reset clears all temporary (transient) properties of the object. Should be</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%   overloaded by each subclasses to perform proper reset actions.</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Run-time variables</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    obj.SE              =   [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Initialization status</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    obj.isInit          =   false;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >initialize(obj,SE,isFwd)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%initialize initializes the object</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Initialization</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    obj.reset;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Set links</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    obj.SE              =   SE;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Initialize the absorber</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Miscellaneous</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    obj.isInit          =   true;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">methods </span><span >(Static=true,Access=?QMol_suite)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >[ClassName,PropNames] = propertyNames()</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%propertyNames returns the names of member properties that can be set</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%   through name-value assignment</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    ClassName           =   </span><span style="color: #a709f5;">'QMol_SE_absorber'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    PropNames           =   {};</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%% Absorber %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">methods </span><span >(Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    applyMask(obj,wfcn)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    V = getPotential(obj,V)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>Upon initialization, the class shoud retain a copy of the </span><a href = "#H_37454CF9"><span style=' font-family: monospace;'>SE</span></a><span> object with the access-right signature specified above (required for memory profiling)</span></li><li  class = 'S9'><span>In the </span><span style=' font-family: monospace;'>initialize</span><span> method, </span><span style=' font-family: monospace;'>isFwd</span><span> indicates whether the TDSE propagation is is a forward (</span><span style=' font-family: monospace;'>true</span><span>) or backward (</span><span style=' font-family: monospace;'>false</span><span>) in time (to adjust the sign of the CAP)</span></li></ul><h3  class = 'S6' id = 'H_CA02FC07' ><span>Mask function</span></h3><div  class = 'S1'><span>Mask absorbers correspond to a given mask function that is multipled to the Kohn-Sham orbitals after each propagation time step. Their signature is</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >applyMask(obj,wfcn)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%applyMask</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Multiply the orbitals in KSO by the mask</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >V = getPotential(~,V)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%getPotential no complex potential, return the object untouched</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>Even when no complex absorbing potential is defined, </span><span style=' font-family: monospace;'>getPotential</span><span> must still be defined, leaving the input Schrodinger-equation potential untouched</span></li></ul><h3  class = 'S6' id = 'H_64DC68BD' ><span>Complex absorbing potential (CAP)</span></h3><div  class = 'S1'><span>Complex absorbing potentials correspond to an imaginary component added to the Schrodinger-equation potential that dampen the Kohn-Sham orbitals at the boundaries. Their signature is</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >applyMask(~,~)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%applyMask no mask applied, do nothinggetMem</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >V = getPotential(obj,V)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%getPotential</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Add the complex potential to the SE-potential object V</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>Even when no mask is defined, </span><span style=' font-family: monospace;'>applyMask</span><span> must still be defined, doing nothing</span></li><li  class = 'S9'><span>V is a compatible Schrodinger-equation potential; use its </span><span style=' font-family: monospace;'>add</span><span> property to add the CAP</span></li></ul><h2  class = 'S2' id = 'H_D431B55B' ><span>Test suite</span></h2><div  class = 'S1'><span>For consistency with the rest of the QMol-grid package, </span><span style=' font-family: monospace;'>QMol_TDSE</span><span> defines an associated test suite. Run the test suite for the class in normal or </span><a href = "./Test_suite.html"><span>summary mode</span></a><span> respectively with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'TDSE'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'-summary'</span><span >,</span><span style="color: #a709f5;">'TDSE'</span><span >);</span></span></div></div></div><div  class = 'S11'><span>See </span><a href = "./QMol_test.html"><span style=' font-family: monospace;'>QMol_test</span></a><span> for details regarding how to create a test suite for new classes.</span></div><h2  class = 'S2' id = 'H_2E204287' ><span>Notes</span></h2><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>QMol_TDSE</span><span> was intorduced in version 01.20 </span></li></ul>
<br>
<!-- 
##### SOURCE BEGIN #####
%% |QMol_TDSE|
% Parent class for time-dependent Schrodinger-equation theory (TDSE) model objects.
%% Description
% |QMol_TDSE| defines an abstract class for the time propagation of Schrodinger-equation 
% (SE) models. It is designed to be agnostic of (i) the model dimension and (ii) 
% the chosen discretization (Cartesian grid or basis). These are to be handled 
% by the specific TDSE-implementation classes and their components.
% 
% |QMol_TDSE| defines many peoperties and methods. Here we only document the 
% ones visible to end users and implementation-specific overloading classes (public 
% or protected access attributes). We provide a quick overview of the requirements 
% of implementation-specific classes for defining actual TDSE propagation schemes.
%% Class properties
% Time propagation
% |display (disp)|
% Whether to display progress of the TDSE calculations as they go on |[ true 
% (default) | false ]|
% |time (T)|
% Time propagation vector |[ vector (default []) ]|
%% 
% * In all TDSE propagation simulations |T(1)| specifies the starting time and 
% |T(end)| the ending time.
% * In forward time propagation simulations (|timeStep| |> 0|) time values in 
% |T| must be all increasing, while for backward time propagation (|timeStep| 
% |< 0|) they must be all decreasing. Time increments in the vector |T| need not 
% be equally spaced.
% * When |display| is activated, |T| specifies the intermediary times for the 
% time-propagation progress display.
% * |T| is also the default time sampling for saved results that do not define 
% their own.
% * Note that the time step used in TDSE propagations is set independently of 
% |T|.
% |timeStep (dt)|
% Time step used for the time propagation  |[ scalar (default 0.01) ]|
%% 
% * Positive (resp. negative) |timeStep| define forward (resp. ackward) time 
% propagation.
% |absorbingBoundary (ABC)|
% Absorber at the edges of the domain |[ [] (default) | mask object | CAP object 
% ]|
%% 
% * The boundary absorber aims at eliminating outgoing wave packets from the 
% discretization domain and avoid spurious reflections at the edges of the domain.
% * Empty |absorbingBoundary| does not implement any absorbing boundary method 
% and any part of the wave packet reaching the edges of the domain will be reflected 
% (or articifially reappears on the other side of the domain through periodic 
% effects).
% * Mask absorbers are applied at the end of each propagation step. They are 
% the easiest to use and implement but are first order, irrespective of the order 
% of the time propagation scheme. See below for details on the required interface 
% for absorbing mask classes.
% * Complex absorbing potentials (CAPs) are integrated within the propagation 
% scheme, as an imaginary potential term that causes exponential decay of the 
% wave packet at the edges. Under the right circumstances, CAPs can preserve the 
% order of the propagation schemes. See below for details on the required interface 
% for CAP classes.
% |externalField (EF)|
% External driving field |[ [] (default) | field object ]|
%% 
% * Empty |externalField| performs field-free TDSE simulations.
% * The specific type and interface for compatible field objects is left to 
% the implementation-specific TDSE propagator REPLACE_WITH_DASH_DASH see the corresponding documentation 
% for details.
% Save the Schrodinger-equation object into individual files
% During the time propagation, copies of the Schrodinger-equation object can 
% be saved in separate MATLAB files.
% |saveSE (sSE)|
% Activate saving the Schrodinger-equation object into separate files |[ true 
% | false (default) ]|
% |saveSEFileName (sSEF)|
% Name for the files in which the Schrodinger-equation objects are saved |[ 
% chracter array (default 'QMolGridREPLACE_WITH_DASH_DASHTDSEREPLACE_WITH_DASH_DASHSE') ]|
%% 
% * The Schrodinger-equation objects saved at different times are put in separate 
% MATLAB (.mat.) file, with names starting with |saveSEFileName| to which the 
% iteration index is appended. Each file produced also contains a scalar variable 
% |t| with the time information.
% * One may specify a location where to create the files by indicating the folder 
% path in |saveSEFileName|
% * |saveSEFileName| is irrelevant when |saveSE| |== false|
% |saveSETime (sSET)|
% Times at which to save the Schrodinger-equation object into a file |[ [] (default) 
% | positive scalar | negative integer | vector | 'all' ]|
%% 
% * Empty |saveSETime| uses the same values as in |time| for when to save the 
% Schrodinger-equation object into MATLAB files.
% * A positive scalar specifies the sampling time step when to save the Schrodinger-equation 
% object into MATLAB files. For forward time propagation, it is equivalent to 
% time|(1):saveSETime:|time|(end)|, and for backward ones to time|(1):-saveSETime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% saves. For forward time propagation, it is equivalent to time|(1):abs(saveSETime)*||timeStep||:|time|(end)|, 
% and for backward ones to time|(1):-abs(saveSETime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to save the Schrodinger-equation 
% object to a MATLAB file.
% * |'all'| saves the Schrodinger-equation object into a MATLAB file after every 
% time step. Warning: this is slow and may result in a very large number of file 
% and/or large disk usage.
% * See the note on how intermediate time saving is performed during the TDSE 
% propagation below.
% Save the dipole, dipole velocity, and dipole acceleration signals
% |saveDipole (sDip)|
% Whether to calculate and save the dipole signal during the TDSE propagation 
% |[ true | false (default) ]|
% |saveDipoleWaveFunctionIndex (sDipI)|
% Index of the wave functions for which to compute the orbital-resolved dipole 
% signal |[ [] (default) | index vector | 'all' ]|
%% 
% * This is irrelevant if |saveDipole| is |false|
% * Specify the indexes of the wave functions for which to compute the orbital-resolved 
% dipole signal in an index vector
% * Empty or |'all'| |saveDipoleWaveFunctionIndex| computes the orbital-resolved 
% dipole for all wave functions
% |saveDipoleTime (sDipT)|
% Times at which to compute and save the dipole signal |[ [] (default) | positive 
% scalar | negative integer | vector | 'all' ]|
%% 
% * Empty |saveDipoleTime| uses the same values as in |time| for when to compute 
% and save the dipole signal.
% * A positive scalar specifies the sampling time step between successive computations 
% of the dipole signal. For forward time propagation, it is equivalent to time|(1):saveDipoleTime:|time|(end)|, 
% and for backward ones to time|(1):-saveDipoleTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% dipole-signal computations. For forward time propagation, it is equivalent to 
% time|(1):abs(saveDipoleTime)*||timeStep||:|time|(end)|, and for backward ones 
% to time|(1):-abs(saveDipoleTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to compute and save the dipole 
% signal.
% * |'all'| computes and saves the dipole signal after every time step. Warning: 
% this is may be slow.
% * See the note on how intermediate time saving is performed during the TDSE 
% propagation below.
% |saveDipoleVelocity (sVel)|
% Whether to calculate and save the dipole velocity signal during the TDSE propagation 
% |[ true | false (default) ]|
% |saveDipoleVelocityWaveFunctionIndex (sVelI)|
% Index of the wave functions for which to compute the orbital-resolved dipole 
% velocity signal |[ [] (default) | index vector | 'all' ]|
%% 
% * This is irrelevant if |saveDipoleVelocity| is |false|
% * Specify the indexes of the wave functions for which to compute the dipole 
% velocity signal in an index vector
% * Empty or |'all'| |saveDipoleVelocityWaveFunctionIndex| computes the dipole 
% velocity for all wave functions
% |saveDipoleVelocityTime (sVelT)|
% Times at which to compute and save the dipole velocity signal |[ 'dipole' 
% (default) | positive scalar | negative integer | vector | 'all' ]|
%% 
% * |'dipole'| |saveDipoleVelocityTime| uses the same times as for |saveDipoleTime| 
% * A positive scalar specifies the sampling time step between successive computations 
% of the dipole velocity signal. For forward time propagation, it is equivalent 
% to time|(1):saveDipoleVelocityTime:|time|(end)|, and for backward ones to time|(1):-saveDipoleVelocityTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% dipole-velocity-signal computations. For forward time propagation, it is equivalent 
% to time|(1):abs(saveDipoleVelocityTime)*||timeStep||:|time|(end)|, and for backward 
% ones to time|(1):-abs(saveDipoleVelocityTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to compute and save the dipole 
% velocity signal.
% * |'all'| computes and saves the dipole velocity signal after every time step. 
% Warning: this is may be slow.
% * See the note on how intermediate time saving is performed during the TDSE 
% propagation below.
% |saveDipoleAcceleration (sAcc)|
% Whether to calculate and save the dipole acceleration signal during the TDSE 
% propagation |[ true | false (default) ]|
% |saveDipoleAccelerationOrbitalIndex (sAccI)|
% Index of the Kohn-Sham orbitals for which to compute the orbital-resolved 
% dipole acceleration signal |[ [] (default) | index vector | 'all' ]|
%% 
% * This is irrelevant if |saveDipoleAcceleration| is |false|
% * Specify the indexes of the wave functions for which to compute the dipole 
% acceleration signal in an index vector
% * Empty or |'all'| |saveDipoleAccelerationWaveFunctionIndex| computes the 
% dipole acceleration for all wave functions
% |saveDipoleAccelerationTime (sAccT)|
% Times at which to compute and save the dipole acceleration signal |[ 'dipole' 
% (default) | positive scalar | negative integer | vector | 'all' ]|
%% 
% * |'dipole'| |saveDipoleAccelerationTime| uses the same times as for |saveDipoleTime| 
% * A positive scalar specifies the sampling time step between successive computations 
% of the dipole acceleration signal. For forward time propagation, it is equivalent 
% to time|(1):saveDipoleAccelerationTime:|time|(end)|, and for backward ones to 
% time|(1):-saveDipoleAccelerationTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% dipole-acceleration-signal computations. For forward time propagation, it is 
% equivalent to time|(1):abs(saveDipoleAccelerationTime)*||timeStep||:|time|(end)|, 
% and for backward ones to time|(1):-abs(saveDipoleAccelerationTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to compute and save the dipole 
% acceleration signal.
% * |'all'| computes and saves the dipole acceleration signal after every time 
% step. Warning: this is may be slow.
% * See the note on how intermediate time saving is performed during the TDSE 
% propagation below.
% Save *Schrodinger-equation and wave function* energies
% |saveEnergySE (sESE)|
% Whether to track the Schrodinger-equation energy during the TDSE propagation 
% |[ true | false (default) ]|
% |saveEnergySETime (sESET)|
% Times at which to compute and save the Schrodinger-equation energy |[ [] (default) 
% | positive scalar | negative integer | vector | 'all' ]|
%% 
% * Empty |saveEnergySETime| uses the same values as in |time| for when to compute 
% and save the Schrodinger-equation energy
% * A positive scalar specifies the sampling time step between successive computations 
% of the Schrodinger-equation energy. For forward time propagation, it is equivalent 
% to time|(1):saveEnergySETime:|time|(end)|, and for backward ones to time|(1):-saveEnergySETime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% Schrodinger-equation-energy computations. For forward time propagation, it is 
% equivalent to time|(1):abs(saveEnergySETime)*||timeStep||:|time|(end)|, and 
% for backward ones to time|(1):-abs(saveEnergySETime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to compute and save the Schrodinger-equation 
% energy.
% * |'all'| computes and saves the Schrodinger-equation energy after every time 
% step. Warning: this is may be slow.
% * See the note on how intermediate time saving is performed during the TDSE 
% propagation below.
% |saveEnergyWaveFunction (sEWfcn)|
% Whether to track the wave function energies during the TDSE propagation |[ 
% true | false (default) ]|
% |saveEnergyWaveFunctionTime (sEWfcnT)|
% Times at which to compute and save the wave function energies |[ [] (default) 
% | positive scalar | negative integer | vector | 'all' ]|
%% 
% * For a wave function $|\psi\rangle$, the orbital energy is defined as $\langle\psi|\hat{\mathcal{H}}|\psi\rangle$ 
% with $\hat{\mathcal{H}}$ the Schrodinger-equation Hamiltonian operator.
% * Empty |saveEnergyWaveFunctionTime| uses the same values as in |time| for 
% when to compute and save the wave function energies
% * A positive scalar specifies the sampling time step between successive computations 
% of the wave function energies. For forward time propagation, it is equivalent 
% to time|(1):saveEnergyWaveFunctionTime:|time|(end)|, and for backward ones to 
% time|(1):-saveEnergyWaveFunctionTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% wave function energy computations. For forward time propagation, it is equivalent 
% to time|(1):abs(saveEnergyWaveFunctionTime)*||timeStep||:|time|(end)|, and for 
% backward ones to time|(1):-abs(saveEnergyWaveFunctionTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to compute and save the wave 
% function energies.
% * |'all'| computes and saves the wave function energies after every time step. 
% Warning: this is may be slow.
% * See the note on how intermediate time saving is performed during the TDSE 
% propagation below.
% Save the external field information
% |saveExternalField (sEF)|
% For TDSE simulation with and external driving field, save the external field 
% in output structures |[ true | false (default) ]|
%% 
% * When activated (|saveExternalField = true|), the information about the external 
% driving field at the sampled times is added to each of the output structures 
% (except |outSE|).
% * For practical reasons, the values for the external driving field may be 
% slightly different than that of |externalField|. This features enables keeping 
% the actual external-field values used throughout the propagation.
% Save the ionization signal
% The ionization signal tracks how much density leaves the simulation domain 
% by being absorbed at the boundaries.
% |saveIonization (sIon)|
% Whether to calculate and save the ionization signal during the TDSE propagation 
% |[ true | false (default) ]|
% |saveIonizationWaveFunctionIndex (sIWfcnI)|
% Index of the wave functions for which to compute the orbital-resolved ionization 
% signal |[ [] (default) | index vector | 'all' ]|
%% 
% * This is irrelevant if |saveIonization| is |false|
% * Specify the indexes of the wave functions for which to compute the ionization 
% signal in an index vector
% * Empty or |'all'| |saveIonizationWaveFunctionIndex| computes the ionization 
% for all wave functions
% |saveIonizationTime (sIonT)|
% Times at which to compute and save the ionization signal |[ [] (default) | 
% positive scalar | negative integer | vector | 'all' ]|
%% 
% * Empty |saveIonizationTime| uses the same values as in |time| for when to 
% compute and save the ionization signal.
% * A positive scalar specifies the sampling time step between successive computations 
% of the ionization signal. For forward time propagation, it is equivalent to 
% time|(1):saveIonizationTime:|time|(end)|, and for backward ones to time|(1):-saveIonizationTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% ionization-signal computations. For forward time propagation, it is equivalent 
% to time|(1):abs(saveIonizationTime)*||timeStep||:|time|(end)|, and for backward 
% ones to time|(1):-abs(saveIonizationTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to compute and save the ionization 
% signal.
% * |'all'| computes and saves the ionization signal after every time step. 
% Warning: this is may be slow.
% * See the note on how intermediate time saving is performed during the TDSE 
% propagation below.
% Save the *wave functions and their projection on a basis*
% Warning: The memory requirements for saving the wave function throughout the 
% TDSE propagation may grow very fast and trigger an error (if MATLAB runs out 
% of memory). Instead, if the full wave function is required consider saving the 
% Schrodinger-equation object in separate files, or if only the result of a specify 
% calculation on the wave function is required consider consider using an installabe 
% output function.
% |saveWaveFunction (sWfcn)|
% Whether to save the wave functions during the TDSE propagation |[ true | false 
% (default) ]|
% |saveWaveFunctionIndex (sWfcnI)|
% Index of the wave functions to save |[ [] (default) | index vector | 'all' 
% ]|
%% 
% * This is irrelevant if |saveWaveFunction| is |false|
% * Empty |saveWaveFunctionIndex| disables saving of the wave functions and 
% is technically equivalent to |saveWaveFunction||= false|
% * Specify the indexes of the wave functions to save in an index vector
% * |'all'| saves all the wave functions
% |saveWaveFunctionTime (sWfcnT)|
% Times at which to save the wave functions |[ [] (default) | positive scalar 
% | negative integer | vector | 'all' ]|
%% 
% * Empty |saveWaveFunctionTime| uses the same values as in |time| for when 
% to save the wave functions.
% * A positive scalar specifies the sampling time step between successive saving 
% of the wave functions. For forward time propagation, it is equivalent to time|(1):saveWaveFunctionTime:|time|(end)|, 
% and for backward ones to time|(1):-saveWaveFunctionTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% saving wave functions. For forward time propagation, it is equivalent to time|(1):abs(saveWaveFunctionTime)*||timeStep||:|time|(end)|, 
% and for backward ones to time|(1):-abs(saveWaveFunctionTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to save the wave functions.
% * |'all'| saves the wave functions after every time step. Warning: generally 
% discouraged as it likely results in very large memory requirements or cause 
% an out-of-memory error REPLACE_WITH_DASH_DASH see the warning above.
% * See the note on how intermediate time saving is performed during the TDSE 
% propagation below.
% |saveWaveFunctionProjection (sWfcnP)|
% Whether to save the projection of the wave functions onto a specific basis 
% during the TDSE propagation |[ true | false (default) ]|
% |saveWaveFunctionProjectionBasis (sWfcnB)|
% Projection basis |[ [] (default) | basis ]|
%% 
% * Empty |saveWaveFunctionProjectionBasis| uses the initial wave functions 
% as the projection basis
% * User-defined |basis| is implementation dependent REPLACE_WITH_DASH_DASH see the respective documentations 
% for details
% |saveWaveFunctionProjectionIndex (sWfcnPI)|
% Index of the wave functions for which to perform the projection |[ [] (default) 
% | index vector | 'all' ]|
%% 
% * This is irrelevant if |saveWaveFunctionProjection| is |false|
% * Empty |saveWaveFunctionProjectionIndex| disables saving of the wave functions 
% and is technically equivalent to |saveWaveFunctionProjection| |= false|
% * Specify the indexes of the wave functions for which to perform the projection 
% in an index vector
% * |'all'| saves the projection for all the wave functions
% |saveWaveFunctionProjectionTime (sWfcnPT)|
% Times at which to save the projection of the wave functions |[ [] (default) 
% | positive scalar | negative integer | vector | 'all' ]|
%% 
% * Empty |saveWaveFunctionProjectionTime| uses the same values as in |time| 
% for when to save the projection of the wave functions.
% * A positive scalar specifies the sampling time step between successive saving 
% of the wave functions' projection. For forward time propagation, it is equivalent 
% to time|(1):saveWaveFunctionProjectionTime:|time|(end)|, and for backward ones 
% to time|(1):-saveWaveFunctionProjectionTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% saving wave functions' projection. For forward time propagation, it is equivalent 
% to time|(1):abs(saveWaveFunctionProjectionTime)*||timeStep||:|time|(end)|, and 
% for backward ones to time|(1):-abs(saveWaveFunctionProjectionTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to save the wave functions' 
% projection.
% * |'all'| saves the wave functions' projection after every time step. Warning: 
% this may be slow.
% * See the note on how intermediate time saving is performed during the TDSE 
% propagation below.
% Save *the output of a functions of the wave function*
% |saveOutputFunction (sF)|
% Installable output function of the wave functions |[ [] (default) | function 
% handle ]|
%% 
% * Leave empty to disable the feature
% * Provide a function handle to enable the feature. The signature for the function 
% is |fun(wfcn,t)| where |wfcn| is a wave function object and |t| is the time 
% (scalar). The function handle may return an array of arbitrary size and shape, 
% but must return at least a scalar and the shape of the output must remain constant 
% throughout the TDSE propagation.
% * Warning: The Schrodinger-equation model wave functions are passed by reference 
% to the output function. Thus modifying the wave functions in the output function 
% will also modify them for the Schrodinger-equation model (and thus TDSE propagation) 
% and will likely result in erroneous results or produce an error.
% |saveOutputFunctionTime (sFT)|
% Times at which to evaluate and save the installable output function of the 
% wave functions |[ [] (default) | positive scalar | negative integer | vector 
% | 'all' ]|
%% 
% * Empty |saveOutputFunctionTime| uses the same values as in |time| for when 
% to evaluate and save the output function.
% * A positive scalar specifies the sampling time step between successive evaluation 
% and saving of the output function. For forward time propagation, it is equivalent 
% to time|(1):saveOutputFunctionTime:|time|(end)|, and for backward ones to time|(1):-saveOutputFunctionTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% evaluations and saving of the output function. For forward time propagation, 
% it is equivalent to time|(1):abs(saveOutputFunctionTime)*||timeStep||:|time|(end)|, 
% and for backward ones to time|(1):-abs(saveOutputFunctionTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to evaluate and save the output 
% function.
% * |'all'| evaluates and saves the output function after every time step. Warning: 
% this may be slow.
% * See the note on how intermediate time saving is performed during the TDSE 
% propagation below.
% Save restart data file
% During the time propagation, a restart file can be generated to enable resuming 
% the simulation if it is cut short. Stopping the TDSE simulation while it writes 
% the restart info may lead to a corrupted file from which restart will not be 
% possible. The restart file contains a copy of the TDSE-propagator and Schrodinger-equation-model 
% objects, respectively called |TDSE| and |SE| in the MATLAB restart file.
% |saveRestart (sRest)|
% Activate the generation of a restart file |[ true | false (default) ]|
% |saveRestartFileName (sRestF)|
% Name for the restart file |[ chracter array (default 'QMolGridREPLACE_WITH_DASH_DASHTDSEREPLACE_WITH_DASH_DASHRestart.mat') 
% ]|
%% 
% * |saveRestartFileName| must be a valid MATLAB file name ('.mat' extension).
% * |saveRestartFileName| is irrelevant when |saveRestart| |== false|
% |saveRestartTime (sRestT)|
% Times at which to generate or update the restart file |[ [] (default) | positive 
% scalar | negative integer | vector | 'all' ]|
%% 
% * Empty |saveRestartTime| uses the same values as in |time| for when to generate 
% and update the restart file.
% * A positive scalar specifies the sampling time step when to generate and 
% update the restart file. For forward time propagation, it is equivalent to time|(1):saveRestartTime:|time|(end)|, 
% and for backward ones to time|(1):-saveRestartTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% the generation and update of the restart file. For forward time propagation, 
% it is equivalent to time|(1):abs(saveRestartTime)*||timeStep||:|time|(end)|, 
% and for backward ones to time|(1):-abs(saveRestartTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to generate and update the 
% restart file.
% * |'all'| generates and updates the restart file after each time step. Warning: 
% this is very slow and is strongly discouraged.
% * Note: In all cases no restart file is generated for the initial time and 
% final propagation time-step.
% * See the note on how intermediate time saving is performed during the TDSE 
% propagation below.
% Output results
% During a TDSE propagation, the results of on-the-fly calculations are strored 
% in structures in the |QMol_TDSE| object. Note that |QMol_TDSE| does not interpolate 
% its time propagation to fit user-supplied sample times, Insatead, the results 
% are saved at the closest propagation time steps, excluding duplicate times. 
% This may result in sampled times that are different, or have a different (smaller) 
% number of elements, than the ones specified above. Notably, using a sampling 
% time that is not a multiple of the propagation time step may result in uneven 
% saved time sampling. The actual times at with output are saved is included in 
% each of the output structure.
% 
% In restart mode, each output structure in the |QMol_TDSE| object contains 
% the fields |ind| and |n|, respectively with the propagation time indexes at 
% which to save the associated results and the next index in |ind| at which saving 
% should be performed. These two fields are removed from each output structure 
% upon completion of the TDSE propagation.
% |outSE (oSE)|
% Support for saving the Schrodinger-equation object into individual MATLAB 
% files during propagation |[ [] (default) | structure ]|
%% 
% * |outSE| is only relevant during TDSE time propagation and in restart mode. 
% It is automatically cleared at the end of the propagation.
% |outDipole (oDip)|
% Result of dipole-signal calculations during the TDSE propagation |[ [] | structure 
% ]|
%% 
% * TDSE propagation that do not compute the dipole signal (|saveDipole| |= 
% false|) leave |outDipole| empty. Otherwise
% * |outDipole.time| defines the precise times at which the dipole signal is 
% computed
% * |outDipole.waveFunction_x| contains the dipole signal for selected wave 
% functions. The indexes of the wave functions associated with each of these are 
% included in |outDipole.indexWaveFunction|
% * In restart mode, |outDipole| also contains a handful of additional fields 
% relevant for run-time calculations. These fields are saved in the MATALB restart 
% file but removed upon completion of the TDSE propagation.
% |outDipoleVelocity (oVel)|
% Result of dipole-velocity-signal calculations during the TDSE propagation 
% |[ [] | structure ]|
%% 
% * TDSE propagation that do not compute the dipole signal (|saveDipoleVelocity| 
% |= false|) leave |outDipoleVelocity| empty. Otherwise
% * |outDipoleVelocity.time| defines the precise times at which the dipole velocity 
% signal is computed
% * |outDipoleVelocity.waveFunction_x| contains the dipole signal for selected 
% wave functions. The indexes of the wave functions associated with each of these 
% are included in |outDipoleVelocity.indexWaveFunction|
% * In restart mode, |outDipoleVelocity| also contains a handful of additional 
% fields relevant for run-time calculations. These fields are saved in the MATALB 
% restart file but removed upon completion of the TDSE propagation.
% |outDipoleAcceleration (oAcc)|
% Result of dipole-acceleration-signal calculations during the TDSE propagation 
% |[ [] | structure ]|
%% 
% * TDSE propagation that do not compute the dipole signal (|saveDipoleAcceleration| 
% |= false|) leave |outDipoleAcceleration| empty. Otherwise
% * |outDipoleAcceleration.time| defines the precise times at which the dipole 
% acceleration signal is computed
% * |outDipoleVelocity.waveFunction_x| contains the dipole signal for selected 
% wave functions. The indexes of the wave functions associated with each of these 
% are included in |outDipoleAcceleration.indexWaveFunction|
% * In restart mode, |outDipoleAcceleration| also contains a handful of additional 
% fields relevant for run-time calculations. These fields are saved in the MATALB 
% restart file but removed upon completion of the TDSE propagation.
% |outEnergySE (oESE)|
% Result of the Schrodinger-equation-energy calculations during the TDSE propagation 
% |[ [] | structure ]|
%% 
% * TDSE propagation that do track the Schrodinger-equation energy (|saveEnergySE| 
% |= false|) leave |outEnergySE| empty. Otherwise
% * |outEnergySE.time| defines the precise times at which the Schrodinger-equation 
% energies are computed
% * |outEnergySE.total| contains the total Schrodinger-equation energy, which 
% should be constant (within the precision of the propagation scheme)
% * |outEnergySE.kinetic| contains the kinetic-energy component, including the 
% driving-field potential vector in the velocity gauge. 
% * |outEnergySE.potential| contains the potential-energy component. 
% * |outEnergySE.externalField| contains the energy contribution from the driving 
% electric field in the length gauge.
% * |outEnergySE.autonomization| contains the energy brought in and out of the 
% system by the external driving field (if any).
% * In restart mode, |outEnergySE| also contains a handful of additional fields 
% relevant for run-time calculations. These fields are saved in the MATALB restart 
% file but removed upon completion of the TDSE propagation.
% |outEnergyWaveFunction (oEKSO)|
% Result of the wave function energy calculations during the TDSE propagation 
% |[ [] | structure ]|
%% 
% * TDSE propagation that do track the Schrodinger-equation energy (|saveEnergyWaveFunction| 
% |= false|) leave |outEnergyWaveFunction| empty. Otherwise
% * For a wave function $|\psi\rangle$, the wave function energy is defined 
% as $\langle\psi|\hat{\mathcal{H}}|\psi\rangle$ with $\hat{\mathcal{H}}$ the 
% Schrodinger-equation Hamiltonian operator. In the velocity gauge, the external 
% potential vector is accounted for in the kinetic-operator of $\hat{\mathcal{H}}$ 
% while, in the length gauge, the external electric field is ignored.
% * |outEnergyWaveFunction.time| defines the precise times at which the wave 
% function energies are computed
% * Each row of |outEnergyWaveFunction.waveFunction| contains the energies of 
% the corresponding wave functions
% * In restart mode, |outEnergyWaveFunction| also contains a handful of additional 
% fields relevant for run-time calculations. These fields are saved in the MATALB 
% restart file but removed upon completion of the TDSE propagation.
% |outIonization (oIon)|
% Result of the ionization calculations during the TDSE propagation |[ [] | 
% structure ]|
%% 
% * TDSE propagation that do track ionization (|saveIonization| |= false|) leave 
% |outIonization| empty. Otherwise
% * |outIonization.time| defines the precise times at which the ionization is 
% computed
% * |outIonization.waveFunction| contains the ionization for the selected wave 
% functions. The indexes of the wave functions associated with each of these are 
% included in |outIonization.indexWaveFunction|
% * In restart mode, |outIonization| also contains a handful of additional fields 
% relevant for run-time calculations. These fields are saved in the MATALB restart 
% file but removed upon completion of the TDSE propagation.
% |outWaveFunction (oWfcn)|
% Wave functions during the TDSE propagation |[ [] | structure ]|
%% 
% * TDSE propagation that do not save the wave function (|saveWaveFunction| 
% |= false|) leave |outWaveFunction| empty. Otherwise
% * The specific shape of the saved wave functions is implementation dependent 
% REPLACE_WITH_DASH_DASH see the corresponding documentation for details. At minimum, each implementation 
% defines
% * |outWaveFunction.time| defines the precise times at which the wave functions 
% are saved
% * |outWaveFunction.waveFunction| contains the saved wave functions and |outWaveFunction.indexWaveFunction| 
% the corresponding wave-function indexes
% * In restart mode, |outWaveFunction| also contains a handful of additional 
% fields relevant for run-time calculations. These fields are saved in the MATALB 
% restart file but removed upon completion of the TDSE propagation.
% |outWaveFunctionProjection (oWfcnP)|
% Projection of the wave functions during the TDSE propagation |[ [] | structure 
% ]|
%% 
% * TDSE propagation that do not save the projection of the wave functions (|saveWaveFunctionProjection| 
% |= false|) leave |outWaveFunctionProjection| empty. Otherwise
% * The specific shape of the saved wave functions' projection is implementation 
% dependent REPLACE_WITH_DASH_DASH see the corresponding documentation for details. At minimum, each 
% implementation defines
% * |outWaveFunctionProjection.time| defines the precise times at which the 
% wave function projections are saved
% * |outWaveFunctionProjection.waveFunction| contains the saved wave functions' 
% projection and |outWaveFunctionProjection.indexWaveFunction| the corresponding 
% wave function indexes
% * The structure also retains a copy of the projection basis as <./QMol_disc_basis.html 
% |QMol_disc_basis|> object(s)
% * In restart mode, |outWaveFunctionProjection| also contains a handful of 
% additional fields relevant for run-time calculations. These fields are saved 
% in the MATALB restart file but removed upon completion of the TDSE propagation.
% |outOutputFunction (oF)|
% Result of the installable output function of the wave functions |[ [] | structure 
% ]|
%% 
% * TDSE propagation that do not define an installabe output function of the 
% orbitals (|saveOutputFunction| |= []|) leave |outOutputFunction| empty. Otherwise
% * |outOutputFunction.time| defines the precise times at which the result of 
% the output function is saved
% * |outOutputFunction.result| contains the results of the output function. 
% If the installable function returns a scalar or a column vector, |outOutputFunction.result| 
% is a |N-by-numel(outOutputFunction.time)| matrix with |N| the numer of elements 
% in the output. Otherwise, |outOutputFunction.result| is an |M-by-numel(outOutputFunction.time)| 
% array with |M| the size of the output.
% * |outOutputFunction.shape| contains the shape of the output function (|N| 
% or |M|, as defined in the previous bullet point).
% |outRestart (oRest)|
% Support for enabling restart of the TDSE propagation |[ [] (default) | structure 
% ]|
%% 
% * |outRestart| is only relevant during TDSE time propagation and in restart 
% mode. It is automatically cleared at the end of the propagation.
% Other hidden class properties
% |QMol_TDSE| defines a handful of additional hidden properties used for the 
% time propagation. These properties cannot be edited with the |set| method, nor 
% by any function outisde of the object (|SetAccess=protected| attribute).
% |SE|
% Schrodinger-equation-model object |[ [] (default) || <./QMol_SE.html |QMol_SE|> 
% |handle object ]|
%% 
% * This is a copy of the <./SE.html Schrodinger-equation-model> handle object 
% passed to |initialize|. 
% |tspan|
% Propagation time vector |[ [] (default) | vector ]| 
%% 
% * After the class is |initialize|d, it is defined as |uniquetol([obj.||T||(1):obj.||dt||:obj.||T||(end), 
% obj.||T||(end)],1e-10,'DataScale',1)|
% |iref|
% Indexes of |tspan| matching the input time vector |T| |[ [] (default) | index 
% vector ]|
%% 
% * After the class is |initialize|d, it is defined as |getOutputIndex||(||T||)|
% |restart|
% Restart structure |[ [] (default) | restart ]|
%% 
% * Collect all the variables and information required for the restart mode
% * |QMol_TDSE| uses the following fields (therefore not available for implementation-specific 
% TDSE propagators overloading the class): |kstart|, |ndisp|, and |idp|
%% Class methods
% Creation
% constructor
% Create a TDSE-model object with empty class properties.

obj = QMol_TDSE;
%% 
% Create a TDSE-model object with the |name| properties set to the specified 
% |value|. Several |name-value| pairs can be specified consecutively. Suitable 
% |name| is any of the TDSE class properties and is case insensitive.

obj = QMol_TDSE(name1,value1);
obj = QMol_TDSE(name1,value1,name2,value2,___);
% Changing class properties
% |set|
% Update the |name| properties of a TDSE-model object to the specified |value|. 
% Several |name-value| pairs can be specified consecutively. Suitable |name| is 
% any of the TDSE class properties and is case insensitive. In restart mode, output 
% results structures can also be edited with |set|. |QMol_TDSE| does not check 
% the integrity of its input/output component during a restart and this feature 
% should only be considered by advanced users.

obj.set(name1,value1);
obj.set(name1,value1,name2,value2,___);
%% 
% This is the common name-value pair assignment method used throughout the QMol-grid 
% package.
% |clear|
% Clear all class properties

obj.clear;
%% 
% Clear a specific set of the class properties. Suitable |name| is any of the 
% TDSE class properties and is case insensitive.

obj.clear(name1,name2,___);
%% 
% This is the common |clear| method available to all classes throughout the 
% QMol-grid package. The |clear| method can be used to delete specific properties 
% before saving an instance of the |QMol_TDSE| class.
% Initializing the object
% |QMol_TDSE| defines a main |initialize| interface (with public access attribute) 
% and a suite of individual initaialization properties (with protected access 
% attributes) for each of the output results.
% |initialize|
% Initialize a TDSE-model object without allocating the output-result structures

obj.initialize(SE);
%% 
% * |SE| is the <./SE.html Schrodinger-equation-model> handle object, _i.e._, 
% <./QMol_SE.html |QMol_SE|>, that describes the Schrodinger-equation systems 
% to propagate.
% * For developers: |initialize| also has a specific interface when called from 
% the |propagate| method that initializes the absorbing boundaries (if any) and 
% determines whether the output-result structures should be initialized too. Overloading 
% classes should avoid redefining |initialize|; If the overloading class needs 
% to perform some initialization (at the beginning of a TDSE propagation or upon 
% restart), overload the |initializeChildren| method instead.
% |initializeChildren|
% Initialize implementation-specific part of overloading class at the beginning 
% of a TDSE propagation (from scratch)

obj.initializeChildren(false);
%% 
% * |QMol_TDSE| calls the |initializeChildren| method after having initialized 
% all its member properties (including the |SE| object being propagated).
% * This should not initialize implementation-specific additional output, which 
% are initialized with |setOutputChildren|
%% 
% Initialize implementation-specific part of overloading class in restart mode.

obj.initializeChildren(true);
%% 
% * |QMol_TDSE| calls the |initializeChildren| method after having reinitialized 
% all its member properties (including the |SE| object being propagated).
% * Note that the restart mode does not call |setTimeStep| during the initialization. 
% All relevant time step information should be stored with the class of in the 
% |restart| structure and |initializeChildren| should bring them back to a working 
% configuration.
% |getOutputIndex|
% Get the time-propagation index for when to save a given result.

ind = obj.getOutputIndex(t);
%% 
% * Vector |t = [t_1, t_2, ___ ]|  returns the indexes of the iteration time 
% steps closest to the listed times |t_1|, |t_2|, ... 
% * Scalar |t| > 0 returns the indexes of the iteration time steps closest to 
% the time sampling |time||(1)|, |time||(1)+t|, |time||(1)+2*t|, ... for forward 
% time propagations and |time||(1)|, |time||(1)-t|, |time||(1)-2*t|, ... for backward 
% ones
% * Integer |t| < 0 returns the indexes of the iteration time steps of |time||(1)|, 
% |time||(1)-||timeStep||*t|, |time||(1)-2*||timeStep||*t|, ... for forward time 
% propagations and |time||(1)|, |time||(1)+||timeStep||*t|, |time||(1)+2*||timeStep||*t|, 
% ... for backward ones

ind = obj.getOutputIndex('all');
%% 
% * Returns the indexes associated with all the iteration time steps
% |setOutputChildren|
% Initialize additional output results defined in an specific implementation 
% of the TDSE propagator (the children class should then overload this method)

obj.setOutputChildren('init');
%% 
% Cleanup the additional output results defined in an specific implementation 
% of the TDSE propagator at the end of the computation

obj.setOutputChildren('clean');
%% 
% |setOutputChildren| should not be called in restart mode (all relevant parameters 
% should be saved with the QMol_TDSE object in the restart MATLAB file).
% |setOutputSE|
% Initialize the |outSE| structure before running a TDSE computation

obj.setOutputSE('init');
%% 
% Cleanup the |outSE| structure at the end of the TDSE computation

obj.setOutputSE('clean');
%% 
% |setOutputSE| should not be called in restart mode (all relevant parameters 
% should be saved with the |QMol_TDSE| object in the restart MATLAB file).
% |setOutputDipole|
% Initialize the |outDipole|, |outDipoleVelocity|, and |outDipoleAcceleration|  
% structures before running a TDSE computation

obj.setOutputDipole('init');
%% 
% Cleanup the |outDipole|, |outDipoleVelocity|, and |outDipoleAcceleration| 
% structures at the end of the TDSE computation

obj.setOutputDipole('clean');
%% 
% |setOutputDipole| should not be called in restart mode (all relevant parameters 
% should be saved with the |QMol_TDSE| object in the restart MATLAB file).
% |setOutputEnergy|
% Initialize the |outEnergySE| and |outEnergyWaveFunction|  structures before 
% running a TDSE computation

obj.setOutputEnergy('init');
%% 
% Cleanup the |outEnergySE| and |outEnergyWaveFunction| structures at the end 
% of the TDSE computation

obj.setOutputEnergy('clean');
%% 
% |setOutputEnergy| should not be called in restart mode (all relevant parameters 
% should be saved with the |QMol_TDSE| object in the restart MATLAB file).
% |setOutputFunction|
% Initialize the |outOutputFunction| structure before running a TDSE computation

obj.setOutputFunction('init');
%% 
% Cleanup the |outOutputFunction| structure at the end of the TDSE computation

obj.setOutputFunction('clean');
%% 
% |setOutputFunction| should not be called in restart mode (all relevant parameters 
% should be saved with the |QMol_TDSE| object in the restart MATLAB file).
% |setOutputIonization|
% Initialize the |outIonization| structure before running a TDSE computation

obj.setOutputIonization('init');
%% 
% Cleanup the |outIonization| structure at the end of the TDSE computation

obj.setOutputIonization('clean');
%% 
% |setOutputIonization| should not be called in restart mode (all relevant parameters 
% should be saved with the |QMol_TDSE| object in the restart MATLAB file).
% |setOutputWaveFunction|
% Initialize the |outWaveFunction| and |outWaveFunctionProjection| structures 
% before running a TDSE computation

obj.setOutputWaveFunction('init');
%% 
% Cleanup the |outWaveFunction| and |outWaveFunctionProjection| structures at 
% the end of the TDSE computation

obj.setOutputWaveFunction('clean');
%% 
% setOutputWaveFunction should not be called in restart mode (all relevant parameters 
% should be saved with the |QMol_TDSE| object in the restart MATLAB file).
% 
% setOutputWaveFunction is implementation dependent and must be defined by each 
% overloading TDSE propagation classes REPLACE_WITH_DASH_DASH see the required signature and behavior 
% below.
% |setOutputRestart|
% Initialize the |outRestart| structure before running a TDSE computation

obj.setOutputRestart('init');
%% 
% Cleanup the |outRestart| structure and delete the restart file at the end 
% of the TDSE computation

obj.setOutputRestart('clean');
%% 
% |setOutputRestart| should not be called in restart mode (all relevant parameters 
% should be saved with the |QMol_TDSE| object in the restart MATLAB file).
% |finalize|
% At the end of a TDSE propagation, performs the appropriate finalization, including 
% cleanup of the output structures.

obj.finalize;
%% 
% * This calls the |'clean'| mode for |setOutputChildren|, |setOutputSE|, |setOutputDipole|, 
% |setOutputEnergy|, |setOutputIonization|, |setOutputWaveFunction|, |setOutputFunction|, 
% and |setOutputRestart|.
% Run-time documentation
% |getMemoryProfile|
% Get an estimate of the memory help by a |QMol_TDSE| object with either

mem = obj.getMemoryProfile;
mem = obj.getMemoryProfile(false);
%% 
% * The object must be |initialize|d for the memory footprint evaluation. If 
% not arleady, |getMemoryProfile| initializes the |SE| model object.
% * The estimate includes (1) |SE| model, (2) TDSE propagator, and (3) output 
% results. Note that all these components may not be used in actual simulations 
% and the memory estimate tries to be conservative. On the other hand, it only 
% includes the discretization of member components on the domain grid and ignores 
% other (small) properties.
% * The output |mem| is the estimated size in bytes.
%% 
% Additionally display the detail of the memory footprint with

mem = obj.getMemoryProfile(true);
% |showDocumentation|
% Display the run-time documentation for the specific configuration of a |QMol_TDSE| 
% object, wich must have been |initialize|d beforehand

obj.showDocumentation;
%% 
% The run-time documentation performs the following steps
%% 
% * Display the QMol-grid package header (showing the kernel, external component 
% versions)
% * Call the TDSE-propagator implementation-specific run-time documentation 
% with the propety |showDoc|.
% * Display the time-propagation information
% * Display the list of output calculated and saved during the TDSE propagation
% * Display the bibliography associated with the list of cited references (from 
% the previous steps)
% * Display the funding information
% * Display the QMol-grid package footer
% TDSE propagation
% |propagate|
% Propagate the TDSE dynamics starting from a Schrodinger-equation model object 
% (from scratch)

obj.propagate(SE);
%% 
% * |SE| is the <./SE.html Schrodinger-equation-model> handle object, _i.e._, 
% <./QMol_SE.html |QMol_SE|>, that describes the Schrodinger-equation systems 
% to propagate.
%% 
% Restart a TDSE propagation

obj.propagate('restart');
% |saveOutputSE|
% Trigger the saving of the SE object into a separate MATLAB file

obj.saveOutputSE(obj,t);
%% 
% * |t| is the current time when the saving is performed
% * Each output file contains |SE| (Schrodinger-equation-model object), |t| 
% (current time), and |externalField| (external field object)
% * For developers: |saveOutputSE| is also responsible for updating the counter 
% |obj.oSE.n| when it is called
% |setOutputEnergy|
% Trigger the saving of the Schrodinger-equation and wave function energies

obj.saveOutputEnergy(k,t);
%% 
% * |k| is the current time-propagation step index
% * |t| is the current time when the saving is performed
% * If requested, the Schrodinger equation energy calls getExternalFieldEnergy 
% to get the contribution from any external field and autonomization variable
% |saveOutputFunction|
% Trigger the computation and saving of the installable output function

obj.saveOutputFunction(obj,k,t);
%% 
% * |k| is the current time-propagation step index
% * |t| is the current time when the saving is performed
% * For developers: saveOutputFunction is also responsible for updating the 
% counter |obj.oFRho.n| and |obj.oFKSO.n| when it is called
%% Overloading the class
% |QMol_TDSE| is an abstract class and only define the common steps and features 
% for all TDSE propagators. Implementation-specific propagators must define specific 
% methods and additional optional methods overload
% Methods that must be overloaded
% To define a specific implementation of a TDSE propagation scheme, overloading 
% classes must define the following methods with the specified signature and attributes
% |propertyNames|
% To enable name-value pair constructor, name-value pair |set|, and the |clear| 
% methods

methods (Static=true,Access=?QMol_suite)
function [ClassName,PropNames] = propertyNames()
%propertyNames returns the names of member properties that can be set
%   through name-value assignment
    
    % Parent-class components
    [~,PropNames]       =   QMol_TDSE.propertyNames;

    ClassName           =   'QMol_child_class';
    PropNames           =   [PropNames,{'property1','property2'}];
end
end
% |showDoc|
% Display the run-time documentation for the specific implementation of the 
% TDSE propagator

methods (Access=protected)
function ref = showDoc(obj)
%showDoc displays the documentation reflecting the specific implementation
%   of the TDSE propagator
    
    % Add specific documentation here

end
end
%% 
% * If no reference is cited, return |ref = {}| otherwise |ref = {'ref 1','ref 
% 2',___}|, where each of the |ref| corresponds to the bibliographic code for 
% the reference (generally of the form |'name_of_first_author publication_year'|) 
% and is case insensitive REPLACE_WITH_DASH_DASH see the <./Documentation.html documentation page> 
% for a list of citable references.
% * Note that only implementation-specific properties should be covered here. 
% All properties common to all TDSE propagators (_e.g._, time step) are handled 
% in the parent |QMol_TDSE| class run-time documentation.
% * Only document the TDSE propagator. If additional ouput are implemented, 
% document those with the |docOutputChildren| method
% |setOutputWaveFunction|
% Initialize the |outWaveFunction| and |outWaveFunctionProjection| structures 
% before running a TDSE computation and clean them up at the end of the computation. 
% The method should have the following signature and features

methods (Access=protected)
function setOutputWaveFunction(obj,opt)
%setOutputOrbitalDensity

switch lower(opt)
case {'init','initialize','initialization'} %%%%%%%%%%%%%%%%%%%%%%%%%%%
 
    % Clean up any old data ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    obj.oWfcn           =   [];
    obj.oWfcnP          =   [];
    
    % Wave functions ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    if obj.sWfcn
        % When to save the wave functions
        obj.oWfcn.ind   =   [obj.getOutputIndex(obj.sWfcnT),NaN];
        obj.oWfcn.time  =   obj.tspan(obj.oWfcn.ind(1:end-1));
        obj.oWfcn.n     =   1;

        if obj.sEF,         obj.setOutputExternalField('oWfcn','init');  end
        
        S               =   obj.SE.disc.SE_sizeWaveFunction;
        if numel(S) > 1   &&   S(end) == 1,     S   =   S(1:end-1);     end
        
        % Indexes
        if isempty(obj.sWfcnI),         obj.oWfcn.indexWaveFunction =   [];
        elseif ischar(obj.sWfcnI),                                                                  if strcmpi(obj.sWfcnI,'all')
                                        obj.oWfcn.indexWaveFunction =   1:obj.SE.N;                 else
                                        obj.oWfcn.indexWaveFunction =   [];
                                        warning('QMol:TDSE:saveWfcn', ...
                                            ['Unknown option for the saving of the wave functions ' obj.sKSOI ...
                                            '. No orbitals saved.']);                               end
        else,                           obj.oWfcn.indexWaveFunction =   obj.sWfcnI;
        end

        % Allocate output
        obj.oWfcn.shape         =   [S numel(obj.oWfcn.indexWaveFunction)];
        obj.oWfcn.waveFunction  =   NaN([obj.oWfcn.shape numel(obj.oWfcn.time)],'like',1i);

    else
        obj.oWfcn.shape =   [];
        obj.oWfcn.ind   =   NaN;
        obj.oWfcn.n     =   1;
    end
    
    % Wave functions' projection ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    if obj.sWfcnP
        % When to save the wave function projections
        obj.oWfcnP.ind  =   [obj.getOutputIndex(obj.sWfcnPT),NaN];
        obj.oWfcnP.time =   obj.tspan(obj.oWfcnP.ind(1:end-1));
        obj.oWfcnP.n    =   1;

        if obj.sEF,         obj.setOutputExternalField('oWfcnP','init');    end
        
        % Projection basis
        if isempty(obj.sWfcnB)  % Project on initial wave functions
            obj.oWfcnP.basis    =   QMol_disc_basis('x',obj.SE.disc.x,'v',obj.SE.wfcn.wfcn);
            obj.oWfcnP.basis.initialize;
        else
            obj.oWfcnP.basis    =   obj.sWfcnB;
            obj.oWfcnP.basis.initialize;
        end

        % Indexes 
        S               =   obj.oWfcnP.basis.SE_sizeWaveFunction;
        if numel(S) > 1   &&   S(end) == 1,     S   =   S(1:end-1);   end

        if isempty(obj.sWfcnPI),        obj.oWfcnP.indexWaveFunction    =   [];
        elseif ischar(obj.sWfcnPI),                                                     if strcmpi(obj.sWfcnPI,'all')
                                        obj.oWfcnP.indexWaveFunction    =   1:obj.SE.N; else
                                        obj.oWfcnP.indexWaveFunction    =   [];
                                        warning('QMol:TDSE:saveWfcnProjection', ...
                                            ['Unknown option for the saving of the wave functions'' projection ' obj.sWfcnPI ...
                                            '. No wave function projections saved.']);  end
        else,                           obj.oWfcnP.indexWaveFunction    =   obj.sWfcnPI;
        end

            % Allocate output
            obj.oWfcnP.shape        =   [S numel(obj.oWfcnP.indexWaveFunction)];
            obj.oWfcnP.waveFunction =   NaN([obj.oWfcnP.shape numel(obj.oWfcnP.time)],'like',1i);

    else
        obj.oWfcnP.shape    =   [];
        obj.oWfcnP.ind      =   NaN;
        obj.oWfcnP.n        =   1;
    end
    
case {'clean','finalize','finalization'} %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    if obj.sWfcn,   obj.oWfcn   =   rmfield(obj.oWfcn,{'ind','n','shape'}); if obj.sEF %#ok<ALIGN> 
                    obj.setOutputExternalField('oWfcn' ,'clean');           end
    else,           obj.oWfcn   =   [];                                     end
    if obj.sWfcnP,  obj.oWfcnP  =   rmfield(obj.oWfcnP,{'ind','n','shape'});if obj.sEF %#ok<ALIGN> 
                    obj.setOutputExternalField('oWfcnP','clean');           end
    else,           obj.oWfcnP   =   [];                                    end
 
otherwise %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % Unexpected option
    error('QMol:TDSE:setOutputWaveFunction',['Unknown option ' opt]);
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
end
%% 
% At minimum, the method should initialize
%% 
% * In obj.|oWfcn|, |outWaveFunction.time|, |outWaveFunction.waveFunction|, 
% and |outWaveFunction.indexWaveFunction| 
% * In |sWfcnP|, |outWaveFunctionProjection.time|, |outWaveFunctionProjection.waveFunction|, 
% and |outWaveFunctionProjection.indexWaveFunction|. The structure should also 
% retain a copy of the projection basis.
% |setTimeStep|
% (Re)set the time step to be used in the TDSE propagation

methods (Access=protected)
function setTimeStep(obj,dt,t)
%setTimeStep
    
    % Perform the proper (re)initialization 

end
end
%% 
% * |dt| is the value of the time step to be used and |t| the current time. 
% Impementation-specific TDSE propagators will often need to keep a copy of |dt| 
% (as it may vady from |timeStep|).
% * |setTimeStep| is called at the very beginning of the TDSE propagation and
% * |setTimeStep| may also be called before performing the last iteration if 
% a rescaling is required to reach the requested final time
% |applyTimeStep|
% Propagate the TDSE dynamics for exactly one time step

methods (Access=protected)
function applyTimeStep(obj,t)
%setTimeStep
    
    % Perform the time propagation

end
end
%% 
% * |t| is the current time, from which to perform the one-time-step propagation
% |saveOutputDipole|
% Save the dipole, dipole velocity, and/or dipole acceleration signal

methods (Access=protected)
function saveOutputDipole(obj,k,t)
%setTimeStep
    
    % Save the dipole signal
    if k == obj.oDip.ind(obj.oDip.n)
        % Total dipole

        % Orbital-resolved dipole (if any)
        
        % Add external field
        if obj.sEF,         obj.addOutputExternalField('oDip',k,t);         end

        % Update counter
        obj.oDip.n      =   obj.oDip.n + 1;
    end
    
    % Save the dipole-velocity signal
    if k == obj.oVel.ind(obj.oVel.n)
        % Total dipole velocity

        % Orbital-resolved dipole velocity (if any)
        
        % Add external field
        if obj.sEF,         obj.addOutputExternalField('oVel',k,t);         end

        % Update counter
        obj.oVel.n      =   obj.oVel.n + 1;
    end
    
    % Save the dipole acceleration signal
    if k == obj.oAcc.ind(obj.oAcc.n)
        % Total dipole acceleration

        % Orbital-resolved dipole acceleration (if any)
        
        % Add external field
        if obj.sEF,         obj.addOutputExternalField('oAcc',k,t);         end

        % Update counter
        obj.oAcc.n      =   obj.oAcc.n + 1;
    end

end
end
%% 
% * |saveOutputDipole| is called is any of the dipole, dipole velocity, or dipole 
% acceleration needs to be computed and saved. It must therefore determine which 
% one(s) actually need to be.
% * |saveOutputDipole| is also responsible for updating the counters in |obj.oDip|, 
% |obj.oVel| and |obj.oAcc| (see their respective documentation entry for the 
% name convention in what/how each should be saved).
% |getExternalFieldEnergy|
% Compute the contributions from any external field and autonomization variable

methods (Access=protected)
function [E,DE] = getExternalFieldEnergy(obj,t)
%getExternalFieldEnergy 
    
    % External field energy

    % Autonomization variable

end
end
%% 
% * |E| is the contribution to the Schrodinger-equation-functional energy from 
% any external field. If not field is applied, or it does not contribute an explicit 
% terms to the Schrodinger-equation energy (_e.g._, velocity Gauge dipole approximation), 
% return |E = [0;0]|
% * |DE| is the autonomization energy variable, which tracks how much energy 
% is put into or withdrawn from the Schrodinger-equation system
% |saveOutputIonization|
% Compute the ionization statistics

methods (Access=protected)
function saveOutputIonization(obj,k,t)
%saveOutputIonization 
    
    % Total ionization signal

    % Orbital-resolved ionization signal
        
    % Add external field
    if obj.sEF,         obj.addOutputExternalField('oIon',k,t);         end


    % Update counter
    obj.oIon.n      =   obj.oIon.n + 1;

end
end
%% 
% * |saveOutputIonization| is also responsible for updating the counters in 
% |obj.oIon| (see the documentation entry for the name convention in what/how 
% each should be saved).
% |saveOutputWaveFunction|
% Save the Wave functions (projection) and one-body density

methods (Access=protected)
function saveOutputWaveFunction(obj,k,t)
%setTimeStep
    
    % Save wave functions
    if k == obj.oWfcn.ind(obj.oWfcn.n)
        % Wave functions
        
        % Add external field
        if obj.sEF,         obj.addOutputExternalField('oWfcn',k,t);         end

        % Update counter
        obj.oWfcn.n     =   obj.oWfcn.n + 1;
    end
    
    % Save the projection of the Kohn-Sham orbitals
    if k == obj.oWfcnP.ind(obj.oWfcnP.n)
        % Kohn-Sham orbitals' projection
        
        % Add external field
        if obj.sEF,         obj.addOutputExternalField('oWfcnP',k,t);        end

        % Update counter
        obj.oWfcnP.n    =   obj.oWfcnP.n + 1;
    end

end
end
%% 
% * |saveOutputWaveFunction| is called is any of the wave functions or their 
% projection needs to be saved. It must therefore determine which one(s) actually 
% need to be.
% * |saveOutputWaveFunction| is also responsible for updating the counters in 
% |obj.oWfcn| and |obj.oWfcnP| (see their respective documentation entry for the 
% name convention in what/how each should be saved).
% Additional optional methods to overload
% |getMemoryProfilePropagator|
% Estimate the memory footprint of the implementation-specific part of the TDSE 
% propagator

methods (Access=protected)
function mem = getMemoryProfilePropagator(obj,opt)
%getMemoryProfilePropagator 
    
    % Initialization
    if nargin < 2,  opt     =   false;  end

    % Estimate of the memory footprint

end
end
%% 
% * Use <./QMol_SE_profiler.html |QMol_SE_profiler|>|.showMemoryFootprint| to 
% display the memory foorprint of the propagator's components (when |opt == true|)
% * |getMemoryProfilePropagator| should only list the memory footprint of the 
% propagation part of the implementation-specific class. Estimate of the memory 
% footprint for the output results is handled with the |getMemoryProfileWaveFunction| 
% and |getMemoryProfileChildren| properties.
% * The |SE| object is initialized when |getMemoryProfilePropagator| is called
% |getMemoryProfileWaveFunction|
% Estimate the memory footprint for saving of the wave functions in the implementation-specific 
% TDSE propagator

methods (Access=protected)
function mem = getMemoryProfileWaveFunction(obj,opt)
%getMemoryProfileOrbitalDensity
    
    % Initialization
    if nargin < 2,  opt     =   false;  end

    % Estimate of the memory footprint

end
end
%% 
% * Use <./QMol_SE_profiler.html |QMol_SE_profiler|>|.showMemoryFootprint| to 
% display the memory foorprint of saving the wave functions (when |opt == true|)
% * |getMemoryProfileWaveFunction| should only list the memory footprint of 
% the requested wave functions. Estimate of the memory footprint for any additional 
% implementation-specific output results with |getMemoryProfileChildren|.
% * The |SE| object is initialized when |getMemoryProfileOrbitalDensity| is 
% called
% |getMemoryProfileChildren|
% Estimate the memory footprint of additional output defined by the implementation-specific 
% part of the TDSE propagator

methods (Access=protected)
function mem = getMemoryProfileChildren(obj,opt)
%getMemoryProfilePropagator 
    
    % Initialization
    if nargin < 2,  opt     =   false;  end

    % Estimate of the memory footprint

end
end
%% 
% * Use <./QMol_SE_profiler.html |QMol_SE_profiler|>|.showMemoryFootprint| to 
% display the memory foorprint of the additional outputs (when |opt == true|)
% * |getMemoryProfileChildren| should only list the memory footprint of additional 
% output defined by the implementation-specific TDSE propagator. Estimate of the 
% memory footprint for the wave function output results is handled with |getMemoryProfileOrbitalDensity|
% * The |SE| object is initialized when |getMemoryProfileChildren| is called
% |docOutputChildren|
% Run-time documentation for additional implementation-specific output variables

methods (Access=protected)
function ref = docOutputChildren(obj)
%docOutputChildren 
    
    % Add specific documentation

end
end
%% 
% * If no reference is cited, return |ref = {}| otherwise |ref = {'ref 1','ref 
% 2',___}|, where each of the |ref| corresponds to the bibliographic code for 
% the reference (generally of the form |'name_of_first_author publication_year'|) 
% and is case insensitive REPLACE_WITH_DASH_DASH see the <./Documentation.html documentation page> 
% for a list of citable references.
% * For consistency with the other output available to all TDSE propagators, 
% only list the additional output that are being calculated during the TDSE propagation 
% (following user-defined properties).
% * Only implementation-specific additional properties should be covered here. 
% All properties common to all TDSE propagators (_e.g._, time step) are handled 
% in the parent |QMol_TDSE| class run-time documentation.
% * Run-time documentation for the implementation-specific TDSE propagator is 
% handled with |showDoc| and therefore should not be included here.
% |setOutputChildren|
% Implementation-specific TDSE propagation classes that overload |QMol_TDSE| 
% may define additional run-time results to save during the propagation. Those 
% are initialized with the |setOutputChildren| method with the following signature 
% (see also the example above for a more fleshed out template)

methods (Access=protected)
function setOutputChildren(obj,opt)
%setOutputChildren
switch lower(opt)
case {'init','initialize','initialization'} %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    % Clean up any old data ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    
    % Initialize output structure(s) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    
case {'clean','finalize','finalization'} %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % Clean output structures at the end of the TDSE propagation

otherwise %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % Unexpected option
    error('QMol:TDSE:setOutputChildren',['Unknown option ' opt]);
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
end
end
% |setOutputExternalField|
% Enable saving of the external-field information in a given output structure

methods (Access=protected)
function setOutputExternalField(obj,structName,opt)
%setOutputExternalField
switch lower(opt)
case {'init','initialize','initialization'} %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    % Add proper field for external field information
    
case {'clean','finalize','finalization'} %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % Clean output structures at the end of the TDSE propagation
    % (for the external-field information only)

otherwise %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % Unexpected option
    error('QMol:TDSE:setOutputExternalField',['Unknown option ' opt]);
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
end
end
%% 
% * |setOutputExternalField| is called in the initialization and cleanup of 
% each of the |setOutputDipole|, |setOutputEnergy|, |setOutputFunction|, |setOutputIonization|, 
% and |setOutputWaveFunction|
% * |structName| is the name of the output structure to which the external field 
% info are to be initialized. |obj.(structName)| gives access to the corresponding 
% property in the class.
% |setRestartChildren|
% Perform the necessary initialization of the implementation-specific TDSE propagator 
% in restart mode 

methods (Access=protected)
function setRestartChildren(obj)
%setRestartChildren
    
    % Initialize upon restart
end
end
%% 
% * |setRestartChildren| is called after the |QMol_TDSE| has performed its own 
% reinitialization, notably |SE| object has been initialized 
% |saveOutputChildren|
% Save additional implementation-specific output

methods (Access=protected)
function saveOutputChildren(obj,k,t)
%saveOutputChildren
    
    % Save additional output
end
end
%% 
% * |k| is the current time-propagation step index
% * |t| is the current time when the saving is performed
% * |saveOutputChildren| is called for every time step (including the starting 
% and final times) of the TDSE propagation. The class is responsible for checking 
% which additional data must be saved, if any, and doing the actual saving.
% |addOutputExternalField|
% Adds the external-field information to a given output structure

methods (Access=protected)
function addOutputExternalField(obj,structName,k,t)
%addOutputExternalField

    % Add external-field information to output structure
end
end
%% 
% * addOutputExternalField is called by |saveOutputDipole|, |saveOutputEnergy|, 
% |saveOutputFunction|, |saveOutputIonization|, and |saveOutputWaveFunction|
% * |structName| is the name of the output structure to which the external field 
% info are to be saved. |obj.(structName)| gives access to the corresponding property 
% in the class.
% * |k| is the current time-propagation step index
% * |t| is the current time when the saving is performed
% |saveRestartChildren|
% Save implementation-specific info needed for restarting a TDSE calculation 
% to the |restart| structure

methods (Access=protected)
function saveRestartChildren(obj,k,t)
%saveOutputChildren
    
    % Save additional output
end
end
%% 
% * |k| is the current time-propagation step index
% * |t| is the current time when the saving is performed
% * |saveRestartChildren| is called at the end of a time-step propagation (and 
% the index |k| and time |t| have been updated accordingly before calling the 
% function)
%% Bourdary absorber
% TDSE propagators support both mask and complex absorbing bondary conditions. 
% The template for absorbing boundayr classes is

classdef QMol_SE_absorber < QMol_suite
%QMol_SE_absorber 

%% Documentation %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
methods (Static,Access=private)
function version
    QMol_doc.showVersion('##.##.###','##/##/####','Author Name')
end
end
methods (Static,Access={?QMol_doc,?QMol_SE_absorber})
function showInfo
    fprintf( '  * QMol_SE_absorber:\n');
    fprintf(['      > Absorbing boundaries\n',...
             '      > Type of absorber\n']); 
    QMol_SE_absorber.version;
end
end
methods (Access=public)
function ref = showDocumentation(obj)
%showDocumentation displays the documentation reflecting member property 
%   values
    
    % Initialization
    ref                 =   {};

    % Header
    fprintf('  * Absorbing boundaries                                  type of absorber\n');

    % Details of the absorber

    % Version
    obj.version;

end
function mem = getMemoryProfile(obj,opt)
%getMemoryProfile computes and returns an estimate of the total memory
%   footprint (in bytes) of the absorber with all its components
%   initialized and used.
    
    % Initialization
    if nargin < 2,  opt =   false;  end

    % Evaluate (and display) estimate of memory footprint

end
end
%% Properties %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
properties (Transient,Hidden,GetAccess=?QMol_suite,SetAccess={?QMol_TDSE_abs_mask,?QMol_TDSE})
    % Linked objects
    SE                              % SE.disc always defines the domain
end
    % Other properties of the class

%% Alias handling %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % Mapping between user-facing long variable names and internal's short

%% Initialization %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
methods (Access=public)
function reset(obj)
%reset clears all temporary (transient) properties of the object. Should be
%   overloaded by each subclasses to perform proper reset actions.
    
    % Run-time variables
    obj.SE              =   [];
    
    % Initialization status
    obj.isInit          =   false;
end
function initialize(obj,SE,isFwd)
%initialize initializes the object

    % Initialization
    obj.reset;
    
    % Set links
    obj.SE              =   SE;

    % Initialize the absorber
    
    % Miscellaneous
    obj.isInit          =   true;

end
end
methods (Static=true,Access=?QMol_suite)
function [ClassName,PropNames] = propertyNames()
%propertyNames returns the names of member properties that can be set
%   through name-value assignment
    
    ClassName           =   'QMol_SE_absorber';
    PropNames           =   {};
end
end
%% Absorber %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
methods (Access=public)
    applyMask(obj,wfcn)
    V = getPotential(obj,V)
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
end
%% 
% * Upon initialization, the class shoud retain a copy of the |SE| object with 
% the access-right signature specified above (required for memory profiling)
% * In the |initialize| method, |isFwd| indicates whether the TDSE propagation 
% is is a forward (|true|) or backward (|false|) in time (to adjust the sign of 
% the CAP)
% Mask function
% Mask absorbers correspond to a given mask function that is multipled to the 
% Kohn-Sham orbitals after each propagation time step. Their signature is

function applyMask(obj,wfcn)
%applyMask
    
    % Multiply the orbitals in KSO by the mask
end
function V = getPotential(~,V)
%getPotential no complex potential, return the object untouched

end
%% 
% * Even when no complex absorbing potential is defined, |getPotential| must 
% still be defined, leaving the input Schrodinger-equation potential untouched
% Complex absorbing potential (CAP)
% Complex absorbing potentials correspond to an imaginary component added to 
% the Schrodinger-equation potential that dampen the Kohn-Sham orbitals at the 
% boundaries. Their signature is

function applyMask(~,~)
%applyMask no mask applied, do nothinggetMem

end
function V = getPotential(obj,V)
%getPotential

    % Add the complex potential to the SE-potential object V

end
%% 
% * Even when no mask is defined, |applyMask| must still be defined, doing nothing
% * V is a compatible Schrodinger-equation potential; use its |add| property 
% to add the CAP
%% Test suite
% For consistency with the rest of the QMol-grid package, |QMol_TDSE| defines 
% an associated test suite. Run the test suite for the class in normal or <./Test_suite.html 
% summary mode> respectively with

QMol_test.test('TDSE');
QMol_test.test('-summary','TDSE');
%% 
% See <./QMol_test.html |QMol_test|> for details regarding how to create a test 
% suite for new classes.
%% Notes
%% 
% * |QMol_TDSE| was intorduced in version 01.20
##### SOURCE END #####
-->
</div></body></html>