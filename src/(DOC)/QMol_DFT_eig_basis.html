<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2024a"><title>QMol_DFT_eig_basis</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S3 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: center;  }
.S4 { margin: 10px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 15px; font-weight: 700; text-align: left;  }
.S5 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block }
.S6 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0.555556px solid rgb(217, 217, 217); border-bottom: 0.555556px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S7 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S8 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.S9 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0.555556px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S10 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0.555556px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S11 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S12 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S13 { border-left: 0px none rgb(33, 33, 33); border-right: 0px none rgb(33, 33, 33); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px; line-height: 15.6px; min-height: 16px; white-space: pre; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span style=' font-family: monospace;'>QMol_DFT_eig_basis</span></h1><div  class = 'S1'><span>Eigen-state solver for DFT models with basis-set discretization.</span></div><h2  class = 'S2'><span>Description</span></h2><div  class = 'S1'><span>Use </span><span style=' font-family: monospace;'>QMol_DFT_eig_basis</span><span> to compute the eigen states of a DFT Hamiltonian operator </span></div><div  class = 'S3' id = 'M_1D4E5B46' ><span texencoding="\mathcal{P}\hat{\mathcal{H}}_{\rm DFT}\left[\{\phi_k\}_k\right]\mathcal{P}^\dagger\ \psi_l = E_l\ \psi_l,
\quad {\rm for} \quad l = 1, 2, \ldots
\quad\quad\quad(1)" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="362.5" height="24.5" /></span></div><div  class = 'S1'><span>where </span><span texencoding="\{\phi_k\}_k" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="36.5" height="19.5" /></span><span> are the Kohn-Sham orbitals of the DFT model and </span><span texencoding="\{\psi_l\}_l" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAnCAYAAAC/mE48AAAAAXNSR0IArs4c6QAABuNJREFUaEPtWX+MXFUV/s6dN+N2bSsxsYU6m/fmzYTKYsCmTVAj2qjUIiWFxGJE6w+g/mNJDVX8AUREUUQjGgXUAhoJWCD8QS0UrJo1MSpBg6Audn3z3p3t7ErRFJSydXfeu8eczXvkZZiZ93aYpn/svr828+6755zvnvN959wlLPKHFnn8WAJgKQMWOQJLJbDIEyA3CdLIyMhplmVtAPBmpdRj9Xr9TycDvFqt9gZjzEcAvBCG4eOu606MjY2F/fqSWQIbN260Jicnr2TmbxDRg8z86SAIjvRrcBDf1Wq110RRdAWAW4hov2VZn5yYmPh3P3tnAmDb9hlKqQMAZguFwvs9z6v3Y2jQ3wgIYRjeRkSXEdHlvu/f1Y+NTAAqlcoHADwA4L6ZmZnLjxw58lI/hk7EN5VKZQeAHwH4nm3bV/VTCpkAuK57GTPfycz3zs3N7Zienp45EcH0s+cgfFsCIAv5QaCcZaPf94PwbSkDstDPg/KaNWuGS6XSZ4no86LPzHyT4zi3pklpZGRkTbFY/BiAIWPMAa31HxLbq1evfu3w8PDHAXwYwKnx93dlkVoe37LiG2QGUKVS+SKArwJ4nog2+b7/x8QB13UvYOb9AJ4zxmxuNBpPyjvbtk9TSv0EwCYi2js7O7tzamrq+XK5fEqpVHKZ+ewwDA8cPnx4uj2YhQCwdu3aFVEUrQrDcINSasr3/d/KfrkBALBn2bJlO8fHx+e6oeo4zruIaCx+/9EgCO6O/ybHcW4koi8AOMjMl2itX5Amq9FofAnAtQAmmHmr1vrvtm1XCoXCZmm+mPmJMAy3NZvNo+12E4nOUqharbbSGHMuM18HYFQptbler/8uE4DYwW8DuJKIPuX7/m29UqobAI7jnEJE9wM4j5m/rrW+BgDXarVqFEWPADhdQAiC4Gvyu9hwHOccIjpIRLf7vi/AmQ4AnAVAmrTnWq3WlmazOdXjcBIfVjLzRVrrZ7MAULZtb1VK/QDAvkKhsNvzvP/2AiBJSQAtInp3kma2ba9TSj0KYBURbfF9/2HZJ7X+RWY+T2v9eLJ/0uTEzj7Uya4ckNZaOsGbANw5MzNzfbdGrVarnRlFkYD1c9u2dyX80rEE1q9fXzx69OhFAL4MYH+hUPim53n/6hX86Oho6fjx498HIN3ZM8aYCxqNRtAW6Mu/t63/faFQ2JrYSL3bpJTaUq/X/9rNdrlcXlYsFi8E8BUA97darVt6lQuAK4IgkLZ5PtN6coAwt2VZkrplY8zFCXF1cqZara4yxsjJysT4UKlU2n7o0KEX04Gma7VcLr+xWCwKKb6lnV9S75rMvF34opNN13Vfx8x7AAhfbNNaP9YtUxqNhpTyB+MMfCJZl0mCMbPfKOweBIGQSMcnqVkAKwB8KwiCqwXldKAySWqtvysbVKvVtxtjpCxWtA8zruu+g5l/LRmY5oUOKpCsG0uItZNz5XL59cVicR8zz7YTaiYAeaWmUqlsB/DTdgWIifEggP+l6jwtmSJv5wdB8HTivOM4u4joOwDeFwTBL7qBnte3hIOY+R6t9WfShDowAFKEBmbeqLX+jTieyqCX67xarY4YY4TY1hHRD5VSuzzPm5X1cVO1h4g2ZI3feQFIrfuQ1npvGtBBAvAeZv7lPLEQvdf3/V9J8zE3Nye9wNbUyBq5rvs5kUMAjXaSkx5AKfUwET01NDS0Y3x8/NiryYAsQh0YADFhyqkKCc5rum3bb4ovU2wA24IgeNBxHOn4fiZBMfMntNb7EkaOFWMeSCK6yvd9KYN5tu5Cgpmjeoqcn+1EqAMDIOW8XJ7MEtFOY4wQ3I8BTCulthtj3grgOiJ6NAzD3ZOTk357YHHJXE9E50sW9ZLePCWQ1VANFABx1nGcUwGcDeAcAJcQ0ZnM/DcAdwB40rKscc/z5P7uFSebKhkXgGi7dIPP+L7/l34zICFUaaiMMf+wLGud7/v35JbBPCh3ck5ub6MokpJ4G4BrYjnrdaAyGM3XP4CnmXkvEY3atn1zt6kwy7dU/W+WBoiILo6i6IZGo/HPhQCQS2vbI0v1BUOx/M2rQq8n1mvhh3dKqbRarVubzebxbt/k6FEoRbgPKKV21+v1wwtSAUlpIrpPJKtXt9UBgETL/5w1qGQB0+l9qks9S042iy+62cjkAPmwWq2uj6LoZklJIroBwL2+7/+n26YpLb80zxi9EABkAAqC4FyllMwpDjNfrbWWdv0V02KefXMBkGwkgS1fvnz42LFjM71uh1O1fMarubPvFIAA4HneSsuyjNZaDqGrTA4cgDwbypr431eiBFBKPZU1Sebd90SsW1AGnAgHTvaeSwCc7BM42fYXfQb8H0g7CnN+saKrAAAAAElFTkSuQmCC" width="32" height="19.5" /></span><span> are the eigen states, with eigen values </span><span texencoding="\{E_l\}_l" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="32.5" height="19.5" /></span><span>, and </span><span style="font-family: STIXGeneral-webfont, serif; font-style: normal; font-weight: 400; color: rgb(33, 33, 33);">𝒫</span><span> is the orthogonal projection on the hull of the basis-set discretization. </span><span style=' font-family: monospace;'>QMol_DFT_eig_basis</span><span> performs a full diagonalization of the Hamiltonian matrix </span><span texencoding="\mathcal{P}\hat{\mathcal{H}}_{\rm DFT}\left[\{\phi_k\}_k\right]\mathcal{P}^\dagger" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="114" height="24.5" /></span><span> using MATLAB </span><span style=' font-family: monospace;'>eig</span><span> function. The DFT-Hamiltonian operator is assumed Hermitian and </span><span style=' font-family: monospace;'>QMol_DFT_eig_basis</span><span> returns real-valued eigen values/states. Note that the eigenstates computed by </span><span style=' font-family: monospace;'>QMol_DFT_eig_basis</span><span> may not correspond to the system's molecular orbitals for which </span><span texencoding="\phi_k=\psi_k" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="49.5" height="19.5" /></span><span>. Those types of calculations are handled by a self-consistent-field (SCF) solver like </span><a href = "./QMol_DFT_SCF_Anderson.html"><span style=' font-family: monospace;'>QMol_DFT_SCF_Anderson</span></a><span>. </span><span style=' font-family: monospace;'>QMol_DFT_eig_basis</span><span> is a handle class.</span></div><div  class = 'S1'><span>Most users only create </span><span style=' font-family: monospace;'>QMol_DFT_eig_basis</span><span> object, with selected </span><a href = "#H_E9C49C16"><span>class properties</span></a><span>, to pass to the SCF solver without directly interacting with any of the </span><a href = "#H_5C9FA558"><span>class methods</span></a><span>.</span></div><h2  class = 'S2' id = 'H_E9C49C16' ><span>Class properties</span></h2><div  class = 'S1'><span style=' font-family: monospace;'>QMol_DFT_eig_basis</span><span> does not define any properties for end users to change. To facilitate simulations,it defines the transient property</span></div><h4  class = 'S4' id = 'H_0ED64D82' ><span style=' font-family: monospace;'>isInitialized (isInit)</span></h4><div  class = 'S1'><span>Whether the eigen-solver object is properly initialized. This is used throughout the QMol-grid package to check that the object holds meaningful information and is ready for use.</span></div><h2  class = 'S2' id = 'H_5C9FA558' ><span>Class methods</span></h2><h3  class = 'S5'><span>Creation</span></h3><h4  class = 'S4'><span>constructor</span></h4><div  class = 'S1'><span>Create a DFT eigen-state solver object with empty class properties.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >obj = QMol_DFT_eig_basis;</span></span></div></div></div><h3  class = 'S5'><span>Initializing the object</span></h3><h4  class = 'S4' id = 'H_85EFED0A' ><span style=' font-family: monospace;'>initialize</span></h4><div  class = 'S1'><span>Initialize a </span><span style=' font-family: monospace;'>QMol_DFT_eig_basis</span><span> object and set the </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to </span><span style=' font-family: monospace;'>true</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >obj.initialize(DFT);</span></span></div></div></div><ul  class = 'S7'><li  class = 'S8'><span style=' font-family: monospace;'>DFT</span><span> is the </span><a href = "./DFT.html"><span>DFT-model</span></a><span> handle object, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "./QMol_DFT_spinPol.html"><span style=' font-family: monospace;'>QMol_DFT_spinPol</span></a><span style=' font-family: monospace;'> </span><span>or </span><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span>, that describes the DFT Hamiltonian operator of Eq. (</span><a href = "#M_1D4E5B46"><span>1</span></a><span>)</span></li></ul><h3  class = 'S5'><span>Run-time documentation</span></h3><h4  class = 'S4' id = 'H_4D7CFC3D' ><span style=' font-family: monospace;'>showDocumentation</span></h4><div  class = 'S1'><span>Display the run-time documentation for the specific configuration of a </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> object, wich must have been </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d beforehand</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ref = obj.showDocumentation;</span></span></div></div></div><ul  class = 'S7'><li  class = 'S8'><span>The output </span><span style=' font-family: monospace;'>ref</span><span> is a cell vector containing the list of references to be included in the bibliography.</span></li></ul><h3  class = 'S5'><span>Eigen-state computation</span></h3><h4  class = 'S4'><span style=' font-family: monospace;'>computeEigenstates</span></h4><div  class = 'S1'><span>Compute the eigen states and energies of Eq. (</span><a href = "#M_1D4E5B46"><span>1</span></a><span>) with either</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >E = obj.computeEigenstates;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >E = obj.computeEigenstates([]);</span></span></div></div></div><ul  class = 'S7'><li  class = 'S8'><span>For spin-restricted DFT models, </span><span style=' font-family: monospace;'>E</span><span> is a vectors containing the respective energies of the computed eigen states. For spin-polarized DFT models, </span><span style=' font-family: monospace;'>E = {E_up,E_down}</span><span> are the up- and down-spin channel energies, respectively.</span></li><li  class = 'S8'><span>Note that only the energies are returned; the eigen states are stored in the DFT object used to </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span> the object, i.e., </span><span style=' text-decoration: underline; font-family: monospace;'>computeEigenstates</span><span style=' text-decoration: underline;'> overwrites the DFT-model Kohn sham orbitals</span><span>.</span></li><li  class = 'S8'><span>This forces the computation of the computation of the DFT-model Kohn-Sham potential.</span></li></ul><div  class = 'S1'><span>Specify the Kohn-Sham potential to use in the eigen-state computation with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >E = obj.computeEigenstates(Vks);</span></span></div></div></div><ul  class = 'S7'><li  class = 'S8'><span style=' font-family: monospace;'>Vks</span><span> is a compatible Kohn-Sham potential</span></li></ul><h2  class = 'S2'><span>Examples</span></h2><h3  class = 'S5'><span>Simple eigen-state computation</span></h3><div  class = 'S1'><span>First we create a spin-restricred DFT models</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">% Domain and atomic centers</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >x   =   -20:.1:15;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >A1  =   QMol_Va_softCoulomb(</span><span style="color: #a709f5;">'name'</span><span >,</span><span style="color: #a709f5;">'atom 1'</span><span >,</span><span style="color: #a709f5;">'charge'</span><span >,3,</span><span style="color: #a709f5;">'position'</span><span >,-3);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >A2  =   QMol_Va_softCoulomb(</span><span style="color: #a709f5;">'name'</span><span >,</span><span style="color: #a709f5;">'atom 2'</span><span >,</span><span style="color: #a709f5;">'charge'</span><span >,3,</span><span style="color: #a709f5;">'position'</span><span >,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span > </span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #008013;">% Atomic orbital vectors</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >AO  =   @(s,n,x0,x) (x(:)-x0).^n .*exp(-(x(:)-x0).^2 * .5/s^2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >V   =  [AO(1.3,0,A1.position,x),AO(1.7,1,A1.position,x),AO(0.8,2,A1.position,x), </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >        AO(1.3,0,A2.position,x),AO(1.7,1,A2.position,x),AO(0.8,2,A2.position,x)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #008013;">% Discretization domain</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >disc=   QMol_disc_basis(</span><span style="color: #a709f5;">'x'</span><span >,x,</span><span style="color: #a709f5;">'basis'</span><span >,V);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >disc.orthonormalizeBasis;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #008013;">% DFT potential components</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >Vext=   QMol_DFT_Vext(</span><span style="color: #a709f5;">'atom'</span><span >,{A1,A2});</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >Vh  =   QMol_DFT_Vh_conv;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >Vxc =   QMol_DFT_Vx_LDA_exp;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #008013;">% Spin-restricted DFT model</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >DFT =   QMol_DFT_spinRes(                           </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'discretization'</span><span >,               disc,   </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'occupation'</span><span >,                   [2 2 1],</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'externalPotential'</span><span >,            Vext,   </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'HartreePotential'</span><span >,             Vh,     </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'exchangeCorrelationPotential'</span><span >, Vxc);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >DFT.initialize;</span></span></div></div></div><div  class = 'S12'><span>Next, we create the eigen-state solver object, </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span> it, and access its run-time documentation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >eigSt = QMol_DFT_eig_basis;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >eigSt.initialize(DFT);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >eigSt.showDocumentation;</span></span></div></div></div><div  class = 'S12'><span>yielding</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S13'><span style="white-space: pre"><span >  * Eigen-state solver for DFT Hamiltonians            MATLAB eig function</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >    using a direct diagonalization of the DFT Hamiltonian matrix.</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >    V-01.21.000 (06/17/2024)                                     F. Mauger</span></span></div></div><div  class = 'S1'><span>We can now compute the eigen-states and energies of Eq. (</span><a href = "#M_1D4E5B46"><span>1</span></a><span>)</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >E = eigSt.computeEigenstates</span></span></div></div></div><div  class = 'S12'><span>which gives</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S13'><span style="white-space: pre"><span >E =</span></span></div><div  class = 'S13'>&nbsp;</div><div  class = 'S13'><span style="white-space: pre"><span >  -2.939619364189480</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >  -2.927121774999187</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >  -2.018312725404784</span></span></div></div><div  class = 'S1'><span>Again, because the eigen-state computation is performed with the (initial) electronic structure in the DFT object -- rather than self consistently -- the updated set of Kohn-Sham orbitals is not an eigen-state of the DFT Hamiltonian opetrator. We can check this by displaying the orbital energies and errors</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >DFT.showEnergy(</span><span style="color: #a709f5;">'orbital'</span><span >);</span></span></div></div></div><div  class = 'S12'><span>yielding</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S13'><span style="white-space: pre"><span >  Orbital      Occ. (elec.)         Energy (-eV)               Error(a.u.)</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >  -------      ------------         ------------               -----------</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >      1            2.00                35.488                   1.002e-01</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >      2            2.00                35.071                   1.001e-01</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >      3            1.00                14.701                   1.482e-01</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >  ------------------------------------------------------------------------</span></span></div></div><h2  class = 'S2'><span>Test suite</span></h2><div  class = 'S1'><span>Run the test suite for the class in normal or </span><a href = "./Test_suite.html"><span>summary mode</span></a><span> respectively with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'DFT_eig_basis'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'-summary'</span><span >,</span><span style="color: #a709f5;">'DFT_eig_basis'</span><span >);</span></span></div></div></div><h2  class = 'S2'><span>For developers</span></h2><h3  class = 'S5'><span>Other hidden class properties</span></h3><div  class = 'S1'><span style=' font-family: monospace;'>QMol_DFT_eig_basis</span><span> defines a handful of additional transient and hidden properties to facilitate and speed up computations. These properties cannot be edited by any function outisde of the object (</span><span style=' font-family: monospace;'>SetAccess=private</span><span> attribute).</span></div><h4  class = 'S4' id = 'H_37454CF9' ><span style=' font-family: monospace;'>DFT</span></h4><div  class = 'S1'><span>DFT-model object </span><span style=' font-family: monospace;'>[ [] (default) | </span><a href = "./QMol_DFT_spinPol.html"><span style=' font-family: monospace;'>QMol_DFT_spinPol</span></a><span style=' font-family: monospace;'> handle object | </span><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span style=' font-family: monospace;'> handle object ]</span></div><ul  class = 'S7'><li  class = 'S8'><span>This is a copy of the </span><a href = "./DFT.html"><span>DFT-model</span></a><span> handle object passed to </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>. </span></li><li  class = 'S8'><span>Un-initialized </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> objects, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span style=' font-family: monospace;'> == false</span><span>, have hempty </span><span style=' font-family: monospace;'>DFT.</span></li></ul><h2  class = 'S2'><span>Notes</span></h2><div  class = 'S1'><span>The results displayed in this documentation page were generated using version 01.21 of the QMol-grid package.</span></div><ul  class = 'S7'><li  class = 'S8'><span style=' font-family: monospace;'>QMol_DFT_eig_basis</span><span> was intorduced in version 01.00.</span></li></ul>
<br>
<!-- 
##### SOURCE BEGIN #####
%% |QMol_DFT_eig_basis|
% Eigen-state solver for DFT models with basis-set discretization.
%% Description
% Use |QMol_DFT_eig_basis| to compute the eigen states of a DFT Hamiltonian 
% operator 
% 
% $$\mathcal{P}\hat{\mathcal{H}}_{\rm DFT}\left[\{\phi_k\}_k\right]\mathcal{P}^\dagger\ 
% \psi_l = E_l\ \psi_l,\quad {\rm for} \quad l = 1, 2, \ldots\quad\quad\quad(1)$$
% 
% where $\{\phi_k\}_k$ are the Kohn-Sham orbitals of the DFT model and $\{\psi_l\}_l$ 
% are the eigen states, with eigen values $\{E_l\}_l$, and $\mathcal{P}$ is the 
% orthogonal projection on the hull of the basis-set discretization. |QMol_DFT_eig_basis| 
% performs a full diagonalization of the Hamiltonian matrix $\mathcal{P}\hat{\mathcal{H}}_{\rm 
% DFT}\left[\{\phi_k\}_k\right]\mathcal{P}^\dagger$ using MATLAB |eig| function. 
% The DFT-Hamiltonian operator is assumed Hermitian and |QMol_DFT_eig_basis| returns 
% real-valued eigen values/states. Note that the eigenstates computed by |QMol_DFT_eig_basis| 
% may not correspond to the system's molecular orbitals for which $\phi_k=\psi_k$. 
% Those types of calculations are handled by a self-consistent-field (SCF) solver 
% like <./QMol_DFT_SCF_Anderson.html |QMol_DFT_SCF_Anderson|>. |QMol_DFT_eig_basis| 
% is a handle class.
% 
% Most users only create |QMol_DFT_eig_basis| object, with selected class properties, 
% to pass to the SCF solver without directly interacting with any of the class 
% methods.
%% Class properties
% |QMol_DFT_eig_basis| does not define any properties for end users to change. 
% To facilitate simulations,it defines the transient property
% |isInitialized (isInit)|
% Whether the eigen-solver object is properly initialized. This is used throughout 
% the QMol-grid package to check that the object holds meaningful information 
% and is ready for use.
%% Class methods
% Creation
% constructor
% Create a DFT eigen-state solver object with empty class properties.

obj = QMol_DFT_eig_basis;
% Initializing the object
% |initialize|
% Initialize a |QMol_DFT_eig_basis| object and set the |isInitialized| flag 
% to |true|

obj.initialize(DFT);
%% 
% * |DFT| is the <./DFT.html DFT-model> handle object, _i.e._, <./QMol_DFT_spinPol.html 
% |QMol_DFT_spinPol|> or <./QMol_DFT_spinRes.html |QMol_DFT_spinRes|>, that describes 
% the DFT Hamiltonian operator of Eq. (1)
% Run-time documentation
% |showDocumentation|
% Display the run-time documentation for the specific configuration of a |QMol_DFT_eigs| 
% object, wich must have been |initialize|d beforehand

ref = obj.showDocumentation;
%% 
% * The output |ref| is a cell vector containing the list of references to be 
% included in the bibliography.
% Eigen-state computation
% |computeEigenstates|
% Compute the eigen states and energies of Eq. (1) with either

E = obj.computeEigenstates;
E = obj.computeEigenstates([]);
%% 
% * For spin-restricted DFT models, |E| is a vectors containing the respective 
% energies of the computed eigen states. For spin-polarized DFT models, |E = {E_up,E_down}| 
% are the up- and down-spin channel energies, respectively.
% * Note that only the energies are returned; the eigen states are stored in 
% the DFT object used to |initialize| the object, i.e., |computeEigenstates| overwrites 
% the DFT-model Kohn sham orbitals.
% * This forces the computation of the computation of the DFT-model Kohn-Sham 
% potential.
%% 
% Specify the Kohn-Sham potential to use in the eigen-state computation with

E = obj.computeEigenstates(Vks);
%% 
% * |Vks| is a compatible Kohn-Sham potential
%% Examples
% Simple eigen-state computation
% First we create a spin-restricred DFT models

% Domain and atomic centers
x   =   -20:.1:15;
A1  =   QMol_Va_softCoulomb('name','atom 1','charge',3,'position',-3);
A2  =   QMol_Va_softCoulomb('name','atom 2','charge',3,'position',2);
 
% Atomic orbital vectors
AO  =   @(s,n,x0,x) (x(:)-x0).^n .*exp(-(x(:)-x0).^2 * .5/s^2);
V   =  [AO(1.3,0,A1.position,x),AO(1.7,1,A1.position,x),AO(0.8,2,A1.position,x), ...
        AO(1.3,0,A2.position,x),AO(1.7,1,A2.position,x),AO(0.8,2,A2.position,x)];

% Discretization domain
disc=   QMol_disc_basis('x',x,'basis',V);
disc.orthonormalizeBasis;

% DFT potential components
Vext=   QMol_DFT_Vext('atom',{A1,A2});
Vh  =   QMol_DFT_Vh_conv;
Vxc =   QMol_DFT_Vx_LDA_exp;

% Spin-restricted DFT model
DFT =   QMol_DFT_spinRes(                           ...
            'discretization',               disc,   ...
            'occupation',                   [2 2 1],...
            'externalPotential',            Vext,   ...
            'HartreePotential',             Vh,     ...
            'exchangeCorrelationPotential', Vxc);
DFT.initialize;
%% 
% Next, we create the eigen-state solver object, |initialize| it, and access 
% its run-time documentation

eigSt = QMol_DFT_eig_basis;
eigSt.initialize(DFT);
eigSt.showDocumentation;
%% 
% yielding
%%
% 
%    * Eigen-state solver for DFT Hamiltonians            MATLAB eig function
%      using a direct diagonalization of the DFT Hamiltonian matrix.
%      V-01.21.000 (06/17/2024)                                     F. Mauger
%
%% 
% We can now compute the eigen-states and energies of Eq. (1)

E = eigSt.computeEigenstates
%% 
% which gives
%%
% 
%  E =
%  
%    -2.939619364189480
%    -2.927121774999187
%    -2.018312725404784
%
%% 
% Again, because the eigen-state computation is performed with the (initial) 
% electronic structure in the DFT object REPLACE_WITH_DASH_DASH rather than self consistently REPLACE_WITH_DASH_DASH the 
% updated set of Kohn-Sham orbitals is not an eigen-state of the DFT Hamiltonian 
% opetrator. We can check this by displaying the orbital energies and errors

DFT.showEnergy('orbital');
%% 
% yielding
%%
% 
%    Orbital      Occ. (elec.)         Energy (-eV)               Error(a.u.)
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-      REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH         REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH               REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
%        1            2.00                35.488                   1.002e-01
%        2            2.00                35.071                   1.001e-01
%        3            1.00                14.701                   1.482e-01
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%
%% Test suite
% Run the test suite for the class in normal or <./Test_suite.html summary mode> 
% respectively with

QMol_test.test('DFT_eig_basis');
QMol_test.test('-summary','DFT_eig_basis');
%% For developers
% Other hidden class properties
% |QMol_DFT_eig_basis| defines a handful of additional transient and hidden 
% properties to facilitate and speed up computations. These properties cannot 
% be edited by any function outisde of the object (|SetAccess=private| attribute).
% |DFT|
% DFT-model object |[ [] (default) || <./QMol_DFT_spinPol.html |QMol_DFT_spinPol|> 
% |handle object || <./QMol_DFT_spinRes.html |QMol_DFT_spinRes|> |handle object 
% ]|
%% 
% * This is a copy of the <./DFT.html DFT-model> handle object passed to |initialize|. 
% * Un-initialized |QMol_DFT_eigs| objects, _i.e._, |isInitialized| |== false|, 
% have hempty |DFT.|
%% Notes
% The results displayed in this documentation page were generated using version 
% 01.21 of the QMol-grid package.
%% 
% * |QMol_DFT_eig_basis| was intorduced in version 01.00.
##### SOURCE END #####
-->
</div></body></html>