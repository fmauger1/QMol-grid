<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2024a"><title>QMol_DFT_eigs</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S3 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: center;  }
.S4 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.S5 { margin: 10px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 15px; font-weight: 700; text-align: left;  }
.S6 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S7 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block }
.S8 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0.555556px solid rgb(217, 217, 217); border-bottom: 0.555556px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S9 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S10 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0.555556px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S11 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0.555556px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S12 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S13 { border-left: 0px none rgb(33, 33, 33); border-right: 0px none rgb(33, 33, 33); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px; line-height: 15.6px; min-height: 16px; white-space: pre; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span style=' font-family: monospace;'>QMol_DFT_eigs</span></h1><div  class = 'S1'><span>Eigen-state solver for DFT models.</span></div><h2  class = 'S2'><span>Description</span></h2><div  class = 'S1'><span>Use </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> to compute the eigen states of a DFT Hamiltonian operator </span></div><div  class = 'S3' id = 'M_1D4E5B46' ><span texencoding="\hat{\mathcal{H}}_{\rm DFT}\left[\{\phi_k\}_k\right]\ \psi_l = E_l\ \psi_l,
\quad {\rm for} \quad l = 1, 2, \ldots
\quad\quad\quad(1)" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="330" height="24.5" /></span></div><div  class = 'S1'><span>where </span><span texencoding="\{\phi_k\}_k" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="36.5" height="19.5" /></span><span> are the Kohn-Sham orbitals of the DFT model and </span><span texencoding="\{\psi_l\}_l" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="32" height="19.5" /></span><span> are the eigen states, with eigen values </span><span texencoding="\{E_l\}_l" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="32.5" height="19.5" /></span><span>. The DFT-Hamiltonian operator is assumed Hermitian and </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> returns real-valued eigen values/states. Note that the eigenstates computed by </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> may not correspond to the system's molecular orbitals for which </span><span texencoding="\phi_k=\psi_k" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="49.5" height="19.5" /></span><span>. Those types of calculations are handled by a self-consistent-field (SCF) solver like </span><a href = "./QMol_DFT_SCF_Anderson.html"><span style=' font-family: monospace;'>QMol_DFT_SCF_Anderson</span></a><span>. </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> is a handle class.</span></div><div  class = 'S1'><span>Most users only create </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> object, with selected </span><a href = "#H_E9C49C16"><span>class properties</span></a><span>, to pass to the SCF solver without directly interacting with any of the </span><a href = "#H_5C9FA558"><span>class methods</span></a><span>.</span></div><h2  class = 'S2' id = 'H_E9C49C16' ><span>Class properties</span></h2><h3  class = 'S4' id = 'H_5E80E5B2' ><span>Eigen solver</span></h3><div  class = 'S1'><span>The eigen solver uses </span><span style=' font-family: monospace;'>MATLAB</span><span> </span><span style=' font-family: monospace;'>eigs</span><span> function and duplicates its options (using the same names); see the </span><span style=' font-family: monospace;'>eigs</span><span> documentation for details. Each eigen-solver property can be changed using the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method:</span></div><h4  class = 'S5'><span style=' font-family: monospace;'>IsFunctionSymmetric (issym)</span></h4><div  class = 'S1'><span>Symmetry of the DFT Hamiltonian operator </span><span style=' font-family: monospace;'>[ true (default) | false ]</span></div><ul  class = 'S6'><li  class = 'S7'><span>This property is only implemented for completeness and should always be </span><span style=' font-family: monospace;'>true</span><span>. Setting </span><span style=' font-family: monospace;'>IsFunctionSymmetric = false</span><span> triggers a warning and may lead to erroneous results.</span></li></ul><h4  class = 'S5'><span>Tolerance (tol)</span></h4><div  class = 'S1'><span>Convergence tolerance </span><span style=' font-family: monospace;'>[ nonnegative scalar (1e-12) ]</span></div><h4  class = 'S5'><span style=' font-family: monospace;'>MaxIterations (maxit)</span></h4><div  class = 'S1'><span>Maximum number of iterations </span><span style=' font-family: monospace;'>[ nonnegative integer (300) ]</span></div><h4  class = 'S5'><span style=' font-family: monospace;'>SubspaceDimension (p)</span></h4><div  class = 'S1'><span>Number of Lanczos basis vectors </span><span style=' font-family: monospace;'>[ nonnegative integer (100) ]</span></div><ul  class = 'S6'><li  class = 'S7'><span style=' font-family: monospace;'>SubspaceDimension</span><span> must be latger than the number of Kohn-Sham orbitals</span></li><li  class = 'S7'><span>If </span><span style=' font-family: monospace;'>SubspaceDimension</span><span> is too large -- larger than the effective dimension of the discrete problem -- </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> instead uses the problem's dimension.</span></li></ul><h4  class = 'S5'><span style=' font-family: monospace;'>Display (disp)</span></h4><div  class = 'S1'><span>Display diagnostic information </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S5'><span style=' font-family: monospace;'>Symmetry (sym)</span></h4><div  class = 'S1'><span>Symmetry of the eigen states </span><span style=' font-family: monospace;'>[ string | [] (default) ]</span></div><ul  class = 'S6'><li  class = 'S7'><span>For problems with a symmetric target, specify the symmetry of the wave functions. This can help converge SCF calculations.</span></li><li  class = 'S7'><span>Note that the specified symmetry </span><span style=' text-decoration: underline;'>must be trictly enforced in the discrete problem</span><span> -- </span><span style=' font-style: italic;'>i.e.</span><span>, a perfectly symmetric target that is exactly centered in the simulation domain (along the requested symmetry directions).</span></li><li  class = 'S7'><span style=' text-decoration: underline;'>For 1D models</span><span>, the syntax of the </span><span style=' font-family: monospace;'>Symmetry</span><span> option is </span><span style=' font-family: monospace;'>'# Sx + # Ax'</span><span>, where </span><span style=' font-family: monospace;'>#</span><span> specifies the umber of symmetric (</span><span style=' font-family: monospace;'>Sx</span><span>) and antisymmetric (</span><span style=' font-family: monospace;'>Ax</span><span>) eigen states. If only one state in the specified symmetry subspace is requested, the number </span><span style=' font-family: monospace;'>#</span><span> can be omitted (</span><span style=' font-family: monospace;'>'Sx'</span><span> is equivalent to </span><span style=' font-family: monospace;'>'1 Sx'</span><span>) and if no state is requested, the symmetry can be ignored altogether (</span><span style=' font-family: monospace;'>'# Sx'</span><span> alone is equivalent to </span><span style=' font-family: monospace;'>'# Sx + 0 Ax'</span><span>). The two symmetey subgroups can be specified in arbitrary order (</span><span style=' font-family: monospace;'>'# Sx + # Ax'</span><span> is equivalent to </span><span style=' font-family: monospace;'>'# Ax + # Sx'</span><span>). The sume of the number of states in each sub group should match the number of Kohn_sham orbitals in the DFT model.</span></li><li  class = 'S7'><span style=' text-decoration: underline;'>For spin-polarized DFT models</span><span>, specify the up- and down-spin symmetries in a cell </span><span style=' font-family: monospace;'>{Symmetry_up, Symmetry_down}</span><span> where each of the </span><span style=' font-family: monospace;'>Symmetry_up</span><span> and </span><span style=' font-family: monospace;'>Symmetry_down</span><span> strings follow the above-listed requirements.</span></li></ul><h3  class = 'S4'><span>Other properties</span></h3><div  class = 'S1'><span>To facilitate simulations, </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> defines a handful of additional transient properties. These </span><span style=' text-decoration: underline;'>cannot</span><span> be edited with the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method.</span></div><h4  class = 'S5' id = 'H_0ED64D82' ><span style=' font-family: monospace;'>isInitialized (isInit)</span></h4><div  class = 'S1'><span>Whether the eigen-solver object is properly initialized. This is used throughout the QMol-grid package to check that the object holds meaningful information and is ready for use.</span></div><h2  class = 'S2' id = 'H_5C9FA558' ><span>Class methods</span></h2><h3  class = 'S4'><span>Creation</span></h3><h4  class = 'S5'><span>constructor</span></h4><div  class = 'S1'><span>Create a DFT eigen-state solver object with empty class properties.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj = QMol_DFT_eigs;</span></span></div></div></div><div  class = 'S9'><span>Create a DFT eigen-state solver object with the </span><span style=' font-family: monospace;'>name</span><span> properties set to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_27AB3DA4"><span>DFT-model properties</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj = QMol_DFT_eigs(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >obj = QMol_DFT_eigs(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><h3  class = 'S4'><span>Changing class properties</span></h3><h4  class = 'S5' id = 'H_4405B79D' ><span style=' font-family: monospace;'>set</span></h4><div  class = 'S1'><span>Update the </span><span style=' font-family: monospace;'>name</span><span> properties of aDFT eigen-state solver object to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_5E80E5B2"><span>Eigen-solver properties</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.set(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >obj.set(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S9'><span>This is the common name-value pair assignment method used throughout the QMol-grid package. The </span><span style=' font-family: monospace;'>set</span><span> method also </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the class. After running, the </span><span style=' font-family: monospace;'>set</span><span> property updates the </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to a </span><span style=' font-family: monospace;'>false</span><span> value.</span></div><h4  class = 'S5' id = 'H_BF84FCE7' ><span style=' font-family: monospace;'>reset</span></h4><div  class = 'S1'><span>Reset the object by deleting/re-initializing all run-time properties of the class and updating the </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to </span><span style=' font-family: monospace;'>false</span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.reset;</span></span></div></div></div><ul  class = 'S6'><li  class = 'S7'><span>This is the common </span><span style=' font-family: monospace;'>reset</span><span> method available to all classes throughout the QMol-grid package.</span></li></ul><h4  class = 'S5' id = 'H_C729A888' ><span style=' font-family: monospace;'>clear</span></h4><div  class = 'S1'><span>Clear all class properties</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.clear;</span></span></div></div></div><div  class = 'S9'><span>Clear a specific set of the class properties. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_5E80E5B2"><span>Eigen-solver properties</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.clear(name1,name2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S9'><span>This is the common </span><span style=' font-family: monospace;'>clear</span><span> method available to all classes throughout the QMol-grid package. The </span><span style=' font-family: monospace;'>clear</span><span> method also </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the class.</span></div><h3  class = 'S4'><span>Initializing the object</span></h3><h4  class = 'S5' id = 'H_85EFED0A' ><span style=' font-family: monospace;'>initialize</span></h4><div  class = 'S1'><span>Initialize a </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> object and set the </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to </span><span style=' font-family: monospace;'>true</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.initialize(DFT);</span></span></div></div></div><ul  class = 'S6'><li  class = 'S7'><span style=' font-family: monospace;'>DFT</span><span> is the </span><a href = "./DFT.html"><span>DFT-model</span></a><span> handle object, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "./QMol_DFT_spinPol.html"><span style=' font-family: monospace;'>QMol_DFT_spinPol</span></a><span style=' font-family: monospace;'> </span><span>or </span><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span>, that describes the DFT Hamiltonian operator of Eq. (</span><a href = "#M_1D4E5B46"><span>1</span></a><span>)</span></li><li  class = 'S7'><span>To avoid any mismatch in internal properties, </span><span style=' font-family: monospace;'>initialize</span><span> first </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the object before performing the initialization</span></li></ul><h3  class = 'S4'><span>Run-time documentation</span></h3><h4  class = 'S5' id = 'H_4D7CFC3D' ><span style=' font-family: monospace;'>showDocumentation</span></h4><div  class = 'S1'><span>Display the run-time documentation for the specific configuration of a </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> object, wich must have been </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d beforehand</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >ref = obj.showDocumentation;</span></span></div></div></div><ul  class = 'S6'><li  class = 'S7'><span>The output </span><span style=' font-family: monospace;'>ref</span><span> is a cell vector containing the list of references to be included in the bibliography.</span></li></ul><h3  class = 'S4'><span>Eigen-state computation</span></h3><h4  class = 'S5'><span style=' font-family: monospace;'>computeEigenstates</span></h4><div  class = 'S1'><span>Compute the eigen states and energies of Eq. (</span><a href = "#M_1D4E5B46"><span>1</span></a><span>) with either</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >E = obj.computeEigenstates;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >E = obj.computeEigenstates([]);</span></span></div></div></div><ul  class = 'S6'><li  class = 'S7'><span>For spin-restricted DFT models, </span><span style=' font-family: monospace;'>E</span><span> is a vectors containing the respective energies of the computed eigen states. For spin-polarized DFT models, </span><span style=' font-family: monospace;'>E = {E_up,E_down}</span><span> are the up- and down-spin channel energies, respectively.</span></li><li  class = 'S7'><span>Note that only the energies are returned; the eigen states are stored in the DFT object used to </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span> the object, i.e., </span><span style=' text-decoration: underline; font-family: monospace;'>computeEigenstates</span><span style=' text-decoration: underline;'> overwrites the DFT-model Kohn sham orbitals</span><span>.</span></li><li  class = 'S7'><span>This forces the computation of the computation of the DFT-model Kohn-Sham potential.</span></li></ul><div  class = 'S1'><span>Specify the Kohn-Sham potential to use in the eigen-state computation with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >E = obj.computeEigenstates(Vks);</span></span></div></div></div><ul  class = 'S6'><li  class = 'S7'><span style=' font-family: monospace;'>Vks</span><span> is a compatible Kohn-Sham potential</span></li></ul><h2  class = 'S2'><span>Examples</span></h2><h3  class = 'S4'><span>Simple eigen-state computation</span></h3><div  class = 'S1'><span>First we create a spin-restricred DFT models</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #008013;">% Domain and atomic centers</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >x   =   -20:.1:15;</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >A1  =   QMol_Va_softCoulomb(</span><span style="color: #a709f5;">'name'</span><span >,</span><span style="color: #a709f5;">'atom 1'</span><span >,</span><span style="color: #a709f5;">'charge'</span><span >,3,</span><span style="color: #a709f5;">'position'</span><span >,-3);</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >A2  =   QMol_Va_softCoulomb(</span><span style="color: #a709f5;">'name'</span><span >,</span><span style="color: #a709f5;">'atom 2'</span><span >,</span><span style="color: #a709f5;">'charge'</span><span >,3,</span><span style="color: #a709f5;">'position'</span><span >,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span style="color: #008013;">% DFT potential components</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >Vext=   QMol_DFT_Vext(</span><span style="color: #a709f5;">'atom'</span><span >,{A1,A2});</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >Vh  =   QMol_DFT_Vh_conv;</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >Vxc =   QMol_DFT_Vx_LDA_exp;</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span style="color: #008013;">% Spin-restricted DFT model</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >DFT =   QMol_DFT_spinRes(                           </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'xspan'</span><span >,                        x,      </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'occupation'</span><span >,                   [2 2 1],</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'externalPotential'</span><span >,            Vext,   </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'HartreePotential'</span><span >,             Vh,     </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'exchangeCorrelationPotential'</span><span >, Vxc);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >DFT.initialize;</span></span></div></div></div><div  class = 'S9'><span>Next, we create the eigen-state solver object, </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span> it, and access its run-time documentation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >eigSt = QMol_DFT_eigs;</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >eigSt.initialize(DFT);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >eigSt.showDocumentation;</span></span></div></div></div><div  class = 'S9'><span>yielding</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S13'><span style="white-space: pre"><span >  * Eigen-state solver for DFT Hamiltonians           MATLAB eigs function</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >    Tolerance  = 1e-12 </span></span></div><div  class = 'S13'><span style="white-space: pre"><span >    Max. iter. = 300</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >    Basis dim. = 100</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >    V-01.21.000 (06/17/2024)                                     F. Mauger</span></span></div></div><div  class = 'S1'><span>We can now compute the eigen-states and energies of Eq. (</span><a href = "#M_1D4E5B46"><span>1</span></a><span>)</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >E = eigSt.computeEigenstates</span></span></div></div></div><div  class = 'S9'><span>which gives</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S13'><span style="white-space: pre"><span >E =</span></span></div><div  class = 'S13'>&nbsp;</div><div  class = 'S13'><span style="white-space: pre"><span >  -2.954096176667686</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >  -2.933903112075727</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >  -2.148472642273518</span></span></div></div><div  class = 'S1'><span>Again, because the eigen-state computation is performed with the (initial) electronic structure in the DFT object -- rather than self consistently -- the updated set of Kohn-Sham orbitals is not an eigen-state of the DFT Hamiltonian opetrator. We can check this by displaying the orbital energies and errors</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >DFT.showEnergy(</span><span style="color: #a709f5;">'orbital'</span><span >);</span></span></div></div></div><div  class = 'S9'><span>yielding</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S13'><span style="white-space: pre"><span >  Orbital      Occ. (elec.)         Energy (-eV)               Error(a.u.)</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >  -------      ------------         ------------               -----------</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >      1            2.00                34.483                   1.139e-01</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >      2            2.00                34.097                   1.181e-01</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >      3            1.00                13.625                   1.528e-01</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >  ------------------------------------------------------------------------</span></span></div></div><h3  class = 'S4'><span>Impose eigen-state symmetry</span></h3><div  class = 'S1'><span>We briefly modify the previous example to make it symmetric</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #008013;">% Domain and atomic centers</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >x   =   -20:.1:20;</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >A1  =   QMol_Va_softCoulomb(</span><span style="color: #a709f5;">'name'</span><span >,</span><span style="color: #a709f5;">'atom 1'</span><span >,</span><span style="color: #a709f5;">'charge'</span><span >,3,</span><span style="color: #a709f5;">'position'</span><span >,-3);</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >A2  =   QMol_Va_softCoulomb(</span><span style="color: #a709f5;">'name'</span><span >,</span><span style="color: #a709f5;">'atom 2'</span><span >,</span><span style="color: #a709f5;">'charge'</span><span >,3,</span><span style="color: #a709f5;">'position'</span><span >,3);</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span style="color: #008013;">% DFT potential components</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >Vext=   QMol_DFT_Vext(</span><span style="color: #a709f5;">'atom'</span><span >,{A1,A2});</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >Vh  =   QMol_DFT_Vh_conv;</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >Vxc =   QMol_DFT_Vx_LDA_exp;</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span style="color: #008013;">% Spin-restricted DFT model</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >DFT =   QMol_DFT_spinRes(                           </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'xspan'</span><span >,                        x,      </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'occupation'</span><span >,                   [2 2 1],</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'externalPotential'</span><span >,            Vext,   </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'HartreePotential'</span><span >,             Vh,     </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'exchangeCorrelationPotential'</span><span >, Vxc);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >DFT.initialize;</span></span></div></div></div><div  class = 'S9'><span>Next, we create the eigen-state solver with a specific symmetry configuration (2 symmetric and one antisymmetric states), </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span> it, and access its run-time documentation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >eigSt = QMol_DFT_eigs(</span><span style="color: #a709f5;">'Symmetry'</span><span >,</span><span style="color: #a709f5;">'2 Sx + Ax'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >eigSt.initialize(DFT);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >eigSt.showDocumentation;</span></span></div></div></div><div  class = 'S9'><span>yielding (note the added symmetry information as comapred to </span><a href = "#M_CDBC23A0"><span>above</span></a><span>)</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S13'><span style="white-space: pre"><span >  * Eigen-state solver for DFT Hamiltonians           MATLAB eigs function</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >    Tolerance  = 1e-12 </span></span></div><div  class = 'S13'><span style="white-space: pre"><span >    Max. iter. = 300</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >    Basis dim. = 100</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >    State sym. = 2 Sx + 1 Ax</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >    V-01.21.000 (06/17/2024)                                     F. Mauger</span></span></div></div><div  class = 'S1'><span>We can now compute the eigen-states and energies of Eq. (</span><a href = "#M_1D4E5B46"><span>1</span></a><span>)</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >E = eigSt.computeEigenstates</span></span></div></div></div><div  class = 'S9'><span>which gives</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S13'><span style="white-space: pre"><span >E =</span></span></div><div  class = 'S13'>&nbsp;</div><div  class = 'S13'><span style="white-space: pre"><span >  -2.841467033665281</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >  -2.837538418285015</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >  -1.978965635739010</span></span></div></div><div  class = 'S1'><span>One ore time, the result is not an eigen-state of the DFT Hamiltonian opetrator:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >DFT.showEnergy(</span><span style="color: #a709f5;">'orbital'</span><span >);</span></span></div></div></div><div  class = 'S9'><span>yielding</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S13'><span style="white-space: pre"><span >  Orbital      Occ. (elec.)         Energy (-eV)               Error(a.u.)</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >  -------      ------------         ------------               -----------</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >      1            2.00                34.481                   9.767e-02</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >      2            2.00                34.374                   9.837e-02</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >      3            1.00                13.425                   1.177e-01</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >  ------------------------------------------------------------------------</span></span></div></div><h2  class = 'S2'><span>Test suite</span></h2><div  class = 'S1'><span>Run the test suite for the class in normal or </span><a href = "./Test_suite.html"><span>summary mode</span></a><span> respectively with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'DFT_eigs'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'-summary'</span><span >,</span><span style="color: #a709f5;">'DFT_eigs'</span><span >);</span></span></div></div></div><h2  class = 'S2'><span>For developers</span></h2><h3  class = 'S4'><span>Other hidden class properties</span></h3><div  class = 'S1'><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> defines a handful of additional transient and hidden properties to facilitate and speed up computations. These properties cannot be edited with the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method, nor by any function outisde of the object (</span><span style=' font-family: monospace;'>SetAccess=private</span><span> attribute).</span></div><h4  class = 'S5' id = 'H_37454CF9' ><span style=' font-family: monospace;'>DFT</span></h4><div  class = 'S1'><span>DFT-model object </span><span style=' font-family: monospace;'>[ [] (default) | </span><a href = "./QMol_DFT_spinPol.html"><span style=' font-family: monospace;'>QMol_DFT_spinPol</span></a><span style=' font-family: monospace;'> handle object | </span><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span style=' font-family: monospace;'> handle object ]</span></div><ul  class = 'S6'><li  class = 'S7'><span>This is a copy of the </span><a href = "./DFT.html"><span>DFT-model</span></a><span> handle object passed to </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>. </span></li><li  class = 'S7'><span>Un-initialized </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> objects, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span style=' font-family: monospace;'> == false</span><span>, have hempty </span><span style=' font-family: monospace;'>DFT.</span></li></ul><h4  class = 'S5'><span style=' font-family: monospace;'>symState</span></h4><div  class = 'S1'><span>Identified symmetry configuration </span><span style=' font-family: monospace;'>[ [] (default) | array | cell ]</span></div><ul  class = 'S6'><li  class = 'S7'><span>After a </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> object is </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d, this describes the symmetry configuration to impose in eigen-state computations.</span></li><li  class = 'S7'><span style=' text-decoration: underline;'>For 1D models</span><span>, </span><span style=' font-family: monospace;'>symState</span><span> is a 2-by-n matrix where each column specifies (i) the number of states (first row) and (ii) the symmetry of the states (second row), with -1 for antisymmetric, 0 for no symmetry imposed, and 1 for symmetric.</span></li><li  class = 'S7'><span style=' text-decoration: underline;'>For spin-polarized models</span><span>, </span><span style=' font-family: monospace;'>symState = {symState_up, symState_down}</span><span> specifies the up- and down-spin symmetry configurations, respectively.</span></li></ul><h2  class = 'S2'><span>Notes</span></h2><div  class = 'S1'><span>The results displayed in this documentation page were generated using version 01.21 of the QMol-grid package.</span></div><ul  class = 'S6'><li  class = 'S7'><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> was intorduced in version 01.00.</span></li></ul>
<br>
<!-- 
##### SOURCE BEGIN #####
%% |QMol_DFT_eigs|
% Eigen-state solver for DFT models.
%% Description
% Use |QMol_DFT_eigs| to compute the eigen states of a DFT Hamiltonian operator 
% 
% $$\hat{\mathcal{H}}_{\rm DFT}\left[\{\phi_k\}_k\right]\ \psi_l = E_l\ \psi_l,\quad 
% {\rm for} \quad l = 1, 2, \ldots\quad\quad\quad(1)$$
% 
% where $\{\phi_k\}_k$ are the Kohn-Sham orbitals of the DFT model and $\{\psi_l\}_l$ 
% are the eigen states, with eigen values $\{E_l\}_l$. The DFT-Hamiltonian operator 
% is assumed Hermitian and |QMol_DFT_eigs| returns real-valued eigen values/states. 
% Note that the eigenstates computed by |QMol_DFT_eigs| may not correspond to 
% the system's molecular orbitals for which $\phi_k=\psi_k$. Those types of calculations 
% are handled by a self-consistent-field (SCF) solver like <./QMol_DFT_SCF_Anderson.html 
% |QMol_DFT_SCF_Anderson|>. |QMol_DFT_eigs| is a handle class.
% 
% Most users only create |QMol_DFT_eigs| object, with selected class properties, 
% to pass to the SCF solver without directly interacting with any of the class 
% methods.
%% Class properties
% Eigen solver
% The eigen solver uses |MATLAB| |eigs| function and duplicates its options 
% (using the same names); see the |eigs| documentation for details. Each eigen-solver 
% property can be changed using the |set| method:
% |IsFunctionSymmetric (issym)|
% Symmetry of the DFT Hamiltonian operator |[ true (default) | false ]|
%% 
% * This property is only implemented for completeness and should always be 
% |true|. Setting |IsFunctionSymmetric = false| triggers a warning and may lead 
% to erroneous results.
% Tolerance (tol)
% Convergence tolerance |[ nonnegative scalar (1e-12) ]|
% |MaxIterations (maxit)|
% Maximum number of iterations |[ nonnegative integer (300) ]|
% |SubspaceDimension (p)|
% Number of Lanczos basis vectors |[ nonnegative integer (100) ]|
%% 
% * |SubspaceDimension| must be latger than the number of Kohn-Sham orbitals
% * If |SubspaceDimension| is too large REPLACE_WITH_DASH_DASH larger than the effective dimension 
% of the discrete problem REPLACE_WITH_DASH_DASH |QMol_DFT_eigs| instead uses the problem's dimension.
% |Display (disp)|
% Display diagnostic information |[ true | false (default) ]|
% |Symmetry (sym)|
% Symmetry of the eigen states |[ string | [] (default) ]|
%% 
% * For problems with a symmetric target, specify the symmetry of the wave functions. 
% This can help converge SCF calculations.
% * Note that the specified symmetry must be trictly enforced in the discrete 
% problem REPLACE_WITH_DASH_DASH _i.e._, a perfectly symmetric target that is exactly centered in 
% the simulation domain (along the requested symmetry directions).
% * For 1D models, the syntax of the |Symmetry| option is |'# Sx + # Ax'|, where 
% |#| specifies the umber of symmetric (|Sx|) and antisymmetric (|Ax|) eigen states. 
% If only one state in the specified symmetry subspace is requested, the number 
% |#| can be omitted (|'Sx'| is equivalent to |'1 Sx'|) and if no state is requested, 
% the symmetry can be ignored altogether (|'# Sx'| alone is equivalent to |'# 
% Sx + 0 Ax'|). The two symmetey subgroups can be specified in arbitrary order 
% (|'# Sx + # Ax'| is equivalent to |'# Ax + # Sx'|). The sume of the number of 
% states in each sub group should match the number of Kohn_sham orbitals in the 
% DFT model.
% * For spin-polarized DFT models, specify the up- and down-spin symmetries 
% in a cell |{Symmetry_up, Symmetry_down}| where each of the |Symmetry_up| and 
% |Symmetry_down| strings follow the above-listed requirements.
% Other properties
% To facilitate simulations, |QMol_DFT_eigs| defines a handful of additional 
% transient properties. These cannot be edited with the |set| method.
% |isInitialized (isInit)|
% Whether the eigen-solver object is properly initialized. This is used throughout 
% the QMol-grid package to check that the object holds meaningful information 
% and is ready for use.
%% Class methods
% Creation
% constructor
% Create a DFT eigen-state solver object with empty class properties.

obj = QMol_DFT_eigs;
%% 
% Create a DFT eigen-state solver object with the |name| properties set to the 
% specified |value|. Several |name-value| pairs can be specified consecutively. 
% Suitable |name| is any of the DFT-model properties and is case insensitive.

obj = QMol_DFT_eigs(name1,value1);
obj = QMol_DFT_eigs(name1,value1,name2,value2,___);
% Changing class properties
% |set|
% Update the |name| properties of aDFT eigen-state solver object to the specified 
% |value|. Several |name-value| pairs can be specified consecutively. Suitable 
% |name| is any of the Eigen-solver properties and is case insensitive.

obj.set(name1,value1);
obj.set(name1,value1,name2,value2,___);
%% 
% This is the common name-value pair assignment method used throughout the QMol-grid 
% package. The |set| method also |reset| the class. After running, the |set| property 
% updates the |isInitialized| flag to a |false| value.
% |reset|
% Reset the object by deleting/re-initializing all run-time properties of the 
% class and updating the |isInitialized| flag to |false|.

obj.reset;
%% 
% * This is the common |reset| method available to all classes throughout the 
% QMol-grid package.
% |clear|
% Clear all class properties

obj.clear;
%% 
% Clear a specific set of the class properties. Suitable |name| is any of the 
% Eigen-solver properties and is case insensitive.

obj.clear(name1,name2,___);
%% 
% This is the common |clear| method available to all classes throughout the 
% QMol-grid package. The |clear| method also |reset| the class.
% Initializing the object
% |initialize|
% Initialize a |QMol_DFT_eigs| object and set the |isInitialized| flag to |true|

obj.initialize(DFT);
%% 
% * |DFT| is the <./DFT.html DFT-model> handle object, _i.e._, <./QMol_DFT_spinPol.html 
% |QMol_DFT_spinPol|> or <./QMol_DFT_spinRes.html |QMol_DFT_spinRes|>, that describes 
% the DFT Hamiltonian operator of Eq. (1)
% * To avoid any mismatch in internal properties, |initialize| first |reset| 
% the object before performing the initialization
% Run-time documentation
% |showDocumentation|
% Display the run-time documentation for the specific configuration of a |QMol_DFT_eigs| 
% object, wich must have been |initialize|d beforehand

ref = obj.showDocumentation;
%% 
% * The output |ref| is a cell vector containing the list of references to be 
% included in the bibliography.
% Eigen-state computation
% |computeEigenstates|
% Compute the eigen states and energies of Eq. (1) with either

E = obj.computeEigenstates;
E = obj.computeEigenstates([]);
%% 
% * For spin-restricted DFT models, |E| is a vectors containing the respective 
% energies of the computed eigen states. For spin-polarized DFT models, |E = {E_up,E_down}| 
% are the up- and down-spin channel energies, respectively.
% * Note that only the energies are returned; the eigen states are stored in 
% the DFT object used to |initialize| the object, i.e., |computeEigenstates| overwrites 
% the DFT-model Kohn sham orbitals.
% * This forces the computation of the computation of the DFT-model Kohn-Sham 
% potential.
%% 
% Specify the Kohn-Sham potential to use in the eigen-state computation with

E = obj.computeEigenstates(Vks);
%% 
% * |Vks| is a compatible Kohn-Sham potential
%% Examples
% Simple eigen-state computation
% First we create a spin-restricred DFT models

% Domain and atomic centers
x   =   -20:.1:15;
A1  =   QMol_Va_softCoulomb('name','atom 1','charge',3,'position',-3);
A2  =   QMol_Va_softCoulomb('name','atom 2','charge',3,'position',2);

% DFT potential components
Vext=   QMol_DFT_Vext('atom',{A1,A2});
Vh  =   QMol_DFT_Vh_conv;
Vxc =   QMol_DFT_Vx_LDA_exp;

% Spin-restricted DFT model
DFT =   QMol_DFT_spinRes(                           ...
            'xspan',                        x,      ...
            'occupation',                   [2 2 1],...
            'externalPotential',            Vext,   ...
            'HartreePotential',             Vh,     ...
            'exchangeCorrelationPotential', Vxc);
DFT.initialize;
%% 
% Next, we create the eigen-state solver object, |initialize| it, and access 
% its run-time documentation

eigSt = QMol_DFT_eigs;
eigSt.initialize(DFT);
eigSt.showDocumentation;
%% 
% yielding
%%
% 
%    * Eigen-state solver for DFT Hamiltonians           MATLAB eigs function
%      Tolerance  = 1e-12 
%      Max. iter. = 300
%      Basis dim. = 100
%      V-01.21.000 (06/17/2024)                                     F. Mauger
%
%% 
% We can now compute the eigen-states and energies of Eq. (1)

E = eigSt.computeEigenstates
%% 
% which gives
%%
% 
%  E =
%  
%    -2.954096176667686
%    -2.933903112075727
%    -2.148472642273518
%
%% 
% Again, because the eigen-state computation is performed with the (initial) 
% electronic structure in the DFT object REPLACE_WITH_DASH_DASH rather than self consistently REPLACE_WITH_DASH_DASH the 
% updated set of Kohn-Sham orbitals is not an eigen-state of the DFT Hamiltonian 
% opetrator. We can check this by displaying the orbital energies and errors

DFT.showEnergy('orbital');
%% 
% yielding
%%
% 
%    Orbital      Occ. (elec.)         Energy (-eV)               Error(a.u.)
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-      REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH         REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH               REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
%        1            2.00                34.483                   1.139e-01
%        2            2.00                34.097                   1.181e-01
%        3            1.00                13.625                   1.528e-01
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%
% Impose eigen-state symmetry
% We briefly modify the previous example to make it symmetric

% Domain and atomic centers
x   =   -20:.1:20;
A1  =   QMol_Va_softCoulomb('name','atom 1','charge',3,'position',-3);
A2  =   QMol_Va_softCoulomb('name','atom 2','charge',3,'position',3);

% DFT potential components
Vext=   QMol_DFT_Vext('atom',{A1,A2});
Vh  =   QMol_DFT_Vh_conv;
Vxc =   QMol_DFT_Vx_LDA_exp;

% Spin-restricted DFT model
DFT =   QMol_DFT_spinRes(                           ...
            'xspan',                        x,      ...
            'occupation',                   [2 2 1],...
            'externalPotential',            Vext,   ...
            'HartreePotential',             Vh,     ...
            'exchangeCorrelationPotential', Vxc);
DFT.initialize;
%% 
% Next, we create the eigen-state solver with a specific symmetry configuration 
% (2 symmetric and one antisymmetric states), |initialize| it, and access its 
% run-time documentation

eigSt = QMol_DFT_eigs('Symmetry','2 Sx + Ax');
eigSt.initialize(DFT);
eigSt.showDocumentation;
%% 
% yielding (note the added symmetry information as comapred to above)
%%
% 
%    * Eigen-state solver for DFT Hamiltonians           MATLAB eigs function
%      Tolerance  = 1e-12 
%      Max. iter. = 300
%      Basis dim. = 100
%      State sym. = 2 Sx + 1 Ax
%      V-01.21.000 (06/17/2024)                                     F. Mauger
%
%% 
% We can now compute the eigen-states and energies of Eq. (1)

E = eigSt.computeEigenstates
%% 
% which gives
%%
% 
%  E =
%  
%    -2.841467033665281
%    -2.837538418285015
%    -1.978965635739010
%
%% 
% One ore time, the result is not an eigen-state of the DFT Hamiltonian opetrator:

DFT.showEnergy('orbital');
%% 
% yielding
%%
% 
%    Orbital      Occ. (elec.)         Energy (-eV)               Error(a.u.)
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-      REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH         REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH               REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
%        1            2.00                34.481                   9.767e-02
%        2            2.00                34.374                   9.837e-02
%        3            1.00                13.425                   1.177e-01
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%
%% Test suite
% Run the test suite for the class in normal or <./Test_suite.html summary mode> 
% respectively with

QMol_test.test('DFT_eigs');
QMol_test.test('-summary','DFT_eigs');
%% For developers
% Other hidden class properties
% |QMol_DFT_eigs| defines a handful of additional transient and hidden properties 
% to facilitate and speed up computations. These properties cannot be edited with 
% the |set| method, nor by any function outisde of the object (|SetAccess=private| 
% attribute).
% |DFT|
% DFT-model object |[ [] (default) || <./QMol_DFT_spinPol.html |QMol_DFT_spinPol|> 
% |handle object || <./QMol_DFT_spinRes.html |QMol_DFT_spinRes|> |handle object 
% ]|
%% 
% * This is a copy of the <./DFT.html DFT-model> handle object passed to |initialize|. 
% * Un-initialized |QMol_DFT_eigs| objects, _i.e._, |isInitialized| |== false|, 
% have hempty |DFT.|
% |symState|
% Identified symmetry configuration |[ [] (default) | array | cell ]|
%% 
% * After a |QMol_DFT_eigs| object is |initialize|d, this describes the symmetry 
% configuration to impose in eigen-state computations.
% * For 1D models, |symState| is a 2-by-n matrix where each column specifies 
% (i) the number of states (first row) and (ii) the symmetry of the states (second 
% row), with -1 for antisymmetric, 0 for no symmetry imposed, and 1 for symmetric.
% * For spin-polarized models, |symState = {symState_up, symState_down}| specifies 
% the up- and down-spin symmetry configurations, respectively.
%% Notes
% The results displayed in this documentation page were generated using version 
% 01.21 of the QMol-grid package.
%% 
% * |QMol_DFT_eigs| was intorduced in version 01.00.
##### SOURCE END #####
-->
</div></body></html>