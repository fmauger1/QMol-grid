<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2024a"><title>QMol_DFT_eigs</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S3 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: center;  }
.S4 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.S5 { margin: 10px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 15px; font-weight: 700; text-align: left;  }
.S6 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S7 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block }
.S8 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0.666667px solid rgb(217, 217, 217); border-bottom: 0.666667px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S9 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S10 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0.666667px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S11 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0.666667px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S12 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S13 { border-left: 0px none rgb(33, 33, 33); border-right: 0px none rgb(33, 33, 33); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px; line-height: 15.6px; min-height: 16px; white-space: pre; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span style=' font-family: monospace;'>QMol_DFT_eigs</span></h1><div  class = 'S1'><span>Eigen-state solver for DFT models.</span></div><h2  class = 'S2'><span>Description</span></h2><div  class = 'S1'><span>Use </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> to compute the eigen states of a DFT Hamiltonian operator </span></div><div  class = 'S3' id = 'M_1D4E5B46' ><span texencoding="\hat{\mathcal{H}}_{\rm DFT}\left[\{\phi_k\}_k\right]\ \psi_l = E_l\ \psi_l,
\quad {\rm for} \quad l = 1, 2, \ldots
\quad\quad\quad(1)" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="330" height="24.5" /></span></div><div  class = 'S1'><span>where </span><span texencoding="\{\phi_k\}_k" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="36.5" height="19.5" /></span><span> are the Kohn-Sham orbitals of the DFT model and </span><span texencoding="\{\psi_l\}_l" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="32" height="19.5" /></span><span> are the eigen states, with eigen values </span><span texencoding="\{E_l\}_l" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="32.5" height="19.5" /></span><span>. The DFT-Hamiltonian operator is assumed Hermitian and </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> returns real-valued eigen values/states. Note that the eigenstates computed by </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> may not correspond to the system's molecular orbitals for which </span><span texencoding="\phi_k=\psi_k" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="49.5" height="19.5" /></span><span>. Those types of calculations are handled by a self-consistent-field (SCF) solver like </span><a href = "./QMol_DFT_SCF_Anderson.html"><span style=' font-family: monospace;'>QMol_DFT_SCF_Anderson</span></a><span>. </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> is a handle class.</span></div><div  class = 'S1'><span>Most users only create </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> object, with selected </span><a href = "#H_E9C49C16"><span>class properties</span></a><span>, to pass to the SCF solver without directly interacting with any of the </span><a href = "#H_5C9FA558"><span>class methods</span></a><span>.</span></div><h2  class = 'S2' id = 'H_E9C49C16' ><span>Class properties</span></h2><h3  class = 'S4' id = 'H_5E80E5B2' ><span>Eigen solver</span></h3><div  class = 'S1'><span>The eigen solver uses </span><span style=' font-family: monospace;'>MATLAB</span><span> </span><span style=' font-family: monospace;'>eigs</span><span> function and duplicates its options (using the same names); see the </span><span style=' font-family: monospace;'>eigs</span><span> documentation for details. Each eigen-solver property can be changed using the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method:</span></div><h4  class = 'S5'><span style=' font-family: monospace;'>IsFunctionSymmetric (issym)</span></h4><div  class = 'S1'><span>Symmetry of the DFT Hamiltonian operator </span><span style=' font-family: monospace;'>[ true (default) | false ]</span></div><ul  class = 'S6'><li  class = 'S7'><span>This property is only implemented for completeness and should always be </span><span style=' font-family: monospace;'>true</span><span>. Setting </span><span style=' font-family: monospace;'>IsFunctionSymmetric = false</span><span> triggers a warning and may lead to erroneous results.</span></li></ul><h4  class = 'S5'><span>Tolerance (tol)</span></h4><div  class = 'S1'><span>Convergence tolerance </span><span style=' font-family: monospace;'>[ nonnegative scalar (1e-12) ]</span></div><h4  class = 'S5'><span style=' font-family: monospace;'>MaxIterations (maxit)</span></h4><div  class = 'S1'><span>Maximum number of iterations </span><span style=' font-family: monospace;'>[ nonnegative integer (300) ]</span></div><h4  class = 'S5'><span style=' font-family: monospace;'>SubspaceDimension (p)</span></h4><div  class = 'S1'><span>Number of Lanczos basis vectors </span><span style=' font-family: monospace;'>[ nonnegative integer (100) ]</span></div><ul  class = 'S6'><li  class = 'S7'><span style=' font-family: monospace;'>SubspaceDimension</span><span> must be larger than the number of Kohn-Sham orbitals</span></li><li  class = 'S7'><span>If </span><span style=' font-family: monospace;'>SubspaceDimension</span><span> is too large -- larger than the effective dimension of the discrete problem -- </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> instead uses the problem's dimension.</span></li></ul><h4  class = 'S5'><span style=' font-family: monospace;'>Display (disp)</span></h4><div  class = 'S1'><span>Display diagnostic information </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S5'><span style=' font-family: monospace;'>Symmetry (sym)</span></h4><div  class = 'S1'><span>Symmetry of the eigen states </span><span style=' font-family: monospace;'>[ string | [] (default) ]</span></div><ul  class = 'S6'><li  class = 'S7'><span>For problems with a symmetric target, specify the symmetry of the wave functions. This can help converge SCF calculations.</span></li><li  class = 'S7'><span>Note that the specified symmetry </span><span style=' text-decoration: underline;'>must be trictly enforced in the discrete problem</span><span> -- </span><span style=' font-style: italic;'>i.e.</span><span>, a perfectly symmetric target that is exactly centered in the simulation domain (along the requested symmetry directions).</span></li><li  class = 'S7'><span style=' text-decoration: underline;'>For 1D models</span><span>, the syntax of the </span><span style=' font-family: monospace;'>Symmetry</span><span> option is </span><span style=' font-family: monospace;'>'# Sx + # Ax'</span><span>, where </span><span style=' font-family: monospace;'>#</span><span> specifies the umber of symmetric (</span><span style=' font-family: monospace;'>Sx</span><span>) and antisymmetric (</span><span style=' font-family: monospace;'>Ax</span><span>) eigen states. If only one state in the specified symmetry subspace is requested, the number </span><span style=' font-family: monospace;'>#</span><span> can be omitted (</span><span style=' font-family: monospace;'>'Sx'</span><span> is equivalent to </span><span style=' font-family: monospace;'>'1 Sx'</span><span>) and if no state is requested, the symmetry can be ignored altogether (</span><span style=' font-family: monospace;'>'# Sx'</span><span> alone is equivalent to </span><span style=' font-family: monospace;'>'# Sx + 0 Ax'</span><span>). The two symmetry subgroups can be specified in arbitrary order (</span><span style=' font-family: monospace;'>'# Sx + # Ax'</span><span> is equivalent to </span><span style=' font-family: monospace;'>'# Ax + # Sx'</span><span>). The sume of the number of states in each sub group should match the number of Kohn_sham orbitals in the DFT model.</span></li><li  class = 'S7'><span style=' text-decoration: underline;'>For spin-polarized DFT models</span><span>, specify the up- and down-spin symmetries in a cell </span><span style=' font-family: monospace;'>{Symmetry_up, Symmetry_down}</span><span> where each of the </span><span style=' font-family: monospace;'>Symmetry_up</span><span> and </span><span style=' font-family: monospace;'>Symmetry_down</span><span> strings follow the above-listed requirements.</span></li></ul><h3  class = 'S4'><span>Other properties</span></h3><div  class = 'S1'><span>To facilitate simulations, </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> defines a handful of additional transient properties. These </span><span style=' text-decoration: underline;'>cannot</span><span> be edited with the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method.</span></div><h4  class = 'S5' id = 'H_0ED64D82' ><span style=' font-family: monospace;'>isInitialized (isInit)</span></h4><div  class = 'S1'><span>Whether the eigen-solver object is properly initialized. This is used throughout the QMol-grid package to check that the object holds meaningful information and is ready for use.</span></div><h2  class = 'S2' id = 'H_5C9FA558' ><span>Class methods</span></h2><h3  class = 'S4'><span>Creation</span></h3><h4  class = 'S5'><span>constructor</span></h4><div  class = 'S1'><span>Create a DFT eigen-state solver object with empty class properties.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj = QMol_DFT_eigs;</span></span></div></div></div><div  class = 'S9'><span>Create a DFT eigen-state solver object with the </span><span style=' font-family: monospace;'>name</span><span> properties set to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_27AB3DA4"><span>DFT-model properties</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj = QMol_DFT_eigs(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >obj = QMol_DFT_eigs(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><h3  class = 'S4'><span>Changing class properties</span></h3><h4  class = 'S5' id = 'H_4405B79D' ><span style=' font-family: monospace;'>set</span></h4><div  class = 'S1'><span>Update the </span><span style=' font-family: monospace;'>name</span><span> properties of aDFT eigen-state solver object to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_5E80E5B2"><span>Eigen-solver properties</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.set(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >obj.set(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S9'><span>This is the common name-value pair assignment method used throughout the QMol-grid package. The </span><span style=' font-family: monospace;'>set</span><span> method also </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the class. After running, the </span><span style=' font-family: monospace;'>set</span><span> property updates the </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to a </span><span style=' font-family: monospace;'>false</span><span> value.</span></div><h4  class = 'S5' id = 'H_BF84FCE7' ><span style=' font-family: monospace;'>reset</span></h4><div  class = 'S1'><span>Reset the object by deleting/re-initializing all run-time properties of the class and updating the </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to </span><span style=' font-family: monospace;'>false</span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.reset;</span></span></div></div></div><ul  class = 'S6'><li  class = 'S7'><span>This is the common </span><span style=' font-family: monospace;'>reset</span><span> method available to all classes throughout the QMol-grid package.</span></li></ul><h4  class = 'S5' id = 'H_C729A888' ><span style=' font-family: monospace;'>clear</span></h4><div  class = 'S1'><span>Clear all class properties</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.clear;</span></span></div></div></div><div  class = 'S9'><span>Clear a specific set of the class properties. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_5E80E5B2"><span>Eigen-solver properties</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.clear(name1,name2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S9'><span>This is the common </span><span style=' font-family: monospace;'>clear</span><span> method available to all classes throughout the QMol-grid package. The </span><span style=' font-family: monospace;'>clear</span><span> method also </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the class.</span></div><h3  class = 'S4'><span>Initializing the object</span></h3><h4  class = 'S5' id = 'H_85EFED0A' ><span style=' font-family: monospace;'>initialize</span></h4><div  class = 'S1'><span>Initialize a </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> object and set the </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to </span><span style=' font-family: monospace;'>true</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.initialize(DFT);</span></span></div></div></div><ul  class = 'S6'><li  class = 'S7'><span style=' font-family: monospace;'>DFT</span><span> is the </span><a href = "./DFT.html"><span>DFT-model</span></a><span> handle object, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "./QMol_DFT_spinPol.html"><span style=' font-family: monospace;'>QMol_DFT_spinPol</span></a><span style=' font-family: monospace;'> </span><span>or </span><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span>, that describes the DFT Hamiltonian operator of Eq. (</span><a href = "#M_1D4E5B46"><span>1</span></a><span>)</span></li><li  class = 'S7'><span>To avoid any mismatch in internal properties, </span><span style=' font-family: monospace;'>initialize</span><span> first </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the object before performing the initialization</span></li></ul><h3  class = 'S4'><span>Run-time documentation</span></h3><h4  class = 'S5' id = 'H_4D7CFC3D' ><span style=' font-family: monospace;'>showDocumentation</span></h4><div  class = 'S1'><span>Display the run-time documentation for the specific configuration of a </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> object, which must have been </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d beforehand</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >ref = obj.showDocumentation;</span></span></div></div></div><ul  class = 'S6'><li  class = 'S7'><span>The output </span><span style=' font-family: monospace;'>ref</span><span> is a cell vector containing the list of references to be included in the bibliography.</span></li></ul><h3  class = 'S4'><span>Eigen-state computation</span></h3><h4  class = 'S5'><span style=' font-family: monospace;'>computeEigenstates</span></h4><div  class = 'S1'><span>Compute the eigen states and energies of Eq. (</span><a href = "#M_1D4E5B46"><span>1</span></a><span>) with either</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >E = obj.computeEigenstates;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >E = obj.computeEigenstates([]);</span></span></div></div></div><ul  class = 'S6'><li  class = 'S7'><span>For spin-restricted DFT models, </span><span style=' font-family: monospace;'>E</span><span> is a vectors containing the respective energies of the computed eigen states. For spin-polarized DFT models, </span><span style=' font-family: monospace;'>E = {E_up,E_down}</span><span> are the up- and down-spin channel energies, respectively.</span></li><li  class = 'S7'><span>Note that only the energies are returned; the eigen states are stored in the DFT object used to </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span> the object, i.e., </span><span style=' text-decoration: underline; font-family: monospace;'>computeEigenstates</span><span style=' text-decoration: underline;'> overwrites the DFT-model Kohn sham orbitals</span><span>.</span></li><li  class = 'S7'><span>This forces the computation of the computation of the DFT-model Kohn-Sham potential.</span></li></ul><div  class = 'S1'><span>Specify the Kohn-Sham potential to use in the eigen-state computation with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >E = obj.computeEigenstates(Vks);</span></span></div></div></div><ul  class = 'S6'><li  class = 'S7'><span style=' font-family: monospace;'>Vks</span><span> is a compatible Kohn-Sham potential</span></li></ul><h2  class = 'S2'><span>Examples</span></h2><h3  class = 'S4'><span>Simple eigen-state computation</span></h3><div  class = 'S1'><span>First we create a spin-restricred DFT models</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #008013;">% Domain and atomic centers</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >x   =   -20:.1:15;</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >A1  =   QMol_Va_softCoulomb(</span><span style="color: #a709f5;">'name'</span><span >,</span><span style="color: #a709f5;">'atom 1'</span><span >,</span><span style="color: #a709f5;">'charge'</span><span >,3,</span><span style="color: #a709f5;">'position'</span><span >,-3);</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >A2  =   QMol_Va_softCoulomb(</span><span style="color: #a709f5;">'name'</span><span >,</span><span style="color: #a709f5;">'atom 2'</span><span >,</span><span style="color: #a709f5;">'charge'</span><span >,3,</span><span style="color: #a709f5;">'position'</span><span >,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span style="color: #008013;">% DFT potential components</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >Vext=   QMol_DFT_Vext(</span><span style="color: #a709f5;">'atom'</span><span >,{A1,A2});</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >Vh  =   QMol_DFT_Vh_conv;</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >Vxc =   QMol_DFT_Vx_LDA_exp;</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span style="color: #008013;">% Spin-restricted DFT model</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >DFT =   QMol_DFT_spinRes(                           </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'xspan'</span><span >,                        x,      </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'occupation'</span><span >,                   [2 2 1],</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'externalPotential'</span><span >,            Vext,   </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'HartreePotential'</span><span >,             Vh,     </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'exchangeCorrelationPotential'</span><span >, Vxc);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >DFT.initialize;</span></span></div></div></div><div  class = 'S9'><span>Next, we create the eigen-state solver object, </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span> it, and access its run-time documentation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >eigSt = QMol_DFT_eigs;</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >eigSt.initialize(DFT);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >eigSt.showDocumentation;</span></span></div></div></div><div  class = 'S9'><span>yielding</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S13'><span style="white-space: pre"><span >  * Eigen-state solver for DFT Hamiltonians           MATLAB eigs function</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >    Tolerance  = 1e-12 </span></span></div><div  class = 'S13'><span style="white-space: pre"><span >    Max. iter. = 300</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >    Basis dim. = 100</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >    V-01.21.000 (06/17/2024)                                     F. Mauger</span></span></div></div><div  class = 'S1'><span>We can now compute the eigen-states and energies of Eq. (</span><a href = "#M_1D4E5B46"><span>1</span></a><span>)</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >E = eigSt.computeEigenstates</span></span></div></div></div><div  class = 'S9'><span>which gives</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S13'><span style="white-space: pre"><span >E =</span></span></div><div  class = 'S13'>&nbsp;</div><div  class = 'S13'><span style="white-space: pre"><span >  -2.954096176667686</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >  -2.933903112075727</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >  -2.148472642273518</span></span></div></div><div  class = 'S1'><span>Again, because the eigen-state computation is performed with the (initial) electronic structure in the DFT object -- rather than self consistently -- the updated set of Kohn-Sham orbitals is not an eigen-state of the DFT Hamiltonian opetrator. We can check this by displaying the orbital energies and errors</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >DFT.showEnergy(</span><span style="color: #a709f5;">'orbital'</span><span >);</span></span></div></div></div><div  class = 'S9'><span>yielding</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S13'><span style="white-space: pre"><span >  Orbital      Occ. (elec.)         Energy (-eV)               Error(a.u.)</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >  -------      ------------         ------------               -----------</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >      1            2.00                34.483                   1.139e-01</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >      2            2.00                34.097                   1.181e-01</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >      3            1.00                13.625                   1.528e-01</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >  ------------------------------------------------------------------------</span></span></div></div><h3  class = 'S4'><span>Impose eigen-state symmetry</span></h3><div  class = 'S1'><span>We briefly modify the previous example to make it symmetric</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #008013;">% Domain and atomic centers</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >x   =   -20:.1:20;</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >A1  =   QMol_Va_softCoulomb(</span><span style="color: #a709f5;">'name'</span><span >,</span><span style="color: #a709f5;">'atom 1'</span><span >,</span><span style="color: #a709f5;">'charge'</span><span >,3,</span><span style="color: #a709f5;">'position'</span><span >,-3);</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >A2  =   QMol_Va_softCoulomb(</span><span style="color: #a709f5;">'name'</span><span >,</span><span style="color: #a709f5;">'atom 2'</span><span >,</span><span style="color: #a709f5;">'charge'</span><span >,3,</span><span style="color: #a709f5;">'position'</span><span >,3);</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span style="color: #008013;">% DFT potential components</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >Vext=   QMol_DFT_Vext(</span><span style="color: #a709f5;">'atom'</span><span >,{A1,A2});</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >Vh  =   QMol_DFT_Vh_conv;</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >Vxc =   QMol_DFT_Vx_LDA_exp;</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span style="color: #008013;">% Spin-restricted DFT model</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >DFT =   QMol_DFT_spinRes(                           </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'xspan'</span><span >,                        x,      </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'occupation'</span><span >,                   [2 2 1],</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'externalPotential'</span><span >,            Vext,   </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'HartreePotential'</span><span >,             Vh,     </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >            </span><span style="color: #a709f5;">'exchangeCorrelationPotential'</span><span >, Vxc);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >DFT.initialize;</span></span></div></div></div><div  class = 'S9'><span>Next, we create the eigen-state solver with a specific symmetry configuration (2 symmetric and one antisymmetric states), </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span> it, and access its run-time documentation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >eigSt = QMol_DFT_eigs(</span><span style="color: #a709f5;">'Symmetry'</span><span >,</span><span style="color: #a709f5;">'2 Sx + Ax'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >eigSt.initialize(DFT);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >eigSt.showDocumentation;</span></span></div></div></div><div  class = 'S9'><span>yielding (note the added symmetry information as compared to </span><a href = "#M_CDBC23A0"><span>above</span></a><span>)</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S13'><span style="white-space: pre"><span >  * Eigen-state solver for DFT Hamiltonians           MATLAB eigs function</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >    Tolerance  = 1e-12 </span></span></div><div  class = 'S13'><span style="white-space: pre"><span >    Max. iter. = 300</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >    Basis dim. = 100</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >    State sym. = 2 Sx + 1 Ax</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >    V-01.21.000 (06/17/2024)                                     F. Mauger</span></span></div></div><div  class = 'S1'><span>We can now compute the eigen-states and energies of Eq. (</span><a href = "#M_1D4E5B46"><span>1</span></a><span>)</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >E = eigSt.computeEigenstates</span></span></div></div></div><div  class = 'S9'><span>which gives</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S13'><span style="white-space: pre"><span >E =</span></span></div><div  class = 'S13'>&nbsp;</div><div  class = 'S13'><span style="white-space: pre"><span >  -2.841467033665281</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >  -2.837538418285015</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >  -1.978965635739010</span></span></div></div><div  class = 'S1'><span>One ore time, the result is not an eigen-state of the DFT Hamiltonian opetrator:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >DFT.showEnergy(</span><span style="color: #a709f5;">'orbital'</span><span >);</span></span></div></div></div><div  class = 'S9'><span>yielding</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S13'><span style="white-space: pre"><span >  Orbital      Occ. (elec.)         Energy (-eV)               Error(a.u.)</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >  -------      ------------         ------------               -----------</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >      1            2.00                34.481                   9.767e-02</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >      2            2.00                34.374                   9.837e-02</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >      3            1.00                13.425                   1.177e-01</span></span></div><div  class = 'S13'><span style="white-space: pre"><span >  ------------------------------------------------------------------------</span></span></div></div><h2  class = 'S2'><span>Test suite</span></h2><div  class = 'S1'><span>Run the test suite for the class in normal or </span><a href = "./Test_suite.html"><span>summary mode</span></a><span> respectively with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'DFT_eigs'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'-summary'</span><span >,</span><span style="color: #a709f5;">'DFT_eigs'</span><span >);</span></span></div></div></div><h2  class = 'S2'><span>For developers</span></h2><h3  class = 'S4'><span>Other hidden class properties</span></h3><div  class = 'S1'><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> defines a handful of additional transient and hidden properties to facilitate and speed up computations. These properties cannot be edited with the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method, nor by any function outside of the object (</span><span style=' font-family: monospace;'>SetAccess=private</span><span> attribute).</span></div><h4  class = 'S5' id = 'H_37454CF9' ><span style=' font-family: monospace;'>DFT</span></h4><div  class = 'S1'><span>DFT-model object </span><span style=' font-family: monospace;'>[ [] (default) | </span><a href = "./QMol_DFT_spinPol.html"><span style=' font-family: monospace;'>QMol_DFT_spinPol</span></a><span style=' font-family: monospace;'> handle object | </span><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span style=' font-family: monospace;'> handle object ]</span></div><ul  class = 'S6'><li  class = 'S7'><span>This is a copy of the </span><a href = "./DFT.html"><span>DFT-model</span></a><span> handle object passed to </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>. </span></li><li  class = 'S7'><span>Un-initialized </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> objects, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span style=' font-family: monospace;'> == false</span><span>, have empty </span><span style=' font-family: monospace;'>DFT.</span></li></ul><h4  class = 'S5'><span style=' font-family: monospace;'>symState</span></h4><div  class = 'S1'><span>Identified symmetry configuration </span><span style=' font-family: monospace;'>[ [] (default) | array | cell ]</span></div><ul  class = 'S6'><li  class = 'S7'><span>After a </span><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> object is </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d, this describes the symmetry configuration to impose in eigen-state computations.</span></li><li  class = 'S7'><span style=' text-decoration: underline;'>For 1D models</span><span>, </span><span style=' font-family: monospace;'>symState</span><span> is a 2-by-n matrix where each column specifies (i) the number of states (first row) and (ii) the symmetry of the states (second row), with -1 for antisymmetric, 0 for no symmetry imposed, and 1 for symmetric.</span></li><li  class = 'S7'><span style=' text-decoration: underline;'>For spin-polarized models</span><span>, </span><span style=' font-family: monospace;'>symState = {symState_up, symState_down}</span><span> specifies the up- and down-spin symmetry configurations, respectively.</span></li></ul><h2  class = 'S2'><span>Notes</span></h2><div  class = 'S1'><span>The results displayed in this documentation page were generated using version 01.21 of the QMol-grid package.</span></div><ul  class = 'S6'><li  class = 'S7'><span style=' font-family: monospace;'>QMol_DFT_eigs</span><span> was introduced in version 01.00.</span></li></ul>
<br>
<!-- 
##### SOURCE BEGIN #####
%% |QMol_DFT_eigs|
% Eigen-state solver for DFT models.
%% Description
% Use |QMol_DFT_eigs| to compute the eigen states of a DFT Hamiltonian operator 
% 
% $$\hat{\mathcal{H}}_{\rm DFT}\left[\{\phi_k\}_k\right]\ \psi_l = E_l\ \psi_l,\quad 
% {\rm for} \quad l = 1, 2, \ldots\quad\quad\quad(1)$$
% 
% where $\{\phi_k\}_k$ are the Kohn-Sham orbitals of the DFT model and $\{\psi_l\}_l$ 
% are the eigen states, with eigen values $\{E_l\}_l$. The DFT-Hamiltonian operator 
% is assumed Hermitian and |QMol_DFT_eigs| returns real-valued eigen values/states. 
% Note that the eigenstates computed by |QMol_DFT_eigs| may not correspond to 
% the system's molecular orbitals for which $\phi_k=\psi_k$. Those types of calculations 
% are handled by a self-consistent-field (SCF) solver like <./QMol_DFT_SCF_Anderson.html 
% |QMol_DFT_SCF_Anderson|>. |QMol_DFT_eigs| is a handle class.
% 
% Most users only create |QMol_DFT_eigs| object, with selected class properties, 
% to pass to the SCF solver without directly interacting with any of the class 
% methods.
%% Class properties
% Eigen solver
% The eigen solver uses |MATLAB| |eigs| function and duplicates its options 
% (using the same names); see the |eigs| documentation for details. Each eigen-solver 
% property can be changed using the |set| method:
% |IsFunctionSymmetric (issym)|
% Symmetry of the DFT Hamiltonian operator |[ true (default) | false ]|
%% 
% * This property is only implemented for completeness and should always be 
% |true|. Setting |IsFunctionSymmetric = false| triggers a warning and may lead 
% to erroneous results.
% Tolerance (tol)
% Convergence tolerance |[ nonnegative scalar (1e-12) ]|
% |MaxIterations (maxit)|
% Maximum number of iterations |[ nonnegative integer (300) ]|
% |SubspaceDimension (p)|
% Number of Lanczos basis vectors |[ nonnegative integer (100) ]|
%% 
% * |SubspaceDimension| must be larger than the number of Kohn-Sham orbitals
% * If |SubspaceDimension| is too large REPLACE_WITH_DASH_DASH larger than the effective dimension 
% of the discrete problem REPLACE_WITH_DASH_DASH |QMol_DFT_eigs| instead uses the problem's dimension.
% |Display (disp)|
% Display diagnostic information |[ true | false (default) ]|
% |Symmetry (sym)|
% Symmetry of the eigen states |[ string | [] (default) ]|
%% 
% * For problems with a symmetric target, specify the symmetry of the wave functions. 
% This can help converge SCF calculations.
% * Note that the specified symmetry must be trictly enforced in the discrete 
% problem REPLACE_WITH_DASH_DASH _i.e._, a perfectly symmetric target that is exactly centered in 
% the simulation domain (along the requested symmetry directions).
% * For 1D models, the syntax of the |Symmetry| option is |'# Sx + # Ax'|, where 
% |#| specifies the umber of symmetric (|Sx|) and antisymmetric (|Ax|) eigen states. 
% If only one state in the specified symmetry subspace is requested, the number 
% |#| can be omitted (|'Sx'| is equivalent to |'1 Sx'|) and if no state is requested, 
% the symmetry can be ignored altogether (|'# Sx'| alone is equivalent to |'# 
% Sx + 0 Ax'|). The two symmetry subgroups can be specified in arbitrary order 
% (|'# Sx + # Ax'| is equivalent to |'# Ax + # Sx'|). The sume of the number of 
% states in each sub group should match the number of Kohn_sham orbitals in the 
% DFT model.
% * For spin-polarized DFT models, specify the up- and down-spin symmetries 
% in a cell |{Symmetry_up, Symmetry_down}| where each of the |Symmetry_up| and 
% |Symmetry_down| strings follow the above-listed requirements.
% Other properties
% To facilitate simulations, |QMol_DFT_eigs| defines a handful of additional 
% transient properties. These cannot be edited with the |set| method.
% |isInitialized (isInit)|
% Whether the eigen-solver object is properly initialized. This is used throughout 
% the QMol-grid package to check that the object holds meaningful information 
% and is ready for use.
%% Class methods
% Creation
% constructor
% Create a DFT eigen-state solver object with empty class properties.

obj = QMol_DFT_eigs;
%% 
% Create a DFT eigen-state solver object with the |name| properties set to the 
% specified |value|. Several |name-value| pairs can be specified consecutively. 
% Suitable |name| is any of the DFT-model properties and is case insensitive.

obj = QMol_DFT_eigs(name1,value1);
obj = QMol_DFT_eigs(name1,value1,name2,value2,___);
% Changing class properties
% |set|
% Update the |name| properties of aDFT eigen-state solver object to the specified 
% |value|. Several |name-value| pairs can be specified consecutively. Suitable 
% |name| is any of the Eigen-solver properties and is case insensitive.

obj.set(name1,value1);
obj.set(name1,value1,name2,value2,___);
%% 
% This is the common name-value pair assignment method used throughout the QMol-grid 
% package. The |set| method also |reset| the class. After running, the |set| property 
% updates the |isInitialized| flag to a |false| value.
% |reset|
% Reset the object by deleting/re-initializing all run-time properties of the 
% class and updating the |isInitialized| flag to |false|.

obj.reset;
%% 
% * This is the common |reset| method available to all classes throughout the 
% QMol-grid package.
% |clear|
% Clear all class properties

obj.clear;
%% 
% Clear a specific set of the class properties. Suitable |name| is any of the 
% Eigen-solver properties and is case insensitive.

obj.clear(name1,name2,___);
%% 
% This is the common |clear| method available to all classes throughout the 
% QMol-grid package. The |clear| method also |reset| the class.
% Initializing the object
% |initialize|
% Initialize a |QMol_DFT_eigs| object and set the |isInitialized| flag to |true|

obj.initialize(DFT);
%% 
% * |DFT| is the <./DFT.html DFT-model> handle object, _i.e._, <./QMol_DFT_spinPol.html 
% |QMol_DFT_spinPol|> or <./QMol_DFT_spinRes.html |QMol_DFT_spinRes|>, that describes 
% the DFT Hamiltonian operator of Eq. (1)
% * To avoid any mismatch in internal properties, |initialize| first |reset| 
% the object before performing the initialization
% Run-time documentation
% |showDocumentation|
% Display the run-time documentation for the specific configuration of a |QMol_DFT_eigs| 
% object, which must have been |initialize|d beforehand

ref = obj.showDocumentation;
%% 
% * The output |ref| is a cell vector containing the list of references to be 
% included in the bibliography.
% Eigen-state computation
% |computeEigenstates|
% Compute the eigen states and energies of Eq. (1) with either

E = obj.computeEigenstates;
E = obj.computeEigenstates([]);
%% 
% * For spin-restricted DFT models, |E| is a vectors containing the respective 
% energies of the computed eigen states. For spin-polarized DFT models, |E = {E_up,E_down}| 
% are the up- and down-spin channel energies, respectively.
% * Note that only the energies are returned; the eigen states are stored in 
% the DFT object used to |initialize| the object, i.e., |computeEigenstates| overwrites 
% the DFT-model Kohn sham orbitals.
% * This forces the computation of the computation of the DFT-model Kohn-Sham 
% potential.
%% 
% Specify the Kohn-Sham potential to use in the eigen-state computation with

E = obj.computeEigenstates(Vks);
%% 
% * |Vks| is a compatible Kohn-Sham potential
%% Examples
% Simple eigen-state computation
% First we create a spin-restricred DFT models

% Domain and atomic centers
x   =   -20:.1:15;
A1  =   QMol_Va_softCoulomb('name','atom 1','charge',3,'position',-3);
A2  =   QMol_Va_softCoulomb('name','atom 2','charge',3,'position',2);

% DFT potential components
Vext=   QMol_DFT_Vext('atom',{A1,A2});
Vh  =   QMol_DFT_Vh_conv;
Vxc =   QMol_DFT_Vx_LDA_exp;

% Spin-restricted DFT model
DFT =   QMol_DFT_spinRes(                           ...
            'xspan',                        x,      ...
            'occupation',                   [2 2 1],...
            'externalPotential',            Vext,   ...
            'HartreePotential',             Vh,     ...
            'exchangeCorrelationPotential', Vxc);
DFT.initialize;
%% 
% Next, we create the eigen-state solver object, |initialize| it, and access 
% its run-time documentation

eigSt = QMol_DFT_eigs;
eigSt.initialize(DFT);
eigSt.showDocumentation;
%% 
% yielding
%%
% 
%    * Eigen-state solver for DFT Hamiltonians           MATLAB eigs function
%      Tolerance  = 1e-12 
%      Max. iter. = 300
%      Basis dim. = 100
%      V-01.21.000 (06/17/2024)                                     F. Mauger
%
%% 
% We can now compute the eigen-states and energies of Eq. (1)

E = eigSt.computeEigenstates
%% 
% which gives
%%
% 
%  E =
%  
%    -2.954096176667686
%    -2.933903112075727
%    -2.148472642273518
%
%% 
% Again, because the eigen-state computation is performed with the (initial) 
% electronic structure in the DFT object REPLACE_WITH_DASH_DASH rather than self consistently REPLACE_WITH_DASH_DASH the 
% updated set of Kohn-Sham orbitals is not an eigen-state of the DFT Hamiltonian 
% opetrator. We can check this by displaying the orbital energies and errors

DFT.showEnergy('orbital');
%% 
% yielding
%%
% 
%    Orbital      Occ. (elec.)         Energy (-eV)               Error(a.u.)
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-      REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH         REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH               REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
%        1            2.00                34.483                   1.139e-01
%        2            2.00                34.097                   1.181e-01
%        3            1.00                13.625                   1.528e-01
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%
% Impose eigen-state symmetry
% We briefly modify the previous example to make it symmetric

% Domain and atomic centers
x   =   -20:.1:20;
A1  =   QMol_Va_softCoulomb('name','atom 1','charge',3,'position',-3);
A2  =   QMol_Va_softCoulomb('name','atom 2','charge',3,'position',3);

% DFT potential components
Vext=   QMol_DFT_Vext('atom',{A1,A2});
Vh  =   QMol_DFT_Vh_conv;
Vxc =   QMol_DFT_Vx_LDA_exp;

% Spin-restricted DFT model
DFT =   QMol_DFT_spinRes(                           ...
            'xspan',                        x,      ...
            'occupation',                   [2 2 1],...
            'externalPotential',            Vext,   ...
            'HartreePotential',             Vh,     ...
            'exchangeCorrelationPotential', Vxc);
DFT.initialize;
%% 
% Next, we create the eigen-state solver with a specific symmetry configuration 
% (2 symmetric and one antisymmetric states), |initialize| it, and access its 
% run-time documentation

eigSt = QMol_DFT_eigs('Symmetry','2 Sx + Ax');
eigSt.initialize(DFT);
eigSt.showDocumentation;
%% 
% yielding (note the added symmetry information as compared to above)
%%
% 
%    * Eigen-state solver for DFT Hamiltonians           MATLAB eigs function
%      Tolerance  = 1e-12 
%      Max. iter. = 300
%      Basis dim. = 100
%      State sym. = 2 Sx + 1 Ax
%      V-01.21.000 (06/17/2024)                                     F. Mauger
%
%% 
% We can now compute the eigen-states and energies of Eq. (1)

E = eigSt.computeEigenstates
%% 
% which gives
%%
% 
%  E =
%  
%    -2.841467033665281
%    -2.837538418285015
%    -1.978965635739010
%
%% 
% One ore time, the result is not an eigen-state of the DFT Hamiltonian opetrator:

DFT.showEnergy('orbital');
%% 
% yielding
%%
% 
%    Orbital      Occ. (elec.)         Energy (-eV)               Error(a.u.)
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-      REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH         REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH               REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
%        1            2.00                34.481                   9.767e-02
%        2            2.00                34.374                   9.837e-02
%        3            1.00                13.425                   1.177e-01
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%
%% Test suite
% Run the test suite for the class in normal or <./Test_suite.html summary mode> 
% respectively with

QMol_test.test('DFT_eigs');
QMol_test.test('-summary','DFT_eigs');
%% For developers
% Other hidden class properties
% |QMol_DFT_eigs| defines a handful of additional transient and hidden properties 
% to facilitate and speed up computations. These properties cannot be edited with 
% the |set| method, nor by any function outside of the object (|SetAccess=private| 
% attribute).
% |DFT|
% DFT-model object |[ [] (default) || <./QMol_DFT_spinPol.html |QMol_DFT_spinPol|> 
% |handle object || <./QMol_DFT_spinRes.html |QMol_DFT_spinRes|> |handle object 
% ]|
%% 
% * This is a copy of the <./DFT.html DFT-model> handle object passed to |initialize|. 
% * Un-initialized |QMol_DFT_eigs| objects, _i.e._, |isInitialized| |== false|, 
% have empty |DFT.|
% |symState|
% Identified symmetry configuration |[ [] (default) | array | cell ]|
%% 
% * After a |QMol_DFT_eigs| object is |initialize|d, this describes the symmetry 
% configuration to impose in eigen-state computations.
% * For 1D models, |symState| is a 2-by-n matrix where each column specifies 
% (i) the number of states (first row) and (ii) the symmetry of the states (second 
% row), with -1 for antisymmetric, 0 for no symmetry imposed, and 1 for symmetric.
% * For spin-polarized models, |symState = {symState_up, symState_down}| specifies 
% the up- and down-spin symmetry configurations, respectively.
%% Notes
% The results displayed in this documentation page were generated using version 
% 01.21 of the QMol-grid package.
%% 
% * |QMol_DFT_eigs| was introduced in version 01.00.
##### SOURCE END #####
-->
</div></body></html>