<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2024a"><title>QMol_TDDFT_abs_mask</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S3 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.S4 { margin: 10px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 15px; font-weight: 700; text-align: left;  }
.S5 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S6 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block }
.S7 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0.666667px solid rgb(217, 217, 217); border-bottom: 0.666667px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S9 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0.666667px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S10 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0.666667px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S11 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S12 { border-left: 0px none rgb(33, 33, 33); border-right: 0px none rgb(33, 33, 33); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px; line-height: 15.6px; min-height: 16px; white-space: pre; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span style=' font-family: monospace;'>QMol_TDDFT_abs_mask</span></h1><div  class = 'S1'><span>Absorbing boundaries using a mask function at the edges of the discretization domain. </span></div><h2  class = 'S2'><span>Description</span></h2><div  class = 'S1'><span>Use </span><span style=' font-family: monospace;'>QMol_TDDFT_abs_mask</span><span> to describe absorbing boundaries with a mask function. After each </span><a href = "./TDDFT.html"><span>TDDFT</span></a><span> propagation time step the Kohn-Sham orbitals in the attached </span><a href = "./DFT.html"><span>DFT model</span></a><span> are multiplied by the mask function. </span></div><h2  class = 'S2'><span>Class properties</span></h2><h3  class = 'S3' id = 'H_9E118FF3' ><span>Mask function</span></h3><div  class = 'S1'><span>The </span><span style=' font-family: monospace;'>QMol_TDDFT_abs_mask</span><span> class defines the following public get-access properties; each can be changed using the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method:</span></div><h4  class = 'S4' id = 'H_802F3E68' ><span style=' font-family: monospace;'>length (L)</span></h4><div  class = 'S1'><span>Length of the absorbing region at the edges of the domain discretization </span><span style=' font-family: monospace;'>[ positive scalar (default 10) | positive two-vector ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>Scalar </span><span style=' font-family: monospace;'>length</span><span> defines a mask function with the same length on both sides of the discretization domain.</span></li><li  class = 'S6'><span style=' font-family: monospace;'>length = [L_left, L_right]</span><span> independently specifies the mask function length on each side of the domain.</span></li><li  class = 'S6'><span>Note: The mask function is defined inward from the two ends of the </span><a href = "./DFT.html"><span>DFT model</span></a><span> discretization domain, which should therefore budget for this.</span></li></ul><h4  class = 'S4'><span style=' font-family: monospace;'>shape</span></h4><div  class = 'S1'><span>Shape of the mask function </span><span style=' font-family: monospace;'>[ 'cos^1/8' (default) | 'cos^2' | function handle ]</span></div><ul  class = 'S5'><li  class = 'S6'><span style=' font-family: monospace;'>'cos^1/8'</span><span> uses a </span><span texencoding="\cos^{1/8}" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="36.5" height="20" /></span><span>-shaped mask function</span></li><li  class = 'S6'><span style=' font-family: monospace;'>'cos^2'</span><span> uses a </span><span texencoding="\cos^{2}" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADkAAAAoCAYAAABEklK7AAAAAXNSR0IArs4c6QAABilJREFUaEPtmHmME1Ucx7+/N9MurLLxiGKguzPzWjWu0ah4/OFFFK+IYEwAxWBQMB6RsFHxSsTgiUcMHhgR73gfRIz3FSJq4pVooqts2teZtaJEohh0Odq+n/mRqRlKCwuamOL2r6Z97zfv8zu/bwj/gw/9DxgxBLmzRHkokkOR/A89EASBx8y3EdGpAHZn5i+Z+fooit4GYOuP1nLpmsvlDqxWqy8B+JqIVjDzGAAnx2Azi8Xiky0Nmcvl2qy1CwB8Zox5HAADIK31dGZeBOALx3Em5vP5X5KgLRVJz/MCpVTPhg0brl25cuVADSSTyezhuu6LRJS11p4WRdF3LQvZ3d2dXrNmjZsEFJhRo0a1p9PpxUTUXS6Xx5dKpR9bFrJZr/N9fzcieoGZf3Bd99J8Pr9hp4MMguBgZl6ilLrIGPN+SzeeRpEcO3as29/ffxeA37u6um5atmxZZaeD9H3/FCKaNHz48J7e3t4/GjmipbprPYDv+0cR0Sxr7Zwoin5qVrMtCxmLgrnW2p6tAQp4S0I2A5T6jKKox1r7chRFxVpktwaptNZjrLUXE9G+AHZjZgXgVQAPhWEYNkqPzs7OUa7rXgBgHIBdAMjeTwE8PTAw8PKqVav+bLBP+b5/HBFdAmANgDKA/QC8C2CAmR8Jw3C97AuCYH8ATzJzXimVT9qKJd73nuddk2xADSFzuVxHtVq9BcCRRDTTGPONGNNaT2XmpwD8JsVe167FKecw890AbnQc52GZVyNHjtylvb39cgDXM3OfUup8Y8znycMFQXAeM891HOfMQqGw6VmjR4/es62t7X5rrd24ceOFIgC01l3M/AyAo5vU31ql1KmFQuGTrc5JUQ/Dhg1baK09Qil1ljGmr7YhllWvAzhAvMzMk8MwFM//rR+Z+S7f9+cmPSlpFIbhjUR0LYA+x3HOyufz34rdXC63V7VaXcrMxRpM4nmHKaXmp1KpqX19fat39OKzRSSDIJgkqQVgXrFYvDUWwZvsxzl/OwCJzFtEdLYx5vdcLpetVCpLiUg8fVIYhpKem31kTbVafUPSkIgWKaVmS6Q9zztAKfUmgF+VUhMLhcIPtY3d3d27rl+//ibXdW/51yDF6MDAwBNEdAYRnWCM+aj+sAKaz+c7Ojo6/ujt7d0o//u+fzYRPQvgq0baMY5YW6VSeYCIpF6jmpCOa3gpgMOJ6Dlm7ikWi6tqz9Va76uU6q+XatsT1c0iqbXez1r7BhG5jdR8E8MUBMEdAK6UBpNKpcY387rv+7OJSK5KIKJxcU3L/ssA3Bvb/5mIrlNKPfNPwJrWpNb6GGb+AMDKwUImbgBTtwWptT6Rmd+LIWcYYx6V75lMZngqlZoHYE7icMuJ6ApjzBfJktmeCNbWbhZJ3/ePJ6Jl0sKbpWv9Q+ogv7PWnp6cUcn1CfsSyb8h4zUyRiYTkWRFZ/ybjJLrPM9b0EiTDhZ4M0jP8w5VSr0FYG+pjTAM7xmMIa31fGa+GsDaZo0nrt1tOjEeObNl5AAYFs/Mhq81BnO2TVmTXJjJZEanUqnXABwC4ENmnhKG4c8NjEkdnUtEoTQnrfXpzCz7sDXnaK0vkMGebFDZbDbHzMcaYx5LPidWNZLORwJYmk6np61YsWLtYMGa1mTdiJB1d5bL5RtKpdK65Ka4tiY4jnOVNAff9/choucBHCc1XalUJpVKpV+Te2LbIhRmAbjZ87x5koIyQojoyvb29tn1twjf9ycS0SsAPi6XyxPqbQ4WeIs5GXtwSSyrxM478vovnU5/U6lU2q210wFMdl13Sm2gy6IY/EUAuxKRXF5rL5o2nSUxD0Nr7Tk1UR3/LhfeGfVKJdGo7vY87+odrcuGsi42LvJtnwbeigBMKxaLy+v+kxQeL7oWgLxVmxFFkcw/m81mO6219zHzCGaemWxMSXil1LSaGJCZvW7duoUAskQ01RjTP9jI1a9rKtC7urq04zjSTCbEsKLqBXxhcljXGwyCYCSACwGIchoB4BdmXk1EDzqO80797JOalOxgZnmNKPdDSXN5R3NQLB0Xx9JxRxlb86q1vbQteZ8cgmw077bXK624fihdWzFqjc48FMmdJZJ/AZ/3D1bhHZ3jAAAAAElFTkSuQmCC" width="28.5" height="20" /></span><span>-shaped mask function</span></li><li  class = 'S6'><span>A function handle enables user-defined mask function, with the signature </span><span style=' font-family: monospace;'>@(x) fun(x)</span><span>. where </span><span style=' font-family: monospace;'>fun(0)=1</span><span> and </span><span style=' font-family: monospace;'>fun(1)=0</span><span> return the values for the mask function at the beginning and end of the absorbing domain, respectively (the absorbing domain at the two ends of the discretization domain are linearly mapped to the segment </span><span style=' font-family: monospace;'>[0 1]</span><span> when calling the mask function).</span></li></ul><h3  class = 'S3'><span>Other properties</span></h3><div  class = 'S1'><span>These properties cannot be edited with the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method.</span></div><h4  class = 'S4'><span style=' font-family: monospace;'>isCAP (=false)</span></h4><div  class = 'S1'><span>This constant property can be used to distinguist CAP (</span><span style=' font-family: monospace;'>isCAP = true</span><span>) from mask absorbing boundary conditions at run time.</span></div><h4  class = 'S4' id = 'H_11930D30' ><span style=' font-family: monospace;'>isInitialized (isInit)</span></h4><div  class = 'S1'><span>Whether the absorbing-boundary mask object is properly initialized. This is used throughout the QMol-grid package to check that the absorber object holds meaningful information and is ready for use. Changing its </span><span style=' font-family: monospace;'>isSpinPol</span><span> may cause simulations to fail or produce erroneous results.</span></div><h2  class = 'S2'><span>Class methods</span></h2><h3  class = 'S3'><span>Creation</span></h3><h4  class = 'S4'><span>constructor</span></h4><div  class = 'S1'><span>Create an absorbing-boundary mask object with empty class properties.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj = QMol_TDDFT_abs_mask;</span></span></div></div></div><div  class = 'S8'><span>Create an absorbing-boundary mask object with the </span><span style=' font-family: monospace;'>name</span><span> properties set to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_9E118FF3"><span>mask function</span></a><span> properties and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj = QMol_TDDFT_abs_mask(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj = QMol_TDDFT_abs_mask(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><h3  class = 'S3'><span>Changing class properties</span></h3><h4  class = 'S4' id = 'H_4405B79D' ><span style=' font-family: monospace;'>set</span></h4><div  class = 'S1'><span>Update the </span><span style=' font-family: monospace;'>name</span><span> properties of an absorbing-boundary mask object to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_9E118FF3"><span>mask function</span></a><span> properties and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj.set(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.set(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S8'><span>This is the common name-value pair assignment method used throughout the QMol-grid package. The </span><span style=' font-family: monospace;'>set</span><span> method also </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the class. After running, the </span><span style=' font-family: monospace;'>set</span><span> property updates the </span><a href = "#H_11930D30"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to a </span><span style=' font-family: monospace;'>false</span><span> value.</span></div><h4  class = 'S4' id = 'H_BF84FCE7' ><span style=' font-family: monospace;'>reset</span></h4><div  class = 'S1'><span>Reset the object by deleting/re-initializing all run-time properties of the class and updating the </span><a href = "#H_11930D30"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to </span><span style=' font-family: monospace;'>false</span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.reset;</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>This is the common </span><span style=' font-family: monospace;'>reset</span><span> method available to all classes throughout the QMol-grid package.</span></li></ul><h4  class = 'S4' id = 'H_C729A888' ><span style=' font-family: monospace;'>clear</span></h4><div  class = 'S1'><span>Clear all class properties</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.clear;</span></span></div></div></div><div  class = 'S8'><span>Clear a specific set of the class properties. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_9E118FF3"><span>mask function</span></a><span> properties and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.clear(name1,name2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S8'><span>This is the common </span><span style=' font-family: monospace;'>clear</span><span> method available to all classes throughout the QMol-grid package. The </span><span style=' font-family: monospace;'>clear</span><span> method also </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the class. The </span><span style=' font-family: monospace;'>clear</span><span> method can be used to delete specific properties before saving an instance of the </span><span style=' font-family: monospace;'>QMol_TDDFT_abs_mask</span><span> class.</span></div><h3  class = 'S3'><span>Initializing the object</span></h3><h4  class = 'S4' id = 'H_09FAB436' ><span style=' font-family: monospace;'>initialize</span></h4><div  class = 'S1'><span>Initialize a </span><span style=' font-family: monospace;'>QMol_TDDFT_abs_mask</span><span> object and set the </span><a href = "#H_11930D30"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to </span><span style=' font-family: monospace;'>true.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.initialize(DFT);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span style=' font-family: monospace;'>DFT</span><span> is the </span><a href = "./DFT.html"><span>DFT-model</span></a><span> handle object, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "./QMol_DFT_spinPol.html"><span style=' font-family: monospace;'>QMol_DFT_spinPol</span></a><span style=' font-family: monospace;'> </span><span>or </span><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span>, being propagated in the </span><a href = "./TDDFT.html"><span>TDDFT</span></a><span> simulation.</span></li><li  class = 'S6'><span>To avoid any mismatch in internal properties, </span><span style=' font-family: monospace;'>initialize</span><span> first </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the object before performing the initialization.</span></li><li  class = 'S6'><span style=' text-decoration: underline;'>For developers:</span><span> For compatibility with complex-absorbing-potential absorbers, the method also supports </span><span style=' font-family: monospace;'>obj.initialize(DFT,isFwd)</span><span>, where </span><span style=' font-family: monospace;'>isFwd</span><span> specifies forward vs backward time propagation but is ignored.</span></li></ul><h3  class = 'S3'><span style=' font-family: monospace;'>Run-time documentation</span></h3><h4  class = 'S4' id = 'H_E3988947' ><span style=' font-family: monospace;'>getMemoryProfile</span></h4><div  class = 'S1'><span>Get an estimate of the memory held by a </span><span style=' font-family: monospace;'>QMol_TDDFT_abs_mask</span><span> object with either</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >mem = obj.getMemoryProfile;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >mem = obj.getMemoryProfile(false);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>The object must be properly </span><a href = "#H_09FAB436"><span style=' font-family: monospace;'>initialize</span></a><span>d.</span></li><li  class = 'S6'><span>The estimate only includes the discretization of the mask function on the domain grid and ignores other (small) properties.</span></li><li  class = 'S6'><span>The output </span><span style=' font-family: monospace;'>mem</span><span> is the estimated size in bytes.</span></li></ul><div  class = 'S1'><span>Additionally display the detail of the memory footprint with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >mem = obj.getMemoryProfile(true);</span></span></div></div></div><h4  class = 'S4' id = 'H_4D7CFC3D' ><span style=' font-family: monospace;'>showDocumentation</span></h4><div  class = 'S1'><span>Display the run-time documentation for the specific configuration of a </span><span style=' font-family: monospace;'>QMol_TDDFT_abs_mask</span><span> object</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >ref = obj.showDocumentation;</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>The output </span><span style=' font-family: monospace;'>ref</span><span> is a cell vector containing the list of references to be included in the bibliography.</span></li></ul><h3  class = 'S3'><span>Mask function</span></h3><div  class = 'S1'><span>To use the mask function, the </span><span style=' font-family: monospace;'>QMol_TDDFT_abs_mask</span><span> object must be properly </span><a href = "#H_09FAB436"><span style=' font-family: monospace;'>initialize</span></a><span>d.</span></div><h4  class = 'S4'><span style=' font-family: monospace;'>applyMask</span></h4><div  class = 'S1'><span>Apply the mask function to a set of Kohn-Sham orbitals</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.applyMask(KSO);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>This multiplies each Kohn-Sham orbital in the orbital-object </span><span style=' font-family: monospace;'>KSO</span><span> by the mask function (formally equivalent to in place </span><span texencoding="\phi(x) \leftarrow \mathcal{W}(x)\times\phi(x)" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="130" height="18" /></span><span>, where </span><span style="font-family: STIXGeneral-webfont, serif; font-style: normal; font-weight: 400; color: rgb(33, 33, 33);">𝒲</span><span> is the mask function).</span></li></ul><h2  class = 'S2'><span>Examples</span></h2><div  class = 'S1'><span>Create a discretization domain and minimal </span><a href = "./DFT.html"><span style=' font-family: monospace;'>DFT</span><span>-model</span></a><span> object.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >disc = QMol_disc(</span><span style="color: #a709f5;">'xspan'</span><span >,-20:.1:25);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >DFT  = QMol_DFT_spinRes(</span><span style="color: #a709f5;">'discretization'</span><span >,disc);</span></span></div></div></div><div  class = 'S8'><span>Create the mask-function absorber and display the run-time documentation.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >ABC  = QMol_TDDFT_abs_mask(</span><span style="color: #a709f5;">'length'</span><span >,5);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >ABC.initialize(DFT);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >ABC.showDocumentation;</span></span></div></div></div><div  class = 'S8'><span>yielding</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S12'><span style="white-space: pre"><span >  * Absorbing boundaries                                     mask function</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Length = 5 a.u. on both ends</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Shape  = cos^1/8</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    V-01.21.000 (06/17/2024)                                     F. Mauger</span></span></div></div><div  class = 'S1'><span>Display the estimated memory footprint for the object.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >ABC.getMemoryProfile(true);</span></span></div></div></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S12'><span style="white-space: pre"><span >  * Absorbing boundaries (mask)                                     3.5 KB</span></span></div></div><h2  class = 'S2'><span>Test suite</span></h2><div  class = 'S1'><span>Run the test suite for the class in normal or </span><a href = "./Test_suite.html"><span>summary mode</span></a><span> respectively with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'TDDFT_abs_mask'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'-summary'</span><span >,</span><span style="color: #a709f5;">'TDDFT_abs_mask'</span><span >);</span></span></div></div></div><h2  class = 'S2'><span>For developers</span></h2><h3  class = 'S3'><span>Other hidden class properties</span></h3><div  class = 'S1'><span style=' font-family: monospace;'>QMol_TDDFT_abs_mask</span><span> defines a handful of additional transient/constant and hidden properties to facilitate and speed up computations. These properties cannot be edited with the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method, nor by any function outisde of the object (</span><span style=' font-family: monospace;'>SetAccess=private</span><span> attribute).</span></div><h4  class = 'S4' id = 'H_37454CF9' ><span style=' font-family: monospace;'>DFT</span></h4><div  class = 'S1'><span>DFT-model object </span><span style=' font-family: monospace;'>[ [] (default) | </span><a href = "./QMol_DFT_spinPol.html"><span style=' font-family: monospace;'>QMol_DFT_spinPol</span></a><span style=' font-family: monospace;'> handle object | </span><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span style=' font-family: monospace;'> handle object ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>This is a copy of the </span><a href = "./DFT.html"><span>DFT-model</span></a><span> handle object passed to </span><a href = "#H_09FAB436"><span style=' font-family: monospace;'>initialize</span></a><span>. </span></li><li  class = 'S6'><span>Un-initialized </span><span style=' font-family: monospace;'>QMol_TDDFT_abs_mask</span><span> objects, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "#H_11930D30"><span style=' font-family: monospace;'>isInitialized</span></a><span style=' font-family: monospace;'> == false</span><span>, have hempty </span><span style=' font-family: monospace;'>DFT.</span></li><li  class = 'S6'><span>For practical reasons, </span><span style=' font-family: monospace;'>DFT</span><span> is editable by </span><a href = "./QMol_DFT.html"><span style=' font-family: monospace;'>QMol_DFT</span></a><span> classes.</span></li></ul><h4  class = 'S4'><span style=' font-family: monospace;'>W</span></h4><div  class = 'S1'><span>Discretization of the mask on the domain grid </span><span style=' font-family: monospace;'>[ [] (default) | vector ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>Un-initialized </span><span style=' font-family: monospace;'>QMol_TDDFT_abs_mask</span><span> objects, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "#H_11930D30"><span style=' font-family: monospace;'>isInitialized</span></a><span style=' font-family: monospace;'> == false</span><span>, have hempty </span><span style=' font-family: monospace;'>W.</span></li></ul><h4  class = 'S4'><span style=' font-family: monospace;'>nKSO</span></h4><div  class = 'S1'><span>Number of Kohn-Sham orbitals in the </span><a href = "./DFT.html"><span>DFT model</span></a><span> </span><span style=' font-family: monospace;'>[ [] (default) | integer | two-integer vector ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>For spin-polarized models, </span><span style=' font-family: monospace;'>nKSO = [N_up, N_down]</span><span> specifies the number of up- and down-spin Kohn-Sham orbitals, respectively.</span></li></ul><h2  class = 'S2'><span>Notes</span></h2><div  class = 'S1'><span>The results displayed in this documentation page were generated using version 01.21 of the QMol-grid package.</span></div><ul  class = 'S5'><li  class = 'S6'><span style=' font-family: monospace;'>QMol_TDDFT_abs_mask</span><span> was introduced in version 01.00.</span></li><li  class = 'S6'><a href = "#H_E3988947"><span style=' font-family: monospace;'>getMemoryProfile</span></a><span> was introduced in version 01.10.</span></li></ul>
<br>
<!-- 
##### SOURCE BEGIN #####
%% |QMol_TDDFT_abs_mask|
% Absorbing boundaries using a mask function at the edges of the discretization 
% domain. 
%% Description
% Use |QMol_TDDFT_abs_mask| to describe absorbing boundaries with a mask function. 
% After each <./TDDFT.html TDDFT> propagation time step the Kohn-Sham orbitals 
% in the attached <./DFT.html DFT model> are multiplied by the mask function. 
%% Class properties
% Mask function
% The |QMol_TDDFT_abs_mask| class defines the following public get-access properties; 
% each can be changed using the |set| method:
% |length (L)|
% Length of the absorbing region at the edges of the domain discretization |[ 
% positive scalar (default 10) | positive two-vector ]|
%% 
% * Scalar |length| defines a mask function with the same length on both sides 
% of the discretization domain.
% * |length = [L_left, L_right]| independently specifies the mask function length 
% on each side of the domain.
% * Note: The mask function is defined inward from the two ends of the <./DFT.html 
% DFT model> discretization domain, which should therefore budget for this.
% |shape|
% Shape of the mask function |[ 'cos^1/8' (default) | 'cos^2' | function handle 
% ]|
%% 
% * |'cos^1/8'| uses a $\cos^{1/8}$-shaped mask function
% * |'cos^2'| uses a $\cos^{2}$-shaped mask function
% * A function handle enables user-defined mask function, with the signature 
% |@(x) fun(x)|. where |fun(0)=1| and |fun(1)=0| return the values for the mask 
% function at the beginning and end of the absorbing domain, respectively (the 
% absorbing domain at the two ends of the discretization domain are linearly mapped 
% to the segment |[0 1]| when calling the mask function).
% Other properties
% These properties cannot be edited with the |set| method.
% |isCAP (=false)|
% This constant property can be used to distinguist CAP (|isCAP = true|) from 
% mask absorbing boundary conditions at run time.
% |isInitialized (isInit)|
% Whether the absorbing-boundary mask object is properly initialized. This is 
% used throughout the QMol-grid package to check that the absorber object holds 
% meaningful information and is ready for use. Changing its |isSpinPol| may cause 
% simulations to fail or produce erroneous results.
%% Class methods
% Creation
% constructor
% Create an absorbing-boundary mask object with empty class properties.

obj = QMol_TDDFT_abs_mask;
%% 
% Create an absorbing-boundary mask object with the |name| properties set to 
% the specified |value|. Several |name-value| pairs can be specified consecutively. 
% Suitable |name| is any of the mask function properties and is case insensitive.

obj = QMol_TDDFT_abs_mask(name1,value1);
obj = QMol_TDDFT_abs_mask(name1,value1,name2,value2,___);
% Changing class properties
% |set|
% Update the |name| properties of an absorbing-boundary mask object to the specified 
% |value|. Several |name-value| pairs can be specified consecutively. Suitable 
% |name| is any of the mask function properties and is case insensitive.

obj.set(name1,value1);
obj.set(name1,value1,name2,value2,___);
%% 
% This is the common name-value pair assignment method used throughout the QMol-grid 
% package. The |set| method also |reset| the class. After running, the |set| property 
% updates the |isInitialized| flag to a |false| value.
% |reset|
% Reset the object by deleting/re-initializing all run-time properties of the 
% class and updating the |isInitialized| flag to |false|.

obj.reset;
%% 
% * This is the common |reset| method available to all classes throughout the 
% QMol-grid package.
% |clear|
% Clear all class properties

obj.clear;
%% 
% Clear a specific set of the class properties. Suitable |name| is any of the 
% mask function properties and is case insensitive.

obj.clear(name1,name2,___);
%% 
% This is the common |clear| method available to all classes throughout the 
% QMol-grid package. The |clear| method also |reset| the class. The |clear| method 
% can be used to delete specific properties before saving an instance of the |QMol_TDDFT_abs_mask| 
% class.
% Initializing the object
% |initialize|
% Initialize a |QMol_TDDFT_abs_mask| object and set the |isInitialized| flag 
% to |true.|

obj.initialize(DFT);
%% 
% * |DFT| is the <./DFT.html DFT-model> handle object, _i.e._, <./QMol_DFT_spinPol.html 
% |QMol_DFT_spinPol|> or <./QMol_DFT_spinRes.html |QMol_DFT_spinRes|>, being propagated 
% in the <./TDDFT.html TDDFT> simulation.
% * To avoid any mismatch in internal properties, |initialize| first |reset| 
% the object before performing the initialization.
% * For developers: For compatibility with complex-absorbing-potential absorbers, 
% the method also supports |obj.initialize(DFT,isFwd)|, where |isFwd| specifies 
% forward vs backward time propagation but is ignored.
% |Run-time documentation|
% |getMemoryProfile|
% Get an estimate of the memory held by a |QMol_TDDFT_abs_mask| object with 
% either

mem = obj.getMemoryProfile;
mem = obj.getMemoryProfile(false);
%% 
% * The object must be properly |initialize|d.
% * The estimate only includes the discretization of the mask function on the 
% domain grid and ignores other (small) properties.
% * The output |mem| is the estimated size in bytes.
%% 
% Additionally display the detail of the memory footprint with

mem = obj.getMemoryProfile(true);
% |showDocumentation|
% Display the run-time documentation for the specific configuration of a |QMol_TDDFT_abs_mask| 
% object

ref = obj.showDocumentation;
%% 
% * The output |ref| is a cell vector containing the list of references to be 
% included in the bibliography.
% Mask function
% To use the mask function, the |QMol_TDDFT_abs_mask| object must be properly 
% |initialize|d.
% |applyMask|
% Apply the mask function to a set of Kohn-Sham orbitals

obj.applyMask(KSO);
%% 
% * This multiplies each Kohn-Sham orbital in the orbital-object |KSO| by the 
% mask function (formally equivalent to in place $\phi(x) \leftarrow \mathcal{W}(x)\times\phi(x)$, 
% where $\mathcal{W}$ is the mask function).
%% Examples
% Create a discretization domain and minimal <./DFT.html |DFT|-model> object.

disc = QMol_disc('xspan',-20:.1:25);
DFT  = QMol_DFT_spinRes('discretization',disc);
%% 
% Create the mask-function absorber and display the run-time documentation.

ABC  = QMol_TDDFT_abs_mask('length',5);
ABC.initialize(DFT);
ABC.showDocumentation;
%% 
% yielding
%%
% 
%    * Absorbing boundaries                                     mask function
%      Length = 5 a.u. on both ends
%      Shape  = cos^1/8
%      V-01.21.000 (06/17/2024)                                     F. Mauger
%
%% 
% Display the estimated memory footprint for the object.

ABC.getMemoryProfile(true);
%%
% 
%    * Absorbing boundaries (mask)                                     3.5 KB
%
%% Test suite
% Run the test suite for the class in normal or <./Test_suite.html summary mode> 
% respectively with

QMol_test.test('TDDFT_abs_mask');
QMol_test.test('-summary','TDDFT_abs_mask');
%% For developers
% Other hidden class properties
% |QMol_TDDFT_abs_mask| defines a handful of additional transient/constant and 
% hidden properties to facilitate and speed up computations. These properties 
% cannot be edited with the |set| method, nor by any function outisde of the object 
% (|SetAccess=private| attribute).
% |DFT|
% DFT-model object |[ [] (default) || <./QMol_DFT_spinPol.html |QMol_DFT_spinPol|> 
% |handle object || <./QMol_DFT_spinRes.html |QMol_DFT_spinRes|> |handle object 
% ]|
%% 
% * This is a copy of the <./DFT.html DFT-model> handle object passed to |initialize|. 
% * Un-initialized |QMol_TDDFT_abs_mask| objects, _i.e._, |isInitialized| |== 
% false|, have hempty |DFT.|
% * For practical reasons, |DFT| is editable by <./QMol_DFT.html |QMol_DFT|> 
% classes.
% |W|
% Discretization of the mask on the domain grid |[ [] (default) | vector ]|
%% 
% * Un-initialized |QMol_TDDFT_abs_mask| objects, _i.e._, |isInitialized| |== 
% false|, have hempty |W.|
% |nKSO|
% Number of Kohn-Sham orbitals in the <./DFT.html DFT model> |[ [] (default) 
% | integer | two-integer vector ]|
%% 
% * For spin-polarized models, |nKSO = [N_up, N_down]| specifies the number 
% of up- and down-spin Kohn-Sham orbitals, respectively.
%% Notes
% The results displayed in this documentation page were generated using version 
% 01.21 of the QMol-grid package.
%% 
% * |QMol_TDDFT_abs_mask| was introduced in version 01.00.
% * |getMemoryProfile| was introduced in version 01.10.
##### SOURCE END #####
-->
</div></body></html>