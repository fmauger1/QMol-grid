<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2024a"><title>QMol_TDSE_abs_CAP</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S3 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.S4 { margin: 10px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 15px; font-weight: 700; text-align: left;  }
.S5 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S6 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block }
.S7 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0.666667px solid rgb(217, 217, 217); border-bottom: 0.666667px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S9 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0.666667px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S10 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0.666667px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S11 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S12 { border-left: 0px none rgb(33, 33, 33); border-right: 0px none rgb(33, 33, 33); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px; line-height: 15.6px; min-height: 16px; white-space: pre; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span style=' font-family: monospace;'>QMol_TDSE_abs_CAP</span></h1><div  class = 'S1'><span>Absorbing boundaries using a complex absorbing potential (CAP) at the edges of the discretization domain. </span></div><h2  class = 'S2'><span>Description</span></h2><div  class = 'S1'><span>Use </span><span style=' font-family: monospace;'>QMol_TDSE_abs_CAP</span><span> to describe absorbing boundaries with a CAP. During the </span><a href = "./TDSE.html"><span>TDSE</span></a><span> propagation, the CAP is added to the potential. </span></div><h2  class = 'S2'><span>Class properties</span></h2><h3  class = 'S3' id = 'H_9E118FF3' ><span>Complex absorbing potential (CAP)</span></h3><div  class = 'S1'><span>The </span><span style=' font-family: monospace;'>QMol_TDSE_abs_CAP</span><span> class defines the following public get-access properties; each can be changed using the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method:</span></div><h4  class = 'S4' id = 'H_AF6C7188' ><span style=' font-family: monospace;'>amplitude (V0)</span></h4><div  class = 'S1'><span>Amplitude of the CAP </span><span style=' font-family: monospace;'>[ positive scalar (default 0.5) ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>When constructing the CAP, the selected </span><a href = "#H_5F9A3AF5"><span style=' font-family: monospace;'>shape</span></a><span> is multiplied by the specified </span><span style=' font-family: monospace;'>amplitude</span><span> (including for user-defined shapes).</span></li></ul><h4  class = 'S4' id = 'H_802F3E68' ><span style=' font-family: monospace;'>length (L)</span></h4><div  class = 'S1'><span>Length of the absorbing region at the edges of the domain discretization </span><span style=' font-family: monospace;'>[ positive scalar (default 10) | positive two-vector ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>Scalar </span><span style=' font-family: monospace;'>length</span><span> defines a CAP with the same length on both sides of the discretization domain.</span></li><li  class = 'S6'><span style=' font-family: monospace;'>length = [L_left, L_right]</span><span> independently specifies the CAP length on each side of the domain.</span></li><li  class = 'S6'><span style=' text-decoration: underline;'>Note:</span><span> The CAP is defined inward from the two ends of the </span><a href = "./SE.html"><span>Schr√∂dinger-equation model</span></a><span> discretization domain, one should therefore budget for this.</span></li></ul><h4  class = 'S4' id = 'H_5F9A3AF5' ><span style=' font-family: monospace;'>shape</span></h4><div  class = 'S1'><span>Shape of the CAP </span><span style=' font-family: monospace;'>[ 'sin^1/8' (default) | 'sin' | 'sin^2' | function handle ]</span></div><ul  class = 'S5'><li  class = 'S6'><span style=' font-family: monospace;'>'sin^1/8'</span><span> uses a </span><span texencoding="\sin^{1/8}" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAAAoCAYAAABHJVyTAAAAAXNSR0IArs4c6QAABftJREFUaEPtWWtsFFUU/s7sbrtV8JEI1UJ3Zm43KiXxh2I0McZGwysiJcTyEDQGxcgjgtGIYEijEBWMKAGJARUQQQOJqAFBJKZINGIU+UM1dTtzp6wNRmI0mpZ2Z+eYW2fIMF1KTJrWLrs/53Hnnu9+5zvfOUso/c5DgEp4nI9ACZAII0qAlADpWyRKDBmqDEmlUiIej6/0PO+IlHLbhc65urq6Kh6PfwzgS13Xl6nnpJT3A3iQiH4CMBLA1UT0vGVZ3wHg8Fr/e4YYhmFomraAmecCqCKiRyzLeudCgAgh7mXmvcw81TCMw1LKFUQ0wXXdGadOnWoHQIZhTCWiDZ7nTXMc5/hQAyQppewyTfNRAJv7AqSuri7uOM46AONisVj92bNnyxKJxD4i+syyrGeDwGtqakZ6nrcfwEHbtlcOKUCCzQoh5jHz230BMnr06FEKAGY+IKV8Ttf1GzVNO8DMX3V3d89vb2/vUOsFzwHYY9v2i0ULiGmaSit2MfN4KeWR2traYR0dHduJ6D4AC2zb3grAM02zgZlfYuYGx3F+KEpAamtryzo7Ozcyc43rug3ZbPZ3FWg6nR6bz+c/BGAS0dvMnAEwUdO05a2trd9HtahfRFUIMYWZtzDzF5qmLbQs68/+bgkuljK6rpuapild2OmnwbnqYZrmTcy8i4jGAvgLwCLbtncqtvQ7IFVVVZeVlZVtIaIH1OLMXKfoOtCAGIYxi4g2a5o2qbW19evQ91VVmQDgGXWNiO72772Sy+Uas9lsZ7+nzGAzJJ1Ol7uuuwmAEU4XFb8Q4mFmXkpEDZZlZYQQk5hZPasT0XLLstaEvUi/pEx/s6HQen2lTDqdrsnn858C2B6uGqE0ei98XQhxKzN/BMBR5TmTyfwWfLMoAPHBet2vLseC4AzDuIuImqKlOuRXpnqeN9lxnB+LBpCQho1g5hlSyj+C4JSYAjgAYFNEaMk0zbUA6lzXrfcdbM9rBRlSWVl5eUVFxVwimgxAlanqf/WImgC0WZa1rwCtNV3Xb0gkEmfCFFSn0dbWNsbzvNlENKKrq2tJeXn5cKX0AJQdvw7AfmZeLaU8caH0M01zfiGnquv6GN98vSalXB9+3//2SmaeFYvFpmcymZPqvmoHiGgPEW2yLEv1RecqUi9AFOLJZPINAMlkMjm/ubn5b3+R24joXSJaE+olFNIpIprNzAsVcOEq4/cVywHcotZTpQ/ADiJaR0Q9lYiZZ6pmi5lPxuNxlc+t4aB8HbgTwAtKCAF8S0Rr8/n8ccdxbCHEQmZu9DxvUtRk+T6k3PO86cy8gIhOep6ngleCut627cPR0tsLED/vPieixyNNlAp+MRGNCvoCwzBuJ6LrAcwBoEpbr7IbGCYA6oQ7iOhQLpdbFNDUMIyJ6rQADCeiRZZlqQowaL9egITUfH0qlXq6qanJjeRkvW3bq8I7FkLcw8wK7YI+RAjxMjMvY2blDKdIKU+HhO8qItoNYDyALRUVFYubm5u7BwuRQgyZRESf+Bt6MhaLvZXJZLpC9EtZlvVzeMOBml8MEADHEonElJaWljPB+2Fjp1Iq3IQNBiiFGHIlgG3MPM3f0FEieqrQMCVa3ooSEBWUL2Q7ANzhB51TCg9glW3bv0ZPrqgZEgSbTqevyOfzjQBU9Uj61x01irNt++glkzLR0/dnma+GUqiFmeullGo+2fMraoYIIabn83kZmTVqQgjlNTb4nmFp2AQVOyDzVIpE/YDv/5UTVCm0OjyLLHpAPM+bE2mjVWYE/n+JmmhLKQ9eKinTM8xVLIjFYqtDHqRnFEdEezVNawyu+xqihjPv+2V3tpTyg5A498wqiEgx70Qul5uSzWZ/Ce6H/kcZpyZuBQ5iQO1IIR+ifL8gomHMXEtEtud51xBRJRG9mUqlDgbuVdf1m2Ox2ExmfgjAtf7OT6ueB4ACVTnXJwA8BiDh3z/EzFvj8fhe13WV9V8R2H4AqrzvZuaNUspvBhQJ/2NDZh4yUOCUAIkgXQKkBEjfyVdiSIkhJYb8pwJVSpkIXP8AJmYSZcdB9QAAAAAASUVORK5CYII=" width="34" height="20" /></span><span>-shaped CAP.</span></li><li  class = 'S6'><span style=' font-family: monospace;'>'sin'</span><span> uses a </span><span style="font-family: STIXGeneral-webfont, serif; font-style: normal; font-weight: 400; color: rgb(33, 33, 33);">sin</span><span>-shaped CAP.</span></li><li  class = 'S6'><span style=' font-family: monospace;'>'sin^2'</span><span> uses a </span><span texencoding="\sin^{2}" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAAoCAYAAACxbNkLAAAAAXNSR0IArs4c6QAABMBJREFUaEPtmGtoHFUUx/9ndjbZVesLJRqTeVwXixH8oIKCHwyImmIwIpQaW0WKUUmrjajYCrUfWvCBisVa1PgoKahYbVEUan0QKYhKlfrBtcbNnTtJjBWLtCgtm929R26ZlWGzKayJYTdkP87OnLm/+z/n/M9cwgL70QLjwSJQvSu6qNCiQrPcAd/3XWZ+koi6AJzDzN8x88YwDD8BoCvD13XKZTKZy0ql0nsAfiCin5n5SgA3RhD3BEEw1DBAmUymWWv9AoBvpZQ7ADAAEkLczcyvADiQSCR6crncH3GoulXIdV3fsqyBfD6/YXJy8nh50W1tbefatr2LiC7WWi8Lw/CnhgDq6OhoOnr0qB2HMQtvbW09rampaZCIOgqFQvfExMSvDQE0Uy/xPO9sInqXmcdt2+7P5XL5OQcSQnQz8yAzf2FZVr+U8tgsm9uMj/u+fzkz77Ys6z4p5edz3hRiKXCHCc7MnUqpL/8PoM7OTntsbOxZAMccx9k8PDxcnHMgE3C+FPI87yYiWp5Opwey2ezf1Tatbrtc5WI9z7uaiB7QWj8ahuFvM2VAQwBFBvuE1nrgVDAGsu6BZoIx9RSG4YDW+v0wDIOyYlWBWlpaTk+n06uIaBmAHIB2A09EwwDGpJQfVZHccl13aTKZPBJ376iQL9Va9xLR+fl8fl1zc/MSAGsArAJwIYCPmXmLUupgPK7v+0sBDDFzzrIss45/f9EYdMh13fXx5jANyHStVCr1EoBUKpXqKxdflMNDRPS0lPKNKDL5vu8QUS8z9xvweJcTQtzMzBsAmBksxcxvAdhJRM8T0clOyMwroqHzR9u2zSgzGjUaJ7r/2hnq5S/LsrpGR0e/OqUPeZ53HRF9SkT3xxZ+Mj19319LRBdJKdebC57nXUNElwBYWR4aK9u2cfwTJ05sA9AH4DgR7SsUCmvGx8cnoximc+0CsISI1kgpt8+m5U9TSAixmplfJ6KtjuM8EpfTmBqAniAINsdfKoS4npk/m8mHhBBPMfNjZvQH0K2UOlx+vuz8AG4AMJhOp9dms9mp/wo1DcjzvC4i+jAK+FAikXitPF5EE7Ajpfwl/sJIVVNfVY21DATgm2Qy2T0yMnKk/HzcmE2KTU1N9VXOb7XAVVPoLAA7mPnWKNB+InpYSnkgGuGnxa9rILPaaHTfCaBckAUArwLYHATB71VMz9RdfSpUXmwmkzmzVCptAmC6Vyq6HgK4MwiC/Q2TcpW77ziOsG37uVgKjjBzj1LqUKyw61chIcRtpVJJhWH4fQzOEkIYr3kx8owBpdTWRgFabVKs0g+iUcNAmBTcEgTBxoYB0lqvLBaLyycmJv6MqWSM9RkA65j5FqXU3oYBMsZqVEgkEltiHmSOlHYT0R7LsjbFP309z7udiN6OfKhXKfVOrLk0F4vF7URklD9YeQ7Q3t7eatv2BwCuMl+8VTayFhuaPm2bGmJmQURnMHMHEQVa6/OIqIWIXnYcZ295enBd94pEIrGCme8CcEH05sNEZM7LzKYYo30QwL0AktH/+5j5Tdu29xSLRTM6PR47azP2YM4Ltimlvq6JJLq57j8faoVaBKp1x+b7/kWF5nvHa33fokK17th837/gFPoHE1oOVlgnCusAAAAASUVORK5CYII=" width="26" height="20" /></span><span>-shaped CAP.</span></li><li  class = 'S6'><span>A function handle enables user-defined CAPs, with the signature </span><span style=' font-family: monospace;'>@(x) fun(x)</span><span>, where </span><span style=' font-family: monospace;'>fun(0)=0</span><span> and </span><span style=' font-family: monospace;'>fun(1)=V_max</span><span> return the values for the CAP at the beginning and end of the absorbing domain, respectively (the absorbing domain at the two ends of the discretization domain are linearly mapped to the segment </span><span style=' font-family: monospace;'>[0 1]</span><span> when calling the CAP function). </span><span style=' text-decoration: underline; font-family: monospace;'>fun</span><span style=' text-decoration: underline;'> must be real valued and positive</span><span>; the sign and complex coefficients are properly assigned when the object is </span><a href = "#H_09FAB436"><span style=' font-family: monospace;'>initialize</span></a><span>d. We recommend setting </span><span style=' font-family: monospace;'>V_max</span><span> to </span><span style=' font-family: monospace;'>1</span><span> and using the </span><a href = "#H_AF6C7188"><span style=' font-family: monospace;'>amplitude</span></a><span> property to control the CAP height.</span></li></ul><h3  class = 'S3'><span>Other properties</span></h3><div  class = 'S1'><span>These properties cannot be edited with the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method.</span></div><h4  class = 'S4' id = 'H_11930D30' ><span style=' font-family: monospace;'>isInitialized (isInit)</span></h4><div  class = 'S1'><span>Whether the absorbing-boundary CAP object is properly initialized. This is used throughout the QMol-grid package to check that the absorber object holds meaningful information and is ready for use. </span></div><h2  class = 'S2'><span>Class methods</span></h2><h3  class = 'S3'><span>Creation</span></h3><h4  class = 'S4'><span>constructor</span></h4><div  class = 'S1'><span>Create an absorbing-boundary CAP object with empty class properties.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj = QMol_TDSE_abs_CAP;</span></span></div></div></div><div  class = 'S8'><span>Create an absorbing-boundary CAP object with the </span><span style=' font-family: monospace;'>name</span><span> properties set to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_9E118FF3"><span>CAP</span></a><span> properties and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj = QMol_TDSE_abs_CAP(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj = QMol_TDSE_abs_CAP(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><h3  class = 'S3'><span>Changing class properties</span></h3><h4  class = 'S4' id = 'H_4405B79D' ><span style=' font-family: monospace;'>set</span></h4><div  class = 'S1'><span>Update the </span><span style=' font-family: monospace;'>name</span><span> properties of an absorbing-boundary CAP object to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_9E118FF3"><span>CAP</span></a><span> properties and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj.set(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.set(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S8'><span>This is the common name-value pair assignment method used throughout the QMol-grid package. The </span><span style=' font-family: monospace;'>set</span><span> method also </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the class. After running, the </span><span style=' font-family: monospace;'>set</span><span> property updates the </span><a href = "#H_11930D30"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to a </span><span style=' font-family: monospace;'>false</span><span> value.</span></div><h4  class = 'S4' id = 'H_BF84FCE7' ><span style=' font-family: monospace;'>reset</span></h4><div  class = 'S1'><span>Reset the object by deleting/re-initializing all run-time properties of the class and updating the </span><a href = "#H_11930D30"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to </span><span style=' font-family: monospace;'>false</span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.reset;</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>This is the common </span><span style=' font-family: monospace;'>reset</span><span> method available to all classes throughout the QMol-grid package.</span></li></ul><h4  class = 'S4' id = 'H_C729A888' ><span style=' font-family: monospace;'>clear</span></h4><div  class = 'S1'><span>Clear all class properties.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.clear;</span></span></div></div></div><div  class = 'S8'><span>Clear a specific set of the class properties. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_9E118FF3"><span>CAP</span></a><span> properties and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.clear(name1,name2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S8'><span>This is the common </span><span style=' font-family: monospace;'>clear</span><span> method available to all classes throughout the QMol-grid package. The </span><span style=' font-family: monospace;'>clear</span><span> method also </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the class.</span></div><h3  class = 'S3'><span>Initializing the object</span></h3><h4  class = 'S4' id = 'H_09FAB436' ><span style=' font-family: monospace;'>initialize</span></h4><div  class = 'S1'><span>Initialize a </span><span style=' font-family: monospace;'>QMol_TDSE_abs_CAP</span><span> object and set the </span><a href = "#H_11930D30"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to </span><span style=' font-family: monospace;'>true</span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.initialize(SE,isForward);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span style=' font-family: monospace;'>SE</span><span> is the </span><a href = "./SE.html"><span>Schr√∂dinger-equation-model</span></a><span> handle object, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "./QMol_SE.html"><span style=' font-family: monospace;'>QMol_SE</span></a><span>, begin propagated in the </span><a href = "./TDSE.html"><span>TDSE</span></a><span> simulation.</span></li><li  class = 'S6'><span style=' font-family: monospace;'>isForward</span><span> specifies whether the TDSE propagation is forward (</span><span style=' font-family: monospace;'>true</span><span>) or backward (</span><span style=' font-family: monospace;'>false</span><span>) in time.</span></li><li  class = 'S6'><span>To avoid any mismatch in internal properties, </span><span style=' font-family: monospace;'>initialize</span><span> first </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the object before performing the initialization.</span></li></ul><h3  class = 'S3'><span style=' font-family: monospace;'>Run-time documentation</span></h3><h4  class = 'S4' id = 'H_E3988947' ><span style=' font-family: monospace;'>getMemoryProfile</span></h4><div  class = 'S1'><span>Get an estimate of the memory held by a </span><span style=' font-family: monospace;'>QMol_TDSE_abs_CAP</span><span> object with either</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >mem = obj.getMemoryProfile;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >mem = obj.getMemoryProfile(false);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>The object must be properly </span><a href = "#H_09FAB436"><span style=' font-family: monospace;'>initialize</span></a><span>d.</span></li><li  class = 'S6'><span>The estimate only includes the discretization of the CAP on the domain grid and ignores other (small) properties.</span></li><li  class = 'S6'><span>The output </span><span style=' font-family: monospace;'>mem</span><span> is the estimated size in bytes.</span></li></ul><div  class = 'S1'><span>Additionally display the detail of the memory footprint with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >mem = obj.getMemoryProfile(true);</span></span></div></div></div><h4  class = 'S4' id = 'H_4D7CFC3D' ><span style=' font-family: monospace;'>showDocumentation</span></h4><div  class = 'S1'><span>Display the run-time documentation for the specific configuration of a </span><span style=' font-family: monospace;'>QMol_TDSE_abs_CAP</span><span> object.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >ref = obj.showDocumentation;</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>The output </span><span style=' font-family: monospace;'>ref</span><span> is a cell vector containing the list of references to be included in the bibliography.</span></li></ul><h2  class = 'S2'><span>Examples</span></h2><div  class = 'S1'><span>Create a discretization domain and minimal </span><a href = "./SE.html"><span>Schr√∂dinger-equation-model</span></a><span> object.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >disc = QMol_disc(</span><span style="color: #a709f5;">'xspan'</span><span >,-20:.1:25);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >SE   = QMol_SE(</span><span style="color: #a709f5;">'discretization'</span><span >,disc);</span></span></div></div></div><div  class = 'S8'><span>Create the CAP absorber and display the run-time documentation.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >ABC  = QMol_TDSE_abs_CAP(</span><span style="color: #a709f5;">'length'</span><span >,5);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >ABC.initialize(SE,true);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >ABC.showDocumentation;</span></span></div></div></div><div  class = 'S8'><span>yielding</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S12'><span style="white-space: pre"><span >  * Absorbing boundaries                       complex absorbing potential</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Length = 5 a.u. on both ends</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Amplitude = 0.5 a.u.    Shape  = sin^1/8</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    V-01.21.000 (06/17/2024)                                     F. Mauger</span></span></div></div><div  class = 'S1'><span>Display the estimated memory footprint for the object.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >ABC.getMemoryProfile(true);</span></span></div></div></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S12'><span style="white-space: pre"><span >  * Absorbing boundaries (mask)                                     7.0 KB</span></span></div></div><h2  class = 'S2'><span>Test suite</span></h2><div  class = 'S1'><span>Run the test suite for the class in normal or </span><a href = "./Test_suite.html"><span>summary mode</span></a><span> respectively with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'TDSE_abs_CAP'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'-summary'</span><span >,</span><span style="color: #a709f5;">'TDSE_abs_CAP'</span><span >);</span></span></div></div></div><h2  class = 'S2'><span>For developers</span></h2><h3  class = 'S3'><span>Other hidden class properties</span></h3><div  class = 'S1'><span style=' font-family: monospace;'>QMol_TDSE_abs_CAP</span><span> defines a handful of additional transient/constant and hidden properties to facilitate and speed up computations. These properties cannot be edited with the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method, nor by any function outisde of the object (</span><span style=' font-family: monospace;'>SetAccess=private</span><span> attribute).</span></div><h4  class = 'S4' id = 'H_37454CF9' ><span style=' font-family: monospace;'>SE</span></h4><div  class = 'S1'><span>Schr√∂dinger-equation-model object </span><span style=' font-family: monospace;'>[ [] (default) | </span><a href = "./QMol_SE.html"><span style=' font-family: monospace;'>QMol_SE</span></a><span style=' font-family: monospace;'> handle object ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>This is a copy of the </span><a href = "./SE.html"><span>Schr√∂dinger-equation-model</span></a><span> handle object passed to </span><a href = "#H_09FAB436"><span style=' font-family: monospace;'>initialize</span></a><span>. </span></li><li  class = 'S6'><span>Un-initialized </span><span style=' font-family: monospace;'>QMol_TDSE_abs_CAP</span><span> objects, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "#H_11930D30"><span style=' font-family: monospace;'>isInitialized</span></a><span style=' font-family: monospace;'> == false</span><span>, have empty </span><span style=' font-family: monospace;'>SE.</span></li><li  class = 'S6'><span>For practical reasons, </span><span style=' font-family: monospace;'>SE</span><span> is editable by </span><a href = "./QMol_TDSE.html"><span style=' font-family: monospace;'>QMol_TDSE</span></a><span> classes.</span></li></ul><h4  class = 'S4'><span style=' font-family: monospace;'>V</span></h4><div  class = 'S1'><span>Discretization of the CAP on the domain grid </span><span style=' font-family: monospace;'>[ [] (default) | vector ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>Un-initialized </span><span style=' font-family: monospace;'>QMol_TDSE_abs_CAP</span><span> objects, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "#H_11930D30"><span style=' font-family: monospace;'>isInitialized</span></a><span style=' font-family: monospace;'> == false</span><span>, have empty </span><span style=' font-family: monospace;'>V.</span></li></ul><h2  class = 'S2'><span>Notes</span></h2><div  class = 'S1'><span>The results displayed in this documentation page were generated using version 01.21 of the QMol-grid package.</span></div><ul  class = 'S5'><li  class = 'S6'><span style=' font-family: monospace;'>QMol_TDSE_abs_CAP</span><span> was introduced in version 01.20.</span></li></ul>
<br>
<!-- 
##### SOURCE BEGIN #####
%% |QMol_TDSE_abs_CAP|
% Absorbing boundaries using a complex absorbing potential (CAP) at the edges 
% of the discretization domain. 
%% Description
% Use |QMol_TDSE_abs_CAP| to describe absorbing boundaries with a CAP. During 
% the <./TDSE.html TDSE> propagation, the CAP is added to the potential. 
%% Class properties
% Complex absorbing potential (CAP)
% The |QMol_TDSE_abs_CAP| class defines the following public get-access properties; 
% each can be changed using the |set| method:
% |amplitude (V0)|
% Amplitude of the CAP |[ positive scalar (default 0.5) ]|
%% 
% * When constructing the CAP, the selected |shape| is multiplied by the specified 
% |amplitude| (including for user-defined shapes).
% |length (L)|
% Length of the absorbing region at the edges of the domain discretization |[ 
% positive scalar (default 10) | positive two-vector ]|
%% 
% * Scalar |length| defines a CAP with the same length on both sides of the 
% discretization domain.
% * |length = [L_left, L_right]| independently specifies the CAP length on each 
% side of the domain.
% * Note: The CAP is defined inward from the two ends of the <./SE.html Schr√∂dinger-equation 
% model> discretization domain, one should therefore budget for this.
% |shape|
% Shape of the CAP |[ 'sin^1/8' (default) | 'sin' | 'sin^2' | function handle 
% ]|
%% 
% * |'sin^1/8'| uses a $\sin^{1/8}$-shaped CAP.
% * |'sin'| uses a $\sin$-shaped CAP.
% * |'sin^2'| uses a $\sin^{2}$-shaped CAP.
% * A function handle enables user-defined CAPs, with the signature |@(x) fun(x)|, 
% where |fun(0)=0| and |fun(1)=V_max| return the values for the CAP at the beginning 
% and end of the absorbing domain, respectively (the absorbing domain at the two 
% ends of the discretization domain are linearly mapped to the segment |[0 1]| 
% when calling the CAP function). |fun| must be real valued and positive; the 
% sign and complex coefficients are properly assigned when the object is |initialize|d. 
% We recommend setting |V_max| to |1| and using the |amplitude| property to control 
% the CAP height.
% Other properties
% These properties cannot be edited with the |set| method.
% |isInitialized (isInit)|
% Whether the absorbing-boundary CAP object is properly initialized. This is 
% used throughout the QMol-grid package to check that the absorber object holds 
% meaningful information and is ready for use. 
%% Class methods
% Creation
% constructor
% Create an absorbing-boundary CAP object with empty class properties.

obj = QMol_TDSE_abs_CAP;
%% 
% Create an absorbing-boundary CAP object with the |name| properties set to 
% the specified |value|. Several |name-value| pairs can be specified consecutively. 
% Suitable |name| is any of the CAP properties and is case insensitive.

obj = QMol_TDSE_abs_CAP(name1,value1);
obj = QMol_TDSE_abs_CAP(name1,value1,name2,value2,___);
% Changing class properties
% |set|
% Update the |name| properties of an absorbing-boundary CAP object to the specified 
% |value|. Several |name-value| pairs can be specified consecutively. Suitable 
% |name| is any of the CAP properties and is case insensitive.

obj.set(name1,value1);
obj.set(name1,value1,name2,value2,___);
%% 
% This is the common name-value pair assignment method used throughout the QMol-grid 
% package. The |set| method also |reset| the class. After running, the |set| property 
% updates the |isInitialized| flag to a |false| value.
% |reset|
% Reset the object by deleting/re-initializing all run-time properties of the 
% class and updating the |isInitialized| flag to |false|.

obj.reset;
%% 
% * This is the common |reset| method available to all classes throughout the 
% QMol-grid package.
% |clear|
% Clear all class properties.

obj.clear;
%% 
% Clear a specific set of the class properties. Suitable |name| is any of the 
% CAP properties and is case insensitive.

obj.clear(name1,name2,___);
%% 
% This is the common |clear| method available to all classes throughout the 
% QMol-grid package. The |clear| method also |reset| the class.
% Initializing the object
% |initialize|
% Initialize a |QMol_TDSE_abs_CAP| object and set the |isInitialized| flag to 
% |true|.

obj.initialize(SE,isForward);
%% 
% * |SE| is the <./SE.html Schr√∂dinger-equation-model> handle object, _i.e._, 
% <./QMol_SE.html |QMol_SE|>, begin propagated in the <./TDSE.html TDSE> simulation.
% * |isForward| specifies whether the TDSE propagation is forward (|true|) or 
% backward (|false|) in time.
% * To avoid any mismatch in internal properties, |initialize| first |reset| 
% the object before performing the initialization.
% |Run-time documentation|
% |getMemoryProfile|
% Get an estimate of the memory held by a |QMol_TDSE_abs_CAP| object with either

mem = obj.getMemoryProfile;
mem = obj.getMemoryProfile(false);
%% 
% * The object must be properly |initialize|d.
% * The estimate only includes the discretization of the CAP on the domain grid 
% and ignores other (small) properties.
% * The output |mem| is the estimated size in bytes.
%% 
% Additionally display the detail of the memory footprint with

mem = obj.getMemoryProfile(true);
% |showDocumentation|
% Display the run-time documentation for the specific configuration of a |QMol_TDSE_abs_CAP| 
% object.

ref = obj.showDocumentation;
%% 
% * The output |ref| is a cell vector containing the list of references to be 
% included in the bibliography.
%% Examples
% Create a discretization domain and minimal <./SE.html Schr√∂dinger-equation-model> 
% object.

disc = QMol_disc('xspan',-20:.1:25);
SE   = QMol_SE('discretization',disc);
%% 
% Create the CAP absorber and display the run-time documentation.

ABC  = QMol_TDSE_abs_CAP('length',5);
ABC.initialize(SE,true);
ABC.showDocumentation;
%% 
% yielding
%%
% 
%    * Absorbing boundaries                       complex absorbing potential
%      Length = 5 a.u. on both ends
%      Amplitude = 0.5 a.u.    Shape  = sin^1/8
%      V-01.21.000 (06/17/2024)                                     F. Mauger
%
%% 
% Display the estimated memory footprint for the object.

ABC.getMemoryProfile(true);
%%
% 
%    * Absorbing boundaries (mask)                                     7.0 KB
%
%% Test suite
% Run the test suite for the class in normal or <./Test_suite.html summary mode> 
% respectively with

QMol_test.test('TDSE_abs_CAP');
QMol_test.test('-summary','TDSE_abs_CAP');
%% For developers
% Other hidden class properties
% |QMol_TDSE_abs_CAP| defines a handful of additional transient/constant and 
% hidden properties to facilitate and speed up computations. These properties 
% cannot be edited with the |set| method, nor by any function outisde of the object 
% (|SetAccess=private| attribute).
% |SE|
% Schr√∂dinger-equation-model object |[ [] (default) || <./QMol_SE.html |QMol_SE|> 
% |handle object ]|
%% 
% * This is a copy of the <./SE.html Schr√∂dinger-equation-model> handle object 
% passed to |initialize|. 
% * Un-initialized |QMol_TDSE_abs_CAP| objects, _i.e._, |isInitialized| |== 
% false|, have empty |SE.|
% * For practical reasons, |SE| is editable by <./QMol_TDSE.html |QMol_TDSE|> 
% classes.
% |V|
% Discretization of the CAP on the domain grid |[ [] (default) | vector ]|
%% 
% * Un-initialized |QMol_TDSE_abs_CAP| objects, _i.e._, |isInitialized| |== 
% false|, have empty |V.|
%% Notes
% The results displayed in this documentation page were generated using version 
% 01.21 of the QMol-grid package.
%% 
% * |QMol_TDSE_abs_CAP| was introduced in version 01.20.
##### SOURCE END #####
-->
</div></body></html>