<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2024a"><title>QMol_Vmol</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S3 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.S4 { margin: 10px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 15px; font-weight: 700; text-align: left;  }
.S5 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S6 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block }
.S7 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0.555556px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0.555556px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S9 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S10 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0.555556px solid rgb(217, 217, 217); border-bottom: 0.555556px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S11 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span style=' font-family: monospace;'>QMol_Vmol</span></h1><div  class = 'S1'><span>Parent class for all molecular-potential objects.</span></div><h2  class = 'S2'><span>Description</span></h2><div  class = 'S1'><span style=' font-family: monospace;'>QMol_Vmol</span><span> defines an abstract class for the description of molecular potentials as sums of atom-like centers (pseudopotentials). It also provides support for compact run-time documentation of the molecular model.</span></div><h2  class = 'S2'><span>Class properties</span></h2><h3  class = 'S3' id = 'H_9E118FF3' ><span>Molecular model</span></h3><h4  class = 'S4' id = 'H_802F3E68' ><span style=' font-family: monospace;'>atom</span></h4><div  class = 'S1'><span>Atomic centers in the molecule </span><span style=' font-family: monospace;'>[ cell (default []) ]</span></div><ul  class = 'S5'><li  class = 'S6'><span style=' font-family: monospace;'>atom = {V1,V2,___}</span><span> Where each of the </span><span style=' font-family: monospace;'>V</span><span>s is a compatible atom-like center (</span><a href = "./Pseudopotential.html"><span>pseudopotentials</span></a><span>)</span></li></ul><h3  class = 'S3'><span>Other properties</span></h3><div  class = 'S1'><span>These properties cannot be edited with the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method.</span></div><h4  class = 'S4' id = 'H_11930D30' ><span style=' font-family: monospace;'>isInitialized (isInit)</span></h4><div  class = 'S1'><span>Whether the potential object is properly initialized. This is used throughout the QMol-grid package to check that the potential object holds meaningful information and is ready for use. Changing its </span><span style=' font-family: monospace;'>isSpinPol</span><span> may cause simulations to fail or produce erroneous results.</span></div><h4  class = 'S4' id = 'H_2DF17FFE' ><span style=' font-family: monospace;'>numberAtom (nbA)</span></h4><div  class = 'S1'><span>Number of atomic centers in the object </span><span style=' font-family: monospace;'>[ positive integer (default []) ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>This is defined as </span><span style=' font-family: monospace;'>numel(</span><a href = "#H_802F3E68"><span style=' font-family: monospace;'>atom</span></a><span style=' font-family: monospace;'>)</span><span>.</span></li><li  class = 'S6'><span>Un-initialized </span><span style=' font-family: monospace;'>QMol_DFT_Vext</span><span> objects, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "#H_11930D30"><span style=' font-family: monospace;'>isInitialized</span></a><span style=' font-family: monospace;'> == false</span><span>, have hempty </span><span style=' font-family: monospace;'>numberAtom.</span></li></ul><h2  class = 'S2'><span>Class methods</span></h2><h3  class = 'S3'><span>Creation</span></h3><div  class = 'S1'><span style=' font-family: monospace;'>QMol_doc</span><span> is an abstract class and cannot be instantiated.</span></div><h3  class = 'S3'><span>Changing class properties</span></h3><div  class = 'S1'><span>Classes overloading </span><span style=' font-family: monospace;'>QMol_suite</span><span> also inherit various methods to interface with properties.</span></div><h4  class = 'S4' id = 'H_4405B79D' ><span style=' font-family: monospace;'>set</span></h4><div  class = 'S1'><span style=' font-family: monospace;'>QMol_Vmol</span><span> inherits the </span><span style=' font-family: monospace;'>name-value</span><span> asignment for the </span><a href = "#H_9E118FF3"><span>molecular model properties</span></a><span> from </span><a href = "./QMol_suite.html"><span style=' font-family: monospace;'>QMol_suite</span></a><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.set(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.set(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S9'><span>The </span><span style=' font-family: monospace;'>set</span><span> method also </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the class. After running, the </span><span style=' font-family: monospace;'>set</span><span> property updates the </span><a href = "#H_11930D30"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to a </span><span style=' font-family: monospace;'>false</span><span> value.</span></div><h4  class = 'S4' id = 'H_BF84FCE7' ><span style=' font-family: monospace;'>reset</span></h4><div  class = 'S1'><span>Reset the object and update the </span><a href = "#H_11930D30"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to a </span><span style=' font-family: monospace;'>false</span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.reset;</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>This also </span><span style=' font-family: monospace;'>reset</span><span>s all the </span><a href = "#H_802F3E68"><span style=' font-family: monospace;'>atom</span></a><span>-like centers in the object, equivalent to the command </span><span style=' font-family: monospace;'>for k = 1:</span><a href = "#H_2DF17FFE"><span style=' font-family: monospace;'>nbA</span></a><span style=' font-family: monospace;'>, </span><a href = "#H_802F3E68"><span style=' font-family: monospace;'>atom</span></a><span style=' font-family: monospace;'>{k}.reset; end</span></li></ul><div  class = 'S1'><span>Overloaded reset methods can call the parent default feature following the template</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >methods (Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >reset(obj)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #008013;">%reset the object</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Run parent reset (updates isInit)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    reset@QMol_Vmol(obj);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Add all object-specific reset computations here</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><h4  class = 'S4' id = 'H_C729A888' ><span style=' font-family: monospace;'>clear</span></h4><div  class = 'S1'><span>Clear all  </span><a href = "#H_9E118FF3"><span>molecular model properties</span></a><span> </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.clear;</span></span></div></div></div><div  class = 'S9'><span>Clear a specific set of the class properties. Suitable </span><span style=' font-family: monospace;'>name</span><span> are specified any of the  </span><a href = "#H_9E118FF3"><span>molecular model properties</span></a><span> and are case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.clear(name1,name2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S9'><span>The </span><span style=' font-family: monospace;'>clear</span><span> method also </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the class. The </span><span style=' font-family: monospace;'>clear</span><span> method can be used to delete specific properties before saving an instance of the child class.</span></div><h3  class = 'S3'><span>Initializing the object</span></h3><h4  class = 'S4' id = 'H_09FAB436' ><span style=' font-family: monospace;'>initialize</span></h4><div  class = 'S1'><span>Initialize a </span><span style=' font-family: monospace;'>QMol_Vmol</span><span> object </span><span style=' text-decoration: underline;'>without</span><span> attaching a QMol-grid theory object and set the </span><a href = "#H_11930D30"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to </span><span style=' font-family: monospace;'>true</span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.initialize;</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.initialize([]);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>To avoid any mismatch in internal properties, </span><span style=' font-family: monospace;'>initialize</span><span> first </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the object before performing the initialization</span></li><li  class = 'S6'><span>This initializes all the </span><a href = "#H_802F3E68"><span style=' font-family: monospace;'>atom</span></a><span>-like centers in the object, equivalent to the command </span><span style=' font-family: monospace;'>for k = 1:</span><a href = "#H_2DF17FFE"><span style=' font-family: monospace;'>nbA</span></a><span style=' font-family: monospace;'>, </span><a href = "#H_802F3E68"><span style=' font-family: monospace;'>atom</span></a><span style=' font-family: monospace;'>{k}.initialize([]); end</span></li><li  class = 'S6'><span>This is only provided for extended compatibility and will likely cause errors in simulations. Initialization with attaching a QMol-grid theory object (next) is recommended.</span></li></ul><div  class = 'S1'><span>Initialize a </span><span style=' font-family: monospace;'>QMol_Vmol</span><span> object </span><span style=' text-decoration: underline;'>with</span><span> attaching a QMol-grid theory object</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.initialize(QM);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>This performs a similar initialization as previously, including </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span>, but with initializing each of the </span><a href = "#H_802F3E68"><span style=' font-family: monospace;'>atom</span></a><span>-like centers </span><span style=' text-decoration: underline;'>with</span><span> the QMol-grid theory object. It is equivalent to the command </span><span style=' font-family: monospace;'>for k = 1:</span><a href = "#H_2DF17FFE"><span style=' font-family: monospace;'>nbA</span></a><span style=' font-family: monospace;'>, </span><a href = "#H_802F3E68"><span style=' font-family: monospace;'>atom</span></a><span style=' font-family: monospace;'>{k}.initialize(QM); end</span></li></ul><h3  class = 'S3'><span style=' font-family: monospace;'>Run-time documentation</span></h3><div  class = 'S1'><span style=' font-family: monospace;'>QMol_Vmol</span><span> provides support for compact run-time documentation of the molecular model.</span></div><h4  class = 'S4' id = 'H_4D7CFC3D' ><span style=' font-family: monospace;'>showDocumentation</span></h4><div  class = 'S1'><span>Display the run-time documentation for the specific configuration of a </span><span style=' font-family: monospace;'>QMol_Vmol</span><span> object</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >ref = obj.showDocumentation;</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>The output </span><span style=' font-family: monospace;'>ref</span><span> is a cell vector containing the list of references to be included in the bibliography.</span></li><li  class = 'S6'><span>The run-time documentation performs the following steps: (1) It call the implementation-specific run-time documentation with the propety </span><a href = "#H_D8A9FEA5"><span style=' font-family: monospace;'>showDoc</span></a><span>. (2) It parses through the atom-like centers listed in </span><a href = "#H_802F3E68"><span style=' font-family: monospace;'>atom</span></a><span>, and call their </span><a href = "#H_7AF21387"><span>run-time documentation</span></a><span> to list the specific parameters for each of them. (3) For each type of pseudopotential used, call again the </span><a href = "#H_7AF21387"><span>run-time documentation</span></a><span> to display their generic description. This ensures a full but compact description of the molecular model without repeating general properties of pseudopotentials that are used several times in the molecular model.</span></li></ul><h2  class = 'S2'><span>Overloading the class</span></h2><div  class = 'S1'><span>To define a specific implementation of molecular potential, overloading classes must define the following methods with the specified signature and attributes</span></div><h4  class = 'S4' id = 'H_884CFDF5' ><span style=' font-family: monospace;'>propertyNames</span></h4><div  class = 'S1'><span>To enable name-value pair constructor, name-value pair </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span>, and the </span><a href = "#H_C729A888"><span style=' font-family: monospace;'>clear</span></a><span> methods</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >methods (Static=true,Access=?QMol_suite)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >[ClassName,PropNames] = propertyNames()</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #008013;">%propertyNames returns the names of member properties that can be set</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #008013;">%   through name-value assignment</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Parent-class components</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    [~,PropNames]       =   QMol_Vmol.propertyNames;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    ClassName           =   </span><span style="color: #a709f5;">'QMol_child_class'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    PropNames           =   [PropNames,{</span><span style="color: #a709f5;">'property1'</span><span >,</span><span style="color: #a709f5;">'property2'</span><span >}];</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><h4  class = 'S4' id = 'H_D8A9FEA5' ><span style=' font-family: monospace;'>showDoc</span></h4><div  class = 'S1'><span>Display the r</span><a href = "#H_4D7CFC3D"><span>un-time documentation</span></a><span> for the specific implementation of the molecular potential.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >methods (Access=?QMol_Vmol)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >ref = showDoc(obj)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #008013;">%showDoc displays the documentation reflecting the specific implementation</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #008013;">%   of the molecular model</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Add specific documentation here</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>If no reference is cited, return </span><span style=' font-family: monospace;'>ref = {}</span><span> otherwise </span><span style=' font-family: monospace;'>ref = {'ref 1','ref 2',___}</span><span>, where each of the </span><span style=' font-family: monospace;'>ref</span><span> corresponds to the bibliographic code for the reference (generally of the form </span><span style=' font-family: monospace;'>'name_of_first_author publication_year'</span><span>) and is case insensitive -- see the </span><a href = "./Documentation.html"><span>documentation page</span></a><span> for a list of citable references.</span></li></ul><h2  class = 'S2'><span>Compatible atom-like center (pseudopotentials) objects</span></h2><div  class = 'S1'><span>To be compatible with </span><span style=' font-family: monospace;'>QMol_Vmol</span><span>, atom-like center (pseudopotentials) classes must define the following properties with the specified signatures</span></div><h4  class = 'S4' id = 'H_7AF21387' ><span style=' font-family: monospace;'>showDocumentation</span></h4><div  class = 'S1'><span>Signature for the run-time documentation of a pseudopotential</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >methods (Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >ref = showDocumentation(obj,opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #008013;">%showDocumentation displays the documentation reflecting member property </span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #008013;">%   values</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Initialization</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >nargin == 1,     opt     =   [];         </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >isempty(opt),    opt     =   </span><span style="color: #a709f5;">'full'</span><span >;     </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    ref                 =   {};</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Display (appropriate) documentation</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">switch </span><span >lower(opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">case </span><span >{</span><span style="color: #a709f5;">'full'</span><span >,</span><span style="color: #a709f5;">'all'</span><span >}</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >            </span><span style="color: #008013;">% Display both potential shape and parameters</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">case </span><span >{</span><span style="color: #a709f5;">'param'</span><span >,</span><span style="color: #a709f5;">'parameters'</span><span >}</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >            </span><span style="color: #008013;">% Display only the potential ID and parameters</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >            </span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >            ref         =   </span><span style="color: #a709f5;">'potential_ID'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">case </span><span >{</span><span style="color: #a709f5;">'pot'</span><span >,</span><span style="color: #a709f5;">'potential'</span><span >}</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >            </span><span style="color: #008013;">% Display the generic description of the potential</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">otherwise</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >            </span><span style="color: #008013;">% Throw a warning or error for unexpected call</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>The initialization block is not mandatory but ensures that the showDocumentation (i) returns the appropriate output format and (ii) defines a default behavior if the end user calls the run-time documentation on an instance of the pseudopotential object (see also next).</span></li><li  class = 'S6'><span>The </span><span style=' font-family: monospace;'>case {'full','all'}</span><span> block is not mandatory but enables extended run-time documentation outside of </span><span style=' font-family: monospace;'>QMol_Vmol</span><span>'s.</span></li><li  class = 'S6'><span>At minimum, the following two blocks must define </span><span style=' font-family: monospace;'>'pot</span><span>' and </span><span style=' font-family: monospace;'>'param'</span><span> options; the added </span><span style=' font-family: monospace;'>'parameters'</span><span> and </span><span style=' font-family: monospace;'>'potential'</span><span> enable a more user-friendly interface.</span></li><li  class = 'S6'><span>The catch all </span><span style=' font-family: monospace;'>otherwise</span><span> block is not mandatory but ensures that unexpected documentation options are flagged.</span></li></ul><h4  class = 'S4'><span style=' font-family: monospace;'>initialize</span></h4><div  class = 'S1'><span>Initialized a pseudopotential object with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >methods (Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >initialize(obj,QM)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #008013;">%initialize initializes the pseudopotential object</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Add the initialization here</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Update the initialization flag</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    obj.isInit       =   true;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>The input </span><span style=' font-family: monospace;'>QM</span><span> is the QMol-grid theory object passed by </span><span style=' font-family: monospace;'>QMol_Vmol</span><span>'s </span><a href = "#H_09FAB436"><span style=' font-family: monospace;'>initialize</span></a><span> method.</span></li><li  class = 'S6'><span>If no QMol-grid theory object is required for the initialization, replace the function definition line with </span><span style=' font-family: monospace;'>function initialize(obj,~)</span></li></ul><h4  class = 'S4'><span style=' font-family: monospace;'>propertyNames</span></h4><div  class = 'S1'><span>Same requirements as for </span><span style=' font-family: monospace;'>QMol_Vmol</span><span>'s </span><a href = "#H_884CFDF5"><span style=' font-family: monospace;'>propertyNames</span></a><span>.</span></div><h4  class = 'S4'><span style=' font-family: monospace;'>getPotential</span></h4><div  class = 'S1'><span>Get the discretization of the pseudopotential. The specific signature is dimension dependent</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >V = obj.getPotential(</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><h4  class = 'S4'><span style=' font-family: monospace;'>getPotentialDerivative</span></h4><div  class = 'S1'><span>Get the discretization of the spatial derivative (gradient) of the pseudopotential. The specific signature is dimension dependent</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >DV = obj.getPotentialDerivative(</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><h2  class = 'S2'><span>Test suite</span></h2><div  class = 'S1'><span>For consistency with the rest of the QMol-grid package, </span><span style=' font-family: monospace;'>QMol_Vmol</span><span> defines an associated test suite. Run the test suite for the class in normal or </span><a href = "./Test_suite.html"><span>summary mode</span></a><span> respectively with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'Vmol'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'-summary'</span><span >,</span><span style="color: #a709f5;">'Vmol'</span><span >);</span></span></div></div></div><div  class = 'S9'><span>See </span><a href = "./QMol_test,html"><span style=' font-family: monospace;'>QMol_test</span></a><span> for details regarding how to create a test suite for new classes.</span></div><h2  class = 'S2'><span>Notes</span></h2><ul  class = 'S5'><li  class = 'S6'><span style=' font-family: monospace;'>QMol_Vmol</span><span> was intorduced in version 01.00.</span></li></ul>
<br>
<!-- 
##### SOURCE BEGIN #####
%% |QMol_Vmol|
% Parent class for all molecular-potential objects.
%% Description
% |QMol_Vmol| defines an abstract class for the description of molecular potentials 
% as sums of atom-like centers (pseudopotentials). It also provides support for 
% compact run-time documentation of the molecular model.
%% Class properties
% Molecular model
% |atom|
% Atomic centers in the molecule |[ cell (default []) ]|
%% 
% * |atom = {V1,V2,___}| Where each of the |V|s is a compatible atom-like center 
% (<./Pseudopotential.html pseudopotentials>)
% Other properties
% These properties cannot be edited with the |set| method.
% |isInitialized (isInit)|
% Whether the potential object is properly initialized. This is used throughout 
% the QMol-grid package to check that the potential object holds meaningful information 
% and is ready for use. Changing its |isSpinPol| may cause simulations to fail 
% or produce erroneous results.
% |numberAtom (nbA)|
% Number of atomic centers in the object |[ positive integer (default []) ]|
%% 
% * This is defined as |numel(||atom||)|.
% * Un-initialized |QMol_DFT_Vext| objects, _i.e._, |isInitialized| |== false|, 
% have hempty |numberAtom.|
%% Class methods
% Creation
% |QMol_doc| is an abstract class and cannot be instantiated.
% Changing class properties
% Classes overloading |QMol_suite| also inherit various methods to interface 
% with properties.
% |set|
% |QMol_Vmol| inherits the |name-value| asignment for the molecular model properties 
% from <./QMol_suite.html |QMol_suite|>.

obj.set(name1,value1);
obj.set(name1,value1,name2,value2,___);
%% 
% The |set| method also |reset| the class. After running, the |set| property 
% updates the |isInitialized| flag to a |false| value.
% |reset|
% Reset the object and update the |isInitialized| flag to a |false|.

obj.reset;
%% 
% * This also |reset|s all the |atom|-like centers in the object, equivalent 
% to the command |for k = 1:||nbA||,| |atom||{k}.reset; end|
%% 
% Overloaded reset methods can call the parent default feature following the 
% template

methods (Access=public)
function reset(obj)
%reset the object
    
    % Run parent reset (updates isInit)
    reset@QMol_Vmol(obj);

    % Add all object-specific reset computations here
end
end
% |clear|
% Clear all  molecular model properties 

obj.clear;
%% 
% Clear a specific set of the class properties. Suitable |name| are specified 
% any of the  molecular model properties and are case insensitive.

obj.clear(name1,name2,___);
%% 
% The |clear| method also |reset| the class. The |clear| method can be used 
% to delete specific properties before saving an instance of the child class.
% Initializing the object
% |initialize|
% Initialize a |QMol_Vmol| object without attaching a QMol-grid theory object 
% and set the |isInitialized| flag to |true|.

obj.initialize;
obj.initialize([]);
%% 
% * To avoid any mismatch in internal properties, |initialize| first |reset| 
% the object before performing the initialization
% * This initializes all the |atom|-like centers in the object, equivalent to 
% the command |for k = 1:||nbA||,| |atom||{k}.initialize([]); end|
% * This is only provided for extended compatibility and will likely cause errors 
% in simulations. Initialization with attaching a QMol-grid theory object (next) 
% is recommended.
%% 
% Initialize a |QMol_Vmol| object with attaching a QMol-grid theory object

obj.initialize(QM);
%% 
% * This performs a similar initialization as previously, including |reset|, 
% but with initializing each of the |atom|-like centers with the QMol-grid theory 
% object. It is equivalent to the command |for k = 1:||nbA||,| |atom||{k}.initialize(QM); 
% end|
% |Run-time documentation|
% |QMol_Vmol| provides support for compact run-time documentation of the molecular 
% model.
% |showDocumentation|
% Display the run-time documentation for the specific configuration of a |QMol_Vmol| 
% object

ref = obj.showDocumentation;
%% 
% * The output |ref| is a cell vector containing the list of references to be 
% included in the bibliography.
% * The run-time documentation performs the following steps: (1) It call the 
% implementation-specific run-time documentation with the propety |showDoc|. (2) 
% It parses through the atom-like centers listed in |atom|, and call their run-time 
% documentation to list the specific parameters for each of them. (3) For each 
% type of pseudopotential used, call again the run-time documentation to display 
% their generic description. This ensures a full but compact description of the 
% molecular model without repeating general properties of pseudopotentials that 
% are used several times in the molecular model.
%% Overloading the class
% To define a specific implementation of molecular potential, overloading classes 
% must define the following methods with the specified signature and attributes
% |propertyNames|
% To enable name-value pair constructor, name-value pair |set|, and the |clear| 
% methods

methods (Static=true,Access=?QMol_suite)
function [ClassName,PropNames] = propertyNames()
%propertyNames returns the names of member properties that can be set
%   through name-value assignment
    
    % Parent-class components
    [~,PropNames]       =   QMol_Vmol.propertyNames;

    ClassName           =   'QMol_child_class';
    PropNames           =   [PropNames,{'property1','property2'}];
end
end
% |showDoc|
% Display the run-time documentation for the specific implementation of the 
% molecular potential.

methods (Access=?QMol_Vmol)
function ref = showDoc(obj)
%showDoc displays the documentation reflecting the specific implementation
%   of the molecular model
    
    % Add specific documentation here

end
end
%% 
% * If no reference is cited, return |ref = {}| otherwise |ref = {'ref 1','ref 
% 2',___}|, where each of the |ref| corresponds to the bibliographic code for 
% the reference (generally of the form |'name_of_first_author publication_year'|) 
% and is case insensitive REPLACE_WITH_DASH_DASH see the <./Documentation.html documentation page> 
% for a list of citable references.
%% Compatible atom-like center (pseudopotentials) objects
% To be compatible with |QMol_Vmol|, atom-like center (pseudopotentials) classes 
% must define the following properties with the specified signatures
% |showDocumentation|
% Signature for the run-time documentation of a pseudopotential

methods (Access=public)
function ref = showDocumentation(obj,opt)
%showDocumentation displays the documentation reflecting member property 
%   values
    
    % Initialization
    if nargin == 1,     opt     =   [];         end
    if isempty(opt),    opt     =   'full';     end

    ref                 =   {};
    
    % Display (appropriate) documentation
    switch lower(opt)
        case {'full','all'}
            % Display both potential shape and parameters

        case {'param','parameters'}
            % Display only the potential ID and parameters
            
            ref         =   'potential_ID';
        case {'pot','potential'}
            % Display the generic description of the potential

        otherwise
            % Throw a warning or error for unexpected call
    end
    
end
end
%% 
% * The initialization block is not mandatory but ensures that the showDocumentation 
% (i) returns the appropriate output format and (ii) defines a default behavior 
% if the end user calls the run-time documentation on an instance of the pseudopotential 
% object (see also next).
% * The |case {'full','all'}| block is not mandatory but enables extended run-time 
% documentation outside of |QMol_Vmol|'s.
% * At minimum, the following two blocks must define |'pot|' and |'param'| options; 
% the added |'parameters'| and |'potential'| enable a more user-friendly interface.
% * The catch all |otherwise| block is not mandatory but ensures that unexpected 
% documentation options are flagged.
% |initialize|
% Initialized a pseudopotential object with

methods (Access=public)
function initialize(obj,QM)
%initialize initializes the pseudopotential object
    
    % Add the initialization here

    % Update the initialization flag
    obj.isInit       =   true;
end
end
%% 
% * The input |QM| is the QMol-grid theory object passed by |QMol_Vmol|'s |initialize| 
% method.
% * If no QMol-grid theory object is required for the initialization, replace 
% the function definition line with |function initialize(obj,~)|
% |propertyNames|
% Same requirements as for |QMol_Vmol|'s |propertyNames|.
% |getPotential|
% Get the discretization of the pseudopotential. The specific signature is dimension 
% dependent

V = obj.getPotential(___);
% |getPotentialDerivative|
% Get the discretization of the spatial derivative (gradient) of the pseudopotential. 
% The specific signature is dimension dependent

DV = obj.getPotentialDerivative(___);
%% Test suite
% For consistency with the rest of the QMol-grid package, |QMol_Vmol| defines 
% an associated test suite. Run the test suite for the class in normal or <./Test_suite.html 
% summary mode> respectively with

QMol_test.test('Vmol');
QMol_test.test('-summary','Vmol');
%% 
% See <./QMol_test,html |QMol_test|> for details regarding how to create a test 
% suite for new classes.
%% Notes
%% 
% * |QMol_Vmol| was intorduced in version 01.00.
##### SOURCE END #####
-->
</div></body></html>