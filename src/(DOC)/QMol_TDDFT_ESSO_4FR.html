<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2025a"><title>QMol_TDDFT_ESSO_4FR</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 25px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S3 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-size: 14px;  }
.S4 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.S5 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 20.4px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.S6 { margin: 10px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 15px; font-weight: 700; text-align: left;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block; min-width: 100%; }
.S7 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S9 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S10 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0' id = 'T_2D7548B9' ><span style=' font-family: monospace;'>QMol_TDDFT_ESSO_4FR</span></h1><div  class = 'S1'><span>Extended phase-space fourth-order Forest Ruth [</span><a href = "#M_3cee"><span>Forest 1990</span></a><span>] symplectic split-operator scheme for TDDFT simulations [</span><a href = "#M_F7CBFF54"><span>Mauger 2026</span></a><span>].</span></div><h2  class = 'S2' id = 'H_ED346F2A' ><span>Description</span></h2><div  class = 'S1'><span>Use </span><span style=' font-family: monospace;'>QMol_TDDFT_ESSO_4FR</span><span> to propagate the TDDFT dynamics of a spin-polarized or restricted </span><a href = "./DFT.html"><span>DFT model</span></a><span> with a </span><a href = "./QMol_disc.html"><span>Cartesian-grid discretization domain</span></a><span> using an extended phase-space fourth-order Forest Ruth [</span><a href = "#M_3cee"><span>Forest 1990</span></a><span>] symplectic scheme [</span><a href = "#M_F7CBFF54"><span>Mauger 2026</span></a><span>]. The time propagation can be performed field free or with an external driving field in the dipole approximation and either length or velocity gauge. The derivation and details of the implementation of the symplectic split-operator can be found in [</span><a href = "#M_F7CBFF54"><span>Mauger 2026</span></a><span>]. During the TDDFT propagation, several observables can be computed on-the-fly and stored in output structures in the </span><span style=' font-family: monospace;'>QMol_TDDFT_ESSO_4FR</span><span> object. Each of these can be activated independently and may define their own sampling times:</span></div><ul  class = 'S3'><li  class = 'S4'><a href = "#H_A211A946"><span>Save the DFT object into individual files</span></a></li><li  class = 'S4'><a href = "#H_A90EE811"><span>Save the dipole, dipole velocity, and dipole acceleration signals</span></a></li><li  class = 'S4'><a href = "#H_FB7F0C94"><span>Save DFT and orbital energies</span></a></li><li  class = 'S4'><a href = "#H_48DDF558"><span>Save the external field information</span></a></li><li  class = 'S4'><a href = "#H_65D2E853"><span>Save the ionization signal</span></a></li><li  class = 'S4'><a href = "#H_E89C839B"><span>Save the Kohn-Sham orbitals (projection) and one-body density</span></a></li><li  class = 'S4'><a href = "#H_236395D1"><span>Save output functions of the one-body density and Kohn-Sham orbitals</span></a></li><li  class = 'S4'><a href = "#H_5CD2979A"><span>Save restart data file</span></a></li></ul><div  class = 'S1'><span>See the </span><a href = "./TDDFT.html"><span>TDDFT documentation</span></a><span> page for examples of using most of these features. </span></div><div  class = 'S1'><span style=' font-family: monospace;'>QMol_TDDFT_ESSO_4FR</span><span> is a handle class.</span></div><h2  class = 'S2' id = 'H_24F205D3' ><span>Class properties</span></h2><h3  class = 'S5' id = 'H_5B03CB4B' ><span>Time propagation</span></h3><h4  class = 'S6' id = 'H_D8AAEC21' ><span style=' font-family: monospace;'>display (disp)</span></h4><div  class = 'S1'><span>Whether to display progress of the TDDFT calculations as they go on </span><span style=' font-family: monospace;'>[ true (default) | false ]</span></div><h4  class = 'S6' id = 'H_3B6C8431' ><span style=' font-family: monospace;'>time (T)</span></h4><div  class = 'S1'><span>Time propagation vector </span><span style=' font-family: monospace;'>[ vector (default []) ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>In all TDDFT propagation simulations </span><span style=' font-family: monospace;'>T(1)</span><span> specifies the starting time and </span><span style=' font-family: monospace;'>T(end)</span><span> the ending time.</span></li><li  class = 'S4'><span>In forward time propagation simulations (</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'> &gt; 0</span><span>), time values in </span><span style=' font-family: monospace;'>T</span><span> must be all increasing, while for backward time propagation (</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'> &lt; 0</span><span>), they must be all decreasing. Time increments in the vector </span><span style=' font-family: monospace;'>T</span><span> need not be equally spaced.</span></li><li  class = 'S4'><span>When </span><a href = "#H_D8AAEC21"><span style=' font-family: monospace;'>display</span></a><span> is activated, </span><span style=' font-family: monospace;'>T</span><span> specifies the intermediate times for the time-propagation progress display.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>T</span><span> is also the default time sampling for saved results that do not define their own.</span></li><li  class = 'S4'><span>Note that the time step used in TDDFT propagations is set independently of </span><span style=' font-family: monospace;'>T</span><span>.</span></li></ul><h4  class = 'S6' id = 'H_3CC0FE7C' ><span style=' font-family: monospace;'>timeStep (dt)</span></h4><div  class = 'S1'><span>Time step used for the time propagation </span><span style=' font-family: monospace;'> [ scalar (default 0.01) ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Positive (resp. negative) </span><span style=' font-family: monospace;'>timeStep</span><span> defines forward (resp. backward) time propagation.</span></li></ul><h4  class = 'S6'><span style=' font-family: monospace;'>omega (w)</span></h4><div  class = 'S1'><span>Restrain parameter </span><span style=' font-family: monospace;'>[ 'midpoint projection' (default) | scalar (default 10) ]</span></div><ul  class = 'S3'><li  class = 'S4'><span style=' font-family: monospace;'>'midpoint projection'</span><span> uses the midpoint projection algorithm from [</span><a href = "#M_5bc6"><span>Luo 2017</span></a><span>].</span></li><li  class = 'S4'><span>Scalar </span><span style=' font-family: monospace;'>w</span><span> uses the restraint algorithm of [</span><a href = "#M_229e"><span>Tao 2016</span></a><span>].</span></li><li  class = 'S4'><span>See [</span><a href = "#M_F7CBFF54"><span>Mauger 2026</span></a><span>] for explanation of the role of the midpoint projection and restraint.</span></li></ul><h4  class = 'S6'><span style=' font-family: monospace;'>splitPotential (spltV)</span></h4><div  class = 'S1'><span>Whether to split the potential between it explicit and implicit parts </span><span style=' font-family: monospace;'>[ true (default) | false ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Splitting the potential leads to more calculations per time steps but has shown a notable increase in calculations accuracy in test cases.</span></li><li  class = 'S4'><span>See [</span><a href = "#M_F7CBFF54"><span>Mauger 2026</span></a><span>] for explanation of the role of the potential split.</span></li></ul><h4  class = 'S6' id = 'H_56B22A57' ><span style=' font-family: monospace;'>splitMotif</span></h4><div  class = 'S1'><span>Splitting motif </span><span style=' font-family: monospace;'>[ 'HHR' | 'HRH' | 'TVR' | 'TRV' (default) ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Order in which the split operator is taken in the extened phase space (see [</span><a href = "#M_F7CBFF54"><span>Mauger 2026</span></a><span>]).</span></li></ul><h4  class = 'S6' id = 'H_85007098' ><span style=' font-family: monospace;'>absorbingBoundary (ABC)</span></h4><div  class = 'S1'><span>Absorber at the edges of the domain </span><span style=' font-family: monospace;'>[ [] (default) | mask object | CAP object ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>The boundary absorber aims at eliminating outgoing wave packets from the discretization domain and avoid spurious reflections at the edges of the domain.</span></li><li  class = 'S4'><span>Empty </span><span style=' font-family: monospace;'>absorbingBoundary</span><span> does not implement any absorbing boundary method and any part of the wave packet reaching the edges of the domain will be reflected (or artirficially reappears on the other side of the domain through periodic effects).</span></li><li  class = 'S4'><span>Mask absorbers are applied at the end of each propagation step. They are the easiest to use and implement but are first order, irrespective of the order of the time propagation scheme. </span></li><li  class = 'S4'><span>Complex absorbing potentials (CAPs) are integrated within the propagation scheme, as an imaginary potential term that causes exponential decay of the wave packet at the edges. Under the right circumstances, CAPs can preserve the order of the propagation schemes. </span></li></ul><h4  class = 'S6' id = 'H_2EA3F8EC' ><span style=' font-family: monospace;'>externalField (EF)</span></h4><div  class = 'S1'><span>External driving field </span><span style=' font-family: monospace;'>[ [] (default) | </span><a href = "./QMol_extField_dipole.html"><span style=' font-family: monospace;'>QMol_extField_dipole</span></a><span style=' font-family: monospace;'> object ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>When performing the TDDFT propagation, any </span><a href = "#H_35230E97"><span style=' font-family: monospace;'>electricField</span></a><span>, </span><a href = "#H_98CCC7E0"><span style=' font-family: monospace;'>electricFieldDerivative</span></a><span>, or </span><a href = "#H_054F0F9E"><span style=' font-family: monospace;'>potentialVector</span></a><span> are repackaged into </span><span style=' font-family: monospace;'>externalField</span><span>.</span></li><li  class = 'S4'><span>If no electric field or potential vector is defined, either through </span><span style=' font-family: monospace;'>externalField, </span><a href = "#H_35230E97"><span style=' font-family: monospace;'>electricField</span></a><span>, or </span><a href = "#H_054F0F9E"><span style=' font-family: monospace;'>potentialVector</span></a><span>, the TDDFT propagation is performed field free.</span></li></ul><h4  class = 'S6' id = 'H_F8E58A47' ><span style=' font-family: monospace;'>externalFieldGauge (EFG)</span></h4><div  class = 'S1'><span>Gauge in which the external driving field is described </span><span style=' font-family: monospace;'>[ [] (default) | 'none' | 'length' | 'velocity' ]</span></div><ul  class = 'S3'><li  class = 'S4'><span style=' font-family: monospace;'>'none'</span><span> ignores any input external field and propagates the field-free TDDFT dynamics</span></li><li  class = 'S4'><span>The decision tree for the selection of the default gauge is detailed </span><a href = "#H_FD72E490"><span>below</span></a><span>.</span></li></ul><h4  class = 'S6' id = 'H_35230E97' ><span style=' font-family: monospace;'>electricField (FE)</span></h4><div  class = 'S1'><span>Electric field of the external driving field </span><span style=' font-family: monospace;'>[ [] (default) | function handle | griddedInterpolant ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>For developers: When initializing the class, non-empty </span><span style=' font-family: monospace;'>electricField</span><span> is moved into the </span><a href = "#H_2EA3F8EC"><span style=' font-family: monospace;'>externalField</span></a><span> property object (if needed creating the object first). During run time, </span><span style=' font-family: monospace;'>FE</span><span> contains the value of the electric field used in the propagation (where relevant).</span></li></ul><h4  class = 'S6' id = 'H_98CCC7E0' ><span style=' font-family: monospace;'>electricFieldDerivative (FDE)</span></h4><div  class = 'S1'><span>Derivative of the electric field of the external driving field </span><span style=' font-family: monospace;'>[ [] (default) | function handle | griddedInterpolant ]</span></div><ul  class = 'S3'><li  class = 'S4'><span style=' font-family: monospace;'>griddedInterpolant</span><span> </span><span style=' font-family: monospace;'>electricFieldDerivative</span><span> is provided for general support but note that non-function-handle </span><a href = "#H_31F9A72A"><span>electric field derivatives are computed self-consistently</span></a><span> from the electric-field or potential-vector components.</span></li><li  class = 'S4'><span>For developers: When initializing the class, non-empty </span><span style=' font-family: monospace;'>electricFieldDerivative</span><span> is moved into the </span><a href = "#H_2EA3F8EC"><span style=' font-family: monospace;'>externalField</span></a><span> property object (if needed creating the object first). During run time, </span><span style=' font-family: monospace;'>FDE</span><span> contains the value of the derivative of the electric field used in the propagation (where relevant).</span></li></ul><h4  class = 'S6' id = 'H_054F0F9E' ><span style=' font-family: monospace;'>potentialVector (FA)</span></h4><div  class = 'S1'><span>Potential vector of the external driving field </span><span style=' font-family: monospace;'>[ [] (default) | function handle | griddedInterpolant ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>For developers: When initializing the class, non-empty </span><span style=' font-family: monospace;'>potentialVector</span><span> is moved into the </span><span style=' font-family: monospace;'>externalField</span><span> property object (if needed creating the object first). During run time, </span><span style=' font-family: monospace;'>FA</span><span> contains the value of the potential vector used in the propagation (where relevant).</span></li></ul><h4  class = 'S6' id = 'H_23189B60' ><span style=' font-family: monospace;'>diffDT</span></h4><div  class = 'S1'><span>Time step used for computing time derivatives </span><span style=' font-family: monospace;'>[ nonnegative scalar (default 1e-5) ]</span></div><h3  class = 'S5'><span>Save the distance between the orbital copies in the extended phase space</span></h3><div  class = 'S1'><span>The distance can be used to estimate the accuracy of the propagation [</span><a href = "#M_F7CBFF54"><span>Mauger 2026</span></a><span>].</span></div><h4  class = 'S6' id = 'M_0c21' ><span style=' font-family: monospace;'>saveDistanceCopy (sDist)</span></h4><div  class = 'S1'><span>save the distance between the extended phase-space copies </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S6'><span style=' font-family: monospace;'>saveDistanceCopyTime (sDistT)</span></h4><div  class = 'S1'><span>Times at which to save the DFT object into a file </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Empty </span><span style=' font-family: monospace;'>saveDistanceCopyTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to calculate and save the distance.</span></li><li  class = 'S4'><span>A positive scalar specifies the sampling time step when to save distance. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveDistanceCopyTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveDistanceCopyTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A negative integer specifies the number of propagation time steps between saves. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveDistanceCopyTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveDistanceCopyTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A vector provides user-defined times at which to save the distance.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>'all'</span><span> saves the distance after every time step.</span></li><li  class = 'S4'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h3  class = 'S5' id = 'H_A211A946' ><span>Save the DFT object into individual files</span></h3><div  class = 'S1'><span>During the time propagation, copies of the DFT object can be saved in separate MATLAB files.</span></div><h4  class = 'S6' id = 'H_7A5FDD1F' ><span style=' font-family: monospace;'>saveDFT (sDFT)</span></h4><div  class = 'S1'><span>Activate saving the DFT object into separate files </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S6' id = 'H_4D9A3574' ><span style=' font-family: monospace;'>saveDFTFileName (sDFTF)</span></h4><div  class = 'S1'><span>Name for the files in which the DFT objects are saved </span><span style=' font-family: monospace;'>[ character array (default 'QMolGrid--TDDFT--DFT') ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>The DFT objects saved at different times are put in separate MATLAB (.mat.) file, with names starting with </span><span style=' font-family: monospace;'>saveDFTFileName</span><span> to which the iteration index is appended. Each file produced also contains a scalar variable </span><span style=' font-family: monospace;'>t</span><span> with the time information.</span></li><li  class = 'S4'><span>One may specify a location where to create the files by indicating the folder path in </span><span style=' font-family: monospace;'>saveDFTFileName</span></li><li  class = 'S4'><span style=' font-family: monospace;'>saveDFTFileName</span><span> is irrelevant when </span><a href = "#H_7A5FDD1F"><span style=' font-family: monospace;'>saveDFT</span></a><span style=' font-family: monospace;'> == false</span></li></ul><h4  class = 'S6' id = 'H_772A678B' ><span style=' font-family: monospace;'>saveDFTTime (sDFTT)</span></h4><div  class = 'S1'><span>Times at which to save the DFT object into a file </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Empty </span><span style=' font-family: monospace;'>saveDFTTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to save the DFT object into MATLAB files.</span></li><li  class = 'S4'><span>A positive scalar specifies the sampling time step when to save the DFT object into MATLAB files. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveDFTTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveDFTTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A negative integer specifies the number of propagation time steps between saves. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveDFTTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveDFTTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A vector provides user-defined times at which to save the DFT object to a MATLAB file.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>'all'</span><span> saves the DFT object into a MATLAB file after every time step. Warning: this is slow and may result in a very large number of file and/or large disk usage.</span></li><li  class = 'S4'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h3  class = 'S5' id = 'H_A90EE811' ><span>Save the dipole, dipole velocity, and dipole acceleration signals</span></h3><h4  class = 'S6' id = 'H_E30347CB' ><span style=' font-family: monospace;'>saveDipole (sDip)</span></h4><div  class = 'S1'><span>Whether to calculate and save the dipole signal during the TDDFT propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S6' id = 'H_9D21E9DE' ><span style=' font-family: monospace;'>saveDipoleOrbitalIndex (sDipI)</span></h4><div  class = 'S1'><span>Index of the Kohn-Sham orbitals for which to compute the orbital-resolved dipole signal </span><span style=' font-family: monospace;'>[ [] (default) | index vector | cell | 'all' ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>This is irrelevant if </span><a href = "#H_E30347CB"><span style=' font-family: monospace;'>saveDipole</span></a><span> is </span><span style=' font-family: monospace;'>false</span></li><li  class = 'S4'><span>Empty </span><span style=' font-family: monospace;'>saveDipoleOrbitalIndex</span><span> disables the orbital-resolved dipole signal calculation</span></li><li  class = 'S4'><span>For spin restricted models, specify the indexes of the orbitals for which to compute the orbital-resolved dipole signal</span></li><li  class = 'S4'><span>For spin polarized models, combine the up- and down-spin channel orbital indexes in a cell of the form </span><span style=' font-family: monospace;'>{ind_up,ind_down}</span></li><li  class = 'S4'><span style=' font-family: monospace;'>'all'</span><span> computes the orbital-resolved dipole for all orbitals</span></li></ul><h4  class = 'S6' id = 'H_CCC421C5' ><span style=' font-family: monospace;'>saveDipoleTime (sDipT)</span></h4><div  class = 'S1'><span>Times at which to compute and save the dipole signal </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Empty </span><span style=' font-family: monospace;'>saveDipoleTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to compute and save the dipole signal.</span></li><li  class = 'S4'><span>A positive scalar specifies the sampling time step between successive computations of the dipole signal. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveDipoleTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveDipoleTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A negative integer specifies the number of propagation time steps between dipole-signal computations. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveDipoleTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveDipoleTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A vector provides user-defined times at which to compute and save the dipole signal.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>'all'</span><span> computes and saves the dipole signal after every time step. Warning: this may be slow.</span></li><li  class = 'S4'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h4  class = 'S6' id = 'H_2978977D' ><span style=' font-family: monospace;'>saveDipoleVelocity (sVel)</span></h4><div  class = 'S1'><span>Whether to calculate and save the dipole velocity signal during the TDDFT propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><ul  class = 'S3'><li  class = 'S4'><span style=' text-decoration: underline;'>Warning:</span><span> only the explicit part of the DFT potential is used to calculate the velocity, thus eglecting contributions from the implicit part. The class throws a warning when this option is activated.</span></li></ul><h4  class = 'S6' id = 'H_E363B1E2' ><span style=' font-family: monospace;'>saveDipoleVelocityOrbitalIndex (sVelI)</span></h4><div  class = 'S1'><span>Index of the Kohn-Sham orbitals for which to compute the orbital-resolved dipole velocity signal </span><span style=' font-family: monospace;'>[ [] (default) | index vector | cell | 'all' ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>This is irrelevant if </span><a href = "#H_2978977D"><span style=' font-family: monospace;'>saveDipoleVelocity</span></a><span> is </span><span style=' font-family: monospace;'>false</span></li><li  class = 'S4'><span>Empty </span><span style=' font-family: monospace;'>saveDipoleVelocityOrbitalIndex</span><span> disables the orbital-resolved dipole velocity signal calculation</span></li><li  class = 'S4'><span>For spin restricted models, specify the indexes of the orbitals for which to compute the orbital-resolved dipole velocity signal</span></li><li  class = 'S4'><span>For spin polarized models, combine the up- and down-spin channel orbital indexes in a cell of the form </span><span style=' font-family: monospace;'>{ind_up,ind_down}</span></li><li  class = 'S4'><span style=' font-family: monospace;'>'all'</span><span> computes the orbital-resolved dipole velocity for all orbitals</span></li></ul><h4  class = 'S6' id = 'H_FD864729' ><span style=' font-family: monospace;'>saveDipoleVelocityTime (sVelT)</span></h4><div  class = 'S1'><span>Times at which to compute and save the dipole velocity signal </span><span style=' font-family: monospace;'>[ 'dipole' (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S3'><li  class = 'S4'><span style=' font-family: monospace;'>'dipole'</span><span> </span><span style=' font-family: monospace;'>saveDipoleVelocityTime</span><span> uses the same times as for </span><a href = "#H_CCC421C5"><span style=' font-family: monospace;'>saveDipoleTime</span></a><span> </span></li><li  class = 'S4'><span>A positive scalar specifies the sampling time step between successive computations of the dipole velocity signal. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveDipoleVelocityTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveDipoleVelocityTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A negative integer specifies the number of propagation time steps between dipole-velocity-signal computations. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveDipoleVelocityTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveDipoleVelocityTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A vector provides user-defined times at which to compute and save the dipole velocity signal.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>'all'</span><span> computes and saves the dipole velocity signal after every time step. Warning: this may be slow.</span></li><li  class = 'S4'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h4  class = 'S6' id = 'H_CB35D0D0' ><span style=' font-family: monospace;'>saveDipoleAcceleration (sAcc)</span></h4><div  class = 'S1'><span>Whether to calculate and save the dipole acceleration signal during the TDDFT propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><ul  class = 'S3'><li  class = 'S4'><span style=' text-decoration: underline;'>Warning:</span><span> only the explicit part of the DFT potential is used to calculate the acceleration, thus eglecting contributions from the implicit part. The class throws a warning when this option is activated.</span></li></ul><h4  class = 'S6' id = 'H_F7D56BC9' ><span style=' font-family: monospace;'>saveDipoleAccelerationOrbitalIndex (sAccI)</span></h4><div  class = 'S1'><span>Index of the Kohn-Sham orbitals for which to compute the orbital-resolved dipole acceleration signal </span><span style=' font-family: monospace;'>[ [] (default) | index vector | cell | 'all' ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>This is irrelevant if </span><a href = "#H_CB35D0D0"><span style=' font-family: monospace;'>saveDipoleAcceleration</span></a><span> is </span><span style=' font-family: monospace;'>false</span></li><li  class = 'S4'><span>Empty </span><span style=' font-family: monospace;'>saveDipoleAccelerationOrbitalIndex</span><span> disables the orbital-resolved dipole acceleration signal calculation</span></li><li  class = 'S4'><span>For spin restricted models, specify the indexes of the orbitals for which to compute the orbital-resolved dipole acceleration signal</span></li><li  class = 'S4'><span>For spin polarized models, combine the up- and down-spin channel orbital indexes in a cell of the form </span><span style=' font-family: monospace;'>{ind_up,ind_down}</span></li><li  class = 'S4'><span style=' font-family: monospace;'>'all'</span><span> computes the orbital-resolved dipole acceleration for all orbitals</span></li></ul><h4  class = 'S6' id = 'H_267F59C7' ><span style=' font-family: monospace;'>saveDipoleAccelerationTime (sAccT)</span></h4><div  class = 'S1'><span>Times at which to compute and save the dipole acceleration signal </span><span style=' font-family: monospace;'>[ 'dipole' (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S3'><li  class = 'S4'><span style=' font-family: monospace;'>'dipole'</span><span> </span><span style=' font-family: monospace;'>saveDipoleAccelerationTime</span><span> uses the same times as for </span><a href = "#H_CCC421C5"><span style=' font-family: monospace;'>saveDipoleTime</span></a><span> </span></li><li  class = 'S4'><span>A positive scalar specifies the sampling time step between successive computations of the dipole acceleration signal. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveDipoleAccelerationTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveDipoleAccelerationTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A negative integer specifies the number of propagation time steps between dipole-acceleration-signal computations. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveDipoleAccelerationTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveDipoleAccelerationTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A vector provides user-defined times at which to compute and save the dipole acceleration signal.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>'all'</span><span> computes and saves the dipole acceleration signal after every time step. Warning: this may be slow.</span></li><li  class = 'S4'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h3  class = 'S5' id = 'H_FB7F0C94' ><span>Save DFT and orbital energies</span></h3><h4  class = 'S6' id = 'H_CB527D7D' ><span style=' font-family: monospace;'>saveEnergyDFT (sEDFT)</span></h4><div  class = 'S1'><span>Whether to track the DFT energy during the TDDFT propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S6' id = 'H_D15EFD11' ><span style=' font-family: monospace;'>saveEnergyDFTTime (sEDFTT)</span></h4><div  class = 'S1'><span>Times at which to compute and save the DFT energy </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Empty </span><span style=' font-family: monospace;'>saveEnergyDFTTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to compute and save the DFT energy</span></li><li  class = 'S4'><span>A positive scalar specifies the sampling time step between successive computations of the DFT energy. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveEnergyDFTTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveEnergyDFTTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A negative integer specifies the number of propagation time steps between DFT-energy computations. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveEnergyDFTTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveEnergyDFTTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A vector provides user-defined times at which to compute and save the DFT energy.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>'all'</span><span> computes and saves the DFT energy after every time step. Warning: this may be slow.</span></li><li  class = 'S4'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h4  class = 'S6' id = 'H_6190C681' ><span style=' font-family: monospace;'>saveEnergyOrbital (sEKSO)</span></h4><div  class = 'S1'><span>Whether to track the orbital energies during the TDDFT propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>For a Kohn-Sham orbital </span><span texencoding="|\phi\rangle" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAAkCAYAAAD2IghRAAAAAXNSR0IArs4c6QAABRZJREFUWEftWG2IVFUYft6zdyd3WEWsJLbV+zGX3VxBsg+i/mSQ5hctQVZGH5CJsBaGVFoKQWElRCSVEJJkhUZGZFkaUtif0h9hFKytzNx7pt0WLJDSdrede+95mxMzcVlndu5+zIrk/Xvfc85znvfreQ/hIv3oIsWNS8Cn2nOXGP/fMd7R0ZEaGBi4Xggx4Pv+TwA4CQkVQ6W9vX368PDwGiFEUxAEe3p7e/uTbBa3cV33MqXUjQCmMTP5vv81gKjCPmTb9rMAHmpoaFiezWZzSc6qCLytre2KIAgOArhKKbUsn8+fTLJZ3MY0zXlCiEMATCJa43ne7mp72La9AMAhItrmed7OJGfVDbht23cD2A/gN6XU0nw+f6IaIO2dMAx3EtGCMAw7k3i4LsAXLVpk5PP5VwE8DuAIM98jpfxjNCYdx1nBzAeZebWU8oNarNcFuOu6V0ZRdADAzcz8kpRyS62kmzNnTothGHrNmSAIVvf19Z0ZDXxdgFuWdRMRHQEwnYhWep73eS0GAZST9DlmvlNKefhCAN9ARK8BOKmUWpHP5/0EwFFOUmY+bBhGVzabHa62blIZb2lpSafT6VlRFL1SBH0vEX0CYINS6qyU8s9a4RJL0lVCiKW5XO7bugEvHbYMwFYiCgF8BeBRALMB6Av0AFgP4HJtY5rm3qNHj2q7ip9lWUuJ6NOi/eumaW6qZjshxksJpevuHUS0UQixWyl1u64OAM4x82Ip5XHXdedHUfQxAJuI1nme90419ltbW2cZhrGfiK4BsMz3/R8r3XDcwG3bbgfwLoCFMTCwLGsbET1TvMx3DQ0Nndls9vexlkfHcbqY+U3tId/3X6x0yXEB16w0NjbuA7CEiHbMnTv3Se1Sy7JmEtGHABaXXL2x7GrHcV5m5k0A8rW6seu6mSiKvmDmwDAMffnzZMB4gJPjOJt0fR4JwjTNhUIIXcZ0fK/yff8j7WbLsqYR0VtajzBzTgix3PO8U9XivOSh7QA2EtH6SjJgzMDLbABoG+lKx3EeYea3R14ok8nMLgouXctvSNpJbdteUmxgXzLz3kKhsLa/v38wftExA4/F33/JpzfU8nRoaOgNAGuLcX8glUo92NPTc07/y2QytyiltCemJ+mkk864lruFQuE9AJ3x5NPgWltbr25sbNTV5FoAW0pJpX9RLGHP1arPesGkx7hpmrYQQrt8nq4ozLxOSvl3KY5vLbV5lMrgN2UQYRgeIKL5Os6FEBtG64h6zaRXlREae7vneZvLcVcaBrYB+CEIgpV9fX2/arZjiXyKmTullD+P1v5jdTwzWvUZU4zHVZ/uir7vP61r7IgQ2tXU1PRYd3d3wTTN64QQnwEQRPSA53m6q4761atzxhk8IYTozOVyvZWmnViDghCiK5fLfV8LdEyr3MXMy6WUxyZNq7iuO0Mp9TwzdwE4phsQM+uYfwHAIBE9xcwzdQIz8+6hoaH3T58+PVALtP4/JepQK8Hm5uZ0oVBwi+JqK4AVRW1xnIjWKqV6k6jBEZeZWj0+nmmnEvvlCYiZf0mn0w93d3f/VddBYpzTznmYLMu6j4j2TdnMaVnWuKadOPKOjo7mwcHBPQBmhmG4qta8+W9Xq+SOpO8qOs5TqdQuIrq/mqZIkpRlSUBEmyf0rpL0JSveSZn5CSnljiRA4zYxXXJbubwm2WNCr7VaWIVhOEMfZBjGWd10khwatyk/1THz2Qm/HY718Ath/w/u5/hSOv2FnwAAAABJRU5ErkJggg==" width="23" height="18" /></span><span>, the orbital energy is defined as </span><span texencoding="\langle\phi|\hat{\mathcal{H}}_{\rm DFT}|\phi\rangle" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="78" height="24.5" /></span><span> with </span><span texencoding="\hat{\mathcal{H}}_{\rm DFT}" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEwAAAAxCAYAAABwK080AAAAAXNSR0IArs4c6QAACIBJREFUaEPtmn2QW1UVwM957yXZRFulOtZus3kfCS0uOhU/YMaKXccRUQsFVLA6tpVvipbKOAUsFKVY0VFsoYiwfBTwE2ZQEcaKqHU6MjI6OmNlGWry7k3sFGodQTC76WZzjznrfcwzdJP3ltZuOnl/5p1377m/e86555wbhN4TiwDGku4JQw9YTCPoAesBi0kgpnjPwv7PwNBxnHMQ8VsAsJ+IVkgpn4ipQ1eJT9vCCoVCamJi4jJEvB4AEnrVzxHRainlDwGAuopERGWnBaxQKMyemJjYjIifBoCdRLTOMIzXEdEtANBPRFdblrWlWCweiKhH14jFBmbbtouIdyDiyQCwcXR09MZ9+/ZVecWu684FgK8BwAoiutuyrLXFYvGFrqERQdFYwBzHOQkR7wWA5xHxM77v/+Egrmc4jnM6It5KRCNEdH65XBYRdOkKkajADM/zlhPRjYh4d7Va3RhY1VSrHBgY6LcsazMALDqaDoNIwLLZ7PxkMnkcAPzN9/2/xgjohm3bi5rx7Jh6vf6nSqXyXFeYURslIwHr9kUeSv17wGLS7AHrAYtJIKZ4ZAsbHBxMjo+PH6uUmsdpRa1WG9m7d+9oh/lM/b4RkuMT971KqdUA0Me5nJTydzH1PmLiHYFxCaSU+gQRbQKAN4Y0rQHAdwHgZiHELgBQ4VVwgmsYxlvS6fSvRkZG/s3vcrmcZ1nWN5RSsw3DuFgpNYiIZxHRRVJKHm/GP22BDQ0NWZVK5RoiWgkAn02n0z/nFdVqtZOJ6FoA4GwfEPHHALDO9/2i53mzOVnlYlwI8R0NEl3XXdosm24HgD8rpVaVy+VnPM/7sFJqsZRyfYxU5YhCbQssn8+/q9Fo3NvM2M8ul8t/DGvKMKWU70NEXuwkOP3UEfEi3/e3aQjsgiuJiDsaTyilljOs/v7+TDKZ3MoQjxqXdF33C+yGtm1fvmPHjokpthYHBgbmmab5TkS8FhF/msvlNrK8ttALiYgzfmGa5lnFYvFJ/r1cLl/ZtMQ9Usp7usW6Jr2pnX17nncDv/d9/8pWOdd1Fymlxsvl8lODg4OvHhsb406FHVgQj+153ioiuk277aTVzZ8/f04qlboGAH7v+/73W2PfEfW3CJO3Bea67keblsHu9Ckp5fPBeLZtzzMM42rDML6USqVGNazTiOhMKeVvGJbjOKcgIgM5BhG3VKvV9el0+v2IuLTRaGyqVCp+BP1mnEhbYNpyOM6UEPEm3/dfdBznRET8olLqKtd1d+lDYQMRfcVxnA3sio7jLEHEHzEsANhFRHcCwHsQ8TYhxGPdZlXhXeuYVsydO/dVmUzmI0TErejXAMB2ABgWQvw9cDki2m1Z1rJisVjS1seWtQQA+AB4hLscQojfdjOoAFpHYFP5RD6ff7NS6mGOWwCw5sCBA3emUqnFAPB5ADiFYQHAJ4UQD8w4v3oFCk0LmOd5bGnbiOiMZv7F2T43Ek/UmfukOux+hmFcdrS1qacDjJPQcwHgDr1Rz3I72jTNh5VSXA0sIaInAxeNspl84iIiVxNrNHTO+p8CAC6psgBQJqJfI+IPWqsK27bfZhgG63Ohvozhnlupxf1znB4h4ldZHyK6gvPv0Bx5HW+fBYAKAMwGAO7/8caf5/v+XdNyScdxuDRagYif02XSbiJaJqV82vO8Kzjwa1c8XwjBrezIj46VfDicAwBfF0Ks0/kZ5vP544loo7bonaZpXsL5XDD4ggULXl+v1zk8nMTghBDDLRNz23xNs73uaVCcN17K9w06gR7mDWOgQQqVz+cHlFL3cUs+NjBuNycSiXVE9EEA4OJ7llZojRBiq23bxxmG8TOOZ7pMWuX7/r8i0+Krpv9m/i9TPBgjVKZtAIDdQRLM78PAWi0ilAq9CRHXImKKiG4N7k/bzet53rlKqVlSyi2RLCybzaYTiQRb04cA4DoimqMvQRIhMC/oioDvJ19ExDN93/9lHFgs2wkYy3CaU6vVhono4wDwaL1eX75nz55/RgGmv0/WarXTAOCxYEPbzRs0EIQQD3UEpoW/zYqZprm1WQu+QSn1EwA4IbzD+rKDf3/HKwn0UYCx0lzfKqU4tekjotOllNs7AXNd92NEVDnYrXzUedsCy+Vyg6Zp3sMXslLKR4eGhkwp5XWIeBUAcFC9WAhxPw/iOM6piMg7UDMM49RSqfR4MDhbxOjo6FJ2104uGlVxvpBJJBIcr97ajJfrhRCb2gHjcfv6+m5RSm3TVcj/GH/UeacEFnQRDMPYGXQcuA1DRJy586kR7kTw5S0X6F8mogczmczKoPel+2j8ToY6F1N6alTFs9nsnEQiwRu0OAjSLUGf70D3hyaaPCGJaOiwALNt+wSuEev1+iqOD4VC4fhGo/Eg9/8QcbXv+9xdeKlZyAU6H9NEtDYIjhz7kskk98uejgIragzTFv1aRGTr5rp08lRrZ2F8G69bSzcdFmCe572b28djY2MXZDKZPBF9j0+W5p3keUKIna2tGF2gP4CIl/u+vzmXy7mmaW5ii5RS8sIi/SklqoWF4QSbFCGGXcDl22EBpgtuPro/AABVRByuVqv3T3XTzdZkWRbnOJcCwD/0n1O+KaWUcU7KqMC0B3DQTwcxsxOwdnpEnbfjKRlnsYdCNqLiXGVwXLw+HDN7wEIZd2gzwj22/XET16k2NeJGvfT5dGrJQ2FQLxujQ2mUbTQal3BJRkSP842T/o/H5Dj5fJ5zxEc4F2TrE0JwRzfSs3Dhwlnj4+P3AcCylpLsoN/PCGBcfHONyjdTuoAOCmNuEWWb13DPNNOIX7QW3/oi5u2IeHbo2zKfno1GY3u7v1lN8S0X3zcbhvFQqVT6y8GIzQhgkUxhhgj1gMXciB6wHrCYBGKK9yysBywmgZjiPQuLCew/wNCWbkb7M6UAAAAASUVORK5CYII=" width="38" height="24.5" /></span><span> the DFT Hamiltonian operator.</span></li><li  class = 'S4'><span>In the velocity gauge, the external potential vector is accounted for in the kinetic-operator of </span><span texencoding="\hat{\mathcal{H}}_{\rm DFT}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="38" height="24.5" /></span><span> while, in the length gauge, the external electric field is ignored.</span></li><li  class = 'S4'><span>Note that the energy of all the Kohn-Sham orbitals are computed and saved. One may use an </span><a href = "#H_236395D1"><span>installable output function</span></a><span> of the Kohn-Sham orbitals to track the energy of a subset of orbitals.</span></li></ul><h4  class = 'S6' id = 'H_98DA6C1A' ><span style=' font-family: monospace;'>saveEnergyOrbitalTime (sEKSOT)</span></h4><div  class = 'S1'><span>Times at which to compute and save the Kohn-Sham orbital energies </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Empty </span><span style=' font-family: monospace;'>saveEnergyOrbitalTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to compute and save the Kohn-Sham orbital energies</span></li><li  class = 'S4'><span>A positive scalar specifies the sampling time step between successive computations of the Kohn-Sham orbital energies. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveEnergyOrbitalTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveEnergyOrbitalTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A negative integer specifies the number of propagation time steps between Kohn-Sham-orbital-energy computations. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveEnergyOrbitalTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveEnergyOrbitalTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A vector provides user-defined times at which to compute and save the Kohn-Sham-orbital energies.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>'all'</span><span> computes and saves the Kohn-Sham orbital energies after every time step. Warning: this may be slow.</span></li><li  class = 'S4'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h3  class = 'S5' id = 'H_48DDF558' ><span>Save the external field information</span></h3><h4  class = 'S6' id = 'H_10596868' ><span style=' font-family: monospace;'>saveExternalField (sEF)</span></h4><div  class = 'S1'><span>For TDDFT simulation with </span><a href = "#H_2EA3F8EC"><span>external driving field</span></a><span>, save the external field in the output structures </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>When activated (</span><span style=' font-family: monospace;'>saveExternalField = true</span><span>), the information about the external driving field at the sampled times is added to each of the </span><a href = "#H_D533B953"><span>output structures</span></a><span>.</span></li><li  class = 'S4'><span>For practical reasons, the values for the external driving field may be slightly different from that of </span><a href = "#H_2EA3F8EC"><span style=' font-family: monospace;'>externalField</span></a><span>. This features enables keeping the actual external-field values used throughout the propagation.</span></li></ul><h3  class = 'S5' id = 'H_65D2E853' ><span>Save the ionization signal</span></h3><div  class = 'S1'><span>The ionization signal tracks how much density leaves the simulation domain by being </span><a href = "#H_85007098"><span>absorbed at the boundaries</span></a><span>.</span></div><h4  class = 'S6' id = 'H_6B566C83' ><span style=' font-family: monospace;'>saveIonization (sIon)</span></h4><div  class = 'S1'><span>Whether to calculate and save the ionization signal during the TDDFT propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S6' id = 'H_07FC104D' ><span style=' font-family: monospace;'>saveIonizationOrbitalIndex (sIKSOI)</span></h4><div  class = 'S1'><span>Index of the Kohn-Sham orbitals for which to compute the orbital-resolved ionization signal </span><span style=' font-family: monospace;'>[ [] (default) | index vector | cell | 'all' ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>This is irrelevant if </span><a href = "#H_6B566C83"><span style=' font-family: monospace;'>saveIonization</span></a><span> is </span><span style=' font-family: monospace;'>false</span></li><li  class = 'S4'><span>Empty </span><span style=' font-family: monospace;'>saveIonizationOrbitalIndex</span><span> disables the orbital-resolved ionization signal calculation</span></li><li  class = 'S4'><span>For spin restricted models, specify the indexes of the orbitals for which to compute the orbital-resolved ionization signal</span></li><li  class = 'S4'><span>For spin polarized models, combine the up- and down-spin channel orbital indexes in a cell of the form </span><span style=' font-family: monospace;'>{ind_up,ind_down}</span></li><li  class = 'S4'><span style=' font-family: monospace;'>'all'</span><span> computes the orbital-resolved ionization for all orbitals</span></li></ul><h4  class = 'S6' id = 'H_01E66AA1' ><span style=' font-family: monospace;'>saveIonizationTime (sIonT)</span></h4><div  class = 'S1'><span>Times at which to compute and save the ionization signal </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Empty </span><span style=' font-family: monospace;'>saveIonizationTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to compute and save the ionization signal.</span></li><li  class = 'S4'><span>A positive scalar specifies the sampling time step between successive computations of the ionization signal. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveIonizationTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveIonizationTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A negative integer specifies the number of propagation time steps between ionization-signal computations. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveIonizationTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveIonizationTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A vector provides user-defined times at which to compute and save the ionization signal.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>'all'</span><span> computes and saves the ionization signal after every time step. Warning: this may be slow.</span></li><li  class = 'S4'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h3  class = 'S5' id = 'H_E89C839B' ><span>Save the Kohn-Sham orbitals (projection) and one-body density</span></h3><div  class = 'S1' id = 'M_5BAA8F46' ><span style=' text-decoration: underline;'>Warning:</span><span> The memory requirements for saving the orbitals or density throughout the TDDFT propagation may grow very fast and trigger an error (if MATLAB runs out of memory). Instead, if the full orbital/one-body density is required consider </span><a href = "#H_A211A946"><span>saving the DFT object in separate files</span></a><span>, or if only the result of a specify calculation on the orbital/one-body density is required consider consider using installable </span><a href = "#H_236395D1"><span>output functions</span></a><span>.</span></div><h4  class = 'S6' id = 'H_B3D550CC' ><span style=' font-family: monospace;'>saveDensity (sRho)</span></h4><div  class = 'S1'><span>Whether to save the one-body density during the TDDFT propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S6' id = 'H_9AA8162A' ><span style=' font-family: monospace;'>saveDensityTime (sRhoT)</span></h4><div  class = 'S1'><span>Times at which to save the one-body density </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Empty </span><span style=' font-family: monospace;'>saveDensityTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to save the one-body density.</span></li><li  class = 'S4'><span>A positive scalar specifies the sampling time step between successive saving of the one-body density. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveDensityTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveDensityTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A negative integer specifies the number of propagation time steps between saving the one-body density. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveDensityTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveDensityTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A vector provides user-defined times at which to save the one-body density.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>'all'</span><span> saves the one-body density after every time step. Warning: generally discouraged as it likely results in very large memory requirements or causes an out-of-memory error -- see the </span><a href = "#M_5BAA8F46"><span>warning above</span></a><span>.</span></li><li  class = 'S4'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h4  class = 'S6' id = 'H_2A78E237' ><span style=' font-family: monospace;'>saveOrbital (sKSO)</span></h4><div  class = 'S1'><span>Whether to save the Kohn-Sham orbitals during the TDDFT propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S6' id = 'H_F26B9668' ><span style=' font-family: monospace;'>saveOrbitalIndex (sKSOI)</span></h4><div  class = 'S1'><span>Index of the Kohn-Sham orbitals to save </span><span style=' font-family: monospace;'>[ [] (default) | index vector | cell | 'all' ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>This is irrelevant if </span><a href = "#H_2A78E237"><span style=' font-family: monospace;'>saveOrbital</span></a><span> is </span><span style=' font-family: monospace;'>false</span></li><li  class = 'S4'><span>Empty </span><span style=' font-family: monospace;'>saveOrbitalIndex</span><span> disables saving of the Kohn-Sham orbitals and is technically equivalent to </span><a href = "#H_2A78E237"><span style=' font-family: monospace;'>saveOrbital </span></a><span style=' font-family: monospace;'>= false</span></li><li  class = 'S4'><span>For spin restricted models, specify the indexes of the orbitals to save</span></li><li  class = 'S4'><span>For spin polarized models, combine the up- and down-spin channel orbital indexes in a cell of the form </span><span style=' font-family: monospace;'>{ind_up,ind_down}</span></li><li  class = 'S4'><span style=' font-family: monospace;'>'all'</span><span> saves all the Kohn-Sham orbitals</span></li></ul><h4  class = 'S6' id = 'H_A93BF65C' ><span style=' font-family: monospace;'>saveOrbitalTime (sKSOT)</span></h4><div  class = 'S1'><span>Times at which to save the Kohn-Sham orbitals </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Empty </span><span style=' font-family: monospace;'>saveOrbitalTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to save the Kohn-Sham orbitals.</span></li><li  class = 'S4'><span>A positive scalar specifies the sampling time step between successive saving of the Kohn-Sham orbitals. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveOrbitalTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveOrbitalTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A negative integer specifies the number of propagation time steps between saving Kohn-Sham orbitals. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveOrbitalTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveOrbitalTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A vector provides user-defined times at which to save the Kohn-Sham orbitals.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>'all'</span><span> saves the Kohn-Sham orbitals after every time step. Warning: generally discouraged as it likely results in very large memory requirements or causes an out-of-memory error -- see the </span><a href = "#M_5BAA8F46"><span>warning above</span></a><span>.</span></li><li  class = 'S4'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h4  class = 'S6' id = 'H_0A85DA1C' ><span style=' font-family: monospace;'>saveOrbitalProjection (sKSOP)</span></h4><div  class = 'S1'><span>Whether to save the projection of the Kohn-Sham orbitals onto a specific basis during the TDDFT propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S6' id = 'H_6BFEE12B' ><span style=' font-family: monospace;'>saveOrbitalProjectionBasis (sKSOPB)</span></h4><div  class = 'S1'><span>Projection basis </span><span style=' font-family: monospace;'>[ [] (default) | matrix basis | </span><a href = "./QMol_disc_basis.html"><span style=' font-family: monospace;'>QMol_disc_basis</span></a><span style=' font-family: monospace;'> ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Empty </span><span style=' font-family: monospace;'>saveOrbitalProjectionBasis</span><span> uses the initial Kohn-Sham orbitals as the projection basis</span></li><li  class = 'S4'><span>matrix </span><span style=' font-family: monospace;'>saveOrbitalProjectionBasis</span><span> specifies the projection basis to be used, with the projection vectors specified in each column of the matrix. For spin-polarized models, the same projection basis used for both the projection of the up- and down-spin Kohn-Sham orbitals. Alternatively, one may specify separate basis sets by collecting them into a cell </span><span style=' font-family: monospace;'>{matrix_basis_up, matrix_basis_down}</span><span>.</span></li><li  class = 'S4'><a href = "./QMol_disc_basis.html"><span style=' font-family: monospace;'>QMol_disc_basis</span></a><span> </span><span style=' font-family: monospace;'>saveOrbitalProjectionBasis</span><span> uses the basis set of the associated domain definition. For spin-polarized models, the same projection basis used for both the projection of the up- and down-spin Kohn-Sham orbitals. Alternatively, one may specify separate basis sets by collecting them into a cell </span><span style=' font-family: monospace;'>{QMol_disc_basis_up, QMol_disc_basis_down}</span><span>.</span></li><li  class = 'S4'><span>For both matrix and </span><a href = "./QMol_disc_basis.html"><span style=' font-family: monospace;'>QMol_disc_basis</span></a><span>, the user-defined basis set is assumed to be a proper orthonormal family defined over the same domain grid as the DFT model being propagated. The TDDFT propagator </span><span style=' text-decoration: underline;'>does not</span><span> check for this and will produce erroneous results, or trigger an error, otherwise.</span></li></ul><h4  class = 'S6' id = 'H_44353F0D' ><span style=' font-family: monospace;'>saveOrbitalProjectionIndex (sKSOPI)</span></h4><div  class = 'S1'><span>Index of the Kohn-Sham orbitals for which to perform the projection </span><span style=' font-family: monospace;'>[ [] (default) | index vector | cell | 'all' ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>This is irrelevant if </span><a href = "#H_0A85DA1C"><span style=' font-family: monospace;'>saveOrbitalProjectionBasis</span></a><span> is </span><span style=' font-family: monospace;'>false</span></li><li  class = 'S4'><span>Empty </span><span style=' font-family: monospace;'>saveOrbitalProjectionIndex</span><span> disables saving of the Kohn-Sham orbitals and is technically equivalent to </span><a href = "#H_0A85DA1C"><span style=' font-family: monospace;'>saveOrbitalProjectionBasis</span></a><span> </span><span style=' font-family: monospace;'>= false</span></li><li  class = 'S4'><span>For spin restricted models, specify the indexes of the orbitals for which to perform the projection</span></li><li  class = 'S4'><span>For spin polarized models, combine the up- and down-spin channel orbital indexes in a cell of the form </span><span style=' font-family: monospace;'>{ind_up,ind_down}</span></li><li  class = 'S4'><span style=' font-family: monospace;'>'all'</span><span> saves the projection for all the Kohn-Sham orbitals</span></li></ul><h4  class = 'S6' id = 'H_71646414' ><span style=' font-family: monospace;'>saveOrbitalProjectionTime (sKSOPT)</span></h4><div  class = 'S1'><span>Times at which to save the projection of the Kohn-Sham orbitals </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Empty </span><span style=' font-family: monospace;'>saveOrbitalProjectionTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to save the projection of the Kohn-Sham orbitals.</span></li><li  class = 'S4'><span>A positive scalar specifies the sampling time step between successive savings of the Kohn-Sham orbitals' projection. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveOrbitalProjectionTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveOrbitalProjectionTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A negative integer specifies the number of propagation time steps between saving Kohn-Sham orbitals' projection. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveOrbitalProjectionTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveOrbitalProjectionTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A vector provides user-defined times at which to save the Kohn-Sham orbitals' projection.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>'all'</span><span> saves the Kohn-Sham orbitals' projection after every time step. Warning: this may be slow.</span></li><li  class = 'S4'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h3  class = 'S5' id = 'H_236395D1' ><span>Save output functions of the one-body density and Kohn-Sham orbitals</span></h3><div  class = 'S1'><span>These enable on-the-fly computation and saving of user-defined observables without having to save the DFT, Kohn-Sham orbitals, or one-body density.</span></div><h4  class = 'S6' id = 'H_D1715482' ><span style=' font-family: monospace;'>saveOutputFunctionDensity (sFRho)</span></h4><div  class = 'S1'><span>Installable output function of the one-body density </span><span style=' font-family: monospace;'>[ [] (default) | function handle ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Leave empty to disable the feature</span></li><li  class = 'S4'><span>Provide a function handle to enable the feature. The signature for the function is </span><span style=' font-family: monospace;'>fun(rho,t)</span><span> where </span><span style=' font-family: monospace;'>rho</span><span> is a one-body density object and </span><span style=' font-family: monospace;'>t</span><span> is the time (scalar). The function handle may return an array of arbitrary size and shape, but must return at least a scalar and the shape of the output must remain constant throughout the TDDFT propagation.</span></li></ul><h4  class = 'S6' id = 'H_D3553E6F' ><span style=' font-family: monospace;'>saveOutputFunctionDensityTime (sFRhoT)</span></h4><div  class = 'S1'><span>Times at which to evaluate and save the installable output function of the one-body density </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Empty </span><span style=' font-family: monospace;'>saveOutputFunctionDensityTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to evaluate and save the output function.</span></li><li  class = 'S4'><span>A positive scalar specifies the sampling time step between successive evaluation and saving of the output function. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveOutputFunctionDensityTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveOutputFunctionDensityTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A negative integer specifies the number of propagation time steps between evaluations and saving of the output function. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveOutputFunctionDensityTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveOutputFunctionDensityTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A vector provides user-defined times at which to evaluate and save the output function.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>'all'</span><span> evaluates and saves the output function after every time step. Warning: this may be slow.</span></li><li  class = 'S4'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h4  class = 'S6' id = 'H_13D0EA88' ><span style=' font-family: monospace;'>saveOutputFunctionOrbital (sFKSO)</span></h4><div  class = 'S1'><span>Installable output function of the Kohn-Sham orbitals </span><span style=' font-family: monospace;'>[ [] (default) | function handle ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Leave empty to disable the feature</span></li><li  class = 'S4'><span>Provide a function handle to enable the feature. The signature for the function is </span><span style=' font-family: monospace;'>fun(KSO,t)</span><span> where </span><span style=' font-family: monospace;'>KSO</span><span> is a Kohn-Sham orbital object and </span><span style=' font-family: monospace;'>t</span><span> is the time (scalar). The functional handle may return an array of arbitrary size and shape, but must return at least a scalar and the shape of the output must remain constant throughout the TDDFT propagation.</span></li><li  class = 'S4'><span style=' text-decoration: underline;'>Warning:</span><span> The DFT model Kohn-Sham orbitals are passed by reference to the output function. Thus modifying the Kohn-Sham orbitals in the output function will also modify them for the DFT model (and thus TDDFT propagation) and will likely result in erroneous results or produce an error.</span></li></ul><h4  class = 'S6' id = 'H_B72B0D00' ><span style=' font-family: monospace;'>saveOutputFunctionOrbitalTime (sFKSOT)</span></h4><div  class = 'S1'><span>Times at which to evaluate and save the installable output function of the Kohn-Sham orbitals </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Empty </span><span style=' font-family: monospace;'>saveOutputFunctionOrbitalTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to evaluate and save the output function.</span></li><li  class = 'S4'><span>A positive scalar specifies the sampling time step between successive evaluation and saving of the output function. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveOutputFunctionOrbitalTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveOutputFunctionOrbitalTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A negative integer specifies the number of propagation time steps between evaluations and saving of the output function. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveOutputFunctionOrbitalTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveOutputFunctionOrbitalTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A vector provides user-defined times at which to evaluate and save the output function.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>'all'</span><span> evaluates and saves the output function after every time step. Warning: this may be slow.</span></li><li  class = 'S4'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h3  class = 'S5' id = 'H_5CD2979A' ><span>Save restart data file</span></h3><div  class = 'S1'><span>During the time propagation, a restart file can be generated to enable resuming the simulation if it is cut short. Stopping the TDDFT simulation while it writes the restart info may lead to a corrupted file from which restart will not be possible. The restart file contains a copy of the TDDFT-propagator and DFT-model objects, respectively called </span><span style=' font-family: monospace;'>TDDFT</span><span> and </span><span style=' font-family: monospace;'>DFT</span><span>.</span></div><h4  class = 'S6' id = 'H_06F9031D' ><span style=' font-family: monospace;'>saveRestart (sRest)</span></h4><div  class = 'S1'><span>Activate the generation of a restart file </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S6' id = 'H_AE8821C0' ><span style=' font-family: monospace;'>saveRestartFileName (sRestF)</span></h4><div  class = 'S1'><span>Name for the restart file </span><span style=' font-family: monospace;'>[ character array (default 'QMolGrid--TDDFT--Restart.mat') ]</span></div><ul  class = 'S3'><li  class = 'S4'><span style=' font-family: monospace;'>saveRestartFileName</span><span> must be a valid MATLAB file name ('.mat' extension).</span></li><li  class = 'S4'><span style=' font-family: monospace;'>saveRestartFileName</span><span> is irrelevant when </span><a href = "#H_06F9031D"><span style=' font-family: monospace;'>saveRestart</span></a><span style=' font-family: monospace;'> == false</span></li></ul><h4  class = 'S6' id = 'H_5668813B' ><span style=' font-family: monospace;'>saveRestartTime (sRestT)</span></h4><div  class = 'S1'><span>Times at which to generate or update the restart file </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Empty </span><span style=' font-family: monospace;'>saveRestartTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to generate and update the restart file.</span></li><li  class = 'S4'><span>A positive scalar specifies the sampling time step when to generate and update the restart file. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveRestartTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveRestartTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A negative integer specifies the number of propagation time steps between the generation and update of the restart file. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveRestartTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveRestartTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S4'><span>A vector provides user-defined times at which to generate and update the restart file.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>'all'</span><span> generates and updates the restart file after each time step. Warning: this is very slow and is strongly discouraged.</span></li><li  class = 'S4'><span style=' text-decoration: underline;'>Note:</span><span> In all cases no restart file is generated for the initial time and final propagation time-step.</span></li><li  class = 'S4'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h3  class = 'S5' id = 'H_D533B953' ><span>Output results</span></h3><div  class = 'S1' id = 'M_16F59492' ><span>During a TDDFT propagation, the results of on-the-fly calculations are stored in structures in the </span><span style=' font-family: monospace;'>QMol_TDDFT</span><span> object. Note that </span><span style=' font-family: monospace;'>QMol_TDDFT</span><span> does </span><span style=' text-decoration: underline;'>not</span><span> interpolate its time propagation to fit user-supplied sample times, Instead, the results are saved at the closest propagation time steps, excluding duplicate times. This may result in sampled times that are different, or have a different (smaller) number of elements, from the ones specified above. Notably, using a sampling time that is not a multiple of the propagation time step may result in uneven saved time sampling. The actual times at with output are saved is included in each of the output structure.</span></div><div  class = 'S1'><span>When </span><a href = "#H_10596868"><span style=' font-family: monospace;'>saveExternalField</span></a><span> is </span><span style=' font-family: monospace;'>true</span><span>, each output-result structure includes the following fields:</span></div><ul  class = 'S3'><li  class = 'S4'><span>In the length gauge, </span><span style=' font-family: monospace;'>outStructure.electricField</span><span> contains the specific values for the electric field used in the TDSE propagation at the saved times.</span></li><li  class = 'S4'><span>In the velocity gauge, </span><span style=' font-family: monospace;'>outStructure.potentialVector</span><span> contains the specific values for the potential vector used in the TDSE propagation at the saved times.</span></li><li  class = 'S4'><span>In all cases, if the potential vector, electric field, or derivative of the electric field are calculated by the propagator during the simulations (see the decision tree </span><a href = "#H_31F9A72A"><span>below</span></a><span>), those are included in </span><span style=' font-family: monospace;'>outStructure.potentialVector</span><span>, </span><span style=' font-family: monospace;'>outStructure.electricField</span><span>, and </span><span style=' font-family: monospace;'>outStructure.electricFieldDerivative</span><span>, respectively.</span></li></ul><div  class = 'S1'><span>In </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>, each of the output structure contains a handful of additional fields to the ones listed below that are relevant for run-time calculations. These fields are saved in the MATLAB restart file but removed upon completion of the TDDFT propagation.</span></div><h4  class = 'S6'><span style=' font-family: monospace;'>outDistanceCopy (oDist)</span></h4><div  class = 'S1'><span>Result of calculating the distance between the extended phase-space copies </span><span style=' font-family: monospace;'>[ structure | [] (default) ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>TDDFT propagation that does not compute the distance (</span><a href = "#M_0c21"><span style=' font-family: monospace;'>saveDistanceCopy</span></a><span style=' font-family: monospace;'> = false</span><span>) leaves </span><span style=' font-family: monospace;'>outDistanceCopy</span><span> empty. Otherwise:</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outDipole.time</span><span> defines the precise times at which the dipole signal is computed.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outDipole.distance</span><span> contains the corresponding distance.</span></li></ul><h4  class = 'S6' id = 'H_F65810AA' ><span style=' font-family: monospace;'>outDipole (oDip)</span></h4><div  class = 'S1'><span>Result of dipole-signal calculations during the TDDFT propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>TDDFT propagation that does not compute the dipole signal (</span><a href = "#H_E30347CB"><span style=' font-family: monospace;'>saveDipole</span></a><span style=' font-family: monospace;'> = false</span><span>) leaves </span><span style=' font-family: monospace;'>outDipole</span><span> empty. Otherwise:</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outDipole.time</span><span> defines the precise times at which the dipole signal is computed.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outDipole.total</span><span> contains the corresponding total dipole signal and, for spin-polarized DFT models, </span><span style=' font-family: monospace;'>outDipole.totalUp</span><span> and </span><span style=' font-family: monospace;'>outDipole.totalDown</span><span> contain the total dipole signal in the up- and down-spin channels, respectively.</span></li><li  class = 'S4'><span>Orbital-resolved dipole signals are stored in </span><span style=' font-family: monospace;'>outDipole.orbital_x</span><span>, </span><span style=' font-family: monospace;'>outDipole.orbitalUp_x</span><span>, and </span><span style=' font-family: monospace;'>outDipole.orbitalDown_x</span><span>. The indices of the orbitals associated with each of these are included in </span><span style=' font-family: monospace;'>outDipole.indexOrbital</span><span>, </span><span style=' font-family: monospace;'>outDipole.indexOrbitalUp</span><span>, and </span><span style=' font-family: monospace;'>outDipole.indexOrbitalDown.</span></li></ul><h4  class = 'S6' id = 'H_95407807' ><span style=' font-family: monospace;'>outDipoleVelocity (oVel)</span></h4><div  class = 'S1'><span>Result of dipole-velocity-signal calculations during the TDDFT propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>TDDFT propagation that does not compute the dipole signal (</span><a href = "#H_2978977D"><span style=' font-family: monospace;'>saveDipoleVelocity</span></a><span style=' font-family: monospace;'> = false</span><span>) leaves </span><span style=' font-family: monospace;'>outDipoleVelocity</span><span> empty. Otherwise:</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outDipoleVelocity.time</span><span> defines the precise times at which the dipole velocity signal is computed.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outDipoleVelocity.total</span><span> contains the corresponding total dipole velocity signal and, for spin-polarized DFT models, </span><span style=' font-family: monospace;'>outDipoleVelocity.totalUp</span><span> and </span><span style=' font-family: monospace;'>outDipoleVelocity.totalDown</span><span> contain the total dipole velocity signal in the up- and down-spin channels, respectively.</span></li><li  class = 'S4'><span>Orbital-resolved dipole velocity signals are stored in </span><span style=' font-family: monospace;'>outDipoleVelocity.orbital_x</span><span>, </span><span style=' font-family: monospace;'>outDipoleVelocity.orbitalUp_x</span><span>, and </span><span style=' font-family: monospace;'>outDipoleVelocity.orbitalDown_x</span><span>. The indices of the orbitals associated with each of these are included in </span><span style=' font-family: monospace;'>outDipoleVelocity.indexOrbital</span><span>, </span><span style=' font-family: monospace;'>outDipoleVelocity.indexOrbitalUp</span><span>, and </span><span style=' font-family: monospace;'>outDipoleVelocity.indexOrbitalDown.</span></li></ul><h4  class = 'S6' id = 'H_02629977' ><span style=' font-family: monospace;'>outDipoleAcceleration (oAcc)</span></h4><div  class = 'S1'><span>Result of dipole-acceleration-signal calculations during the TDDFT propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>TDDFT propagation that does not compute the dipole signal (</span><a href = "#H_CB35D0D0"><span style=' font-family: monospace;'>saveDipoleAcceleration</span></a><span style=' font-family: monospace;'> = false</span><span>) leaves </span><span style=' font-family: monospace;'>outDipoleAcceleration</span><span> empty. Otherwise:</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outDipoleAcceleration.time</span><span> defines the precise times at which the dipole acceleration signal is computed.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outDipoleAcceleration.total</span><span> contains the corresponding total dipole acceleration signal and, for spin-polarized DFT models, </span><span style=' font-family: monospace;'>outDipoleAcceleration.totalUp</span><span> and </span><span style=' font-family: monospace;'>outDipoleAcceleration.totalDown</span><span> contain the total dipole acceleration signal in the up- and down-spin channels, respectively.</span></li><li  class = 'S4'><span>Orbital-resolved dipole velocity signals are stored in </span><span style=' font-family: monospace;'>outDipoleAcceleration.orbital_x</span><span>, </span><span style=' font-family: monospace;'>outDipoleAcceleration.orbitalUp_x</span><span>, and </span><span style=' font-family: monospace;'>outDipoleAcceleration.orbitalDown_x</span><span>. The indices of the orbitals associated with each of these are included in </span><span style=' font-family: monospace;'>outDipoleAcceleration.indexOrbital</span><span>, </span><span style=' font-family: monospace;'>outDipoleAcceleration.indexOrbitalUp</span><span>, and </span><span style=' font-family: monospace;'>outDipoleAcceleration.indexOrbitalDown.</span></li></ul><h4  class = 'S6' id = 'H_B6B04F7C' ><span style=' font-family: monospace;'>outEnergyDFT (oEDFT)</span></h4><div  class = 'S1'><span>Result of the DFT-energy calculations during the TDDFT propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>TDDFT propagation that does track the DFT energy (</span><a href = "#H_CB527D7D"><span style=' font-family: monospace;'>saveEnergyDFT</span></a><span style=' font-family: monospace;'> = false</span><span>) leaves </span><span style=' font-family: monospace;'>outEnergyDFT</span><span> empty. Otherwise:</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outEnergyDFT.time</span><span> defines the precise times at which the DFT energies are computed.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outEnergyDFT.total</span><span> contains the total DFT energy, which should be constant (within the precision of the propagation scheme).</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outEnergyDFT.kinetic</span><span> contains the kinetic-energy component, including the driving-field potential vector in the velocity gauge. For spin-polarized models the two rows contain the up- and down-spin kinetic energy components, respectively.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outEnergyDFT.external</span><span> contains the external-energy component. For spin-polarized models the two rows contain the up- and down-spin external energy components, respectively</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outEnergyDFT.Hartree</span><span> contains the Hartree-energy component. </span></li><li  class = 'S4'><span style=' font-family: monospace;'>outEnergyDFT.exchangeCorrelation</span><span> contains the exchange-correlation-energy component. </span></li><li  class = 'S4'><span style=' font-family: monospace;'>outEnergyDFT.externalField</span><span> contains the energy contribution from the driving electric field in the length gauge. For spin-polarized models the two rows contain the up- and down-spin energy components, respectively.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outEnergyDFT.autonomization</span><span> contains the energy brought in and out of the system by the </span><a href = "#H_2EA3F8EC"><span>external driving field</span></a><span> (if any).</span></li></ul><h4  class = 'S6' id = 'H_71BECE2C' ><span style=' font-family: monospace;'>outEnergyOrbital (oEKSO)</span></h4><div  class = 'S1'><span>Result of the Kohn-Sham-orbital-energy calculations during the TDDFT propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>TDDFT propagation that does track the DFT energy (</span><a href = "#H_6190C681"><span style=' font-family: monospace;'>saveEnergyOrbital</span></a><span style=' font-family: monospace;'> = false</span><span>) leaves </span><span style=' font-family: monospace;'>outEnergyDFT</span><span> empty. Otherwise:</span></li><li  class = 'S4'><span>For a Kohn-Sham orbital </span><span texencoding="|\phi\rangle" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAAkCAYAAAD2IghRAAAAAXNSR0IArs4c6QAABRZJREFUWEftWG2IVFUYft6zdyd3WEWsJLbV+zGX3VxBsg+i/mSQ5hctQVZGH5CJsBaGVFoKQWElRCSVEJJkhUZGZFkaUtif0h9hFKytzNx7pt0WLJDSdrede+95mxMzcVlndu5+zIrk/Xvfc85znvfreQ/hIv3oIsWNS8Cn2nOXGP/fMd7R0ZEaGBi4Xggx4Pv+TwA4CQkVQ6W9vX368PDwGiFEUxAEe3p7e/uTbBa3cV33MqXUjQCmMTP5vv81gKjCPmTb9rMAHmpoaFiezWZzSc6qCLytre2KIAgOArhKKbUsn8+fTLJZ3MY0zXlCiEMATCJa43ne7mp72La9AMAhItrmed7OJGfVDbht23cD2A/gN6XU0nw+f6IaIO2dMAx3EtGCMAw7k3i4LsAXLVpk5PP5VwE8DuAIM98jpfxjNCYdx1nBzAeZebWU8oNarNcFuOu6V0ZRdADAzcz8kpRyS62kmzNnTothGHrNmSAIVvf19Z0ZDXxdgFuWdRMRHQEwnYhWep73eS0GAZST9DlmvlNKefhCAN9ARK8BOKmUWpHP5/0EwFFOUmY+bBhGVzabHa62blIZb2lpSafT6VlRFL1SBH0vEX0CYINS6qyU8s9a4RJL0lVCiKW5XO7bugEvHbYMwFYiCgF8BeBRALMB6Av0AFgP4HJtY5rm3qNHj2q7ip9lWUuJ6NOi/eumaW6qZjshxksJpevuHUS0UQixWyl1u64OAM4x82Ip5XHXdedHUfQxAJuI1nme90419ltbW2cZhrGfiK4BsMz3/R8r3XDcwG3bbgfwLoCFMTCwLGsbET1TvMx3DQ0Nndls9vexlkfHcbqY+U3tId/3X6x0yXEB16w0NjbuA7CEiHbMnTv3Se1Sy7JmEtGHABaXXL2x7GrHcV5m5k0A8rW6seu6mSiKvmDmwDAMffnzZMB4gJPjOJt0fR4JwjTNhUIIXcZ0fK/yff8j7WbLsqYR0VtajzBzTgix3PO8U9XivOSh7QA2EtH6SjJgzMDLbABoG+lKx3EeYea3R14ok8nMLgouXctvSNpJbdteUmxgXzLz3kKhsLa/v38wftExA4/F33/JpzfU8nRoaOgNAGuLcX8glUo92NPTc07/y2QytyiltCemJ+mkk864lruFQuE9AJ3x5NPgWltbr25sbNTV5FoAW0pJpX9RLGHP1arPesGkx7hpmrYQQrt8nq4ozLxOSvl3KY5vLbV5lMrgN2UQYRgeIKL5Os6FEBtG64h6zaRXlREae7vneZvLcVcaBrYB+CEIgpV9fX2/arZjiXyKmTullD+P1v5jdTwzWvUZU4zHVZ/uir7vP61r7IgQ2tXU1PRYd3d3wTTN64QQnwEQRPSA53m6q4761atzxhk8IYTozOVyvZWmnViDghCiK5fLfV8LdEyr3MXMy6WUxyZNq7iuO0Mp9TwzdwE4phsQM+uYfwHAIBE9xcwzdQIz8+6hoaH3T58+PVALtP4/JepQK8Hm5uZ0oVBwi+JqK4AVRW1xnIjWKqV6k6jBEZeZWj0+nmmnEvvlCYiZf0mn0w93d3f/VddBYpzTznmYLMu6j4j2TdnMaVnWuKadOPKOjo7mwcHBPQBmhmG4qta8+W9Xq+SOpO8qOs5TqdQuIrq/mqZIkpRlSUBEmyf0rpL0JSveSZn5CSnljiRA4zYxXXJbubwm2WNCr7VaWIVhOEMfZBjGWd10khwatyk/1THz2Qm/HY718Ath/w/u5/hSOv2FnwAAAABJRU5ErkJggg==" width="23" height="18" /></span><span>, the orbital energy is defined as </span><span texencoding="\langle\phi|\hat{\mathcal{H}}_{\rm DFT}|\phi\rangle" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="78" height="24.5" /></span><span> with </span><span texencoding="\hat{\mathcal{H}}_{\rm DFT}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="38" height="24.5" /></span><span> the DFT Hamiltonian operator. In the velocity gauge, the external potential vector is accounted for in the kinetic-operator of </span><span texencoding="\hat{\mathcal{H}}_{\rm DFT}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="38" height="24.5" /></span><span> while, in the length gauge, the external electric field is ignored.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outEnergyOrbital.time</span><span> defines the precise times at which the Kohn-Sham-orbital energies are computed</span></li><li  class = 'S4'><span>For spin-restricted models, each row of </span><span style=' font-family: monospace;'>outEnergyOrbital.orbital</span><span> contains the energies of the corresponding Kohn-Sham orbital</span></li><li  class = 'S4'><span>For spin-polarized models, each row of </span><span style=' font-family: monospace;'>outEnergyOrbital.orbitalUp</span><span> and </span><span style=' font-family: monospace;'>outEnergyOrbital.orbitalDown</span><span> contains the energies of the corresponding Kohn-Sham orbital for the up- and down-spin channels, respectively.</span></li></ul><h4  class = 'S6' id = 'H_E1C662FA' ><span style=' font-family: monospace;'>outIonization (oIon)</span></h4><div  class = 'S1'><span>Result of the ionization calculations during the TDDFT propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>TDDFT propagation that does track ionization (</span><a href = "#H_6B566C83"><span style=' font-family: monospace;'>saveIonization</span></a><span style=' font-family: monospace;'> = false</span><span>) leaves </span><span style=' font-family: monospace;'>outIonization</span><span> empty. Otherwise:</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outIonization.time</span><span> defines the precise times at which the ionization is computed.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outIonization.total</span><span> contains the total ionization.</span></li><li  class = 'S4'><span>For spin-polarized models, </span><span style=' font-family: monospace;'>outIonization.totalUp</span><span> and </span><span style=' font-family: monospace;'>outIonization.totalDown</span><span> contain the total ionization for the up- and down-spin channels, respectively.</span></li><li  class = 'S4'><span>Orbital-resolved ionization signals are stored in </span><span style=' font-family: monospace;'>outIonization.orbital</span><span>, </span><span style=' font-family: monospace;'>outIonization.orbitalUp</span><span>, and </span><span style=' font-family: monospace;'>outIonization.orbitalDown</span><span>. The indices of the orbitals associated with each of these are included in </span><span style=' font-family: monospace;'>outIonization.indexOrbital</span><span>, </span><span style=' font-family: monospace;'>outIonization.indexOrbitalUp</span><span>, and </span><span style=' font-family: monospace;'>outIonization.indexOrbitalDown.</span></li></ul><h4  class = 'S6' id = 'H_D6D335DD' ><span style=' font-family: monospace;'>outDensity (oRho)</span></h4><div  class = 'S1'><span>One-body densities during the TDDFT propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>TDDFT propagation that does not save the one-body density (</span><a href = "#H_B3D550CC"><span style=' font-family: monospace;'>saveDensity</span></a><span style=' font-family: monospace;'> = false</span><span>) leaves </span><span style=' font-family: monospace;'>outDensity</span><span> empty. Otherwise:</span></li><li  class = 'S4'><span>The specific shape of the saved one-body densities is implementation dependent -- see the corresponding documentation for details. At minimum, each implementation defines:</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outDensity.time</span><span> defines the precise times at which the one-body density is saved.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outDensity.total</span><span> contains the corresponding one-body densities and, for spin-polarized DFT models, </span><span style=' font-family: monospace;'>outDensity.totalUp</span><span> and </span><span style=' font-family: monospace;'>outDensity.totalDown</span><span> contain the one-body densities in the up- and down-spin channels respectively.</span></li></ul><h4  class = 'S6' id = 'H_371940E8' ><span style=' font-family: monospace;'>outOrbital (oKSO)</span></h4><div  class = 'S1'><span>Kohn-Sham orbitals during the TDDFT propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>TDDFT propagation that does not save the Kohn-Sham orbitals (</span><a href = "#H_2A78E237"><span style=' font-family: monospace;'>saveOrbital</span></a><span style=' font-family: monospace;'> = false</span><span>) leaves </span><span style=' font-family: monospace;'>outOrbital</span><span> empty. Otherwise:</span></li><li  class = 'S4'><span>The specific shape of the saved Kohn-Sham orbitals is implementation dependent -- see the corresponding documentation for details. At minimum, each implementation defines:</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outOrbital.time</span><span> defines the precise times at which the Kohn-Sham orbitals are saved.</span></li><li  class = 'S4'><span>For spin-restricted models, </span><span style=' font-family: monospace;'>outOrbital.orbital</span><span> contains the saved Kohn-Sham orbitals and </span><span style=' font-family: monospace;'>outOrbital.indexOrbital</span><span> the corresponding orbital indices.</span></li><li  class = 'S4'><span>For spin-polarized models, </span><span style=' font-family: monospace;'>outOrbital.orbitalUp</span><span> and </span><span style=' font-family: monospace;'>outOrbital.orbitalDown</span><span> contains the saved Kohn-Sham orbitals for the up- and down-spin channels, respectively, and </span><span style=' font-family: monospace;'>outOrbital.indexOrbitalUp</span><span> and </span><span style=' font-family: monospace;'>outOrbital.indexOrbitalDown</span><span> the corresponding orbital indices.</span></li></ul><h4  class = 'S6' id = 'H_5096ABA5' ><span style=' font-family: monospace;'>outOrbitalProjection (oKSOP)</span></h4><div  class = 'S1'><span>Projection of the Kohn-Sham orbitals during the TDDFT propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>TDDFT propagation that does not save the projection of the Kohn-Sham orbitals (</span><a href = "#H_0A85DA1C"><span style=' font-family: monospace;'>saveOrbitalProjection</span></a><span style=' font-family: monospace;'> = false</span><span>) leaves </span><span style=' font-family: monospace;'>outOrbitalProjection</span><span> empty. Otherwise:</span></li><li  class = 'S4'><span>The specific shape of the saved Kohn-Sham orbitals' projection is implementation dependent -- see the corresponding documentation for details. At minimum, each implementation defines:</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outOrbitalProjection.time</span><span> defines the precise times at which the Kohn-Sham orbitals' projection is saved.</span></li><li  class = 'S4'><span>For spin-restricted models, </span><span style=' font-family: monospace;'>outOrbitalProjection.orbital</span><span> contains the saved Kohn-Sham orbitals' projection and </span><span style=' font-family: monospace;'>outOrbitalProjection.indexOrbital</span><span> the corresponding orbital indices.</span></li><li  class = 'S4'><span>For spin-polarized models, </span><span style=' font-family: monospace;'>outOrbitalProjection.orbitalUp</span><span> and </span><span style=' font-family: monospace;'>outOrbitalProjection.orbitalDown</span><span> contains the saved Kohn-Sham orbitals' projection for the up- and down-spin channels, respectively, and </span><span style=' font-family: monospace;'>outOrbitalProjection.indexOrbitalUp</span><span> and </span><span style=' font-family: monospace;'>outOrbitalProjection.indexOrbitalDown</span><span> the corresponding orbital indices.</span></li><li  class = 'S4'><span>The structure also retains a copy of the projection basis as </span><a href = "./QMol_disc_basis.html"><span style=' font-family: monospace;'>QMol_disc_basis</span></a><span> object(s).</span></li></ul><h4  class = 'S6' id = 'H_9F79DF61' ><span style=' font-family: monospace;'>outOutputFunctionDensity (oFRho)</span></h4><div  class = 'S1'><span>Result of the installable output function of the one-body density </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>TDDFT propagation that does not define an installable output function of the density (</span><a href = "#H_D1715482"><span style=' font-family: monospace;'>saveOutputFunctionDensity</span></a><span style=' font-family: monospace;'> = []</span><span>) leaves </span><span style=' font-family: monospace;'>outOutputFunctionDensity</span><span> empty. Otherwise:</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outOutputFunctionDensity.time</span><span> defines the precise times at which the result of the output function is saved.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outOutputFunctionDensity.result</span><span> contains the results of the output functions. If the installable function returns a scalar or a column vector, </span><span style=' font-family: monospace;'>outOutputFunctionDensity.result</span><span> is a </span><span style=' font-family: monospace;'>N-by-numel(outOutputFunctionDensity.time)</span><span> matrix with </span><span style=' font-family: monospace;'>N</span><span> the number of elements in the output. Otherwise, </span><span style=' font-family: monospace;'>outOutputFunctionDensity.result</span><span> is an </span><span style=' font-family: monospace;'>M-by-numel(outOutputFunctionDensity.time)</span><span> array with </span><span style=' font-family: monospace;'>M</span><span> the size of the output.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outOutputFunctionDensity.shape</span><span> contains the shape of the output function (</span><span style=' font-family: monospace;'>N</span><span> or </span><span style=' font-family: monospace;'>M</span><span>, as defined in the previous bullet point).</span></li></ul><h4  class = 'S6' id = 'H_25C1C7F6' ><span style=' font-family: monospace;'>outOutputFunctionOrbital (oFKSO)</span></h4><div  class = 'S1'><span>Result of the installable output function of the Kohn-Sham orbitals </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>TDDFT propagation that does not define an installable output function of the orbitals (</span><a href = "#H_13D0EA88"><span style=' font-family: monospace;'>saveOutputFunctionOrbital</span></a><span style=' font-family: monospace;'> = []</span><span>) leaves </span><span style=' font-family: monospace;'>outOutputFunctionOrbital</span><span> empty. Otherwise:</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outOutputFunctionOrbital.time</span><span> defines the precise times at which the result of the output function is saved.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outOutputFunctionOrbital.result</span><span> contains the results of the output functions. If the installable function returns a scalar or a column vector, </span><span style=' font-family: monospace;'>outOutputFunctionOrbital.result</span><span> is a </span><span style=' font-family: monospace;'>N-by-numel(outOutputFunctionOrbital.time)</span><span> matrix with </span><span style=' font-family: monospace;'>N</span><span> the number of elements in the output. Otherwise, </span><span style=' font-family: monospace;'>outOutputFunctionOrbital.result</span><span> is an </span><span style=' font-family: monospace;'>M-by-numel(outOutputFunctionOrbital.time)</span><span> array with </span><span style=' font-family: monospace;'>M</span><span> the size of the output.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>outOutputFunctionOrbital.shape</span><span> contains the shape of the output function (</span><span style=' font-family: monospace;'>N</span><span> or </span><span style=' font-family: monospace;'>M</span><span>, as defined in the previous bullet point).</span></li></ul><h2  class = 'S2' id = 'H_444F9B6D' ><span>Class methods</span></h2><h3  class = 'S5' id = 'H_A7EA7D3E' ><span>Creation</span></h3><h4  class = 'S6' id = 'H_0783E8B1' ><span>constructor</span></h4><div  class = 'S1'><span>Create an extended fourth-order Forest Ruth [</span><a href = "#M_3cee"><span>Forest 1990</span></a><span>] symplectic TDDFT-propagator object with empty class properties [</span><a href = "#M_F7CBFF54"><span>Mauger 2026</span></a><span>].</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj = QMol_TDDFT_ESSO_4FR;</span></span></div></div></div><div  class = 'S8'><span>Create a TDDFT-propagator object with the </span><span style=' font-family: monospace;'>name</span><span> properties set to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the TDDFT </span><a href = "#H_24F205D3"><span>class properties</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj = QMol_TDDFT_ESSO_4FR(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj = QMol_TDDFT_ESSO_4FR(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><h3  class = 'S5' id = 'H_87F4F901' ><span>Changing class properties</span></h3><h4  class = 'S6' id = 'H_4405B79D' ><span style=' font-family: monospace;'>set</span></h4><div  class = 'S1'><span>Update the </span><span style=' font-family: monospace;'>name</span><span> properties of a TDDFT-model object to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the TDDFT </span><a href = "#H_24F205D3"><span>class properties</span></a><span> and is case insensitive. In restart mode, </span><a href = "#H_D533B953"><span>output result</span></a><span> structures can also be edited with </span><span style=' font-family: monospace;'>set</span><span>. </span><span style=' font-family: monospace;'>QMol_TDDFT</span><span> does not check the integrity of its input/output component during a restart and this feature should only be considered by advanced users.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj.set(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.set(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S8'><span>This is the common name-value pair assignment method used throughout the QMol-grid package.</span></div><h4  class = 'S6' id = 'H_C729A888' ><span style=' font-family: monospace;'>clear</span></h4><div  class = 'S1'><span>Clear all class properties</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.clear;</span></span></div></div></div><div  class = 'S8'><span>Clear a specific set of the class properties. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the TDDFT </span><a href = "#H_24F205D3"><span>class properties</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.clear(name1,name2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S8'><span>This is the common </span><span style=' font-family: monospace;'>clear</span><span> method available to all classes throughout the QMol-grid package. The </span><span style=' font-family: monospace;'>clear</span><span> method can be used to delete specific properties before saving an instance of the TDDFT propagator class and propagation results.</span></div><h3  class = 'S5' id = 'H_686ACD09' ><span>Initializing the object</span></h3><h4  class = 'S6' id = 'H_85EFED0A' ><span style=' font-family: monospace;'>initialize</span></h4><div  class = 'S1'><span>Initialize extended fourth-order Forest Ruth symplectic TDDFT-propagator object without allocating the </span><a href = "#H_D533B953"><span>output-result</span></a><span> structures</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.initialize(DFT);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span style=' font-family: monospace;'>DFT</span><span> is the </span><a href = "./DFT.html"><span>DFT-model</span></a><span> handle object, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "./QMol_DFT_spinPol.html"><span style=' font-family: monospace;'>QMol_DFT_spinPol</span></a><span style=' font-family: monospace;'> </span><span>or </span><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span>, that describes the DFT system to propagate.</span></li><li  class = 'S4'><span style=' text-decoration: underline;'>For developers:</span><span> </span><span style=' font-family: monospace;'>initialize</span><span> has also a specific interface when called from the </span><a href = "#H_5CD9DA16"><span style=' font-family: monospace;'>propagate</span></a><span> method that initializes the absorbing boundaries (if any) and determines whether the </span><a href = "#H_D533B953"><span>output-result</span></a><span> structures should be initialized too. Overloading classes should avoid redefining </span><span style=' font-family: monospace;'>initialize</span><span>; If the overloading class needs to perform some initialization (at the beginning of a TDDFT propagation or upon restart), overload the </span><span style=' font-family: monospace;'>initializeChildren</span><span> method instead.</span></li></ul><h3  class = 'S5' id = 'H_B2D31FE3' ><span>Run-time documentation</span></h3><h4  class = 'S6' id = 'H_E3988947' ><span style=' font-family: monospace;'>getMemoryProfile</span></h4><div  class = 'S1'><span>Get an estimate of the memory help by a </span><span style=' font-family: monospace;'>QMol_TDDFT_ESSO_4FR</span><span> object with either</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >mem = obj.getMemoryProfile;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >mem = obj.getMemoryProfile(false);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>The object must be </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d for the memory footprint evaluation. If not already, </span><span style=' font-family: monospace;'>getMemoryProfile</span><span> initializes the </span><span style=' font-family: monospace;'>DFT</span><span> model object.</span></li><li  class = 'S4'><span>The estimate includes the (1) </span><span style=' font-family: monospace;'>DFT</span><span> model, (2) TDDFT propagator, and (3) </span><a href = "#H_D533B953"><span>output results</span></a><span>. Note that all these components may not be used in actual simulations and the memory estimate tries to be conservative. On the other hand, it only includes the discretization of member components on the domain grid and ignores other (expectedly small) properties.</span></li><li  class = 'S4'><span>The output </span><span style=' font-family: monospace;'>mem</span><span> is the estimated size in bytes.</span></li></ul><div  class = 'S1'><span>Additionally display the detail of the memory footprint with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >mem = obj.getMemoryProfile(true);</span></span></div></div></div><h4  class = 'S6' id = 'H_ABD08C91' ><span style=' font-family: monospace;'>showDocumentation</span></h4><div  class = 'S1'><span>Display the run-time documentation for the specific configuration of a </span><span style=' font-family: monospace;'>QMol_TDDFT_ESSO_4FR</span><span> object, which must have been </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d beforehand</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.showDocumentation;</span></span></div></div></div><h3  class = 'S5' id = 'H_AEFB66DB' ><span>TDDFT propagation</span></h3><h4  class = 'S6' id = 'H_5CD9DA16' ><span style=' font-family: monospace;'>propagate</span></h4><div  class = 'S1'><span>Propagate the TDDFT dynamics starting from a DFT model object (from scratch)</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.propagate(DFT);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span style=' font-family: monospace;'>DFT</span><span> is the </span><a href = "./DFT.html"><span>DFT-model</span></a><span> handle object, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "./QMol_DFT_spinPol.html"><span style=' font-family: monospace;'>QMol_DFT_spinPol</span></a><span style=' font-family: monospace;'> </span><span>or </span><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span>, that describes the DFT system to propagate.</span></li><li  class = 'S4'><span>Neither the TDDFT-propagation </span><span style=' font-family: monospace;'>obj</span><span> nor the DFT-model </span><span style=' font-family: monospace;'>DFT</span><span> objects need be </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d. In all cases both are (re)initialized at the beginning of the TDDFT propagation to ensure proper and consistent linkage and setup between them.</span></li></ul><div  class = 'S1'><span>Restart a TDDFT propagation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.propagate(</span><span style="color: rgb(167, 9, 245);">'restart'</span><span >);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>This can be performed after loading the corresponding restart MATLAB file into the workspace.</span></li></ul><h4  class = 'S6' id = 'H_FD72E490' ><span>Choice of gauge</span></h4><div  class = 'S1'><span>If no specific gauge is specified with </span><a href = "#H_F8E58A47"><span style=' font-family: monospace;'>externalFieldGauge</span></a><span>, the gauge is selected following the decision tree:</span></div><ul  class = 'S3'><li  class = 'S4'><span>Length gauge if </span><a href = "#H_2EA3F8EC"><span style=' font-family: monospace;'>externalField</span></a><span style=' font-family: monospace;'>.electricField</span><span> or </span><a href = "#H_35230E97"><span style=' font-family: monospace;'>electricField</span></a><span> is a function handle, otherwise:</span></li><li  class = 'S4'><span>Velocity gauge if </span><a href = "#H_2EA3F8EC"><span style=' font-family: monospace;'>externalField</span></a><span style=' font-family: monospace;'>.potentialVector</span><span> or </span><a href = "#H_054F0F9E"><span style=' font-family: monospace;'>potentialVector</span></a><span> is a function handle, otherwise:</span></li><li  class = 'S4'><span>Length gauge if </span><a href = "#H_2EA3F8EC"><span style=' font-family: monospace;'>externalField</span></a><span style=' font-family: monospace;'>.electricField</span><span> or </span><a href = "#H_35230E97"><span style=' font-family: monospace;'>electricField</span></a><span> is a </span><span style=' font-family: monospace;'>griddedInterpolant</span><span>, otherwise:</span></li><li  class = 'S4'><span>Velocity gauge if </span><a href = "#H_2EA3F8EC"><span style=' font-family: monospace;'>externalField</span></a><span style=' font-family: monospace;'>.potentialVector</span><span> or </span><a href = "#H_054F0F9E"><span style=' font-family: monospace;'>potentialVector</span></a><span> is a </span><span style=' font-family: monospace;'>griddedInterpolant</span><span>, otherwise:</span></li><li  class = 'S4'><span>Field free (ignore any input field)</span></li></ul><h4  class = 'S6' id = 'H_31F9A72A' ><span>External-field components used in simulations</span></h4><div  class = 'S1'><span>Depending on the types of input, not all provided external-field may be used in the simulations. For the potential vector and electric field -- recall that </span><a href = "#H_35230E97"><span style=' font-family: monospace;'>electricField</span></a><span> and </span><a href = "#H_054F0F9E"><span style=' font-family: monospace;'>potentialVector</span></a><span> are repackaged into </span><a href = "#H_2EA3F8EC"><span style=' font-family: monospace;'>externalField</span></a><span> at the beginning of the simulation: </span></div><ul  class = 'S3'><li  class = 'S4'><span>If both are provided as function handles, then </span><a href = "#H_2EA3F8EC"><span style=' font-family: monospace;'>externalField</span></a><span style=' font-family: monospace;'>.electricField</span><span> and </span><a href = "#H_2EA3F8EC"><span style=' font-family: monospace;'>externalField</span></a><span style=' font-family: monospace;'>.potentialVector</span><span> are called whenever the values for the potential vector or electric field are required. Note that the TDDFT propagator does </span><span style=' text-decoration: underline;'>not</span><span> check whether the provided potential vector and electric field are consistent with each other (</span><span texencoding="E(t)=-\partial_t A(t)" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="92.5" height="19.5" /></span><span>) and providing non-matching components will likely result in erroneous results. Otherwise,</span></li><li  class = 'S4'><span>If only one of them is provided as a function handle, then both the potential vector and electric field are computed from that same function handle (see </span><a href = "#M_0A78CFE1"><span>below</span></a><span> for details on how this is done). Otherwise,</span></li><li  class = 'S4'><span>In the length gauge, if </span><a href = "#H_2EA3F8EC"><span style=' font-family: monospace;'>externalField</span></a><span style=' font-family: monospace;'>.electricField</span><span> is a </span><span style=' font-family: monospace;'>griddedInterpolant</span><span> then it is used to compute both the electric field and potential vector, otherwise </span><a href = "#H_2EA3F8EC"><span style=' font-family: monospace;'>externalField</span></a><span style=' font-family: monospace;'>.potentialVector</span><span> is used to compute them both.</span></li><li  class = 'S4'><span>In the velocity gauge, if </span><a href = "#H_2EA3F8EC"><span style=' font-family: monospace;'>externalField</span></a><span style=' font-family: monospace;'>.potentialVector</span><span> is a </span><span style=' font-family: monospace;'>griddedInterpolant</span><span> then it is used to compute both the electric field and potential vector, otherwise </span><a href = "#H_2EA3F8EC"><span style=' font-family: monospace;'>externalField</span></a><span style=' font-family: monospace;'>.electricField</span><span> is used to compute them both.</span></li><li  class = 'S4'><span>If none of the </span><a href = "#H_2EA3F8EC"><span style=' font-family: monospace;'>externalField</span></a><span style=' font-family: monospace;'>.electricField</span><span> and </span><a href = "#H_2EA3F8EC"><span style=' font-family: monospace;'>externalField</span></a><span style=' font-family: monospace;'>.potentialVector</span><span> are defined, the TDDFT propagation is performed field free irrespective of the choice of </span><a href = "#H_F8E58A47"><span style=' font-family: monospace;'>externalFieldGauge</span></a><span> and even if an </span><a href = "#H_2EA3F8EC"><span style=' font-family: monospace;'>externalField</span></a><span style=' font-family: monospace;'>.electricFieldDerivative</span><span> is defined.</span></li></ul><div  class = 'S1'><span>The choice of ignoring some (interpolated) input fields is made to ensure the self-consistency of the TDDFT dynamics, and associated observables, during the numerical propagation. To force using an interpolated field input, one can encapsulate it into a function handle </span><span style=' font-family: monospace;'>@(t) interpolatedField(t)</span><span>. </span></div><div  class = 'S1'><span>For the electric-field derivative:</span></div><ul  class = 'S3'><li  class = 'S4'><span>If </span><a href = "#H_2EA3F8EC"><span style=' font-family: monospace;'>externalField</span></a><span style=' font-family: monospace;'>.electricFieldDerivative</span><span> is defined as a function handle, then </span><a href = "#H_2EA3F8EC"><span style=' font-family: monospace;'>externalField</span></a><span style=' font-family: monospace;'>.electricFieldDerivative</span><span> is called when the derivative of the electric field is required.</span></li><li  class = 'S4'><span>Otherwise, the electric-field derivative is computed numerically from </span><a href = "#H_2EA3F8EC"><span style=' font-family: monospace;'>externalField</span></a><span style=' font-family: monospace;'>.electricField</span><span> or </span><a href = "#H_2EA3F8EC"><span style=' font-family: monospace;'>externalField</span></a><span style=' font-family: monospace;'>.potentialVector</span><span>, depending on which field component(s) are being used in the TDDFT propagation. </span></li></ul><div  class = 'S1' id = 'M_0A78CFE1' ><span>Numerical computation of missing or ignored field components:</span></div><ul  class = 'S3'><li  class = 'S4'><span>Where required, the potential vector is computed from the electric field using a Simpson's 1/3 quadrature rule.</span></li><li  class = 'S4'><span>Where required, the electric field is computed from the potential vector using a second-order centered finite difference with </span><a href = "#H_23189B60"><span style=' font-family: monospace;'>diffDT</span></a><span> time step.</span></li><li  class = 'S4'><span>Where required, the electric field derivative is computed from the electric field or the potential vector using a second-order centered finite difference with </span><a href = "#H_23189B60"><span style=' font-family: monospace;'>diffDT</span></a><span> time step.</span></li></ul><h2  class = 'S2'><span>Examples</span></h2><div  class = 'S1'><span>See the </span><a href = "./TDHF.html"><span>time-dependend Hartree-Fock page</span></a><span> for examples of extended phase-space TDDFT simulations with various output computations.</span></div><h2  class = 'S2' id = 'H_D431B55B' ><span>Test suite</span></h2><div  class = 'S1'><span>For consistency with the rest of the QMol-grid package, </span><span style=' font-family: monospace;'>QMol_TDDFT_ESSO_4FR</span><span> defines an associated test suite. Run the test suite for the class in normal or </span><a href = "./Test_suite.html"><span>summary mode</span></a><span> respectively with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: rgb(167, 9, 245);">'TDDFT_ESSO_4FR'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: rgb(167, 9, 245);">'-summary'</span><span >,</span><span style="color: rgb(167, 9, 245);">'TDDFT_ESSO_4FR'</span><span >);</span></span></div></div></div><h2  class = 'S2' id = 'H_3BEADFD3' ><span>References</span></h2><div  class = 'S1' id = 'M_3cee' ><span>[Forest 1990] E. Forest and R.D. Ruth, "Fourth-order symplectic integration," Physica D: Nonlinear Phenomena 43, 105 (1990).</span></div><div  class = 'S1' id = 'M_5bc6' ><span>[Luo 2017] J. Luo, X. Wu, G. Huang, and F. Liu, "Eplicit symplectic-like integrators with midpoint permutations for spinning compact binaries," The Astrophysical Journal 834, 64 (2017).</span></div><div  class = 'S1' id = 'M_F7CBFF54' ><span>[Mauger 2026] F. Mauger and C. Chandre, "Extended phase-space symplectic integration for electronic dynamics," arXiv:2510.16542 (2026).</span></div><div  class = 'S1' id = 'M_229e' ><span>[Tao 2016] M. Tao, "Explicit symplectic approximation of nonseparable Hamiltonians: Algorithm and long time performance," Physical Review E 94, 043303 (2016).</span></div><h2  class = 'S2' id = 'H_2E204287' ><span>Notes</span></h2><ul  class = 'S3'><li  class = 'S4'><span style=' font-family: monospace;'>QMol_TDDFT_ESSO_4FR</span><span> was introduced in version 01.23.</span></li></ul>
<br>
<!-- 
##### SOURCE BEGIN #####
%% |QMol_TDDFT_ESSO_4FR|
% Extended phase-space fourth-order Forest Ruth [Forest 1990] symplectic split-operator 
% scheme for TDDFT simulations [Mauger 2026].
%% Description
% Use |QMol_TDDFT_ESSO_4FR| to propagate the TDDFT dynamics of a spin-polarized 
% or restricted <./DFT.html DFT model> with a <./QMol_disc.html Cartesian-grid 
% discretization domain> using an extended phase-space fourth-order Forest Ruth 
% [Forest 1990] symplectic scheme [Mauger 2026]. The time propagation can be performed 
% field free or with an external driving field in the dipole approximation and 
% either length or velocity gauge. The derivation and details of the implementation 
% of the symplectic split-operator can be found in [Mauger 2026]. During the TDDFT 
% propagation, several observables can be computed on-the-fly and stored in output 
% structures in the |QMol_TDDFT_ESSO_4FR| object. Each of these can be activated 
% independently and may define their own sampling times:
%% 
% * Save the DFT object into individual files
% * Save the dipole, dipole velocity, and dipole acceleration signals
% * Save DFT and orbital energies
% * Save the external field information
% * Save the ionization signal
% * Save the Kohn-Sham orbitals (projection) and one-body density
% * Save output functions of the one-body density and Kohn-Sham orbitals
% * Save restart data file
%% 
% See the <./TDDFT.html TDDFT documentation> page for examples of using most 
% of these features. 
% 
% |QMol_TDDFT_ESSO_4FR| is a handle class.
%% Class properties
% Time propagation
% |display (disp)|
% Whether to display progress of the TDDFT calculations as they go on |[ true 
% (default) | false ]|
% |time (T)|
% Time propagation vector |[ vector (default []) ]|
%% 
% * In all TDDFT propagation simulations |T(1)| specifies the starting time 
% and |T(end)| the ending time.
% * In forward time propagation simulations (|timeStep| |> 0|), time values 
% in |T| must be all increasing, while for backward time propagation (|timeStep| 
% |< 0|), they must be all decreasing. Time increments in the vector |T| need 
% not be equally spaced.
% * When |display| is activated, |T| specifies the intermediate times for the 
% time-propagation progress display.
% * |T| is also the default time sampling for saved results that do not define 
% their own.
% * Note that the time step used in TDDFT propagations is set independently 
% of |T|.
% |timeStep (dt)|
% Time step used for the time propagation  |[ scalar (default 0.01) ]|
%% 
% * Positive (resp. negative) |timeStep| defines forward (resp. backward) time 
% propagation.
% |omega (w)|
% Restrain parameter |[ 'midpoint projection' (default) | scalar (default 10) 
% ]|
%% 
% * |'midpoint projection'| uses the midpoint projection algorithm from [Luo 
% 2017].
% * Scalar |w| uses the restraint algorithm of [Tao 2016].
% * See [Mauger 2026] for explanation of the role of the midpoint projection 
% and restraint.
% |splitPotential (spltV)|
% Whether to split the potential between it explicit and implicit parts |[ true 
% (default) | false ]|
%% 
% * Splitting the potential leads to more calculations per time steps but has 
% shown a notable increase in calculations accuracy in test cases.
% * See [Mauger 2026] for explanation of the role of the potential split.
% |splitMotif|
% Splitting motif |[ 'HHR' | 'HRH' | 'TVR' | 'TRV' (default) ]|
%% 
% * Order in which the split operator is taken in the extened phase space (see 
% [Mauger 2026]).
% |absorbingBoundary (ABC)|
% Absorber at the edges of the domain |[ [] (default) | mask object | CAP object 
% ]|
%% 
% * The boundary absorber aims at eliminating outgoing wave packets from the 
% discretization domain and avoid spurious reflections at the edges of the domain.
% * Empty |absorbingBoundary| does not implement any absorbing boundary method 
% and any part of the wave packet reaching the edges of the domain will be reflected 
% (or artirficially reappears on the other side of the domain through periodic 
% effects).
% * Mask absorbers are applied at the end of each propagation step. They are 
% the easiest to use and implement but are first order, irrespective of the order 
% of the time propagation scheme. 
% * Complex absorbing potentials (CAPs) are integrated within the propagation 
% scheme, as an imaginary potential term that causes exponential decay of the 
% wave packet at the edges. Under the right circumstances, CAPs can preserve the 
% order of the propagation schemes. 
% |externalField (EF)|
% External driving field |[ [] (default) || <./QMol_extField_dipole.html |QMol_extField_dipole|> 
% |object ]|
%% 
% * When performing the TDDFT propagation, any |electricField|, |electricFieldDerivative|, 
% or |potentialVector| are repackaged into |externalField|.
% * If no electric field or potential vector is defined, either through |externalField,| 
% |electricField|, or |potentialVector|, the TDDFT propagation is performed field 
% free.
% |externalFieldGauge (EFG)|
% Gauge in which the external driving field is described |[ [] (default) | 'none' 
% | 'length' | 'velocity' ]|
%% 
% * |'none'| ignores any input external field and propagates the field-free 
% TDDFT dynamics
% * The decision tree for the selection of the default gauge is detailed below.
% |electricField (FE)|
% Electric field of the external driving field |[ [] (default) | function handle 
% | griddedInterpolant ]|
%% 
% * For developers: When initializing the class, non-empty |electricField| is 
% moved into the |externalField| property object (if needed creating the object 
% first). During run time, |FE| contains the value of the electric field used 
% in the propagation (where relevant).
% |electricFieldDerivative (FDE)|
% Derivative of the electric field of the external driving field |[ [] (default) 
% | function handle | griddedInterpolant ]|
%% 
% * |griddedInterpolant| |electricFieldDerivative| is provided for general support 
% but note that non-function-handle electric field derivatives are computed self-consistently 
% from the electric-field or potential-vector components.
% * For developers: When initializing the class, non-empty |electricFieldDerivative| 
% is moved into the |externalField| property object (if needed creating the object 
% first). During run time, |FDE| contains the value of the derivative of the electric 
% field used in the propagation (where relevant).
% |potentialVector (FA)|
% Potential vector of the external driving field |[ [] (default) | function 
% handle | griddedInterpolant ]|
%% 
% * For developers: When initializing the class, non-empty |potentialVector| 
% is moved into the |externalField| property object (if needed creating the object 
% first). During run time, |FA| contains the value of the potential vector used 
% in the propagation (where relevant).
% |diffDT|
% Time step used for computing time derivatives |[ nonnegative scalar (default 
% 1e-5) ]|
% Save the distance between the orbital copies in the extended phase space
% The distance can be used to estimate the accuracy of the propagation [Mauger 
% 2026].
% |saveDistanceCopy (sDist)|
% save the distance between the extended phase-space copies |[ true | false 
% (default) ]|
% |saveDistanceCopyTime (sDistT)|
% Times at which to save the DFT object into a file |[ [] (default) | positive 
% scalar | negative integer | vector | 'all' ]|
%% 
% * Empty |saveDistanceCopyTime| uses the same values as in |time| for when 
% to calculate and save the distance.
% * A positive scalar specifies the sampling time step when to save distance. 
% For forward time propagation, it is equivalent to time|(1):saveDistanceCopyTime:|time|(end)|, 
% and for backward ones to time|(1):-saveDistanceCopyTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% saves. For forward time propagation, it is equivalent to time|(1):abs(saveDistanceCopyTime)*||timeStep||:|time|(end)|, 
% and for backward ones to time|(1):-abs(saveDistanceCopyTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to save the distance.
% * |'all'| saves the distance after every time step.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% Save the DFT object into individual files
% During the time propagation, copies of the DFT object can be saved in separate 
% MATLAB files.
% |saveDFT (sDFT)|
% Activate saving the DFT object into separate files |[ true | false (default) 
% ]|
% |saveDFTFileName (sDFTF)|
% Name for the files in which the DFT objects are saved |[ character array (default 
% 'QMolGridREPLACE_WITH_DASH_DASHTDDFTREPLACE_WITH_DASH_DASHDFT') ]|
%% 
% * The DFT objects saved at different times are put in separate MATLAB (.mat.) 
% file, with names starting with |saveDFTFileName| to which the iteration index 
% is appended. Each file produced also contains a scalar variable |t| with the 
% time information.
% * One may specify a location where to create the files by indicating the folder 
% path in |saveDFTFileName|
% * |saveDFTFileName| is irrelevant when |saveDFT| |== false|
% |saveDFTTime (sDFTT)|
% Times at which to save the DFT object into a file |[ [] (default) | positive 
% scalar | negative integer | vector | 'all' ]|
%% 
% * Empty |saveDFTTime| uses the same values as in |time| for when to save the 
% DFT object into MATLAB files.
% * A positive scalar specifies the sampling time step when to save the DFT 
% object into MATLAB files. For forward time propagation, it is equivalent to 
% time|(1):saveDFTTime:|time|(end)|, and for backward ones to time|(1):-saveDFTTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% saves. For forward time propagation, it is equivalent to time|(1):abs(saveDFTTime)*||timeStep||:|time|(end)|, 
% and for backward ones to time|(1):-abs(saveDFTTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to save the DFT object to 
% a MATLAB file.
% * |'all'| saves the DFT object into a MATLAB file after every time step. Warning: 
% this is slow and may result in a very large number of file and/or large disk 
% usage.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% Save the dipole, dipole velocity, and dipole acceleration signals
% |saveDipole (sDip)|
% Whether to calculate and save the dipole signal during the TDDFT propagation 
% |[ true | false (default) ]|
% |saveDipoleOrbitalIndex (sDipI)|
% Index of the Kohn-Sham orbitals for which to compute the orbital-resolved 
% dipole signal |[ [] (default) | index vector | cell | 'all' ]|
%% 
% * This is irrelevant if |saveDipole| is |false|
% * Empty |saveDipoleOrbitalIndex| disables the orbital-resolved dipole signal 
% calculation
% * For spin restricted models, specify the indexes of the orbitals for which 
% to compute the orbital-resolved dipole signal
% * For spin polarized models, combine the up- and down-spin channel orbital 
% indexes in a cell of the form |{ind_up,ind_down}|
% * |'all'| computes the orbital-resolved dipole for all orbitals
% |saveDipoleTime (sDipT)|
% Times at which to compute and save the dipole signal |[ [] (default) | positive 
% scalar | negative integer | vector | 'all' ]|
%% 
% * Empty |saveDipoleTime| uses the same values as in |time| for when to compute 
% and save the dipole signal.
% * A positive scalar specifies the sampling time step between successive computations 
% of the dipole signal. For forward time propagation, it is equivalent to time|(1):saveDipoleTime:|time|(end)|, 
% and for backward ones to time|(1):-saveDipoleTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% dipole-signal computations. For forward time propagation, it is equivalent to 
% time|(1):abs(saveDipoleTime)*||timeStep||:|time|(end)|, and for backward ones 
% to time|(1):-abs(saveDipoleTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to compute and save the dipole 
% signal.
% * |'all'| computes and saves the dipole signal after every time step. Warning: 
% this may be slow.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% |saveDipoleVelocity (sVel)|
% Whether to calculate and save the dipole velocity signal during the TDDFT 
% propagation |[ true | false (default) ]|
%% 
% * Warning: only the explicit part of the DFT potential is used to calculate 
% the velocity, thus eglecting contributions from the implicit part. The class 
% throws a warning when this option is activated.
% |saveDipoleVelocityOrbitalIndex (sVelI)|
% Index of the Kohn-Sham orbitals for which to compute the orbital-resolved 
% dipole velocity signal |[ [] (default) | index vector | cell | 'all' ]|
%% 
% * This is irrelevant if |saveDipoleVelocity| is |false|
% * Empty |saveDipoleVelocityOrbitalIndex| disables the orbital-resolved dipole 
% velocity signal calculation
% * For spin restricted models, specify the indexes of the orbitals for which 
% to compute the orbital-resolved dipole velocity signal
% * For spin polarized models, combine the up- and down-spin channel orbital 
% indexes in a cell of the form |{ind_up,ind_down}|
% * |'all'| computes the orbital-resolved dipole velocity for all orbitals
% |saveDipoleVelocityTime (sVelT)|
% Times at which to compute and save the dipole velocity signal |[ 'dipole' 
% (default) | positive scalar | negative integer | vector | 'all' ]|
%% 
% * |'dipole'| |saveDipoleVelocityTime| uses the same times as for |saveDipoleTime| 
% * A positive scalar specifies the sampling time step between successive computations 
% of the dipole velocity signal. For forward time propagation, it is equivalent 
% to time|(1):saveDipoleVelocityTime:|time|(end)|, and for backward ones to time|(1):-saveDipoleVelocityTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% dipole-velocity-signal computations. For forward time propagation, it is equivalent 
% to time|(1):abs(saveDipoleVelocityTime)*||timeStep||:|time|(end)|, and for backward 
% ones to time|(1):-abs(saveDipoleVelocityTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to compute and save the dipole 
% velocity signal.
% * |'all'| computes and saves the dipole velocity signal after every time step. 
% Warning: this may be slow.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% |saveDipoleAcceleration (sAcc)|
% Whether to calculate and save the dipole acceleration signal during the TDDFT 
% propagation |[ true | false (default) ]|
%% 
% * Warning: only the explicit part of the DFT potential is used to calculate 
% the acceleration, thus eglecting contributions from the implicit part. The class 
% throws a warning when this option is activated.
% |saveDipoleAccelerationOrbitalIndex (sAccI)|
% Index of the Kohn-Sham orbitals for which to compute the orbital-resolved 
% dipole acceleration signal |[ [] (default) | index vector | cell | 'all' ]|
%% 
% * This is irrelevant if |saveDipoleAcceleration| is |false|
% * Empty |saveDipoleAccelerationOrbitalIndex| disables the orbital-resolved 
% dipole acceleration signal calculation
% * For spin restricted models, specify the indexes of the orbitals for which 
% to compute the orbital-resolved dipole acceleration signal
% * For spin polarized models, combine the up- and down-spin channel orbital 
% indexes in a cell of the form |{ind_up,ind_down}|
% * |'all'| computes the orbital-resolved dipole acceleration for all orbitals
% |saveDipoleAccelerationTime (sAccT)|
% Times at which to compute and save the dipole acceleration signal |[ 'dipole' 
% (default) | positive scalar | negative integer | vector | 'all' ]|
%% 
% * |'dipole'| |saveDipoleAccelerationTime| uses the same times as for |saveDipoleTime| 
% * A positive scalar specifies the sampling time step between successive computations 
% of the dipole acceleration signal. For forward time propagation, it is equivalent 
% to time|(1):saveDipoleAccelerationTime:|time|(end)|, and for backward ones to 
% time|(1):-saveDipoleAccelerationTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% dipole-acceleration-signal computations. For forward time propagation, it is 
% equivalent to time|(1):abs(saveDipoleAccelerationTime)*||timeStep||:|time|(end)|, 
% and for backward ones to time|(1):-abs(saveDipoleAccelerationTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to compute and save the dipole 
% acceleration signal.
% * |'all'| computes and saves the dipole acceleration signal after every time 
% step. Warning: this may be slow.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% Save DFT and orbital energies
% |saveEnergyDFT (sEDFT)|
% Whether to track the DFT energy during the TDDFT propagation |[ true | false 
% (default) ]|
% |saveEnergyDFTTime (sEDFTT)|
% Times at which to compute and save the DFT energy |[ [] (default) | positive 
% scalar | negative integer | vector | 'all' ]|
%% 
% * Empty |saveEnergyDFTTime| uses the same values as in |time| for when to 
% compute and save the DFT energy
% * A positive scalar specifies the sampling time step between successive computations 
% of the DFT energy. For forward time propagation, it is equivalent to time|(1):saveEnergyDFTTime:|time|(end)|, 
% and for backward ones to time|(1):-saveEnergyDFTTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% DFT-energy computations. For forward time propagation, it is equivalent to time|(1):abs(saveEnergyDFTTime)*||timeStep||:|time|(end)|, 
% and for backward ones to time|(1):-abs(saveEnergyDFTTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to compute and save the DFT 
% energy.
% * |'all'| computes and saves the DFT energy after every time step. Warning: 
% this may be slow.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% |saveEnergyOrbital (sEKSO)|
% Whether to track the orbital energies during the TDDFT propagation |[ true 
% | false (default) ]|
%% 
% * For a Kohn-Sham orbital $|\phi\rangle$, the orbital energy is defined as 
% $\langle\phi|\hat{\mathcal{H}}_{\rm DFT}|\phi\rangle$ with $\hat{\mathcal{H}}_{\rm 
% DFT}$ the DFT Hamiltonian operator.
% * In the velocity gauge, the external potential vector is accounted for in 
% the kinetic-operator of $\hat{\mathcal{H}}_{\rm DFT}$ while, in the length gauge, 
% the external electric field is ignored.
% * Note that the energy of all the Kohn-Sham orbitals are computed and saved. 
% One may use an installable output function of the Kohn-Sham orbitals to track 
% the energy of a subset of orbitals.
% |saveEnergyOrbitalTime (sEKSOT)|
% Times at which to compute and save the Kohn-Sham orbital energies |[ [] (default) 
% | positive scalar | negative integer | vector | 'all' ]|
%% 
% * Empty |saveEnergyOrbitalTime| uses the same values as in |time| for when 
% to compute and save the Kohn-Sham orbital energies
% * A positive scalar specifies the sampling time step between successive computations 
% of the Kohn-Sham orbital energies. For forward time propagation, it is equivalent 
% to time|(1):saveEnergyOrbitalTime:|time|(end)|, and for backward ones to time|(1):-saveEnergyOrbitalTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% Kohn-Sham-orbital-energy computations. For forward time propagation, it is equivalent 
% to time|(1):abs(saveEnergyOrbitalTime)*||timeStep||:|time|(end)|, and for backward 
% ones to time|(1):-abs(saveEnergyOrbitalTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to compute and save the Kohn-Sham-orbital 
% energies.
% * |'all'| computes and saves the Kohn-Sham orbital energies after every time 
% step. Warning: this may be slow.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% Save the external field information
% |saveExternalField (sEF)|
% For TDDFT simulation with external driving field, save the external field 
% in the output structures |[ true | false (default) ]|
%% 
% * When activated (|saveExternalField = true|), the information about the external 
% driving field at the sampled times is added to each of the output structures.
% * For practical reasons, the values for the external driving field may be 
% slightly different from that of |externalField|. This features enables keeping 
% the actual external-field values used throughout the propagation.
% Save the ionization signal
% The ionization signal tracks how much density leaves the simulation domain 
% by being absorbed at the boundaries.
% |saveIonization (sIon)|
% Whether to calculate and save the ionization signal during the TDDFT propagation 
% |[ true | false (default) ]|
% |saveIonizationOrbitalIndex (sIKSOI)|
% Index of the Kohn-Sham orbitals for which to compute the orbital-resolved 
% ionization signal |[ [] (default) | index vector | cell | 'all' ]|
%% 
% * This is irrelevant if |saveIonization| is |false|
% * Empty |saveIonizationOrbitalIndex| disables the orbital-resolved ionization 
% signal calculation
% * For spin restricted models, specify the indexes of the orbitals for which 
% to compute the orbital-resolved ionization signal
% * For spin polarized models, combine the up- and down-spin channel orbital 
% indexes in a cell of the form |{ind_up,ind_down}|
% * |'all'| computes the orbital-resolved ionization for all orbitals
% |saveIonizationTime (sIonT)|
% Times at which to compute and save the ionization signal |[ [] (default) | 
% positive scalar | negative integer | vector | 'all' ]|
%% 
% * Empty |saveIonizationTime| uses the same values as in |time| for when to 
% compute and save the ionization signal.
% * A positive scalar specifies the sampling time step between successive computations 
% of the ionization signal. For forward time propagation, it is equivalent to 
% time|(1):saveIonizationTime:|time|(end)|, and for backward ones to time|(1):-saveIonizationTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% ionization-signal computations. For forward time propagation, it is equivalent 
% to time|(1):abs(saveIonizationTime)*||timeStep||:|time|(end)|, and for backward 
% ones to time|(1):-abs(saveIonizationTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to compute and save the ionization 
% signal.
% * |'all'| computes and saves the ionization signal after every time step. 
% Warning: this may be slow.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% Save the Kohn-Sham orbitals (projection) and one-body density
% Warning: The memory requirements for saving the orbitals or density throughout 
% the TDDFT propagation may grow very fast and trigger an error (if MATLAB runs 
% out of memory). Instead, if the full orbital/one-body density is required consider 
% saving the DFT object in separate files, or if only the result of a specify 
% calculation on the orbital/one-body density is required consider consider using 
% installable output functions.
% |saveDensity (sRho)|
% Whether to save the one-body density during the TDDFT propagation |[ true 
% | false (default) ]|
% |saveDensityTime (sRhoT)|
% Times at which to save the one-body density |[ [] (default) | positive scalar 
% | negative integer | vector | 'all' ]|
%% 
% * Empty |saveDensityTime| uses the same values as in |time| for when to save 
% the one-body density.
% * A positive scalar specifies the sampling time step between successive saving 
% of the one-body density. For forward time propagation, it is equivalent to time|(1):saveDensityTime:|time|(end)|, 
% and for backward ones to time|(1):-saveDensityTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% saving the one-body density. For forward time propagation, it is equivalent 
% to time|(1):abs(saveDensityTime)*||timeStep||:|time|(end)|, and for backward 
% ones to time|(1):-abs(saveDensityTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to save the one-body density.
% * |'all'| saves the one-body density after every time step. Warning: generally 
% discouraged as it likely results in very large memory requirements or causes 
% an out-of-memory error REPLACE_WITH_DASH_DASH see the warning above.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% |saveOrbital (sKSO)|
% Whether to save the Kohn-Sham orbitals during the TDDFT propagation |[ true 
% | false (default) ]|
% |saveOrbitalIndex (sKSOI)|
% Index of the Kohn-Sham orbitals to save |[ [] (default) | index vector | cell 
% | 'all' ]|
%% 
% * This is irrelevant if |saveOrbital| is |false|
% * Empty |saveOrbitalIndex| disables saving of the Kohn-Sham orbitals and is 
% technically equivalent to |saveOrbital| |= false|
% * For spin restricted models, specify the indexes of the orbitals to save
% * For spin polarized models, combine the up- and down-spin channel orbital 
% indexes in a cell of the form |{ind_up,ind_down}|
% * |'all'| saves all the Kohn-Sham orbitals
% |saveOrbitalTime (sKSOT)|
% Times at which to save the Kohn-Sham orbitals |[ [] (default) | positive scalar 
% | negative integer | vector | 'all' ]|
%% 
% * Empty |saveOrbitalTime| uses the same values as in |time| for when to save 
% the Kohn-Sham orbitals.
% * A positive scalar specifies the sampling time step between successive saving 
% of the Kohn-Sham orbitals. For forward time propagation, it is equivalent to 
% time|(1):saveOrbitalTime:|time|(end)|, and for backward ones to time|(1):-saveOrbitalTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% saving Kohn-Sham orbitals. For forward time propagation, it is equivalent to 
% time|(1):abs(saveOrbitalTime)*||timeStep||:|time|(end)|, and for backward ones 
% to time|(1):-abs(saveOrbitalTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to save the Kohn-Sham orbitals.
% * |'all'| saves the Kohn-Sham orbitals after every time step. Warning: generally 
% discouraged as it likely results in very large memory requirements or causes 
% an out-of-memory error REPLACE_WITH_DASH_DASH see the warning above.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% |saveOrbitalProjection (sKSOP)|
% Whether to save the projection of the Kohn-Sham orbitals onto a specific basis 
% during the TDDFT propagation |[ true | false (default) ]|
% |saveOrbitalProjectionBasis (sKSOPB)|
% Projection basis |[ [] (default) | matrix basis || <./QMol_disc_basis.html 
% |QMol_disc_basis|> |]|
%% 
% * Empty |saveOrbitalProjectionBasis| uses the initial Kohn-Sham orbitals as 
% the projection basis
% * matrix |saveOrbitalProjectionBasis| specifies the projection basis to be 
% used, with the projection vectors specified in each column of the matrix. For 
% spin-polarized models, the same projection basis used for both the projection 
% of the up- and down-spin Kohn-Sham orbitals. Alternatively, one may specify 
% separate basis sets by collecting them into a cell |{matrix_basis_up, matrix_basis_down}|.
% * <./QMol_disc_basis.html |QMol_disc_basis|> |saveOrbitalProjectionBasis| 
% uses the basis set of the associated domain definition. For spin-polarized models, 
% the same projection basis used for both the projection of the up- and down-spin 
% Kohn-Sham orbitals. Alternatively, one may specify separate basis sets by collecting 
% them into a cell |{QMol_disc_basis_up, QMol_disc_basis_down}|.
% * For both matrix and <./QMol_disc_basis.html |QMol_disc_basis|>, the user-defined 
% basis set is assumed to be a proper orthonormal family defined over the same 
% domain grid as the DFT model being propagated. The TDDFT propagator does not 
% check for this and will produce erroneous results, or trigger an error, otherwise.
% |saveOrbitalProjectionIndex (sKSOPI)|
% Index of the Kohn-Sham orbitals for which to perform the projection |[ [] 
% (default) | index vector | cell | 'all' ]|
%% 
% * This is irrelevant if |saveOrbitalProjectionBasis| is |false|
% * Empty |saveOrbitalProjectionIndex| disables saving of the Kohn-Sham orbitals 
% and is technically equivalent to |saveOrbitalProjectionBasis| |= false|
% * For spin restricted models, specify the indexes of the orbitals for which 
% to perform the projection
% * For spin polarized models, combine the up- and down-spin channel orbital 
% indexes in a cell of the form |{ind_up,ind_down}|
% * |'all'| saves the projection for all the Kohn-Sham orbitals
% |saveOrbitalProjectionTime (sKSOPT)|
% Times at which to save the projection of the Kohn-Sham orbitals |[ [] (default) 
% | positive scalar | negative integer | vector | 'all' ]|
%% 
% * Empty |saveOrbitalProjectionTime| uses the same values as in |time| for 
% when to save the projection of the Kohn-Sham orbitals.
% * A positive scalar specifies the sampling time step between successive savings 
% of the Kohn-Sham orbitals' projection. For forward time propagation, it is equivalent 
% to time|(1):saveOrbitalProjectionTime:|time|(end)|, and for backward ones to 
% time|(1):-saveOrbitalProjectionTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% saving Kohn-Sham orbitals' projection. For forward time propagation, it is equivalent 
% to time|(1):abs(saveOrbitalProjectionTime)*||timeStep||:|time|(end)|, and for 
% backward ones to time|(1):-abs(saveOrbitalProjectionTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to save the Kohn-Sham orbitals' 
% projection.
% * |'all'| saves the Kohn-Sham orbitals' projection after every time step. 
% Warning: this may be slow.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% Save output functions of the one-body density and Kohn-Sham orbitals
% These enable on-the-fly computation and saving of user-defined observables 
% without having to save the DFT, Kohn-Sham orbitals, or one-body density.
% |saveOutputFunctionDensity (sFRho)|
% Installable output function of the one-body density |[ [] (default) | function 
% handle ]|
%% 
% * Leave empty to disable the feature
% * Provide a function handle to enable the feature. The signature for the function 
% is |fun(rho,t)| where |rho| is a one-body density object and |t| is the time 
% (scalar). The function handle may return an array of arbitrary size and shape, 
% but must return at least a scalar and the shape of the output must remain constant 
% throughout the TDDFT propagation.
% |saveOutputFunctionDensityTime (sFRhoT)|
% Times at which to evaluate and save the installable output function of the 
% one-body density |[ [] (default) | positive scalar | negative integer | vector 
% | 'all' ]|
%% 
% * Empty |saveOutputFunctionDensityTime| uses the same values as in |time| 
% for when to evaluate and save the output function.
% * A positive scalar specifies the sampling time step between successive evaluation 
% and saving of the output function. For forward time propagation, it is equivalent 
% to time|(1):saveOutputFunctionDensityTime:|time|(end)|, and for backward ones 
% to time|(1):-saveOutputFunctionDensityTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% evaluations and saving of the output function. For forward time propagation, 
% it is equivalent to time|(1):abs(saveOutputFunctionDensityTime)*||timeStep||:|time|(end)|, 
% and for backward ones to time|(1):-abs(saveOutputFunctionDensityTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to evaluate and save the output 
% function.
% * |'all'| evaluates and saves the output function after every time step. Warning: 
% this may be slow.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% |saveOutputFunctionOrbital (sFKSO)|
% Installable output function of the Kohn-Sham orbitals |[ [] (default) | function 
% handle ]|
%% 
% * Leave empty to disable the feature
% * Provide a function handle to enable the feature. The signature for the function 
% is |fun(KSO,t)| where |KSO| is a Kohn-Sham orbital object and |t| is the time 
% (scalar). The functional handle may return an array of arbitrary size and shape, 
% but must return at least a scalar and the shape of the output must remain constant 
% throughout the TDDFT propagation.
% * Warning: The DFT model Kohn-Sham orbitals are passed by reference to the 
% output function. Thus modifying the Kohn-Sham orbitals in the output function 
% will also modify them for the DFT model (and thus TDDFT propagation) and will 
% likely result in erroneous results or produce an error.
% |saveOutputFunctionOrbitalTime (sFKSOT)|
% Times at which to evaluate and save the installable output function of the 
% Kohn-Sham orbitals |[ [] (default) | positive scalar | negative integer | vector 
% | 'all' ]|
%% 
% * Empty |saveOutputFunctionOrbitalTime| uses the same values as in |time| 
% for when to evaluate and save the output function.
% * A positive scalar specifies the sampling time step between successive evaluation 
% and saving of the output function. For forward time propagation, it is equivalent 
% to time|(1):saveOutputFunctionOrbitalTime:|time|(end)|, and for backward ones 
% to time|(1):-saveOutputFunctionOrbitalTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% evaluations and saving of the output function. For forward time propagation, 
% it is equivalent to time|(1):abs(saveOutputFunctionOrbitalTime)*||timeStep||:|time|(end)|, 
% and for backward ones to time|(1):-abs(saveOutputFunctionOrbitalTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to evaluate and save the output 
% function.
% * |'all'| evaluates and saves the output function after every time step. Warning: 
% this may be slow.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% Save restart data file
% During the time propagation, a restart file can be generated to enable resuming 
% the simulation if it is cut short. Stopping the TDDFT simulation while it writes 
% the restart info may lead to a corrupted file from which restart will not be 
% possible. The restart file contains a copy of the TDDFT-propagator and DFT-model 
% objects, respectively called |TDDFT| and |DFT|.
% |saveRestart (sRest)|
% Activate the generation of a restart file |[ true | false (default) ]|
% |saveRestartFileName (sRestF)|
% Name for the restart file |[ character array (default 'QMolGridREPLACE_WITH_DASH_DASHTDDFTREPLACE_WITH_DASH_DASHRestart.mat') 
% ]|
%% 
% * |saveRestartFileName| must be a valid MATLAB file name ('.mat' extension).
% * |saveRestartFileName| is irrelevant when |saveRestart| |== false|
% |saveRestartTime (sRestT)|
% Times at which to generate or update the restart file |[ [] (default) | positive 
% scalar | negative integer | vector | 'all' ]|
%% 
% * Empty |saveRestartTime| uses the same values as in |time| for when to generate 
% and update the restart file.
% * A positive scalar specifies the sampling time step when to generate and 
% update the restart file. For forward time propagation, it is equivalent to time|(1):saveRestartTime:|time|(end)|, 
% and for backward ones to time|(1):-saveRestartTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% the generation and update of the restart file. For forward time propagation, 
% it is equivalent to time|(1):abs(saveRestartTime)*||timeStep||:|time|(end)|, 
% and for backward ones to time|(1):-abs(saveRestartTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to generate and update the 
% restart file.
% * |'all'| generates and updates the restart file after each time step. Warning: 
% this is very slow and is strongly discouraged.
% * Note: In all cases no restart file is generated for the initial time and 
% final propagation time-step.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% Output results
% During a TDDFT propagation, the results of on-the-fly calculations are stored 
% in structures in the |QMol_TDDFT| object. Note that |QMol_TDDFT| does not interpolate 
% its time propagation to fit user-supplied sample times, Instead, the results 
% are saved at the closest propagation time steps, excluding duplicate times. 
% This may result in sampled times that are different, or have a different (smaller) 
% number of elements, from the ones specified above. Notably, using a sampling 
% time that is not a multiple of the propagation time step may result in uneven 
% saved time sampling. The actual times at with output are saved is included in 
% each of the output structure.
% 
% When |saveExternalField| is |true|, each output-result structure includes 
% the following fields:
%% 
% * In the length gauge, |outStructure.electricField| contains the specific 
% values for the electric field used in the TDSE propagation at the saved times.
% * In the velocity gauge, |outStructure.potentialVector| contains the specific 
% values for the potential vector used in the TDSE propagation at the saved times.
% * In all cases, if the potential vector, electric field, or derivative of 
% the electric field are calculated by the propagator during the simulations (see 
% the decision tree below), those are included in |outStructure.potentialVector|, 
% |outStructure.electricField|, and |outStructure.electricFieldDerivative|, respectively.
%% 
% In restart mode, each of the output structure contains a handful of additional 
% fields to the ones listed below that are relevant for run-time calculations. 
% These fields are saved in the MATLAB restart file but removed upon completion 
% of the TDDFT propagation.
% |outDistanceCopy (oDist)|
% Result of calculating the distance between the extended phase-space copies 
% |[ structure | [] (default) ]|
%% 
% * TDDFT propagation that does not compute the distance (|saveDistanceCopy| 
% |= false|) leaves |outDistanceCopy| empty. Otherwise:
% * |outDipole.time| defines the precise times at which the dipole signal is 
% computed.
% * |outDipole.distance| contains the corresponding distance.
% |outDipole (oDip)|
% Result of dipole-signal calculations during the TDDFT propagation |[ [] | 
% structure ]|
%% 
% * TDDFT propagation that does not compute the dipole signal (|saveDipole| 
% |= false|) leaves |outDipole| empty. Otherwise:
% * |outDipole.time| defines the precise times at which the dipole signal is 
% computed.
% * |outDipole.total| contains the corresponding total dipole signal and, for 
% spin-polarized DFT models, |outDipole.totalUp| and |outDipole.totalDown| contain 
% the total dipole signal in the up- and down-spin channels, respectively.
% * Orbital-resolved dipole signals are stored in |outDipole.orbital_x|, |outDipole.orbitalUp_x|, 
% and |outDipole.orbitalDown_x|. The indices of the orbitals associated with each 
% of these are included in |outDipole.indexOrbital|, |outDipole.indexOrbitalUp|, 
% and |outDipole.indexOrbitalDown.|
% |outDipoleVelocity (oVel)|
% Result of dipole-velocity-signal calculations during the TDDFT propagation 
% |[ [] | structure ]|
%% 
% * TDDFT propagation that does not compute the dipole signal (|saveDipoleVelocity| 
% |= false|) leaves |outDipoleVelocity| empty. Otherwise:
% * |outDipoleVelocity.time| defines the precise times at which the dipole velocity 
% signal is computed.
% * |outDipoleVelocity.total| contains the corresponding total dipole velocity 
% signal and, for spin-polarized DFT models, |outDipoleVelocity.totalUp| and |outDipoleVelocity.totalDown| 
% contain the total dipole velocity signal in the up- and down-spin channels, 
% respectively.
% * Orbital-resolved dipole velocity signals are stored in |outDipoleVelocity.orbital_x|, 
% |outDipoleVelocity.orbitalUp_x|, and |outDipoleVelocity.orbitalDown_x|. The 
% indices of the orbitals associated with each of these are included in |outDipoleVelocity.indexOrbital|, 
% |outDipoleVelocity.indexOrbitalUp|, and |outDipoleVelocity.indexOrbitalDown.|
% |outDipoleAcceleration (oAcc)|
% Result of dipole-acceleration-signal calculations during the TDDFT propagation 
% |[ [] | structure ]|
%% 
% * TDDFT propagation that does not compute the dipole signal (|saveDipoleAcceleration| 
% |= false|) leaves |outDipoleAcceleration| empty. Otherwise:
% * |outDipoleAcceleration.time| defines the precise times at which the dipole 
% acceleration signal is computed.
% * |outDipoleAcceleration.total| contains the corresponding total dipole acceleration 
% signal and, for spin-polarized DFT models, |outDipoleAcceleration.totalUp| and 
% |outDipoleAcceleration.totalDown| contain the total dipole acceleration signal 
% in the up- and down-spin channels, respectively.
% * Orbital-resolved dipole velocity signals are stored in |outDipoleAcceleration.orbital_x|, 
% |outDipoleAcceleration.orbitalUp_x|, and |outDipoleAcceleration.orbitalDown_x|. 
% The indices of the orbitals associated with each of these are included in |outDipoleAcceleration.indexOrbital|, 
% |outDipoleAcceleration.indexOrbitalUp|, and |outDipoleAcceleration.indexOrbitalDown.|
% |outEnergyDFT (oEDFT)|
% Result of the DFT-energy calculations during the TDDFT propagation |[ [] | 
% structure ]|
%% 
% * TDDFT propagation that does track the DFT energy (|saveEnergyDFT| |= false|) 
% leaves |outEnergyDFT| empty. Otherwise:
% * |outEnergyDFT.time| defines the precise times at which the DFT energies 
% are computed.
% * |outEnergyDFT.total| contains the total DFT energy, which should be constant 
% (within the precision of the propagation scheme).
% * |outEnergyDFT.kinetic| contains the kinetic-energy component, including 
% the driving-field potential vector in the velocity gauge. For spin-polarized 
% models the two rows contain the up- and down-spin kinetic energy components, 
% respectively.
% * |outEnergyDFT.external| contains the external-energy component. For spin-polarized 
% models the two rows contain the up- and down-spin external energy components, 
% respectively
% * |outEnergyDFT.Hartree| contains the Hartree-energy component. 
% * |outEnergyDFT.exchangeCorrelation| contains the exchange-correlation-energy 
% component. 
% * |outEnergyDFT.externalField| contains the energy contribution from the driving 
% electric field in the length gauge. For spin-polarized models the two rows contain 
% the up- and down-spin energy components, respectively.
% * |outEnergyDFT.autonomization| contains the energy brought in and out of 
% the system by the external driving field (if any).
% |outEnergyOrbital (oEKSO)|
% Result of the Kohn-Sham-orbital-energy calculations during the TDDFT propagation 
% |[ [] | structure ]|
%% 
% * TDDFT propagation that does track the DFT energy (|saveEnergyOrbital| |= 
% false|) leaves |outEnergyDFT| empty. Otherwise:
% * For a Kohn-Sham orbital $|\phi\rangle$, the orbital energy is defined as 
% $\langle\phi|\hat{\mathcal{H}}_{\rm DFT}|\phi\rangle$ with $\hat{\mathcal{H}}_{\rm 
% DFT}$ the DFT Hamiltonian operator. In the velocity gauge, the external potential 
% vector is accounted for in the kinetic-operator of $\hat{\mathcal{H}}_{\rm DFT}$ 
% while, in the length gauge, the external electric field is ignored.
% * |outEnergyOrbital.time| defines the precise times at which the Kohn-Sham-orbital 
% energies are computed
% * For spin-restricted models, each row of |outEnergyOrbital.orbital| contains 
% the energies of the corresponding Kohn-Sham orbital
% * For spin-polarized models, each row of |outEnergyOrbital.orbitalUp| and 
% |outEnergyOrbital.orbitalDown| contains the energies of the corresponding Kohn-Sham 
% orbital for the up- and down-spin channels, respectively.
% |outIonization (oIon)|
% Result of the ionization calculations during the TDDFT propagation |[ [] | 
% structure ]|
%% 
% * TDDFT propagation that does track ionization (|saveIonization| |= false|) 
% leaves |outIonization| empty. Otherwise:
% * |outIonization.time| defines the precise times at which the ionization is 
% computed.
% * |outIonization.total| contains the total ionization.
% * For spin-polarized models, |outIonization.totalUp| and |outIonization.totalDown| 
% contain the total ionization for the up- and down-spin channels, respectively.
% * Orbital-resolved ionization signals are stored in |outIonization.orbital|, 
% |outIonization.orbitalUp|, and |outIonization.orbitalDown|. The indices of the 
% orbitals associated with each of these are included in |outIonization.indexOrbital|, 
% |outIonization.indexOrbitalUp|, and |outIonization.indexOrbitalDown.|
% |outDensity (oRho)|
% One-body densities during the TDDFT propagation |[ [] | structure ]|
%% 
% * TDDFT propagation that does not save the one-body density (|saveDensity| 
% |= false|) leaves |outDensity| empty. Otherwise:
% * The specific shape of the saved one-body densities is implementation dependent 
% REPLACE_WITH_DASH_DASH see the corresponding documentation for details. At minimum, each implementation 
% defines:
% * |outDensity.time| defines the precise times at which the one-body density 
% is saved.
% * |outDensity.total| contains the corresponding one-body densities and, for 
% spin-polarized DFT models, |outDensity.totalUp| and |outDensity.totalDown| contain 
% the one-body densities in the up- and down-spin channels respectively.
% |outOrbital (oKSO)|
% Kohn-Sham orbitals during the TDDFT propagation |[ [] | structure ]|
%% 
% * TDDFT propagation that does not save the Kohn-Sham orbitals (|saveOrbital| 
% |= false|) leaves |outOrbital| empty. Otherwise:
% * The specific shape of the saved Kohn-Sham orbitals is implementation dependent 
% REPLACE_WITH_DASH_DASH see the corresponding documentation for details. At minimum, each implementation 
% defines:
% * |outOrbital.time| defines the precise times at which the Kohn-Sham orbitals 
% are saved.
% * For spin-restricted models, |outOrbital.orbital| contains the saved Kohn-Sham 
% orbitals and |outOrbital.indexOrbital| the corresponding orbital indices.
% * For spin-polarized models, |outOrbital.orbitalUp| and |outOrbital.orbitalDown| 
% contains the saved Kohn-Sham orbitals for the up- and down-spin channels, respectively, 
% and |outOrbital.indexOrbitalUp| and |outOrbital.indexOrbitalDown| the corresponding 
% orbital indices.
% |outOrbitalProjection (oKSOP)|
% Projection of the Kohn-Sham orbitals during the TDDFT propagation |[ [] | 
% structure ]|
%% 
% * TDDFT propagation that does not save the projection of the Kohn-Sham orbitals 
% (|saveOrbitalProjection| |= false|) leaves |outOrbitalProjection| empty. Otherwise:
% * The specific shape of the saved Kohn-Sham orbitals' projection is implementation 
% dependent REPLACE_WITH_DASH_DASH see the corresponding documentation for details. At minimum, each 
% implementation defines:
% * |outOrbitalProjection.time| defines the precise times at which the Kohn-Sham 
% orbitals' projection is saved.
% * For spin-restricted models, |outOrbitalProjection.orbital| contains the 
% saved Kohn-Sham orbitals' projection and |outOrbitalProjection.indexOrbital| 
% the corresponding orbital indices.
% * For spin-polarized models, |outOrbitalProjection.orbitalUp| and |outOrbitalProjection.orbitalDown| 
% contains the saved Kohn-Sham orbitals' projection for the up- and down-spin 
% channels, respectively, and |outOrbitalProjection.indexOrbitalUp| and |outOrbitalProjection.indexOrbitalDown| 
% the corresponding orbital indices.
% * The structure also retains a copy of the projection basis as <./QMol_disc_basis.html 
% |QMol_disc_basis|> object(s).
% |outOutputFunctionDensity (oFRho)|
% Result of the installable output function of the one-body density |[ [] | 
% structure ]|
%% 
% * TDDFT propagation that does not define an installable output function of 
% the density (|saveOutputFunctionDensity| |= []|) leaves |outOutputFunctionDensity| 
% empty. Otherwise:
% * |outOutputFunctionDensity.time| defines the precise times at which the result 
% of the output function is saved.
% * |outOutputFunctionDensity.result| contains the results of the output functions. 
% If the installable function returns a scalar or a column vector, |outOutputFunctionDensity.result| 
% is a |N-by-numel(outOutputFunctionDensity.time)| matrix with |N| the number 
% of elements in the output. Otherwise, |outOutputFunctionDensity.result| is an 
% |M-by-numel(outOutputFunctionDensity.time)| array with |M| the size of the output.
% * |outOutputFunctionDensity.shape| contains the shape of the output function 
% (|N| or |M|, as defined in the previous bullet point).
% |outOutputFunctionOrbital (oFKSO)|
% Result of the installable output function of the Kohn-Sham orbitals |[ [] 
% | structure ]|
%% 
% * TDDFT propagation that does not define an installable output function of 
% the orbitals (|saveOutputFunctionOrbital| |= []|) leaves |outOutputFunctionOrbital| 
% empty. Otherwise:
% * |outOutputFunctionOrbital.time| defines the precise times at which the result 
% of the output function is saved.
% * |outOutputFunctionOrbital.result| contains the results of the output functions. 
% If the installable function returns a scalar or a column vector, |outOutputFunctionOrbital.result| 
% is a |N-by-numel(outOutputFunctionOrbital.time)| matrix with |N| the number 
% of elements in the output. Otherwise, |outOutputFunctionOrbital.result| is an 
% |M-by-numel(outOutputFunctionOrbital.time)| array with |M| the size of the output.
% * |outOutputFunctionOrbital.shape| contains the shape of the output function 
% (|N| or |M|, as defined in the previous bullet point).
%% Class methods
% Creation
% constructor
% Create an extended fourth-order Forest Ruth [Forest 1990] symplectic TDDFT-propagator 
% object with empty class properties [Mauger 2026].

obj = QMol_TDDFT_ESSO_4FR;
%% 
% Create a TDDFT-propagator object with the |name| properties set to the specified 
% |value|. Several |name-value| pairs can be specified consecutively. Suitable 
% |name| is any of the TDDFT class properties and is case insensitive.

obj = QMol_TDDFT_ESSO_4FR(name1,value1);
obj = QMol_TDDFT_ESSO_4FR(name1,value1,name2,value2,___);
% Changing class properties
% |set|
% Update the |name| properties of a TDDFT-model object to the specified |value|. 
% Several |name-value| pairs can be specified consecutively. Suitable |name| is 
% any of the TDDFT class properties and is case insensitive. In restart mode, 
% output result structures can also be edited with |set|. |QMol_TDDFT| does not 
% check the integrity of its input/output component during a restart and this 
% feature should only be considered by advanced users.

obj.set(name1,value1);
obj.set(name1,value1,name2,value2,___);
%% 
% This is the common name-value pair assignment method used throughout the QMol-grid 
% package.
% |clear|
% Clear all class properties

obj.clear;
%% 
% Clear a specific set of the class properties. Suitable |name| is any of the 
% TDDFT class properties and is case insensitive.

obj.clear(name1,name2,___);
%% 
% This is the common |clear| method available to all classes throughout the 
% QMol-grid package. The |clear| method can be used to delete specific properties 
% before saving an instance of the TDDFT propagator class and propagation results.
% Initializing the object
% |initialize|
% Initialize extended fourth-order Forest Ruth symplectic TDDFT-propagator object 
% without allocating the output-result structures

obj.initialize(DFT);
%% 
% * |DFT| is the <./DFT.html DFT-model> handle object, _i.e._, <./QMol_DFT_spinPol.html 
% |QMol_DFT_spinPol|> or <./QMol_DFT_spinRes.html |QMol_DFT_spinRes|>, that describes 
% the DFT system to propagate.
% * For developers: |initialize| has also a specific interface when called from 
% the |propagate| method that initializes the absorbing boundaries (if any) and 
% determines whether the output-result structures should be initialized too. Overloading 
% classes should avoid redefining |initialize|; If the overloading class needs 
% to perform some initialization (at the beginning of a TDDFT propagation or upon 
% restart), overload the |initializeChildren| method instead.
% Run-time documentation
% |getMemoryProfile|
% Get an estimate of the memory help by a |QMol_TDDFT_ESSO_4FR| object with 
% either

mem = obj.getMemoryProfile;
mem = obj.getMemoryProfile(false);
%% 
% * The object must be |initialize|d for the memory footprint evaluation. If 
% not already, |getMemoryProfile| initializes the |DFT| model object.
% * The estimate includes the (1) |DFT| model, (2) TDDFT propagator, and (3) 
% output results. Note that all these components may not be used in actual simulations 
% and the memory estimate tries to be conservative. On the other hand, it only 
% includes the discretization of member components on the domain grid and ignores 
% other (expectedly small) properties.
% * The output |mem| is the estimated size in bytes.
%% 
% Additionally display the detail of the memory footprint with

mem = obj.getMemoryProfile(true);
% |showDocumentation|
% Display the run-time documentation for the specific configuration of a |QMol_TDDFT_ESSO_4FR| 
% object, which must have been |initialize|d beforehand

obj.showDocumentation;
% TDDFT propagation
% |propagate|
% Propagate the TDDFT dynamics starting from a DFT model object (from scratch)

obj.propagate(DFT);
%% 
% * |DFT| is the <./DFT.html DFT-model> handle object, _i.e._, <./QMol_DFT_spinPol.html 
% |QMol_DFT_spinPol|> or <./QMol_DFT_spinRes.html |QMol_DFT_spinRes|>, that describes 
% the DFT system to propagate.
% * Neither the TDDFT-propagation |obj| nor the DFT-model |DFT| objects need 
% be |initialize|d. In all cases both are (re)initialized at the beginning of 
% the TDDFT propagation to ensure proper and consistent linkage and setup between 
% them.
%% 
% Restart a TDDFT propagation

obj.propagate('restart');
%% 
% * This can be performed after loading the corresponding restart MATLAB file 
% into the workspace.
% Choice of gauge
% If no specific gauge is specified with |externalFieldGauge|, the gauge is 
% selected following the decision tree:
%% 
% * Length gauge if |externalField||.electricField| or |electricField| is a 
% function handle, otherwise:
% * Velocity gauge if |externalField||.potentialVector| or |potentialVector| 
% is a function handle, otherwise:
% * Length gauge if |externalField||.electricField| or |electricField| is a 
% |griddedInterpolant|, otherwise:
% * Velocity gauge if |externalField||.potentialVector| or |potentialVector| 
% is a |griddedInterpolant|, otherwise:
% * Field free (ignore any input field)
% External-field components used in simulations
% Depending on the types of input, not all provided external-field may be used 
% in the simulations. For the potential vector and electric field REPLACE_WITH_DASH_DASH recall that 
% |electricField| and |potentialVector| are repackaged into |externalField| at 
% the beginning of the simulation: 
%% 
% * If both are provided as function handles, then |externalField||.electricField| 
% and |externalField||.potentialVector| are called whenever the values for the 
% potential vector or electric field are required. Note that the TDDFT propagator 
% does not check whether the provided potential vector and electric field are 
% consistent with each other ($E(t)=-\partial_t A(t)$) and providing non-matching 
% components will likely result in erroneous results. Otherwise,
% * If only one of them is provided as a function handle, then both the potential 
% vector and electric field are computed from that same function handle (see below 
% for details on how this is done). Otherwise,
% * In the length gauge, if |externalField||.electricField| is a |griddedInterpolant| 
% then it is used to compute both the electric field and potential vector, otherwise 
% |externalField||.potentialVector| is used to compute them both.
% * In the velocity gauge, if |externalField||.potentialVector| is a |griddedInterpolant| 
% then it is used to compute both the electric field and potential vector, otherwise 
% |externalField||.electricField| is used to compute them both.
% * If none of the |externalField||.electricField| and |externalField||.potentialVector| 
% are defined, the TDDFT propagation is performed field free irrespective of the 
% choice of |externalFieldGauge| and even if an |externalField||.electricFieldDerivative| 
% is defined.
%% 
% The choice of ignoring some (interpolated) input fields is made to ensure 
% the self-consistency of the TDDFT dynamics, and associated observables, during 
% the numerical propagation. To force using an interpolated field input, one can 
% encapsulate it into a function handle |@(t) interpolatedField(t)|. 
% 
% For the electric-field derivative:
%% 
% * If |externalField||.electricFieldDerivative| is defined as a function handle, 
% then |externalField||.electricFieldDerivative| is called when the derivative 
% of the electric field is required.
% * Otherwise, the electric-field derivative is computed numerically from |externalField||.electricField| 
% or |externalField||.potentialVector|, depending on which field component(s) 
% are being used in the TDDFT propagation. 
%% 
% Numerical computation of missing or ignored field components:
%% 
% * Where required, the potential vector is computed from the electric field 
% using a Simpson's 1/3 quadrature rule.
% * Where required, the electric field is computed from the potential vector 
% using a second-order centered finite difference with |diffDT| time step.
% * Where required, the electric field derivative is computed from the electric 
% field or the potential vector using a second-order centered finite difference 
% with |diffDT| time step.
%% Examples
% See the <./TDHF.html time-dependend Hartree-Fock page> for examples of extended 
% phase-space TDDFT simulations with various output computations.
%% Test suite
% For consistency with the rest of the QMol-grid package, |QMol_TDDFT_ESSO_4FR| 
% defines an associated test suite. Run the test suite for the class in normal 
% or <./Test_suite.html summary mode> respectively with

QMol_test.test('TDDFT_ESSO_4FR');
QMol_test.test('-summary','TDDFT_ESSO_4FR');
%% References
% [Forest 1990] E. Forest and R.D. Ruth, "Fourth-order symplectic integration," 
% Physica D: Nonlinear Phenomena 43, 105 (1990).
% 
% [Luo 2017] J. Luo, X. Wu, G. Huang, and F. Liu, "Eplicit symplectic-like integrators 
% with midpoint permutations for spinning compact binaries," The Astrophysical 
% Journal 834, 64 (2017).
% 
% [Mauger 2026] F. Mauger and C. Chandre, "Extended phase-space symplectic integration 
% for electronic dynamics," arXiv:2510.16542 (2026).
% 
% [Tao 2016] M. Tao, "Explicit symplectic approximation of nonseparable Hamiltonians: 
% Algorithm and long time performance," Physical Review E 94, 043303 (2016).
%% Notes
%% 
% * |QMol_TDDFT_ESSO_4FR| was introduced in version 01.23.
##### SOURCE END #####
-->
</div></body></html>