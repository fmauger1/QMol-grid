<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2024a"><title>QMol_DFT_SCF_Anderson</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S3 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: center;  }
.S4 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.S5 { margin: 10px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 15px; font-weight: 700; text-align: left;  }
.S6 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S7 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block }
.S8 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0.555556px solid rgb(217, 217, 217); border-bottom: 0.555556px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S9 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S10 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0.555556px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S11 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0.555556px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span style=' font-family: monospace;'>QMol_DFT_SCF_Anderson</span></h1><div  class = 'S1'><span>Anderson's mising scheme for DFT ground-state calculations.</span></div><h2  class = 'S2'><span>Description</span></h2><div  class = 'S1'><span>Use </span><span style=' font-family: monospace;'>QMol_DFT_SCF_Anderson</span><span> to solve DFT self-consistent field (SCF) nonlinear eigen-state problem</span></div><div  class = 'S3' id = 'M_2D62CEEB' ><span texencoding="\hat{\mathcal{H}}_{\rm DFT}\left[\{\phi_k\}_k\right]\  \phi_k({\bf x}) = E_k\ \phi_k({\bf x})
\quad {\rm for}\quad k=1,\ 2,\ \ldots
\quad\quad\quad (1)" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="384.5" height="24.5" alt="Self-consistent field DFT equation" /></span></div><div  class = 'S1'><span>where </span><span texencoding="\hat{\mathcal{H}}_{\rm DFT}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="38" height="24.5" /></span><span> is the DFT Hamiltonian operator and </span><span texencoding="\{\phi_k\}_k" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="36.5" height="19.5" /></span><span> are the Kohn-Sham orbitals with energies </span><span texencoding="\{E_k\}_k" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="36.5" height="19.5" /></span><span>. </span><span style=' font-family: monospace;'>QMol_DFT_SCF_Anderson</span><span> uses an Anderson's mixing scheme [</span><a href = "#M_B3B891AF"><span>Anderson 1965</span></a><span>] in SCF iterations, as described in [</span><a href = "#M_0D7825C9"><span>Johnson 1988</span></a><span>], for either the one-body density or the Kohn-Sham potential. </span><span style=' font-family: monospace;'>QMol_DFT_SCF_Anderson</span><span> is a handle class.</span></div><h2  class = 'S2' id = 'H_E9C49C16' ><span>Class properties</span></h2><h3  class = 'S4' id = 'H_5E80E5B2' ><span>Anderson's mixing</span></h3><div  class = 'S1'><span>The </span><span style=' font-family: monospace;'>QMol_DFT_SCF_Anderson</span><span> class defines the following public get-access properties; each can be changed using the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method:</span></div><h4  class = 'S5' id = 'H_7F127413' ><span style=' font-family: monospace;'>tolerance (tol)</span></h4><div  class = 'S1'><span>Convergence tolerance </span><span style=' font-family: monospace;'>[ nonnegative scalar (default 1e-10) ]</span></div><h4  class = 'S5'><span style=' font-family: monospace;'>maxIterations (maxit)</span></h4><div  class = 'S1'><span>Maximum number of SCF iterations </span><span style=' font-family: monospace;'>[ nonnegative integer (default 100) ]</span></div><h4  class = 'S5' id = 'H_8D604F00' ><span style=' font-family: monospace;'>mixing (mix)</span></h4><div  class = 'S1'><span>Mixing coefficient </span><span style=' font-family: monospace;'>[ 0 to 1 scalar (default 0.5) ]</span></div><ul  class = 'S6'><li  class = 'S7'><span>Too large </span><span style=' font-family: monospace;'>mixing</span><span> coefficient may render the SCF unstable and prevent convergence.</span></li><li  class = 'S7'><span>Too small </span><span style=' font-family: monospace;'>mixing</span><span> coefficient makes the SCF convergence slower.</span></li><li  class = 'S7'><span>Optimal </span><span style=' font-family: monospace;'>mixing</span><span> coefficient is system dependent and should be adapted accordingly.</span></li></ul><h4  class = 'S5' id = 'H_54C04817' ><span style=' font-family: monospace;'>mixingMode (mode)</span></h4><div  class = 'S1'><span>What to mix in the SCF iterations </span><span style=' font-family: monospace;'>[ density (default) | potential ]</span></div><ul  class = 'S6'><li  class = 'S7'><span style=' font-family: monospace;'>density</span><span> mixes the one-body density while </span><span style=' font-family: monospace;'>potential</span><span> mixes the Kohn-Sham potential. In both cases, only the explicit part of the potential is being mixed in the SCF iterations and any implicit exchange-correlation functional is not being mixed.</span></li></ul><h4  class = 'S5'><span style=' font-family: monospace;'>convergenceTest (test)</span></h4><div  class = 'S1'><span>Convergence criterion </span><span style=' font-family: monospace;'>[ 'density' (default) | 'eigenvalues' ]</span></div><ul  class = 'S6'><li  class = 'S7'><span>With the </span><span style=' font-family: monospace;'>'density'</span><span> criterion, the result is considered converged when the </span><span texencoding="\mathcal{L}^2" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAoCAYAAABq13MpAAAAAXNSR0IArs4c6QAABUVJREFUWEftmG2IVFUYx//PmZ2RmU2jFrXW3dk7d4a21i+FfigpWpAMVAoCSyPMjLJaUSvCMl8SS7KkEtfIVwoKE9GSEApKLNPetD41tcvMvXd2ZlctM4rmbefOeeLIHbhM6844s6XS3k/D3Puc8zv/c57/89xLuAwvugyZMQr9X+3aqNL/K6VbWlr8DQ0NS4hoEYAQgFNEtCmdTm8+ffp0ulyMi348Ojo6rshms1sAtAP4lIiamPk+AFcR0du5XK5rYGAg4wa/6NChUGgOgFl+v39xNBr9S8FFIpHJxWJxv1Kdme+wLOvzSwa6o6PDl81m10spdyYSiZ9cYBQKhVYAeJGIHjYMY9clAw1AtLe3N/b09CiF2Q2m6/pCZt5JRLMNwzhYF7Su61cCuJWZbyGiaczcyMxniOgrZj5i2/a3qVQqW6+TOEo/6PF4ZsZisXhN0BMnTmwMBAJLATwG4C2Px7PH5/Mlo9HooBqwvb19bD6fn0JEC5j5Zcuyfi5NpGIbGxvvlVJ2EdEUZj5ERE+Yptkz1OJUcmYymXeIKNrW1rb28OHD9gVDh8PhCVLKbcx8tqGhYVksFvuzWiXD4fAUKeWb6nkiWlEsFqMej2e5lHL84ODgI+XOoJ7TdX2WlPIpZn4gkUicvGDL6+zsbEgkEmsABP1+f1cpw6uB1nV9OjO/C6BHSjmvBKBp2u1EtMHr9c7u7e094x6rtbW12ev1dgshVsVisR+Hmqei5bW1tYWEEPuEEIvj8fixamAdtRTwXgC/ejyee9wAKsmklNPLlZ40aVKTz+fbQES7DcP47HxzVYR2VNkohJgVj8d/qQY6HA63SikPALgJwBLTNLtL7tDS0nK11+t9j4i63a7gFJnXiGjPcMDnjlklCF3XlVO84vV67yrfyqFi1XHq6+vbyMxLVcLZtj0nlUqddYrGmGKxuJKIxgshlsZisbz6fzhgTdPuBOC3LOvD0nwVoZ3jsVtK+Xgikfih0iLD4fA0KeXHAMYy8zzLst53gMcVi8WXAIxz54YDrP6/GcAnROT26wnMPNm27bnJZHKgauhSIjKzR9O01eX2415Ec3NzwOfzbSei+wEct2377mQyeVLX9anMrNQ/atv2upKPRyKRMVLKtcy8fBgxVpqmud5dfCoqrQZTlsfMW5ULpNPpdUN1Xq7k+8BR+QUAB4QQa5i5iYieNgzjeHnlq7RzNbmHu0AEAgFVWOar7BZC7M1kMidLPhuJRNT2bwOgOjR15QCo8rvJNM2jAGQtgHVBl4JVk5PP56dKKTuZWVXAFudeEMA1zu8dmUxm2fl2pF74qo5HpUkcG9sNYAaA35l5pmVZX1eKq/X+SECrNnIhgB3nPJToOcMwNozE2a25uFRSw9WwX0dEyksXGIbxR6W4eu7XpbTy2Fwut52Z5wLoLS/X9YANF1sztFP5VjHzagXMzPMty/qmfLJgMNghhJjR1NS05cSJE4WRWEit0KTruuqbtzJzrxDiIcMwvisHCoVCtwHoklI+OVSLWesCyqEVjKpezwO41hnUB+AIgI8KhcKXkUik0NfX9ygzv0FEB5l5mWmaCTdA6YWBmSOFQuGZ/v7+32oFrOjTjnXtJ6LNhmHscwIoGAyG1HcJZl7EzP1EFAbQTUSvGoaRUoVDHZdUKtUmpZyjeg5mfl3TtHeHK/u1LuQfx0PTtBuJ6Fnno0lp3DwRqVeeL5j5e2a+HoBq5G9wPXeKmY8JIXYNDg4eGon3xH/N8mpVq564WhOxnjnrjh2FrlvCKgcYVbpKoep+bFTpuiWscoC/Ad9LhEdA6PxYAAAAAElFTkSuQmCC" width="22.5" height="20" /></span><span> norm difference in the one-body density between two consecutive SCF iterations is smaller than </span><a href = "#H_7F127413"><span style=' font-family: monospace;'>tolerance</span></a><span style=' font-family: monospace;'>*</span><a href = "#H_8D604F00"><span style=' font-family: monospace;'>mixing</span></a><span>.</span></li><li  class = 'S7'><span>With the </span><span style=' font-family: monospace;'>'eigenvalues'</span><span> criterion, the result is considered converged when the sum in the absolute-value difference between the DFT Hamiltonian operator eigenvalues between two consecutive SCF iterations is smaller than </span><a href = "#H_7F127413"><span style=' font-family: monospace;'>tolerance</span></a><span style=' font-family: monospace;'>*</span><a href = "#H_8D604F00"><span style=' font-family: monospace;'>mixing</span></a><span>.</span></li></ul><h4  class = 'S5'><span style=' font-family: monospace;'>display (disp)</span></h4><div  class = 'S1'><span>Whether to display the SCF iteration progress </span><span style=' font-family: monospace;'>[ true (default) | false ]</span></div><h3  class = 'S4'><span>Other properties</span></h3><div  class = 'S1'><span>To facilitate simulations, </span><span style=' font-family: monospace;'>QMol_DFT_SCF_Anderson</span><span> defines a handful of additional transient properties. These </span><span style=' text-decoration: underline;'>cannot</span><span> be edited with the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method.</span></div><h4  class = 'S5' id = 'H_0ED64D82' ><span style=' font-family: monospace;'>isInitialized (isInit)</span></h4><div  class = 'S1'><span>Whether the DFT-model object is properly initialized. This is used throughout the QMol-grid package to check that the DFT-model object holds meaningful information and is ready for use.</span></div><h2  class = 'S2' id = 'H_5C9FA558' ><span>Class methods</span></h2><h3  class = 'S4'><span>Creation</span></h3><h4  class = 'S5'><span>constructor</span></h4><div  class = 'S1'><span>Create an Anderson's mixing scheme object with empty class properties.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj = QMol_DFT_SCF_Anderson;</span></span></div></div></div><div  class = 'S9'><span>Create an Anderson's mixing scheme object with the </span><span style=' font-family: monospace;'>name</span><span> properties set to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of </span><a href = "#H_5E80E5B2"><span>Anderson's mixing</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj = QMol_DFT_SCF_Anderson(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >obj = QMol_DFT_SCF_Anderson(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><h3  class = 'S4'><span>Changing class properties</span></h3><h4  class = 'S5' id = 'H_4405B79D' ><span style=' font-family: monospace;'>set</span></h4><div  class = 'S1'><span>Update the </span><span style=' font-family: monospace;'>name</span><span> properties of an Anderson's mixing scheme object to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of </span><a href = "#H_5E80E5B2"><span>Anderson's mixing</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.set(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >obj.set(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S9'><span>This is the common name-value pair assignment method used throughout the QMol-grid package. The </span><span style=' font-family: monospace;'>set</span><span> method also </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the class. After running, the </span><span style=' font-family: monospace;'>set</span><span> property updates the </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to a </span><span style=' font-family: monospace;'>false</span><span> value.</span></div><h4  class = 'S5' id = 'H_BF84FCE7' ><span style=' font-family: monospace;'>reset</span></h4><div  class = 'S1'><span>Reset the object by deleting/re-initializing all run-time properties of the class and updating the </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to </span><span style=' font-family: monospace;'>false</span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.reset;</span></span></div></div></div><ul  class = 'S6'><li  class = 'S7'><span>This is the common </span><span style=' font-family: monospace;'>reset</span><span> method available to all classes throughout the QMol-grid package.</span></li></ul><h4  class = 'S5' id = 'H_C729A888' ><span style=' font-family: monospace;'>clear</span></h4><div  class = 'S1'><span>Clear all class properties</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.clear;</span></span></div></div></div><div  class = 'S9'><span>Clear a specific set of the class properties. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of  </span><a href = "#H_5E80E5B2"><span>Anderson's mixing</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.clear(name1,name2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S9'><span>This is the common </span><span style=' font-family: monospace;'>clear</span><span> method available to all classes throughout the QMol-grid package. The </span><span style=' font-family: monospace;'>clear</span><span> method also </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the class.</span></div><h3  class = 'S4'><span>Initializing the object</span></h3><h4  class = 'S5' id = 'H_85EFED0A' ><span style=' font-family: monospace;'>initialize</span></h4><div  class = 'S1'><span>Initialize a </span><span style=' font-family: monospace;'>QMol_DFT_SCF_Anderson</span><span> object and set the </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to </span><span style=' font-family: monospace;'>true</span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.initialize;</span></span></div></div></div><h3  class = 'S4'><span>Run-time documentation</span></h3><h4  class = 'S5' id = 'H_4D7CFC3D' ><span style=' font-family: monospace;'>showDocumentation</span></h4><div  class = 'S1'><span>Display the run-time documentation for the specific configuration of a </span><span style=' font-family: monospace;'>QMol_DFT_SCF_Anderson</span><span> object, which must have been </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d beforehand.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >ref = obj.showDocumentation;</span></span></div></div></div><ul  class = 'S6'><li  class = 'S7'><span>The output </span><span style=' font-family: monospace;'>ref</span><span> is a cell vector containing the list of references to be included in the bibliography.</span></li></ul><h3  class = 'S4'><span>SCF comptation</span></h3><h4  class = 'S5'><span style=' font-family: monospace;'>solveSCF</span></h4><div  class = 'S1'><span>Compute the solution of the SCF problem of Eq. (</span><a href = "#M_2D62CEEB"><span>1</span></a><span>) with </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.solveSCF(DFT);</span></span></div></div></div><ul  class = 'S6'><li  class = 'S7'><span style=' font-family: monospace;'>DFT</span><span> is the </span><a href = "./DFT.html"><span>DFT-model</span></a><span> handle object, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "./QMol_DFT_spinPol.html"><span style=' font-family: monospace;'>QMol_DFT_spinPol</span></a><span style=' font-family: monospace;'> </span><span>or </span><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span>, that describes the DFT Hamiltonian operator of Eq. (</span><a href = "#M_2D62CEEB"><span>1</span></a><span>).</span></li><li  class = 'S7'><span>To avoid any mismatch in internal properties, </span><span style=' font-family: monospace;'>solveSCF</span><span> first </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the object and (re)initializes the </span><span style=' font-family: monospace;'>DFT</span><span> before performing the SCF iterations.</span></li><li  class = 'S7'><span>The first step of the SCF iterations uses linear mixing (with the </span><a href = "#H_8D604F00"><span style=' font-family: monospace;'>mixing</span></a><span> coefficient); the following iterations use Anderson's mixing.</span></li><li  class = 'S7'><span>For grid-based DFT models, the SCF iterations use the </span><a href = "./QMol_DFT_eigs.html"><span style=' font-family: monospace;'>QMol_DFT_eigs</span></a><span> eigen-state solver with default properties; for basis set models, it uses the </span><a href = "./QMol_DFT_eig_basis.html"><span style=' font-family: monospace;'>QMol_DFT_eig_basis</span></a><span> solver (again with default properties).</span></li><li  class = 'S7'><span>The result Kohn-Sham orbitals are stored in the input </span><span style=' font-family: monospace;'>DFT</span><span> object (in </span><span style=' font-family: monospace;'>DFT.orbital</span><span>).</span></li></ul><div  class = 'S1'><span>Specify the eigen-state solver to use in the SCF iterations with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.solveSCF(DFT,ES);</span></span></div></div></div><ul  class = 'S6'><li  class = 'S7'><span>This enables non-default properties for the eigen-state solver object </span><span style=' font-family: monospace;'>ES</span><span>.</span></li></ul><div  class = 'S1'><span>Specify the initial condition to start the SCF iterations with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.solveSCF(DFT,[],IC);    </span><span style="color: #008013;">% Default eigen-state solver</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >obj.solveSCF(DFT,ES,IC);    </span><span style="color: #008013;">% supplied eigen-state solver</span></span></div></div></div><ul  class = 'S6'><li  class = 'S7'><span style=' font-family: monospace;'>IC = []</span><span> (or omitted) starts the SCF iterations from scratch, from the equivalent of the eigen-states of the external potential only (no Hartree or exchange-correlation contribution). This is the default and most general option but my result in slow (or failed) convergence.</span></li><li  class = 'S7'><span style=' font-family: monospace;'>IC = 'DFT'</span><span> starts the SCF iterations from the one-body density from the input DFT object (</span><span style=' font-family: monospace;'>DFT.getDensity</span><span>).</span></li><li  class = 'S7'><span style=' font-family: monospace;'>IC = rho</span><span>, where </span><span style=' font-family: monospace;'>rho</span><span> is a compatible one-body density object, starts SCF iterations from the supplied one-body density (the total charge in </span><span style=' font-family: monospace;'>rho</span><span> may not match the </span><span style=' font-family: monospace;'>DFT</span><span> total charge, in which case the input density is rescaled to the proper total charge).</span></li><li  class = 'S7'><span style=' font-family: monospace;'>IC = Vks</span><span>, where </span><span style=' font-family: monospace;'>Vks</span><span> is a compatible Kohn-Sham potential object, starts SCF iterations from the supplied Kohn-Sham potential.</span></li><li  class = 'S7'><span>The type of initial condition may not match the </span><a href = "#H_54C04817"><span style=' font-family: monospace;'>mixingMode</span></a><span>. For instance, one my supply a starting one-body density while mixing the Kohn-Sham potential in the SCF iterations.</span></li></ul><h2  class = 'S2'><span>Examples</span></h2><div  class = 'S1'><span>Examples of SCF calculations for spin-polarized and spin-restricted DFT models can be found in the </span><a href = "./QMol_DFT_spinPol.html"><span style=' font-family: monospace;'>QMol_DFT_spinPol</span></a><span> and </span><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span> documentation pages, respectively.</span></div><h2  class = 'S2'><span>Test suite</span></h2><div  class = 'S1'><span>Run the test suite for the class in normal or </span><a href = "./Test_suite.html"><span>summary mode</span></a><span> respectively with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'DFT_SCF_Anderson'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'-summary'</span><span >,</span><span style="color: #a709f5;">'DFT_SCF_Anderson'</span><span >);</span></span></div></div></div><h2  class = 'S2'><span>References</span></h2><div  class = 'S1' id = 'M_B3B891AF' ><span>[Anderson 1965] D.G. Anderson, "Iterative procedures for nonlinear integral equations," Journal of the ACM 12, 547 (1965).</span></div><div  class = 'S1' id = 'M_0D7825C9' ><span>[Johnson 1988] D. D. Johnson, "Modified Broyden''s method for accelerating convergence in self-consistent calculations," Physical Review B 38, 12807 (1988).</span></div><h2  class = 'S2'><span>Notes</span></h2><ul  class = 'S6'><li  class = 'S7'><span style=' font-family: monospace;'>QMol_DFT_SCF_Anderson</span><span> was introduced in version 01.00.</span></li></ul>
<br>
<!-- 
##### SOURCE BEGIN #####
%% |QMol_DFT_SCF_Anderson|
% Anderson's mising scheme for DFT ground-state calculations.
%% Description
% Use |QMol_DFT_SCF_Anderson| to solve DFT self-consistent field (SCF) nonlinear 
% eigen-state problem
% 
% $$\hat{\mathcal{H}}_{\rm DFT}\left[\{\phi_k\}_k\right]\  \phi_k({\bf x}) = 
% E_k\ \phi_k({\bf x})\quad {\rm for}\quad k=1,\ 2,\ \ldots\quad\quad\quad (1)$$
% 
% where $\hat{\mathcal{H}}_{\rm DFT}$ is the DFT Hamiltonian operator and $\{\phi_k\}_k$ 
% are the Kohn-Sham orbitals with energies $\{E_k\}_k$. |QMol_DFT_SCF_Anderson| 
% uses an Anderson's mixing scheme [Anderson 1965] in SCF iterations, as described 
% in [Johnson 1988], for either the one-body density or the Kohn-Sham potential. 
% |QMol_DFT_SCF_Anderson| is a handle class.
%% Class properties
% Anderson's mixing
% The |QMol_DFT_SCF_Anderson| class defines the following public get-access 
% properties; each can be changed using the |set| method:
% |tolerance (tol)|
% Convergence tolerance |[ nonnegative scalar (default 1e-10) ]|
% |maxIterations (maxit)|
% Maximum number of SCF iterations |[ nonnegative integer (default 100) ]|
% |mixing (mix)|
% Mixing coefficient |[ 0 to 1 scalar (default 0.5) ]|
%% 
% * Too large |mixing| coefficient may render the SCF unstable and prevent convergence.
% * Too small |mixing| coefficient makes the SCF convergence slower.
% * Optimal |mixing| coefficient is system dependent and should be adapted accordingly.
% |mixingMode (mode)|
% What to mix in the SCF iterations |[ density (default) | potential ]|
%% 
% * |density| mixes the one-body density while |potential| mixes the Kohn-Sham 
% potential. In both cases, only the explicit part of the potential is being mixed 
% in the SCF iterations and any implicit exchange-correlation functional is not 
% being mixed.
% |convergenceTest (test)|
% Convergence criterion |[ 'density' (default) | 'eigenvalues' ]|
%% 
% * With the |'density'| criterion, the result is considered converged when 
% the $\mathcal{L}^2$ norm difference in the one-body density between two consecutive 
% SCF iterations is smaller than |tolerance||*||mixing|.
% * With the |'eigenvalues'| criterion, the result is considered converged when 
% the sum in the absolute-value difference between the DFT Hamiltonian operator 
% eigenvalues between two consecutive SCF iterations is smaller than |tolerance||*||mixing|.
% |display (disp)|
% Whether to display the SCF iteration progress |[ true (default) | false ]|
% Other properties
% To facilitate simulations, |QMol_DFT_SCF_Anderson| defines a handful of additional 
% transient properties. These cannot be edited with the |set| method.
% |isInitialized (isInit)|
% Whether the DFT-model object is properly initialized. This is used throughout 
% the QMol-grid package to check that the DFT-model object holds meaningful information 
% and is ready for use.
%% Class methods
% Creation
% constructor
% Create an Anderson's mixing scheme object with empty class properties.

obj = QMol_DFT_SCF_Anderson;
%% 
% Create an Anderson's mixing scheme object with the |name| properties set to 
% the specified |value|. Several |name-value| pairs can be specified consecutively. 
% Suitable |name| is any of Anderson's mixing and is case insensitive.

obj = QMol_DFT_SCF_Anderson(name1,value1);
obj = QMol_DFT_SCF_Anderson(name1,value1,name2,value2,___);
% Changing class properties
% |set|
% Update the |name| properties of an Anderson's mixing scheme object to the 
% specified |value|. Several |name-value| pairs can be specified consecutively. 
% Suitable |name| is any of Anderson's mixing and is case insensitive.

obj.set(name1,value1);
obj.set(name1,value1,name2,value2,___);
%% 
% This is the common name-value pair assignment method used throughout the QMol-grid 
% package. The |set| method also |reset| the class. After running, the |set| property 
% updates the |isInitialized| flag to a |false| value.
% |reset|
% Reset the object by deleting/re-initializing all run-time properties of the 
% class and updating the |isInitialized| flag to |false|.

obj.reset;
%% 
% * This is the common |reset| method available to all classes throughout the 
% QMol-grid package.
% |clear|
% Clear all class properties

obj.clear;
%% 
% Clear a specific set of the class properties. Suitable |name| is any of  Anderson's 
% mixing and is case insensitive.

obj.clear(name1,name2,___);
%% 
% This is the common |clear| method available to all classes throughout the 
% QMol-grid package. The |clear| method also |reset| the class.
% Initializing the object
% |initialize|
% Initialize a |QMol_DFT_SCF_Anderson| object and set the |isInitialized| flag 
% to |true|.

obj.initialize;
% Run-time documentation
% |showDocumentation|
% Display the run-time documentation for the specific configuration of a |QMol_DFT_SCF_Anderson| 
% object, which must have been |initialize|d beforehand.

ref = obj.showDocumentation;
%% 
% * The output |ref| is a cell vector containing the list of references to be 
% included in the bibliography.
% SCF comptation
% |solveSCF|
% Compute the solution of the SCF problem of Eq. (1) with 

obj.solveSCF(DFT);
%% 
% * |DFT| is the <./DFT.html DFT-model> handle object, _i.e._, <./QMol_DFT_spinPol.html 
% |QMol_DFT_spinPol|> or <./QMol_DFT_spinRes.html |QMol_DFT_spinRes|>, that describes 
% the DFT Hamiltonian operator of Eq. (1).
% * To avoid any mismatch in internal properties, |solveSCF| first |reset| the 
% object and (re)initializes the |DFT| before performing the SCF iterations.
% * The first step of the SCF iterations uses linear mixing (with the |mixing| 
% coefficient); the following iterations use Anderson's mixing.
% * For grid-based DFT models, the SCF iterations use the <./QMol_DFT_eigs.html 
% |QMol_DFT_eigs|> eigen-state solver with default properties; for basis set models, 
% it uses the <./QMol_DFT_eig_basis.html |QMol_DFT_eig_basis|> solver (again with 
% default properties).
% * The result Kohn-Sham orbitals are stored in the input |DFT| object (in |DFT.orbital|).
%% 
% Specify the eigen-state solver to use in the SCF iterations with

obj.solveSCF(DFT,ES);
%% 
% * This enables non-default properties for the eigen-state solver object |ES|.
%% 
% Specify the initial condition to start the SCF iterations with

obj.solveSCF(DFT,[],IC);    % Default eigen-state solver
obj.solveSCF(DFT,ES,IC);    % supplied eigen-state solver
%% 
% * |IC = []| (or omitted) starts the SCF iterations from scratch, from the 
% equivalent of the eigen-states of the external potential only (no Hartree or 
% exchange-correlation contribution). This is the default and most general option 
% but my result in slow (or failed) convergence.
% * |IC = 'DFT'| starts the SCF iterations from the one-body density from the 
% input DFT object (|DFT.getDensity|).
% * |IC = rho|, where |rho| is a compatible one-body density object, starts 
% SCF iterations from the supplied one-body density (the total charge in |rho| 
% may not match the |DFT| total charge, in which case the input density is rescaled 
% to the proper total charge).
% * |IC = Vks|, where |Vks| is a compatible Kohn-Sham potential object, starts 
% SCF iterations from the supplied Kohn-Sham potential.
% * The type of initial condition may not match the |mixingMode|. For instance, 
% one my supply a starting one-body density while mixing the Kohn-Sham potential 
% in the SCF iterations.
%% Examples
% Examples of SCF calculations for spin-polarized and spin-restricted DFT models 
% can be found in the <./QMol_DFT_spinPol.html |QMol_DFT_spinPol|> and <./QMol_DFT_spinRes.html 
% |QMol_DFT_spinRes|> documentation pages, respectively.
%% Test suite
% Run the test suite for the class in normal or <./Test_suite.html summary mode> 
% respectively with

QMol_test.test('DFT_SCF_Anderson');
QMol_test.test('-summary','DFT_SCF_Anderson');
%% References
% [Anderson 1965] D.G. Anderson, "Iterative procedures for nonlinear integral 
% equations," Journal of the ACM 12, 547 (1965).
% 
% [Johnson 1988] D. D. Johnson, "Modified Broyden''s method for accelerating 
% convergence in self-consistent calculations," Physical Review B 38, 12807 (1988).
%% Notes
%% 
% * |QMol_DFT_SCF_Anderson| was introduced in version 01.00.
##### SOURCE END #####
-->
</div></body></html>