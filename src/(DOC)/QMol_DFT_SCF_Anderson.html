<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2024a"><title>QMol_DFT_SCF_Anderson</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S3 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: center;  }
.S4 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.S5 { margin: 10px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 15px; font-weight: 700; text-align: left;  }
.S6 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S7 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block }
.S8 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0.666667px solid rgb(217, 217, 217); border-bottom: 0.666667px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S9 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S10 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0.666667px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S11 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0.666667px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span style=' font-family: monospace;'>QMol_DFT_SCF_Anderson</span></h1><div  class = 'S1'><span>Anderson's mising scheme for DFT ground-state calculations.</span></div><h2  class = 'S2'><span>Description</span></h2><div  class = 'S1'><span>Use </span><span style=' font-family: monospace;'>QMol_DFT_SCF_Anderson</span><span> to solve DFT self-consistent field (SCF) nonlinear eigen-state problem</span></div><div  class = 'S3' id = 'M_2D62CEEB' ><span texencoding="\hat{\mathcal{H}}_{\rm DFT}\left[\{\phi_k\}_k\right]\  \phi_k({\bf x}) = E_k\ \phi_k({\bf x})
\quad {\rm for}\quad k=1,\ 2,\ \ldots
\quad\quad\quad (1)" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="384.5" height="24.5" alt="Self-consistent field DFT equation" /></span></div><div  class = 'S1'><span>where </span><span texencoding="\hat{\mathcal{H}}_{\rm DFT}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="38" height="24.5" /></span><span> is the DFT Hamiltonian operator and </span><span texencoding="\{\phi_k\}_k" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="36.5" height="19.5" /></span><span> are the Kohn-Sham orbitals with energies </span><span texencoding="\{E_k\}_k" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="36.5" height="19.5" /></span><span>. </span><span style=' font-family: monospace;'>QMol_DFT_SCF_Anderson</span><span> uses an Anderson's mixing scheme [</span><a href = "#M_B3B891AF"><span>Anderson 1965</span></a><span>] in SCF iterations, as described in [</span><a href = "#M_0D7825C9"><span>Johnson 1988</span></a><span>], for either the one-body density or the Kohn-Sham potential. </span><span style=' font-family: monospace;'>QMol_DFT_SCF_Anderson</span><span> is a handle class.</span></div><h2  class = 'S2' id = 'H_E9C49C16' ><span>Class properties</span></h2><h3  class = 'S4' id = 'H_5E80E5B2' ><span>Anderson's mixing</span></h3><div  class = 'S1'><span>The </span><span style=' font-family: monospace;'>QMol_DFT_SCF_Anderson</span><span> class defines the following public get-access properties; each can be changed using the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method:</span></div><h4  class = 'S5' id = 'H_7F127413' ><span style=' font-family: monospace;'>tolerance (tol)</span></h4><div  class = 'S1'><span>Convergence tolerance </span><span style=' font-family: monospace;'>[ nonnegative scalar (default 1e-10) ]</span></div><h4  class = 'S5'><span style=' font-family: monospace;'>maxIterations (maxit)</span></h4><div  class = 'S1'><span>Maximum number of SCF iterations </span><span style=' font-family: monospace;'>[ nonnegative integer (default 100) ]</span></div><h4  class = 'S5' id = 'H_8D604F00' ><span style=' font-family: monospace;'>mixing (mix)</span></h4><div  class = 'S1'><span>Mixing coefficient </span><span style=' font-family: monospace;'>[ 0 to 1 scalar (default 0.5) ]</span></div><ul  class = 'S6'><li  class = 'S7'><span>Too large </span><span style=' font-family: monospace;'>mixing</span><span> coefficient may render the SCF unstable and prevent convergence.</span></li><li  class = 'S7'><span>Too small </span><span style=' font-family: monospace;'>mixing</span><span> coefficient makes the SCF convergence slower.</span></li><li  class = 'S7'><span>Optimal </span><span style=' font-family: monospace;'>mixing</span><span> coefficient is system dependent and should be adapted accordingly.</span></li></ul><h4  class = 'S5' id = 'H_54C04817' ><span style=' font-family: monospace;'>mixingMode (mode)</span></h4><div  class = 'S1'><span>What to mix in the SCF iterations </span><span style=' font-family: monospace;'>[ density (default) | potential ]</span></div><ul  class = 'S6'><li  class = 'S7'><span style=' font-family: monospace;'>density</span><span> mixes the one-body density while </span><span style=' font-family: monospace;'>potential</span><span> mixes the Kohn-Sham potential. In both cases, only the explicit part of the potential is being mixed in the SCF iterations and any implicit exchange-correlation functional is not being mixed.</span></li></ul><h4  class = 'S5'><span style=' font-family: monospace;'>convergenceTest (test)</span></h4><div  class = 'S1'><span>Convergence criterion </span><span style=' font-family: monospace;'>[ 'density' (default) | 'eigenvalues' ]</span></div><ul  class = 'S6'><li  class = 'S7'><span>With the </span><span style=' font-family: monospace;'>'density'</span><span> criterion, the result is considered converged when the </span><span texencoding="\mathcal{L}^2" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAoCAYAAABq13MpAAAAAXNSR0IArs4c6QAABTlJREFUWEftl2uIlFUYx//PeWdGdlcNWswL4+x7GdraIqr1Q0nRgiBRUVBZ6gezlW4aumHRxdRAgraEkuzihaXIsBBNCaEvyZJpN00IWtxl9rzvzM5qW2YU7bSzM3OeOMs7MIy7O+PMmkr7flp2nnPO7/zP8/yfcwiX4UeXITMmof+rU5tU+n+ldEtLSyAejy8FsBbADQD+IKIPmfk113UHisW46OmhgROJxHpmXkpEewFMYeYHAMxl5kOGYSzp7e39tRD8okObpnkLEW1USrXG4/HTGq6hoWG2EGI3gDuIaIWUsuOSgrYs61kiOiGl/LIQzDTNxUS0m4japZQvXErQ1NjYOLW7u3sQgCqC1ip3MnOb53lbqoK2bfsKALcx861ENJ+Z65j5DBF9w8yHs9ns98lk8p9qncSyrAcBdAgh7uzt7T1aEfTMmTPramtr1wB4EsD7hmF8GgqF+rq6uob1hI2NjdPS6XQzES3XVe953sn8QnpsXV3dQ0qpVUTUrAuMiFa6rts92uZ8N2ln5lnDw8OPnTp1KnXe0I7jXKWU2s7MZwOBQFssFvurXCUdx2lWSr2r44nopVwu12UYxvNKqRmjAfmFeLMQ4j3DMFpjsdjP5215/q43AojU1NSs6urq+rtcYNu2FzDzLgDdSqkleXcwTVPna3swGLynp6fnTOF8TU1NU4eGht4GsKu4OPNxJS2voaHBEkLsFUI8XZxb48H7wHsA/GYYxv2Fitm23aqUWlCsdDgcrgkEAuuJ6KTruh8B4NHWKAntq7JZCHF3scmPBe04zlyl1AEANwFY7bru1jxAOBy+MhgMfkxEW6WUB/Nz6BP1PG+dECIhpfxgLOCRNCt11LZta6d4PRgM3lt8lGMVUSKR2MzMa3TBZbPZRclk8qyOjUajU3K53MtENEMIsSYWi6X1/8cDdhzneqVUi7/xkSVLQvvpsVsp9VQ8Hj9RapOO48xXSn0BYBozL/E87xMfeHoul3sVwPTC2vBrpg3ACmbeL4QYcSP/m87MLQAecV33p7JzOl+IzGyYprmhs7MzOxb4nDlzakOh0A4i0pefY9ls9r6+vr7Ttm3PY2at/pFsNrsp7+O+wiuISBdecLR5mbkjEAiszJ9KWUrrIG15zLxNu8Dg4OCmgYEB3cHO+fzi+8xX+RUAB4QQG5m5nojWSimPjZerpU6xbKXzgX5z0Y1lmb4TCCH2pFKp03njj0aj+vi3A3jYHzMEQBfaFtd1jxS36XIBK3KP4kFNTU2hdDo9TxcHM+sOGPZjIgBm+X/vTKVSbWOdSDXAZadHqUV8G9NXyYX6As/Md3me922pcZX+XtI9ypiYLMtqBbBzRAWiF6WU7RORu2OtXTV0NBq9LpfL7QNwNRHtB7BcSvlnGZutOKQqaP+esIOZFwPoKW7XFVOVGFgxdMHbboMGZuZlnud9V7xeJBJpEkIsrK+vf+f48eOZidhIpdBk27a+N29j5h4hxKNSyh+KgSzLuh3AKqXUM/kb3oWA1jC6e60DMNtfIATgMIDPM5nM19FoNJNIJB5n5reI6KB+DrmuGy+EyT8YmDmayWSe6+/v/30iYEdtLr517dNtVUqpn/MjhhCJRKxAILCamZ9g5n4icgBsJaI3pJRJ3Th0uiSTyQal1CJ952DmN03T3DVe2690I+ekh2maNxKRfv1aBZOmiUjfOb5i5h+Z+Rr/eX9tQdwvzHxUCNExPDx8aCLeiRfM8ipVq5pxlRZiNWtWPXYSumoJy5xgUukyhao6bFLpqiUsc4J/AckAiUfQ/7prAAAAAElFTkSuQmCC" width="22.5" height="20" /></span><span> norm difference in the one-body density between two consecutive SCF iterations is smaller than </span><a href = "#H_7F127413"><span style=' font-family: monospace;'>tolerance</span></a><span style=' font-family: monospace;'>*</span><a href = "#H_8D604F00"><span style=' font-family: monospace;'>mixing</span></a><span>.</span></li><li  class = 'S7'><span>With the </span><span style=' font-family: monospace;'>'eigenvalues'</span><span> criterion, the result is considered converged when the sum in the absolute-value difference between the DFT Hamiltonian operator eigenvalues between two consecutive SCF iterations is smaller than </span><a href = "#H_7F127413"><span style=' font-family: monospace;'>tolerance</span></a><span style=' font-family: monospace;'>*</span><a href = "#H_8D604F00"><span style=' font-family: monospace;'>mixing</span></a><span>.</span></li></ul><h4  class = 'S5'><span>display (disp)</span></h4><div  class = 'S1'><span>Whether to display the SCF iteration progress </span><span style=' font-family: monospace;'>[ true (default) | false ]</span></div><h3  class = 'S4'><span>Other properties</span></h3><div  class = 'S1'><span>To facilitate simulations, </span><span style=' font-family: monospace;'>QMol_DFT_SCF_Anderson</span><span> defines a handful of additional transient properties. These </span><span style=' text-decoration: underline;'>cannot</span><span> be edited with the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method.</span></div><h4  class = 'S5' id = 'H_0ED64D82' ><span style=' font-family: monospace;'>isInitialized (isInit)</span></h4><div  class = 'S1'><span>Whether the DFT-model object is properly initialized. This is used throughout the QMol-grid package to check that the DFT-model object holds meaningful information and is ready for use.</span></div><h2  class = 'S2' id = 'H_5C9FA558' ><span>Class methods</span></h2><h3  class = 'S4'><span>Creation</span></h3><h4  class = 'S5'><span>constructor</span></h4><div  class = 'S1'><span>Create an Anderson's mixing scheme object with empty class properties.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj = QMol_DFT_SCF_Anderson;</span></span></div></div></div><div  class = 'S9'><span>Create an Anderson's mixing scheme object with the </span><span style=' font-family: monospace;'>name</span><span> properties set to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of </span><a href = "#H_5E80E5B2"><span>Anderson's mixing</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj = QMol_DFT_SCF_Anderson(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >obj = QMol_DFT_SCF_Anderson(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><h3  class = 'S4'><span>Changing class properties</span></h3><h4  class = 'S5' id = 'H_4405B79D' ><span style=' font-family: monospace;'>set</span></h4><div  class = 'S1'><span>Update the </span><span style=' font-family: monospace;'>name</span><span> properties of an Anderson's mixing scheme object to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of </span><a href = "#H_5E80E5B2"><span>Anderson's mixing</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.set(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >obj.set(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S9'><span>This is the common name-value pair assignment method used throughout the QMol-grid package. The </span><span style=' font-family: monospace;'>set</span><span> method also </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the class. After running, the </span><span style=' font-family: monospace;'>set</span><span> property updates the </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to a </span><span style=' font-family: monospace;'>false</span><span> value.</span></div><h4  class = 'S5' id = 'H_BF84FCE7' ><span style=' font-family: monospace;'>reset</span></h4><div  class = 'S1'><span>Reset the object by deleting/re-initializing all run-time properties of the class and updating the </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to </span><span style=' font-family: monospace;'>false</span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.reset;</span></span></div></div></div><ul  class = 'S6'><li  class = 'S7'><span>This is the common </span><span style=' font-family: monospace;'>reset</span><span> method available to all classes throughout the QMol-grid package.</span></li></ul><h4  class = 'S5' id = 'H_C729A888' ><span style=' font-family: monospace;'>clear</span></h4><div  class = 'S1'><span>Clear all class properties</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.clear;</span></span></div></div></div><div  class = 'S9'><span>Clear a specific set of the class properties. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of  </span><a href = "#H_5E80E5B2"><span>Anderson's mixing</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.clear(name1,name2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S9'><span>This is the common </span><span style=' font-family: monospace;'>clear</span><span> method available to all classes throughout the QMol-grid package. The </span><span style=' font-family: monospace;'>clear</span><span> method also </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the class.</span></div><h3  class = 'S4'><span>Initializing the object</span></h3><h4  class = 'S5' id = 'H_85EFED0A' ><span style=' font-family: monospace;'>initialize</span></h4><div  class = 'S1'><span>Initialize a </span><span style=' font-family: monospace;'>QMol_DFT_SCF_Anderson</span><span> object and set the </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to </span><span style=' font-family: monospace;'>true</span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.initialize;</span></span></div></div></div><h3  class = 'S4'><span>Run-time documentation</span></h3><h4  class = 'S5' id = 'H_4D7CFC3D' ><span style=' font-family: monospace;'>showDocumentation</span></h4><div  class = 'S1'><span>Display the run-time documentation for the specific configuration of a </span><span style=' font-family: monospace;'>QMol_DFT_SCF_Anderson</span><span> object, which must have been </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d beforehand.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >ref = obj.showDocumentation;</span></span></div></div></div><ul  class = 'S6'><li  class = 'S7'><span>The output </span><span style=' font-family: monospace;'>ref</span><span> is a cell vector containing the list of references to be included in the bibliography.</span></li></ul><h3  class = 'S4'><span>SCF comptation</span></h3><h4  class = 'S5'><span style=' font-family: monospace;'>solveSCF</span></h4><div  class = 'S1'><span>Compute the solution of the SCF problem of Eq. (</span><a href = "#M_2D62CEEB"><span>1</span></a><span>) with </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.solveSCF(DFT);</span></span></div></div></div><ul  class = 'S6'><li  class = 'S7'><span style=' font-family: monospace;'>DFT</span><span> is the </span><a href = "./DFT.html"><span>DFT-model</span></a><span> handle object, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "./QMol_DFT_spinPol.html"><span style=' font-family: monospace;'>QMol_DFT_spinPol</span></a><span style=' font-family: monospace;'> </span><span>or </span><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span>, that describes the DFT Hamiltonian operator of Eq. (</span><a href = "#M_2D62CEEB"><span>1</span></a><span>).</span></li><li  class = 'S7'><span>To avoid any mismatch in internal properties, </span><span style=' font-family: monospace;'>solveSCF</span><span> first </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the object and (re)initializes the </span><span style=' font-family: monospace;'>DFT</span><span> before performing the SCF iterations.</span></li><li  class = 'S7'><span>The first step of the SCF iterations uses linear mixing (with the </span><a href = "#H_8D604F00"><span style=' font-family: monospace;'>mixing</span></a><span> coefficient); the following iterations use Anderson's mixing.</span></li><li  class = 'S7'><span>For grid-based DFT models, the SCF iterations use the </span><a href = "./QMol_DFT_eigs.html"><span style=' font-family: monospace;'>QMol_DFT_eigs</span></a><span> eigen-state solver with default properties; for basis set models, it uses the </span><a href = "./QMol_DFT_eig_basis.html"><span style=' font-family: monospace;'>QMol_DFT_eig_basis</span></a><span> solver (again with default properties).</span></li><li  class = 'S7'><span>The result Kohn-Sham orbitals are stored in the input </span><span style=' font-family: monospace;'>DFT</span><span> object (in </span><span style=' font-family: monospace;'>DFT.orbital</span><span>).</span></li></ul><div  class = 'S1'><span>Specify the eigen-state solver to use in the SCF iterations with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.solveSCF(DFT,ES);</span></span></div></div></div><ul  class = 'S6'><li  class = 'S7'><span>This enables non-default properties for the eigen-state solver object </span><span style=' font-family: monospace;'>ES</span><span>.</span></li></ul><div  class = 'S1'><span>Specify the initial condition to start the SCF iterations with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.solveSCF(DFT,[],IC);    </span><span style="color: #008013;">% Default eigen-state solver</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >obj.solveSCF(DFT,ES,IC);    </span><span style="color: #008013;">% supplied eigen-state solver</span></span></div></div></div><ul  class = 'S6'><li  class = 'S7'><span style=' font-family: monospace;'>IC = []</span><span> (or omitted) starts the SCF iterations from scratch, from the equivalent of the eigen-states of the external potential only (no Hartree or exchange-correlation contribution). This is the default and most general option but my result in slow (or failed) convergence.</span></li><li  class = 'S7'><span style=' font-family: monospace;'>IC = 'DFT'</span><span> starts the SCF iterations from the one-body density from the input DFT object (</span><span style=' font-family: monospace;'>DFT.getDensity</span><span>).</span></li><li  class = 'S7'><span style=' font-family: monospace;'>IC = rho</span><span>, where </span><span style=' font-family: monospace;'>rho</span><span> is a compatible one-body density object, starts SCF iterations from the supplied one-body density (the total charge in </span><span style=' font-family: monospace;'>rho</span><span> may not match the </span><span style=' font-family: monospace;'>DFT</span><span> total charge, in which case the input density is rescaled to the proper total charge).</span></li><li  class = 'S7'><span style=' font-family: monospace;'>IC = Vks</span><span>, where </span><span style=' font-family: monospace;'>Vks</span><span> is a compatible Kohn-Sham potential object, starts SCF iterations from the supplied Kohn-Sham potential.</span></li><li  class = 'S7'><span>The type of initial condition may not match the </span><a href = "#H_54C04817"><span style=' font-family: monospace;'>mixingMode</span></a><span>. For instance, one my supply a starting one-body density while mixing the Kohn-Sham potential in the SCF iterations.</span></li></ul><h2  class = 'S2'><span>Examples</span></h2><div  class = 'S1'><span>Examples of SCF calculations for spin-polarized and spin-restricted DFT models can be found in the </span><a href = "./QMol_DFT_spinPol.html"><span style=' font-family: monospace;'>QMol_DFT_spinPol</span></a><span> and </span><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span> documentation pages, respectively.</span></div><h2  class = 'S2'><span>Test suite</span></h2><div  class = 'S1'><span>Run the test suite for the class in normal or </span><a href = "./Test_suite.html"><span>summary mode</span></a><span> respectively with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'DFT_SCF_Anderson'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'-summary'</span><span >,</span><span style="color: #a709f5;">'DFT_SCF_Anderson'</span><span >);</span></span></div></div></div><h2  class = 'S2'><span>References</span></h2><div  class = 'S1' id = 'M_B3B891AF' ><span>[Anderson 1965] D.G. Anderson, "Iterative procedures for nonlinear integral equations," Journal of the ACM 12, 547 (1965).</span></div><div  class = 'S1' id = 'M_0D7825C9' ><span>[Johnson 1988] D. D. Johnson, "Modified Broyden''s method for accelerating convergence in self-consistent calculations," Physical Review B 38, 12807 (1988).</span></div><h2  class = 'S2'><span>Notes</span></h2><ul  class = 'S6'><li  class = 'S7'><span style=' font-family: monospace;'>QMol_DFT_SCF_Anderson</span><span> was introduced in version 01.00.</span></li></ul>
<br>
<!-- 
##### SOURCE BEGIN #####
%% |QMol_DFT_SCF_Anderson|
% Anderson's mising scheme for DFT ground-state calculations.
%% Description
% Use |QMol_DFT_SCF_Anderson| to solve DFT self-consistent field (SCF) nonlinear 
% eigen-state problem
% 
% $$\hat{\mathcal{H}}_{\rm DFT}\left[\{\phi_k\}_k\right]\  \phi_k({\bf x}) = 
% E_k\ \phi_k({\bf x})\quad {\rm for}\quad k=1,\ 2,\ \ldots\quad\quad\quad (1)$$
% 
% where $\hat{\mathcal{H}}_{\rm DFT}$ is the DFT Hamiltonian operator and $\{\phi_k\}_k$ 
% are the Kohn-Sham orbitals with energies $\{E_k\}_k$. |QMol_DFT_SCF_Anderson| 
% uses an Anderson's mixing scheme [Anderson 1965] in SCF iterations, as described 
% in [Johnson 1988], for either the one-body density or the Kohn-Sham potential. 
% |QMol_DFT_SCF_Anderson| is a handle class.
%% Class properties
% Anderson's mixing
% The |QMol_DFT_SCF_Anderson| class defines the following public get-access 
% properties; each can be changed using the |set| method:
% |tolerance (tol)|
% Convergence tolerance |[ nonnegative scalar (default 1e-10) ]|
% |maxIterations (maxit)|
% Maximum number of SCF iterations |[ nonnegative integer (default 100) ]|
% |mixing (mix)|
% Mixing coefficient |[ 0 to 1 scalar (default 0.5) ]|
%% 
% * Too large |mixing| coefficient may render the SCF unstable and prevent convergence.
% * Too small |mixing| coefficient makes the SCF convergence slower.
% * Optimal |mixing| coefficient is system dependent and should be adapted accordingly.
% |mixingMode (mode)|
% What to mix in the SCF iterations |[ density (default) | potential ]|
%% 
% * |density| mixes the one-body density while |potential| mixes the Kohn-Sham 
% potential. In both cases, only the explicit part of the potential is being mixed 
% in the SCF iterations and any implicit exchange-correlation functional is not 
% being mixed.
% |convergenceTest (test)|
% Convergence criterion |[ 'density' (default) | 'eigenvalues' ]|
%% 
% * With the |'density'| criterion, the result is considered converged when 
% the $\mathcal{L}^2$ norm difference in the one-body density between two consecutive 
% SCF iterations is smaller than |tolerance||*||mixing|.
% * With the |'eigenvalues'| criterion, the result is considered converged when 
% the sum in the absolute-value difference between the DFT Hamiltonian operator 
% eigenvalues between two consecutive SCF iterations is smaller than |tolerance||*||mixing|.
% display (disp)
% Whether to display the SCF iteration progress |[ true (default) | false ]|
% Other properties
% To facilitate simulations, |QMol_DFT_SCF_Anderson| defines a handful of additional 
% transient properties. These cannot be edited with the |set| method.
% |isInitialized (isInit)|
% Whether the DFT-model object is properly initialized. This is used throughout 
% the QMol-grid package to check that the DFT-model object holds meaningful information 
% and is ready for use.
%% Class methods
% Creation
% constructor
% Create an Anderson's mixing scheme object with empty class properties.

obj = QMol_DFT_SCF_Anderson;
%% 
% Create an Anderson's mixing scheme object with the |name| properties set to 
% the specified |value|. Several |name-value| pairs can be specified consecutively. 
% Suitable |name| is any of Anderson's mixing and is case insensitive.

obj = QMol_DFT_SCF_Anderson(name1,value1);
obj = QMol_DFT_SCF_Anderson(name1,value1,name2,value2,___);
% Changing class properties
% |set|
% Update the |name| properties of an Anderson's mixing scheme object to the 
% specified |value|. Several |name-value| pairs can be specified consecutively. 
% Suitable |name| is any of Anderson's mixing and is case insensitive.

obj.set(name1,value1);
obj.set(name1,value1,name2,value2,___);
%% 
% This is the common name-value pair assignment method used throughout the QMol-grid 
% package. The |set| method also |reset| the class. After running, the |set| property 
% updates the |isInitialized| flag to a |false| value.
% |reset|
% Reset the object by deleting/re-initializing all run-time properties of the 
% class and updating the |isInitialized| flag to |false|.

obj.reset;
%% 
% * This is the common |reset| method available to all classes throughout the 
% QMol-grid package.
% |clear|
% Clear all class properties

obj.clear;
%% 
% Clear a specific set of the class properties. Suitable |name| is any of  Anderson's 
% mixing and is case insensitive.

obj.clear(name1,name2,___);
%% 
% This is the common |clear| method available to all classes throughout the 
% QMol-grid package. The |clear| method also |reset| the class.
% Initializing the object
% |initialize|
% Initialize a |QMol_DFT_SCF_Anderson| object and set the |isInitialized| flag 
% to |true|.

obj.initialize;
% Run-time documentation
% |showDocumentation|
% Display the run-time documentation for the specific configuration of a |QMol_DFT_SCF_Anderson| 
% object, which must have been |initialize|d beforehand.

ref = obj.showDocumentation;
%% 
% * The output |ref| is a cell vector containing the list of references to be 
% included in the bibliography.
% SCF comptation
% |solveSCF|
% Compute the solution of the SCF problem of Eq. (1) with 

obj.solveSCF(DFT);
%% 
% * |DFT| is the <./DFT.html DFT-model> handle object, _i.e._, <./QMol_DFT_spinPol.html 
% |QMol_DFT_spinPol|> or <./QMol_DFT_spinRes.html |QMol_DFT_spinRes|>, that describes 
% the DFT Hamiltonian operator of Eq. (1).
% * To avoid any mismatch in internal properties, |solveSCF| first |reset| the 
% object and (re)initializes the |DFT| before performing the SCF iterations.
% * The first step of the SCF iterations uses linear mixing (with the |mixing| 
% coefficient); the following iterations use Anderson's mixing.
% * For grid-based DFT models, the SCF iterations use the <./QMol_DFT_eigs.html 
% |QMol_DFT_eigs|> eigen-state solver with default properties; for basis set models, 
% it uses the <./QMol_DFT_eig_basis.html |QMol_DFT_eig_basis|> solver (again with 
% default properties).
% * The result Kohn-Sham orbitals are stored in the input |DFT| object (in |DFT.orbital|).
%% 
% Specify the eigen-state solver to use in the SCF iterations with

obj.solveSCF(DFT,ES);
%% 
% * This enables non-default properties for the eigen-state solver object |ES|.
%% 
% Specify the initial condition to start the SCF iterations with

obj.solveSCF(DFT,[],IC);    % Default eigen-state solver
obj.solveSCF(DFT,ES,IC);    % supplied eigen-state solver
%% 
% * |IC = []| (or omitted) starts the SCF iterations from scratch, from the 
% equivalent of the eigen-states of the external potential only (no Hartree or 
% exchange-correlation contribution). This is the default and most general option 
% but my result in slow (or failed) convergence.
% * |IC = 'DFT'| starts the SCF iterations from the one-body density from the 
% input DFT object (|DFT.getDensity|).
% * |IC = rho|, where |rho| is a compatible one-body density object, starts 
% SCF iterations from the supplied one-body density (the total charge in |rho| 
% may not match the |DFT| total charge, in which case the input density is rescaled 
% to the proper total charge).
% * |IC = Vks|, where |Vks| is a compatible Kohn-Sham potential object, starts 
% SCF iterations from the supplied Kohn-Sham potential.
% * The type of initial condition may not match the |mixingMode|. For instance, 
% one my supply a starting one-body density while mixing the Kohn-Sham potential 
% in the SCF iterations.
%% Examples
% Examples of SCF calculations for spin-polarized and spin-restricted DFT models 
% can be found in the <./QMol_DFT_spinPol.html |QMol_DFT_spinPol|> and <./QMol_DFT_spinRes.html 
% |QMol_DFT_spinRes|> documentation pages, respectively.
%% Test suite
% Run the test suite for the class in normal or <./Test_suite.html summary mode> 
% respectively with

QMol_test.test('DFT_SCF_Anderson');
QMol_test.test('-summary','DFT_SCF_Anderson');
%% References
% [Anderson 1965] D.G. Anderson, "Iterative procedures for nonlinear integral 
% equations," Journal of the ACM 12, 547 (1965).
% 
% [Johnson 1988] D. D. Johnson, "Modified Broyden''s method for accelerating 
% convergence in self-consistent calculations," Physical Review B 38, 12807 (1988).
%% Notes
%% 
% * |QMol_DFT_SCF_Anderson| was introduced in version 01.00.
##### SOURCE END #####
-->
</div></body></html>