<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2024a"><title>QMol_TDDFT</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S3 { margin-bottom: 20px; padding-bottom: 4px;  }
.S4 { margin: 0px; padding: 10px 0px 10px 5px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 700; text-align: start;  }
.S5 { margin: -1px 0px 0px; padding: 10px 0px 10px 7px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: start;  }
.S6 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.S7 { margin: 10px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 15px; font-weight: 700; text-align: left;  }
.S8 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S9 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block }
.S10 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0.666667px solid rgb(217, 217, 217); border-bottom: 0.666667px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S11 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S12 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0.666667px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S13 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0.666667px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S14 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0' id = 'T_474FB08F' ><span style=' font-family: monospace;'>QMol_TDDFT</span></h1><div  class = 'S1'><span>Parent class for time-dependent density-functional theory (TDDFT) model objects.</span></div><h2  class = 'S2' id = 'H_ED346F2A' ><span>Description</span></h2><div  class = 'S1'><span style=' font-family: monospace;'>QMol_TDDFT</span><span> defines an abstract class for the time propagation of DFT models. It is designed to be agnostic of (i) the model dimension, (ii) the chosen discretization (Cartesian grid or basis), and (ii) spin polarized or restricted configuration. These are to be handled by the specific TDDFT-implementation classes and their components.</span></div><div  class = 'S1'><span style=' font-family: monospace;'>QMol_TDDFT</span><span> defines many peoperties and methods. Here we only document the ones visible to end users and implementation-specific overloading classes (public or protected access attributes). We provide a </span><a href = "#H_2FB9B214"><span>quick overview</span></a><span> of the requirements of implementation-specific classes for defining actual TDDFT propagation schemes.</span></div><div  class = 'S3'><div  class = 'S4'><span style=' font-weight: bold;'>Table of Contents</span></div><div  class = 'S5'><a href = "#H_ED346F2A"><span>Description
</span></a><a href = "#H_24F205D3"><span>Class properties
</span></a><span>    </span><a href = "#H_5B03CB4B"><span>Time propagation
</span></a><span>        </span><a href = "#H_D8AAEC21"><span>display (disp)
</span></a><span>        </span><a href = "#H_3B6C8431"><span>time (T)
</span></a><span>        </span><a href = "#H_3CC0FE7C"><span>timeStep (dt)
</span></a><span>        </span><a href = "#H_85007098"><span>absorbingBoundary (ABC)
</span></a><span>        </span><a href = "#H_2EA3F8EC"><span>externalField (EF)
</span></a><span>    </span><a href = "#H_A211A946"><span>Save the DFT object into individual files
</span></a><span>        </span><a href = "#H_7A5FDD1F"><span>saveDFT (sDFT)
</span></a><span>        </span><a href = "#H_4D9A3574"><span>saveDFTFileName (sDFTF)
</span></a><span>        </span><a href = "#H_772A678B"><span>saveDFTTime (sDFTT)
</span></a><span>    </span><a href = "#H_A90EE811"><span>Save the dipole, dipole velocity, and dipole acceleration signals
</span></a><span>        </span><a href = "#H_E30347CB"><span>saveDipole (sDip)
</span></a><span>        </span><a href = "#H_9D21E9DE"><span>saveDipoleOrbitalIndex (sDipI)
</span></a><span>        </span><a href = "#H_CCC421C5"><span>saveDipoleTime (sDipT)
</span></a><span>        </span><a href = "#H_2978977D"><span>saveDipoleVelocity (sVel)
</span></a><span>        </span><a href = "#H_E363B1E2"><span>saveDipoleVelocityOrbitalIndex (sVelI)
</span></a><span>        </span><a href = "#H_FD864729"><span>saveDipoleVelocityTime (sVelT)
</span></a><span>        </span><a href = "#H_CB35D0D0"><span>saveDipoleAcceleration (sAcc)
</span></a><span>        </span><a href = "#H_F7D56BC9"><span>saveDipoleAccelerationOrbitalIndex (sAccI)
</span></a><span>        </span><a href = "#H_267F59C7"><span>saveDipoleAccelerationTime (sAccT)
</span></a><span>    </span><a href = "#H_FB7F0C94"><span>Save DFT and orbital energies
</span></a><span>        </span><a href = "#H_CB527D7D"><span>saveEnergyDFT (sEDFT)
</span></a><span>        </span><a href = "#H_D15EFD11"><span>saveEnergyDFTTime (sEDFTT)
</span></a><span>        </span><a href = "#H_6190C681"><span>saveEnergyOrbital (sEKSO)
</span></a><span>        </span><a href = "#H_98DA6C1A"><span>saveEnergyOrbitalTime (sEKSOT)
</span></a><span>    </span><a href = "#H_48DDF558"><span>Save the external field information
</span></a><span>        </span><a href = "#H_10596868"><span>saveExternalField (sEF)
</span></a><span>    </span><a href = "#H_65D2E853"><span>Save the ionization signal
</span></a><span>        </span><a href = "#H_6B566C83"><span>saveIonization (sIon)
</span></a><span>        </span><a href = "#H_07FC104D"><span>saveIonizationOrbitalIndex (sIKSOI)
</span></a><span>        </span><a href = "#H_01E66AA1"><span>saveIonizationTime (sIonT)
</span></a><span>    </span><a href = "#H_E89C839B"><span>Save the Kohn-Sham orbitals (projection) and one-body density
</span></a><span>        </span><a href = "#H_B3D550CC"><span>saveDensity (sRho)
</span></a><span>        </span><a href = "#H_9AA8162A"><span>saveDensityTime (sRhoT)
</span></a><span>        </span><a href = "#H_2A78E237"><span>saveOrbital (sKSO)
</span></a><span>        </span><a href = "#H_F26B9668"><span>saveOrbitalIndex (sKSOI)
</span></a><span>        </span><a href = "#H_A93BF65C"><span>saveOrbitalTime (sKSOT)
</span></a><span>        </span><a href = "#H_0A85DA1C"><span>saveOrbitalProjection (sKSOP)
</span></a><span>        </span><a href = "#H_6BFEE12B"><span>saveOrbitalProjectionBasis (sKSOPB)
</span></a><span>        </span><a href = "#H_44353F0D"><span>saveOrbitalProjectionIndex (sKSOPI)
</span></a><span>        </span><a href = "#H_71646414"><span>saveOrbitalProjectionTime (sKSOPT)
</span></a><span>    </span><a href = "#H_236395D1"><span>Save output functions of the one-body density and Kohn-Sham orbitals
</span></a><span>        </span><a href = "#H_D1715482"><span>saveOutputFunctionDensity (sFRho)
</span></a><span>        </span><a href = "#H_D3553E6F"><span>saveOutputFunctionDensityTime (sFRhoT)
</span></a><span>        </span><a href = "#H_13D0EA88"><span>saveOutputFunctionOrbital (sFKSO)
</span></a><span>        </span><a href = "#H_B72B0D00"><span>saveOutputFunctionOrbitalTime (sFKSOT)
</span></a><span>    </span><a href = "#H_5CD2979A"><span>Save restart data file
</span></a><span>        </span><a href = "#H_06F9031D"><span>saveRestart (sRest)
</span></a><span>        </span><a href = "#H_AE8821C0"><span>saveRestartFileName (sRestF)
</span></a><span>        </span><a href = "#H_5668813B"><span>saveRestartTime (sRestT)
</span></a><span>    </span><a href = "#H_D533B953"><span>Output results
</span></a><span>        </span><a href = "#H_28F8C3A4"><span>outDFT (oDFT)
</span></a><span>        </span><a href = "#H_F65810AA"><span>outDipole (oDip)
</span></a><span>        </span><a href = "#H_95407807"><span>outDipoleVelocity (oVel)
</span></a><span>        </span><a href = "#H_02629977"><span>outDipoleAcceleration (oAcc)
</span></a><span>        </span><a href = "#H_B6B04F7C"><span>outEnergyDFT (oEDFT)
</span></a><span>        </span><a href = "#H_71BECE2C"><span>outEnergyOrbital (oEKSO)
</span></a><span>        </span><a href = "#H_E1C662FA"><span>outIonization (oIon)
</span></a><span>        </span><a href = "#H_D6D335DD"><span>outDensity (oRho)
</span></a><span>        </span><a href = "#H_371940E8"><span>outOrbital (oKSO)
</span></a><span>        </span><a href = "#H_5096ABA5"><span>outOrbitalProjection (oKSOP)
</span></a><span>        </span><a href = "#H_9F79DF61"><span>outOutputFunctionDensity (oFRho)
</span></a><span>        </span><a href = "#H_25C1C7F6"><span>outOutputFunctionOrbital (oFKSO)
</span></a><span>        </span><a href = "#H_B2980914"><span>outRestart (oRest)
</span></a><span>    </span><a href = "#H_C8F30381"><span>Other hidden class properties
</span></a><span>        </span><a href = "#H_37454CF9"><span>DFT
</span></a><span>        </span><a href = "#H_110A8982"><span>tspan
</span></a><span>        </span><a href = "#H_8882E7D7"><span>iref
</span></a><span>        </span><a href = "#H_4F8B0111"><span>restart
</span></a><a href = "#H_444F9B6D"><span>Class methods
</span></a><span>    </span><a href = "#H_A7EA7D3E"><span>Creation
</span></a><span>        </span><a href = "#H_0783E8B1"><span>constructor
</span></a><span>    </span><a href = "#H_87F4F901"><span>Changing class properties
</span></a><span>        </span><a href = "#H_4405B79D"><span>set
</span></a><span>        </span><a href = "#H_C729A888"><span>clear
</span></a><span>    </span><a href = "#H_686ACD09"><span>Initializing the object
</span></a><span>        </span><a href = "#H_85EFED0A"><span>initialize
</span></a><span>        </span><a href = "#H_3FFF1372"><span>initializeChildren
</span></a><span>        </span><a href = "#H_63C6DA3F"><span>getOutputIndex
</span></a><span>        </span><a href = "#H_D3F27113"><span>setOutputChildren
</span></a><span>        </span><a href = "#H_12E03134"><span>setOutputDFT
</span></a><span>        </span><a href = "#H_5D387730"><span>setOutputDipole
</span></a><span>        </span><a href = "#H_C32F9472"><span>setOutputEnergy
</span></a><span>        </span><a href = "#H_C219079B"><span>setOutputFunction
</span></a><span>        </span><a href = "#H_EA0844B5"><span>setOutputIonization
</span></a><span>        </span><a href = "#H_D7894DE5"><span>setOutputOrbitalDensity
</span></a><span>        </span><a href = "#H_C640DA93"><span>setOutputRestart
</span></a><span>        </span><a href = "#H_5904178E"><span>finalize
</span></a><span>    </span><a href = "#H_B2D31FE3"><span>Run-time documentation
</span></a><span>        </span><a href = "#H_E3988947"><span>getMemoryProfile
</span></a><span>        </span><a href = "#H_ABD08C91"><span>showDocumentation
</span></a><span>    </span><a href = "#H_AEFB66DB"><span>TDDFT propagation
</span></a><span>        </span><a href = "#H_5CD9DA16"><span>propagate
</span></a><span>        </span><a href = "#H_DC96BD5E"><span>saveOutputDFT
</span></a><span>        </span><a href = "#H_9ED0647B"><span>setOutputEnergy
</span></a><span>        </span><a href = "#H_1C92546A"><span>saveOutputFunction
</span></a><a href = "#H_2FB9B214"><span>Overloading the class
</span></a><span>    </span><a href = "#H_B9A8411A"><span>Methods that must be overloaded
</span></a><span>        </span><a href = "#H_884CFDF5"><span>propertyNames
</span></a><span>        </span><a href = "#H_D8A9FEA5"><span>showDoc
</span></a><span>        </span><a href = "#H_CBF28755"><span>setOutputOrbitalDensity
</span></a><span>        </span><a href = "#H_8328AE09"><span>setTimeStep
</span></a><span>        </span><a href = "#H_BE45A424"><span>applyTimeStep
</span></a><span>        </span><a href = "#H_3FBF0B69"><span>saveOutputDipole
</span></a><span>        </span><a href = "#H_FDA44F8F"><span>getExternalFieldEnergy
</span></a><span>        </span><a href = "#H_4BB23773"><span>saveOutputIonization
</span></a><span>        </span><a href = "#H_24EF3880"><span>saveOutputOrbitalDensity
</span></a><span>    </span><a href = "#H_C9A49DFA"><span>Additional optional methods to overload
</span></a><span>        </span><a href = "#H_DC4E9FF3"><span>getMemoryProfilePropagator
</span></a><span>        </span><a href = "#H_483AC36A"><span>getMemoryProfileOrbitalDensity
</span></a><span>        </span><a href = "#H_A5C2DE6E"><span>getMemoryProfileChildren
</span></a><span>        </span><a href = "#H_B96633C8"><span>docOutputChildren
</span></a><span>        </span><a href = "#H_675447D6"><span>setOutputChildren
</span></a><span>        </span><a href = "#H_DF38E3D0"><span>setOutputExternalField
</span></a><span>        </span><a href = "#H_F3159701"><span>setRestartChildren
</span></a><span>        </span><a href = "#H_E5FC9CB8"><span>saveOutputChildren
</span></a><span>        </span><a href = "#H_B478C7F5"><span>addOutputExternalField
</span></a><span>        </span><a href = "#H_9D80AD2B"><span>saveRestartChildren
</span></a><a href = "#H_8CAFC83D"><span>Bourdary absorber
</span></a><span>    </span><a href = "#H_CA02FC07"><span>Mask function
</span></a><span>    </span><a href = "#H_64DC68BD"><span>Complex absorbing potential (CAP)
</span></a><a href = "#H_D431B55B"><span>Test suite
</span></a><a href = "#H_2E204287"><span>Notes</span></a></div></div><h2  class = 'S2' id = 'H_24F205D3' ><span>Class properties</span></h2><h3  class = 'S6' id = 'H_5B03CB4B' ><span>Time propagation</span></h3><h4  class = 'S7' id = 'H_D8AAEC21' ><span style=' font-family: monospace;'>display (disp)</span></h4><div  class = 'S1'><span>Whether to display progress of the TDDFT calculations as they go on </span><span style=' font-family: monospace;'>[ true (default) | false ]</span></div><h4  class = 'S7' id = 'H_3B6C8431' ><span style=' font-family: monospace;'>time (T)</span></h4><div  class = 'S1'><span>Time propagation vector </span><span style=' font-family: monospace;'>[ vector (default []) ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>In all TDDFT propagation simulations </span><span style=' font-family: monospace;'>T(1)</span><span> specifies the starting time and </span><span style=' font-family: monospace;'>T(end)</span><span> the ending time.</span></li><li  class = 'S9'><span>In forward time propagation simulations (</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'> &gt; 0</span><span>) time values in </span><span style=' font-family: monospace;'>T</span><span> must be all increasing, while for backward time propagation (</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'> &lt; 0</span><span>) they must be all decreasing. Time increments in the vector </span><span style=' font-family: monospace;'>T</span><span> need not be equally spaced.</span></li><li  class = 'S9'><span>When </span><a href = "#H_D8AAEC21"><span style=' font-family: monospace;'>display</span></a><span> is activated, </span><span style=' font-family: monospace;'>T</span><span> specifies the intermediary times for the time-propagation progress display.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>T</span><span> is also the default time sampling for saved results that do not define their own.</span></li><li  class = 'S9'><span>Note that the time step used in TDDFT propagations is set independently of </span><span style=' font-family: monospace;'>T</span><span>.</span></li></ul><h4  class = 'S7' id = 'H_3CC0FE7C' ><span style=' font-family: monospace;'>timeStep (dt)</span></h4><div  class = 'S1'><span>Time step used for the time propagation </span><span style=' font-family: monospace;'> [ scalar (default 0.01) ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Positive (resp. negative) </span><span style=' font-family: monospace;'>timeStep</span><span> define forward (resp. ackward) time propagation.</span></li></ul><h4  class = 'S7' id = 'H_85007098' ><span style=' font-family: monospace;'>absorbingBoundary (ABC)</span></h4><div  class = 'S1'><span>Absorber at the edges of the domain </span><span style=' font-family: monospace;'>[ [] (default) | mask object | CAP object ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>The boundary absorber aims at eliminating outgoing wave packets from the discretization domain and avoid spurious reflections at the edges of the domain.</span></li><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>absorbingBoundary</span><span> does not implement any absorbing boundary method and any part of the wave packet reaching the edges of the domain will be reflected (or articifially reappears on the other side of the domain through periodic effects).</span></li><li  class = 'S9'><span>Mask absorbers are applied at the end of each propagation step. They are the easiest to use and implement but are first order, irrespective of the order of the time propagation scheme. See </span><a href = "#H_CA02FC07"><span>below</span></a><span> for details on the required interface for absorbing mask classes.</span></li><li  class = 'S9'><span>Complex absorbing potentials (CAPs) are integrated within the propagation scheme, as an imaginary potential term that causes exponential decay of the wave packet at the edges.Under the rihgt circumstances, CAPs can preserve the order of the propagation schemes. See </span><a href = "#H_64DC68BD"><span>below</span></a><span> for details on the required interface for CAP classes.</span></li></ul><h4  class = 'S7' id = 'H_2EA3F8EC' ><span style=' font-family: monospace;'>externalField (EF)</span></h4><div  class = 'S1'><span>External driving field </span><span style=' font-family: monospace;'>[ [] (default) | field object ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>externalField</span><span> performs field-free TDDFT simulations.</span></li><li  class = 'S9'><span>The specific type and interface for compatible field objects is left to the implementation-specific TDDFT propagator -- see the corresponding documentation for details.</span></li></ul><h3  class = 'S6' id = 'H_A211A946' ><span>Save the DFT object into individual files</span></h3><div  class = 'S1'><span>During the time propagation, copies of the DFT object can be saved in separate MATLAB files.</span></div><h4  class = 'S7' id = 'H_7A5FDD1F' ><span style=' font-family: monospace;'>saveDFT (sDFT)</span></h4><div  class = 'S1'><span>Activate saving the DFT object into separate files </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S7' id = 'H_4D9A3574' ><span style=' font-family: monospace;'>saveDFTFileName (sDFTF)</span></h4><div  class = 'S1'><span>Name for the files in which the DFT objects are saved </span><span style=' font-family: monospace;'>[ chracter array (default 'QMolGrid--TDDFT--DFT') ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>The DFT objects saved at different times are put in separate MATLAB (.mat.) file, with names starting with </span><span style=' font-family: monospace;'>saveDFTFileName</span><span> to which the iteration index is appended. Each file produced also contains a scalar variable </span><span style=' font-family: monospace;'>t</span><span> with the time information.</span></li><li  class = 'S9'><span>One may specify a location where to create the files by indicating the folder path in </span><span style=' font-family: monospace;'>saveDFTFileName</span></li><li  class = 'S9'><span style=' font-family: monospace;'>saveDFTFileName</span><span> is irrelevant when </span><a href = "#H_7A5FDD1F"><span style=' font-family: monospace;'>saveDFT</span></a><span style=' font-family: monospace;'> == false</span></li></ul><h4  class = 'S7' id = 'H_772A678B' ><span style=' font-family: monospace;'>saveDFTTime (sDFTT)</span></h4><div  class = 'S1'><span>Times at which to save the DFT object into a file </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveDFTTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to save the DFT object into MATLAB files.</span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step when to save the DFT object into MATLAB files. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveDFTTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveDFTTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between saves. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveDFTTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveDFTTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to save the DFT object to a MATLAB file.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> saves the DFT object into a MATLAB file after every time step. Warning: this is slow and may result in a very large number of file and/or large disk usage.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h3  class = 'S6' id = 'H_A90EE811' ><span>Save the dipole, dipole velocity, and dipole acceleration signals</span></h3><h4  class = 'S7' id = 'H_E30347CB' ><span style=' font-family: monospace;'>saveDipole (sDip)</span></h4><div  class = 'S1'><span>Whether to calculate and save the dipole signal during the TDDFT propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S7' id = 'H_9D21E9DE' ><span style=' font-family: monospace;'>saveDipoleOrbitalIndex (sDipI)</span></h4><div  class = 'S1'><span>Index of the Kohn-Sham orbitals for which to compute the orbital-resolved dipole signal </span><span style=' font-family: monospace;'>[ [] (default) | index vector | cell | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>This is irrelevant if </span><a href = "#H_E30347CB"><span style=' font-family: monospace;'>saveDipole</span></a><span> is </span><span style=' font-family: monospace;'>false</span></li><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveDipoleOrbitalIndex</span><span> disables the orbital-resolved dipole signal calculation</span></li><li  class = 'S9'><span>For spin restricted models, specify the indexes of the orbitals for which to compute the orbital-resolved dipole signal</span></li><li  class = 'S9'><span>For spin polarized models, combine the up- and down-spin channel orbital indexes in a cell of the form </span><span style=' font-family: monospace;'>{ind_up,ind_down}</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> computes the orbital-resolved dipole for all orbitals</span></li></ul><h4  class = 'S7' id = 'H_CCC421C5' ><span style=' font-family: monospace;'>saveDipoleTime (sDipT)</span></h4><div  class = 'S1'><span>Times at which to compute and save the dipole signal </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveDipoleTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to compute and save the dipole signal.</span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step between successive computations of the dipole signal. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveDipoleTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveDipoleTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between dipole-signal computations. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveDipoleTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveDipoleTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to compute and save the dipole signal.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> computes and saves the dipole signal after every time step. Warning: this is may be slow.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h4  class = 'S7' id = 'H_2978977D' ><span style=' font-family: monospace;'>saveDipoleVelocity (sVel)</span></h4><div  class = 'S1'><span>Whether to calculate and save the dipole velocity signal during the TDDFT propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S7' id = 'H_E363B1E2' ><span style=' font-family: monospace;'>saveDipoleVelocityOrbitalIndex (sVelI)</span></h4><div  class = 'S1'><span>Index of the Kohn-Sham orbitals for which to compute the orbital-resolved dipole velocity signal </span><span style=' font-family: monospace;'>[ [] (default) | index vector | cell | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>This is irrelevant if </span><a href = "#H_2978977D"><span style=' font-family: monospace;'>saveDipoleVelocity</span></a><span> is </span><span style=' font-family: monospace;'>false</span></li><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveDipoleVelocityOrbitalIndex</span><span> disables the orbital-resolved dipole velocity signal calculation</span></li><li  class = 'S9'><span>For spin restricted models, specify the indexes of the orbitals for which to compute the orbital-resolved dipole velocity signal</span></li><li  class = 'S9'><span>For spin polarized models, combine the up- and down-spin channel orbital indexes in a cell of the form </span><span style=' font-family: monospace;'>{ind_up,ind_down}</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> computes the orbital-resolved dipole velocity for all orbitals</span></li></ul><h4  class = 'S7' id = 'H_FD864729' ><span style=' font-family: monospace;'>saveDipoleVelocityTime (sVelT)</span></h4><div  class = 'S1'><span>Times at which to compute and save the dipole velocity signal </span><span style=' font-family: monospace;'>[ 'dipole' (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>'dipole'</span><span> </span><span style=' font-family: monospace;'>saveDipoleVelocityTime</span><span> uses the same times as for </span><a href = "#H_CCC421C5"><span style=' font-family: monospace;'>saveDipoleTime</span></a><span> </span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step between successive computations of the dipole velocity signal. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveDipoleVelocityTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveDipoleVelocityTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between dipole-velocity-signal computations. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveDipoleVelocityTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveDipoleVelocityTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to compute and save the dipole velocity signal.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> computes and saves the dipole velocity signal after every time step. Warning: this is may be slow.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h4  class = 'S7' id = 'H_CB35D0D0' ><span style=' font-family: monospace;'>saveDipoleAcceleration (sAcc)</span></h4><div  class = 'S1'><span>Whether to calculate and save the dipole acceleration signal during the TDDFT propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S7' id = 'H_F7D56BC9' ><span style=' font-family: monospace;'>saveDipoleAccelerationOrbitalIndex (sAccI)</span></h4><div  class = 'S1'><span>Index of the Kohn-Sham orbitals for which to compute the orbital-resolved dipole acceleration signal </span><span style=' font-family: monospace;'>[ [] (default) | index vector | cell | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>This is irrelevant if </span><a href = "#H_CB35D0D0"><span style=' font-family: monospace;'>saveDipoleAcceleration</span></a><span> is </span><span style=' font-family: monospace;'>false</span></li><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveDipoleAccelerationOrbitalIndex</span><span> disables the orbital-resolved dipole acceleration signal calculation</span></li><li  class = 'S9'><span>For spin restricted models, specify the indexes of the orbitals for which to compute the orbital-resolved dipole acceleration signal</span></li><li  class = 'S9'><span>For spin polarized models, combine the up- and down-spin channel orbital indexes in a cell of the form </span><span style=' font-family: monospace;'>{ind_up,ind_down}</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> computes the orbital-resolved dipole acceleration for all orbitals</span></li></ul><h4  class = 'S7' id = 'H_267F59C7' ><span style=' font-family: monospace;'>saveDipoleAccelerationTime (sAccT)</span></h4><div  class = 'S1'><span>Times at which to compute and save the dipole acceleration signal </span><span style=' font-family: monospace;'>[ 'dipole' (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>'dipole'</span><span> </span><span style=' font-family: monospace;'>saveDipoleAccelerationTime</span><span> uses the same times as for </span><a href = "#H_CCC421C5"><span style=' font-family: monospace;'>saveDipoleTime</span></a><span> </span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step between successive computations of the dipole acceleration signal. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveDipoleAccelerationTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveDipoleAccelerationTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between dipole-acceleration-signal computations. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveDipoleAccelerationTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveDipoleAccelerationTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to compute and save the dipole acceleration signal.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> computes and saves the dipole acceleration signal after every time step. Warning: this is may be slow.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h3  class = 'S6' id = 'H_FB7F0C94' ><span>Save DFT and orbital energies</span></h3><h4  class = 'S7' id = 'H_CB527D7D' ><span style=' font-family: monospace;'>saveEnergyDFT (sEDFT)</span></h4><div  class = 'S1'><span>Whether to track the DFT energy during the TDDFT propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S7' id = 'H_D15EFD11' ><span style=' font-family: monospace;'>saveEnergyDFTTime (sEDFTT)</span></h4><div  class = 'S1'><span>Times at which to compute and save the DFT energy </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveEnergyDFTTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to compute and save the DFT energy</span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step between successive computations of the DFT energy. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveEnergyDFTTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveEnergyDFTTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between DFT-energy computations. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveEnergyDFTTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveEnergyDFTTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to compute and save the DFT energy.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> computes and saves the DFT energy after every time step. Warning: this is may be slow.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h4  class = 'S7' id = 'H_6190C681' ><span style=' font-family: monospace;'>saveEnergyOrbital (sEKSO)</span></h4><div  class = 'S1'><span>Whether to track the orbital energies during the TDDFT propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S7' id = 'H_98DA6C1A' ><span style=' font-family: monospace;'>saveEnergyOrbitalTime (sEKSOT)</span></h4><div  class = 'S1'><span>Times at which to compute and save the Kohn-Sham orbital energies </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>For a Kohn-Sham orbital </span><span texencoding="|\phi\rangle" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAAkCAYAAAD2IghRAAAAAXNSR0IArs4c6QAABRFJREFUWEftWG2IVFUYft6zdyd3WMVMRbbVe+/MZTdXiYwi6k/+yPKL9k+aVBZlJqyFIZWV/qoshYikEkKStLDoi0xLQQqDKIXK6Mfqysy957LTggVhWjvtzL3njROzcJtmZ+7MuhOS9+e9557znPd93vd5ziFcpA9dpLhxCXizM3cp4v/LiFuWdRURzSgWi9/mcrl8nCBUpEp3d/fkkZGRNUKItmKxuGdwcHAozmTRMY7jXKaUuh7AJGYmz/O+ABBWmiedTt+klDrMzA9JKd+Ns1ZF4F1dXdOLxeJBALOUUkt83z8ZZ7LoGNM05wohDgEwiWiN67q7x5qjp6enfXh4eI/+nkwm7+vv7/+91noTBty27TsAvA/gZ6XUYt/3T1QDY1nWKiLay8y3SykP/yfAFy5caPi+/xKARwAcYeaVUsqz1cB0dnZe2draepCZvzcMoy+TyYxUGz8hEXccZ0YYhvsB3MjML0gpNwPgakBKm90O4H5mXiqlPNZ04JZl3UBERwBMJqLlrut+Wiv1+vtokQLYZZrmpqNHjwZj/TchEbcsawMRvQzgpFJqme/7Xhzgo0VKRPNbWlqWZjKZbFOAd3R0JJPJ5LQwDF8EcCcRfQxgg1LqnJTyt1p00SBLRfoOgC2e5z0/1j/jjrju10EQLNELEZFO7ecAHgQwE4DewACA9QCu0GNM09xXjQKzZ8/uMAxD1weCIOgdS0PGBby0yE4AtxHRRiHEbqXULcysNeA8My+SUh53HGdeGIYfAbCJaJ3rum9WiT7Ztv00gOeIaL3runr+fz0NA7dtuxvAXgALImB0qrcS0VMAvmlpaenNZDK/1Nsebdu+GsAhZj4VBMGKXC73aznyhoB3dnZOa21t1Ty8lYh2zJkz5zGdfsuyphLRewAWAXjFNM2No7RIpVLbmHkTAL+WGpfot5OIVgO42/M8LWT/eBoBTqlUapPuz+UgTNNcIITQqqf5vcLzvA9KBTeJiF4HcC8zZ4UQS13XPV1DSRcT0SfMfKCSDagbuOM46TAMPwPQVV75qVTqAWZ+o3xD6XR6plJK9/Lr4iqpZVmzABwkoumVMlQ38FQq1cfMr0WLT0eup6cnkc/nXwWwFsD+RCKxemBg4HyZsEyOq6SWZV24iGu7WygU3gLQGy0+DW7UawC4BsDmUg/WnyhSsOeFEIuz2ezX1WhywTlumqYthNApn6s7CjOvk1L+WeLxzSWZR6kNfqnfa2oFQbCfiOZpngshNtQyUBe8q5R57O2u6z45GrlS790K4Idisbg8l8v9pKMdKeTTzNwrpTxVQ/6jfXxMH18Xx6OuT6ui53lPaCEpo9Cutra2h/v7+wumaV4rhDgAQBDRPa7ralWt+kyUckYjeEII0ZvNZgcrnXYiAgUhRF82m/2uFuioV9Ei5rqutrkV7XBdES9xdopS6hlm7gNwTAsQM2vOPwtgmIgeZ+apuoCZeXc+n3/7zJkzf8QB3RR3qJ1ge3t7slAoOES0BcAyAMeJaK1SajCuG4xuqKl+vJHTTqXoR05AqwAs8Tzvx2pZqpsq5ZM1etopn2dUkZn5q6acORs97ZQDLynytjgC9beqVUpH3HsVzfNEIrGLiO5i5n2FQmHt0NDQcJxCjI7RbtMwDO0Az47rXiXuTVZUSZn5USnljnpBl1qg9iUfEtHKuAfrcd3WamMVBMEUvbhhGOe06DQCPJ1Oz1dKXT7uu8NGFm/2P38Bm8ftUqxpU30AAAAASUVORK5CYII=" width="23" height="18" /></span><span>, the orbital energy is defined as </span><span texencoding="\langle\phi|\hat{\mathcal{H}}_{\rm DFT}|\phi\rangle" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="78" height="24.5" /></span><span> with </span><span texencoding="\hat{\mathcal{H}}_{\rm DFT}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="38" height="24.5" /></span><span> the DFT Hamiltonian operator.</span></li><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveEnergyOrbitalTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to compute and save the Kohn-Sham orbital energies</span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step between successive computations of the Kohn-Sham orbital energies. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveEnergyOrbitalTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveEnergyOrbitalTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between Kohn-Sham-orbital-energy computations. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveEnergyOrbitalTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveEnergyOrbitalTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to compute and save the Kohn-Sham-orbital energies.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> computes and saves the Kohn-Sham orbital energies after every time step. Warning: this is may be slow.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h3  class = 'S6' id = 'H_48DDF558' ><span>Save the external field information</span></h3><h4  class = 'S7' id = 'H_10596868' ><span style=' font-family: monospace;'>saveExternalField (sEF)</span></h4><div  class = 'S1'><span>For TDDFT simulation with and </span><a href = "#H_2EA3F8EC"><span>external driving field</span></a><span>, save the external field in output structures </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>When activated (</span><span style=' font-family: monospace;'>saveExternalField = true</span><span>), the information about the external driving field at the sampled times is added to each of the </span><a href = "#H_D533B953"><span>output structures</span></a><span> (except </span><a href = "#H_28F8C3A4"><span style=' font-family: monospace;'>outDFT</span></a><span>).</span></li><li  class = 'S9'><span>For practical reasons, the values for the external driving field may be slightly different than that of </span><a href = "#H_2EA3F8EC"><span style=' font-family: monospace;'>externalField</span></a><span>. This features enables keeping the actual external-field values used throughout the propagation.</span></li></ul><h3  class = 'S6' id = 'H_65D2E853' ><span>Save the ionization signal</span></h3><div  class = 'S1'><span>The ionization signal tracks how much density leaves the simulation domain by being </span><a href = "#H_8CAFC83D"><span>absorbed at the boundaries</span></a><span>.</span></div><h4  class = 'S7' id = 'H_6B566C83' ><span style=' font-family: monospace;'>saveIonization (sIon)</span></h4><div  class = 'S1'><span>Whether to calculate and save the ionization signal during the TDDFT propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S7' id = 'H_07FC104D' ><span style=' font-family: monospace;'>saveIonizationOrbitalIndex (sIKSOI)</span></h4><div  class = 'S1'><span>Index of the Kohn-Sham orbitals for which to compute the orbital-resolved ionization signal </span><span style=' font-family: monospace;'>[ [] (default) | index vector | cell | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>This is irrelevant if </span><a href = "#H_6B566C83"><span style=' font-family: monospace;'>saveIonization</span></a><span> is </span><span style=' font-family: monospace;'>false</span></li><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveIonizationOrbitalIndex</span><span> disables the orbital-resolved ionization signal calculation</span></li><li  class = 'S9'><span>For spin restricted models, specify the indexes of the orbitals for which to compute the orbital-resolved ionization signal</span></li><li  class = 'S9'><span>For spin polarized models, combine the up- and down-spin channel orbital indexes in a cell of the form </span><span style=' font-family: monospace;'>{ind_up,ind_down}</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> computes the orbital-resolved ionization for all orbitals</span></li></ul><h4  class = 'S7' id = 'H_01E66AA1' ><span style=' font-family: monospace;'>saveIonizationTime (sIonT)</span></h4><div  class = 'S1'><span>Times at which to compute and save the ionization signal </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveIonizationTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to compute and save the ionization signal.</span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step between successive computations of the ionization signal. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveIonizationTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveIonizationTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between ionization-signal computations. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveIonizationTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveIonizationTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to compute and save the ionization signal.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> computes and saves the ionization signal after every time step. Warning: this is may be slow.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h3  class = 'S6' id = 'H_E89C839B' ><span>Save the Kohn-Sham orbitals (projection) and one-body density</span></h3><div  class = 'S1' id = 'M_5BAA8F46' ><span style=' text-decoration: underline;'>Warning:</span><span> The memory requirements for saving the orbitals or density throughout the TDDFT propagation may grow very fast and trigger an error (if MATLAB runs out of memory). Instead, if the full orbital/one-body density is required consider </span><a href = "#H_A211A946"><span>saving the DFT object in separate files</span></a><span>, or if only the result of a specify calculation on the orbital/one-body density is required consider consider using installabe </span><a href = "#H_236395D1"><span>output functions</span></a><span>.</span></div><h4  class = 'S7' id = 'H_B3D550CC' ><span style=' font-family: monospace;'>saveDensity (sRho)</span></h4><div  class = 'S1'><span>Whether to save the one-body density during the TDDFT propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S7' id = 'H_9AA8162A' ><span style=' font-family: monospace;'>saveDensityTime (sRhoT)</span></h4><div  class = 'S1'><span>Times at which to save the one-body density </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveDensityTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to save the one-body density.</span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step between successive saving of the one-body density. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveDensityTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveDensityTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between saving the one-body density. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveDensityTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveDensityTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to save the one-body density.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> saves the one-body density after every time step. Warning: generally discouraged as it likely results in very large memory requirements or cause an out-of-memory error -- see the </span><a href = "#M_5BAA8F46"><span>warning above</span></a><span>.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h4  class = 'S7' id = 'H_2A78E237' ><span style=' font-family: monospace;'>saveOrbital (sKSO)</span></h4><div  class = 'S1'><span>Whether to save the Kohn-Sham orbitals during the TDDFT propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S7' id = 'H_F26B9668' ><span style=' font-family: monospace;'>saveOrbitalIndex (sKSOI)</span></h4><div  class = 'S1'><span>Index of the Kohn-Sham orbitals to save </span><span style=' font-family: monospace;'>[ [] (default) | index vector | cell | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>This is irrelevant if </span><a href = "#H_2A78E237"><span style=' font-family: monospace;'>saveOrbital</span></a><span> is </span><span style=' font-family: monospace;'>false</span></li><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveOrbitalIndex</span><span> disables saving of the Kohn-Sham orbitals and is technically equivalent to </span><a href = "#H_2A78E237"><span style=' font-family: monospace;'>saveOrbital </span></a><span style=' font-family: monospace;'>= false</span></li><li  class = 'S9'><span>For spin restricted models, specify the indexes of the orbitals to save</span></li><li  class = 'S9'><span>For spin polarized models, combine the up- and down-spin channel orbital indexes in a cell of the form </span><span style=' font-family: monospace;'>{ind_up,ind_down}</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> saves all the Kohn-Sham orbitals</span></li></ul><h4  class = 'S7' id = 'H_A93BF65C' ><span style=' font-family: monospace;'>saveOrbitalTime (sKSOT)</span></h4><div  class = 'S1'><span>Times at which to save the Kohn-Sham orbitals </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveOrbitalTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to save the Kohn-Sham orbitals.</span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step between successive saving of the Kohn-Sham orbitals. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveOrbitalTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveOrbitalTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between saving Kohn-Sham orbitals. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveOrbitalTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveOrbitalTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to save the Kohn-Sham orbitals.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> saves the Kohn-Sham orbitals after every time step. Warning: generally discouraged as it likely results in very large memory requirements or cause an out-of-memory error -- see the </span><a href = "#M_5BAA8F46"><span>warning above</span></a><span>.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h4  class = 'S7' id = 'H_0A85DA1C' ><span style=' font-family: monospace;'>saveOrbitalProjection (sKSOP)</span></h4><div  class = 'S1'><span>Whether to save the projection of the Kohn-Sham orbitals onto a specific basis during the TDDFT propagation </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S7' id = 'H_6BFEE12B' ><span style=' font-family: monospace;'>saveOrbitalProjectionBasis (sKSOPB)</span></h4><div  class = 'S1'><span>Projection basis </span><span style=' font-family: monospace;'>[ [] (default) | basis ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveOrbitalProjectionBasis</span><span> uses the initial Kohn-Sham orbitals as the projection basis</span></li><li  class = 'S9'><span>User-defined </span><span style=' font-family: monospace;'>basis</span><span> is implementation dependent -- see the respective documentations for details</span></li></ul><h4  class = 'S7' id = 'H_44353F0D' ><span style=' font-family: monospace;'>saveOrbitalProjectionIndex (sKSOPI)</span></h4><div  class = 'S1'><span>Index of the Kohn-Sham orbitals for which to perform the projection </span><span style=' font-family: monospace;'>[ [] (default) | index vector | cell | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>This is irrelevant if </span><a href = "#H_0A85DA1C"><span style=' font-family: monospace;'>saveOrbitalProjectionBasis</span></a><span> is </span><span style=' font-family: monospace;'>false</span></li><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveOrbitalProjectionIndex</span><span> disables saving of the Kohn-Sham orbitals and is technically equivalent to </span><a href = "#H_0A85DA1C"><span style=' font-family: monospace;'>saveOrbitalProjectionBasis</span></a><span> </span><span style=' font-family: monospace;'>= false</span></li><li  class = 'S9'><span>For spin restricted models, specify the indexes of the orbitals for which to perform the projection</span></li><li  class = 'S9'><span>For spin polarized models, combine the up- and down-spin channel orbital indexes in a cell of the form </span><span style=' font-family: monospace;'>{ind_up,ind_down}</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> saves the projection for all the Kohn-Sham orbitals</span></li></ul><h4  class = 'S7' id = 'H_71646414' ><span style=' font-family: monospace;'>saveOrbitalProjectionTime (sKSOPT)</span></h4><div  class = 'S1'><span>Times at which to save the projection of the Kohn-Sham orbitals </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveOrbitalProjectionTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to save the projection of the Kohn-Sham orbitals.</span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step between successive saving of the Kohn-Sham orbitals' projection. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveOrbitalProjectionTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveOrbitalProjectionTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between saving Kohn-Sham orbitals' projection. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveOrbitalProjectionTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveOrbitalProjectionTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to save the Kohn-Sham orbitals' projection.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> saves the Kohn-Sham orbitals' projection after every time step. Warning: this may be slow.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h3  class = 'S6' id = 'H_236395D1' ><span>Save output functions of the one-body density and Kohn-Sham orbitals</span></h3><h4  class = 'S7' id = 'H_D1715482' ><span style=' font-family: monospace;'>saveOutputFunctionDensity (sFRho)</span></h4><div  class = 'S1'><span>Installable output function of the one-body density </span><span style=' font-family: monospace;'>[ [] (default) | function handle ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Leave empty to disable the feature</span></li><li  class = 'S9'><span>Provide a function handle to enable the feature. The signature for the function is </span><span style=' font-family: monospace;'>fun(rho,t)</span><span> where </span><span style=' font-family: monospace;'>rho</span><span> is a one-body density object and </span><span style=' font-family: monospace;'>t</span><span> is the time (scalar). The functiona handle may return an array of arbitrary size and shape, but must return at least a scalar.</span></li></ul><h4  class = 'S7' id = 'H_D3553E6F' ><span style=' font-family: monospace;'>saveOutputFunctionDensityTime (sFRhoT)</span></h4><div  class = 'S1'><span>Times at which to evaluate and save the installable output function of the one-body density </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveOutputFunctionDensityTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to evaluate and save the output function.</span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step between successive evaluation and saving of the output function. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveOutputFunctionDensityTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveOutputFunctionDensityTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between evaluations and saving of the output function. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveOutputFunctionDensityTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveOutputFunctionDensityTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to evaluate and save the output function.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> evaluates and saves the output function after every time step. Warning: this may be slow.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h4  class = 'S7' id = 'H_13D0EA88' ><span style=' font-family: monospace;'>saveOutputFunctionOrbital (sFKSO)</span></h4><div  class = 'S1'><span>Installable output function of the Kohn-Sham orbitals </span><span style=' font-family: monospace;'>[ [] (default) | function handle ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Leave empty to disable the feature</span></li><li  class = 'S9'><span>Provide a function handle to enable the feature. The signature for the function is </span><span style=' font-family: monospace;'>fun(KSO,t)</span><span> where </span><span style=' font-family: monospace;'>KSO</span><span> is a Kohn-Sham orbital object and </span><span style=' font-family: monospace;'>t</span><span> is the time (scalar). The functiona handle may return an array of arbitrary size and shape, but must return at least a scalar.</span></li><li  class = 'S9'><span style=' text-decoration: underline;'>Warning:</span><span> The DFT model Kohn-Sham orbitals are passed by reference to the output function. Thus modifying the Kohn-Sham orbitals in the output function will also modify them for the DFT model (and thus TDDFT propagation) and will likely result in erroneous results or produce an error.</span></li></ul><h4  class = 'S7' id = 'H_B72B0D00' ><span style=' font-family: monospace;'>saveOutputFunctionOrbitalTime (sFKSOT)</span></h4><div  class = 'S1'><span>Times at which to evaluate and save the installable output function of the Kohn-Sham orbitals </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveOutputFunctionOrbitalTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to evaluate and save the output function.</span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step between successive evaluation and saving of the output function. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveOutputFunctionOrbitalTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveOutputFunctionOrbitalTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between evaluations and saving of the output function. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveOutputFunctionOrbitalTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveOutputFunctionOrbitalTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to evaluate and save the output function.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> evaluates and saves the output function after every time step. Warning: this may be slow.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h3  class = 'S6' id = 'H_5CD2979A' ><span>Save restart data file</span></h3><div  class = 'S1'><span>During the time propagation, a restart file can be generated to enable resuming the simulation if it is cut short. Stopping the TDDFT simulation while it writes the restart info may lead to a corrupted file from which restart will not be possible. The restart file contains a copy of the TDDFT-propagator and DFT-model objects, respectively called </span><span style=' font-family: monospace;'>TDDFT</span><span> and </span><span style=' font-family: monospace;'>DFT</span><span> in the MATLAB restart file.</span></div><h4  class = 'S7' id = 'H_06F9031D' ><span style=' font-family: monospace;'>saveRestart (sRest)</span></h4><div  class = 'S1'><span>Activate the generation of a restart file </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h4  class = 'S7' id = 'H_AE8821C0' ><span style=' font-family: monospace;'>saveRestartFileName (sRestF)</span></h4><div  class = 'S1'><span>Name for the restart file </span><span style=' font-family: monospace;'>[ chracter array (default 'QMolGrid--TDDFT--Restart.mat') ]</span></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>saveDFTFileName</span><span> must be a valid MATLAB file name ('.mat' extension).</span></li><li  class = 'S9'><span style=' font-family: monospace;'>saveDFTFileName</span><span> is irrelevant when </span><a href = "#H_06F9031D"><span style=' font-family: monospace;'>saveRestart</span></a><span style=' font-family: monospace;'> == false</span></li></ul><h4  class = 'S7' id = 'H_5668813B' ><span style=' font-family: monospace;'>saveRestartTime (sRestT)</span></h4><div  class = 'S1'><span>Times at which to generate or update the restart file </span><span style=' font-family: monospace;'>[ [] (default) | positive scalar | negative integer | vector | 'all' ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Empty </span><span style=' font-family: monospace;'>saveRestartTime</span><span> uses the same values as in </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span> for when to generate and update the restart file.</span></li><li  class = 'S9'><span>A positive scalar specifies the sampling time step when to generate and update the restart file. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):saveRestartTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-saveRestartTime:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A negative integer specifies the number of propagation time steps between the generation and update of the restart file. For forward time propagation, it is equivalent to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):abs(saveRestartTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>, and for backward ones to </span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(1):-abs(saveRestartTime)*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>:</span><a href = "#H_3B6C8431"><span>time</span></a><span style=' font-family: monospace;'>(end)</span><span>.</span></li><li  class = 'S9'><span>A vector provides user-defined times at which to generate and update the restart file.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>'all'</span><span> generates and updates the restart file after each time step. Warning: this is very slow and is strongly discouraged.</span></li><li  class = 'S9'><span style=' text-decoration: underline;'>Note:</span><span> In all cases no restart file is generated for the initial time and final propagation time-step.</span></li><li  class = 'S9'><span>See the note on how intermediate time saving is performed during the TDDFT propagation </span><a href = "#M_16F59492"><span>below</span></a><span>.</span></li></ul><h3  class = 'S6' id = 'H_D533B953' ><span>Output results</span></h3><div  class = 'S1' id = 'M_16F59492' ><span>During a TDDFT propagation, the results of on-the-fly calculations are strored in structures in the </span><span style=' font-family: monospace;'>QMol_TDDFT</span><span> object. Note that </span><span style=' font-family: monospace;'>QMol_TDDFT</span><span> does </span><span style=' text-decoration: underline;'>not</span><span> interpolate its time propagation to fit user-supplied sample times, Insatead, the results are saved at the closest propagation time steps, excluding duplicate times. This may result in sampled times that are different, or have a different (smaller) number of elements, than the ones specified above. Notably, using a sampling time that is not a multiple of the propagation time step may result in uneven saved time sampling. The actual times at with output are saved is included in each of the output structure.</span></div><div  class = 'S1'><span>In </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>, each output structure in the </span><span style=' font-family: monospace;'>QMol_TDDFT</span><span> object contains the fields </span><span style=' font-family: monospace;'>ind</span><span> and </span><span style=' font-family: monospace;'>n</span><span>, respectively with the propagation time indexes at which to save the associated results and the next index in </span><span style=' font-family: monospace;'>ind</span><span> at which saving should be performed. These two fields are </span><a href = "#H_5904178E"><span>removed</span></a><span> from each output structure upon completion of the TDDFT propagation.</span></div><h4  class = 'S7' id = 'H_28F8C3A4' ><span style=' font-family: monospace;'>outDFT (oDFT)</span></h4><div  class = 'S1'><span>Support for </span><a href = "#H_A211A946"><span>saving the DFT object into individual MATLAB files</span></a><span> during propagation </span><span style=' font-family: monospace;'>[ [] (default) | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>outDFT</span><span> is only relevant during TDDFT time propagation and in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>. It is automatically cleared at the end of the propagation.</span></li></ul><h4  class = 'S7' id = 'H_F65810AA' ><span style=' font-family: monospace;'>outDipole (oDip)</span></h4><div  class = 'S1'><span>Result of dipole-signal calculations during the TDDFT propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>TDDFT propagation that do not compute the dipole signal (</span><a href = "#H_E30347CB"><span style=' font-family: monospace;'>saveDipole</span></a><span style=' font-family: monospace;'> = false</span><span>) leave </span><span style=' font-family: monospace;'>outDipole</span><span> empty. Otherwise</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outDipole.time</span><span> defines the precise times at which the dipole signal is computed</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outDipole.total</span><span> contains the corresponding total dipole signal and, for spin-polarized DFT models, </span><span style=' font-family: monospace;'>outDipole.totalUp</span><span> and </span><span style=' font-family: monospace;'>outDipole.totalDown</span><span> contain the total dipole signal in the up- and down-spin channels respectively, Each successive row contains the dipole signal in the x, y, and z directions, respectively.</span></li><li  class = 'S9'><span>Orbital-resolved dipole signals are stored in </span><span style=' font-family: monospace;'>outDipole.orbital_x</span><span>, </span><span style=' font-family: monospace;'>outDipole.orbital_y</span><span>, </span><span style=' font-family: monospace;'>outDipole.orbital_z</span><span>, </span><span style=' font-family: monospace;'>outDipole.orbitalUp_x</span><span>, </span><span style=' font-family: monospace;'>outDipole.orbitalUp_y</span><span>, </span><span style=' font-family: monospace;'>outDipole.orbitalUp_z</span><span>, </span><span style=' font-family: monospace;'>outDipole.orbitalDown_x</span><span>, </span><span style=' font-family: monospace;'>outDipole.orbitalDown_y</span><span>, and </span><span style=' font-family: monospace;'>outDipole.orbitalDown_z</span><span>. The indexes of the orbitals associated with each of these are included in </span><span style=' font-family: monospace;'>outDipole.indexOrbital</span><span>, </span><span style=' font-family: monospace;'>outDipole.indexOrbitalUp</span><span>, and </span><span style=' font-family: monospace;'>outDipole.indexOrbitalDown</span></li><li  class = 'S9'><span>In </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>, </span><span style=' font-family: monospace;'>outDipole</span><span> also contains a handful of additional fields relevant for run-time calculations. These fields are saved in the MATALB restart file but </span><a href = "#H_5904178E"><span>removed</span></a><span> upon completion of the TDDFT propagation.</span></li></ul><h4  class = 'S7' id = 'H_95407807' ><span style=' font-family: monospace;'>outDipoleVelocity (oVel)</span></h4><div  class = 'S1'><span>Result of dipole-velocity-signal calculations during the TDDFT propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>TDDFT propagation that do not compute the dipole signal (</span><a href = "#H_2978977D"><span style=' font-family: monospace;'>saveDipoleVelocity</span></a><span style=' font-family: monospace;'> = false</span><span>) leave </span><span style=' font-family: monospace;'>outDipoleVelocity</span><span> empty. Otherwise</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outDipole.time</span><span> defines the precise times at which the dipole velocity signal is computed</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outDipoleVelocity.total</span><span> contains the corresponding total dipole velocity signal and, for spin-polarized DFT models, </span><span style=' font-family: monospace;'>outDipoleVelocity.totalUp</span><span> and </span><span style=' font-family: monospace;'>outDipoleVelocity.totalDown</span><span> contain the total dipole velocity signal in the up- and down-spin channels respectively, Each successive row contains the dipole velocity signal in the x, y, and z directions, respectively.</span></li><li  class = 'S9'><span>Orbital-resolved dipole velocity signals are stored in </span><span style=' font-family: monospace;'>outDipoleVelocity.orbital_x</span><span>, </span><span style=' font-family: monospace;'>outDipoleVelocity.orbital_y</span><span>, </span><span style=' font-family: monospace;'>outDipoleVelocity.orbital_z</span><span>, </span><span style=' font-family: monospace;'>outDipoleVelocity.orbitalUp_x</span><span>, </span><span style=' font-family: monospace;'>outDipoleVelocity.orbitalUp_y</span><span>, </span><span style=' font-family: monospace;'>outDipoleVelocity.orbitalUp_z</span><span>, </span><span style=' font-family: monospace;'>outDipoleVelocity.orbitalDown_x</span><span>, </span><span style=' font-family: monospace;'>outDipoleVelocity.orbitalDown_y</span><span>, and </span><span style=' font-family: monospace;'>outDipoleVelocity.orbitalDown_z</span><span>. The indexes of the orbitals associated with each of these are included in </span><span style=' font-family: monospace;'>outDipole.indexOrbital</span><span>, </span><span style=' font-family: monospace;'>outDipole.indexOrbitalUp</span><span>, and </span><span style=' font-family: monospace;'>outDipole.indexOrbitalDown</span></li><li  class = 'S9'><span>In </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>, </span><span style=' font-family: monospace;'>outDipoleVelocity</span><span> also contains a handful of additional fields relevant for run-time calculations. These fields are saved in the MATALB restart file but </span><a href = "#H_5904178E"><span>removed</span></a><span> upon completion of the TDDFT propagation.</span></li></ul><h4  class = 'S7' id = 'H_02629977' ><span style=' font-family: monospace;'>outDipoleAcceleration (oAcc)</span></h4><div  class = 'S1'><span>Result of dipole-acceleration-signal calculations during the TDDFT propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>TDDFT propagation that do not compute the dipole signal (</span><a href = "#H_CB35D0D0"><span style=' font-family: monospace;'>saveDipoleAcceleration</span></a><span style=' font-family: monospace;'> = false</span><span>) leave </span><span style=' font-family: monospace;'>outDipoleAcceleration</span><span> empty. Otherwise</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outDipoleAcceleration.time</span><span> defines the precise times at which the dipole acceleration signal is computed</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outDipoleAcceleration.total</span><span> contains the corresponding total dipole acceleration signal and, for spin-polarized DFT models, </span><span style=' font-family: monospace;'>outDipoleAcceleration.totalUp</span><span> and </span><span style=' font-family: monospace;'>outDipoleAcceleration.totalDown</span><span> contain the total dipole acceleration signal in the up- and down-spin channels respectively, Each successive row contains the dipole acceleration signal in the x, y, and z directions, respectively.</span></li><li  class = 'S9'><span>Orbital-resolved dipole velocity signals are stored in </span><span style=' font-family: monospace;'>outDipoleAcceleration.orbital_x</span><span>, </span><span style=' font-family: monospace;'>outDipoleAcceleration.orbital_y</span><span>, </span><span style=' font-family: monospace;'>outDipoleAcceleration.orbital_z</span><span>, </span><span style=' font-family: monospace;'>outDipoleAcceleration.orbitalUp_x</span><span>, </span><span style=' font-family: monospace;'>outDipoleAcceleration.orbitalUp_y</span><span>, </span><span style=' font-family: monospace;'>outDipoleAcceleration.orbitalUp_z</span><span>, </span><span style=' font-family: monospace;'>outDipoleAcceleration.orbitalDown_x</span><span>, </span><span style=' font-family: monospace;'>outDipoleAcceleration.orbitalDown_y</span><span>, and </span><span style=' font-family: monospace;'>outDipoleAcceleration.orbitalDown_z</span><span>. The indexes of the orbitals associated with each of these are included in </span><span style=' font-family: monospace;'>outDipole.indexOrbital</span><span>, </span><span style=' font-family: monospace;'>outDipole.indexOrbitalUp</span><span>, and </span><span style=' font-family: monospace;'>outDipole.indexOrbitalDown</span></li><li  class = 'S9'><span>In </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>, </span><span style=' font-family: monospace;'>outDipoleAcceleration</span><span> also contains a handful of additional fields relevant for run-time calculations. These fields are saved in the MATALB restart file but </span><a href = "#H_5904178E"><span>removed</span></a><span> upon completion of the TDDFT propagation.</span></li></ul><h4  class = 'S7' id = 'H_B6B04F7C' ><span style=' font-family: monospace;'>outEnergyDFT (oEDFT)</span></h4><div  class = 'S1'><span>Result of the DFT-energy calculations during the TDDFT propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>TDDFT propagation that do track the DFT energy (</span><a href = "#H_CB527D7D"><span style=' font-family: monospace;'>saveEnergyDFT</span></a><span style=' font-family: monospace;'> = false</span><span>) leave </span><span style=' font-family: monospace;'>outEnergyDFT</span><span> empty. Otherwise</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outEnergyDFT.time</span><span> defines the precise times at which the DFT energies are computed</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outEnergyDFT.total</span><span> contains the total DFT energy, which should be constant (within the precision of the propagation scheme)</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outEnergyDFT.kinetic</span><span> contains the kinetic-energy component. For spin-polarized models each the two rows contain the up- and down-spin kinetic energy components, respectively</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outEnergyDFT.external</span><span> contains the external-energy component. For spin-polarized models each the two rows contain the up- and down-spin external energy components, respectively</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outEnergyDFT.Hartree</span><span> contains the Hartree-energy component. </span></li><li  class = 'S9'><span style=' font-family: monospace;'>outEnergyDFT.exchangeCorrelation</span><span> contains the exchange-correlation-energy component. </span></li><li  class = 'S9'><span style=' font-family: monospace;'>outEnergyDFT.externalField</span><span> contains the energy contribution from external fields (if any). For spin-polarized models each the two rows contain the up- and down-spin energy components, respectively</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outEnergyDFT.autonomization</span><span> contains the energy brought in and out of the system by the </span><a href = "#H_2EA3F8EC"><span>external driving field</span></a><span> (if any).</span></li><li  class = 'S9'><span>In </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>, </span><span style=' font-family: monospace;'>outEnergyDFT</span><span> also contains a handful of additional fields relevant for run-time calculations. These fields are saved in the MATALB restart file but </span><a href = "#H_5904178E"><span>removed</span></a><span> upon completion of the TDDFT propagation.</span></li></ul><h4  class = 'S7' id = 'H_71BECE2C' ><span style=' font-family: monospace;'>outEnergyOrbital (oEKSO)</span></h4><div  class = 'S1'><span>Result of the Kohn-Sham-orbital-energy calculations during the TDDFT propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>TDDFT propagation that do track the DFT energy (</span><a href = "#H_6190C681"><span style=' font-family: monospace;'>saveEnergyOrbital</span></a><span style=' font-family: monospace;'> = false</span><span>) leave </span><span style=' font-family: monospace;'>outEnergyDFT</span><span> empty. Otherwise</span></li><li  class = 'S9'><span>For a Kohn-Sham orbital </span><span texencoding="|\phi\rangle" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAAkCAYAAAD2IghRAAAAAXNSR0IArs4c6QAABRFJREFUWEftWG2IVFUYft6zdyd3WMVMRbbVe+/MZTdXiYwi6k/+yPKL9k+aVBZlJqyFIZWV/qoshYikEkKStLDoi0xLQQqDKIXK6Mfqysy957LTggVhWjvtzL3njROzcJtmZ+7MuhOS9+e9557znPd93vd5ziFcpA9dpLhxCXizM3cp4v/LiFuWdRURzSgWi9/mcrl8nCBUpEp3d/fkkZGRNUKItmKxuGdwcHAozmTRMY7jXKaUuh7AJGYmz/O+ABBWmiedTt+klDrMzA9JKd+Ns1ZF4F1dXdOLxeJBALOUUkt83z8ZZ7LoGNM05wohDgEwiWiN67q7x5qjp6enfXh4eI/+nkwm7+vv7/+91noTBty27TsAvA/gZ6XUYt/3T1QDY1nWKiLay8y3SykP/yfAFy5caPi+/xKARwAcYeaVUsqz1cB0dnZe2draepCZvzcMoy+TyYxUGz8hEXccZ0YYhvsB3MjML0gpNwPgakBKm90O4H5mXiqlPNZ04JZl3UBERwBMJqLlrut+Wiv1+vtokQLYZZrmpqNHjwZj/TchEbcsawMRvQzgpFJqme/7Xhzgo0VKRPNbWlqWZjKZbFOAd3R0JJPJ5LQwDF8EcCcRfQxgg1LqnJTyt1p00SBLRfoOgC2e5z0/1j/jjrju10EQLNELEZFO7ecAHgQwE4DewACA9QCu0GNM09xXjQKzZ8/uMAxD1weCIOgdS0PGBby0yE4AtxHRRiHEbqXULcysNeA8My+SUh53HGdeGIYfAbCJaJ3rum9WiT7Ztv00gOeIaL3runr+fz0NA7dtuxvAXgALImB0qrcS0VMAvmlpaenNZDK/1Nsebdu+GsAhZj4VBMGKXC73aznyhoB3dnZOa21t1Ty8lYh2zJkz5zGdfsuyphLRewAWAXjFNM2No7RIpVLbmHkTAL+WGpfot5OIVgO42/M8LWT/eBoBTqlUapPuz+UgTNNcIITQqqf5vcLzvA9KBTeJiF4HcC8zZ4UQS13XPV1DSRcT0SfMfKCSDagbuOM46TAMPwPQVV75qVTqAWZ+o3xD6XR6plJK9/Lr4iqpZVmzABwkoumVMlQ38FQq1cfMr0WLT0eup6cnkc/nXwWwFsD+RCKxemBg4HyZsEyOq6SWZV24iGu7WygU3gLQGy0+DW7UawC4BsDmUg/WnyhSsOeFEIuz2ezX1WhywTlumqYthNApn6s7CjOvk1L+WeLxzSWZR6kNfqnfa2oFQbCfiOZpngshNtQyUBe8q5R57O2u6z45GrlS790K4Idisbg8l8v9pKMdKeTTzNwrpTxVQ/6jfXxMH18Xx6OuT6ui53lPaCEpo9Cutra2h/v7+wumaV4rhDgAQBDRPa7ralWt+kyUckYjeEII0ZvNZgcrnXYiAgUhRF82m/2uFuioV9Ei5rqutrkV7XBdES9xdopS6hlm7gNwTAsQM2vOPwtgmIgeZ+apuoCZeXc+n3/7zJkzf8QB3RR3qJ1ge3t7slAoOES0BcAyAMeJaK1SajCuG4xuqKl+vJHTTqXoR05AqwAs8Tzvx2pZqpsq5ZM1etopn2dUkZn5q6acORs97ZQDLynytjgC9beqVUpH3HsVzfNEIrGLiO5i5n2FQmHt0NDQcJxCjI7RbtMwDO0Az47rXiXuTVZUSZn5USnljnpBl1qg9iUfEtHKuAfrcd3WamMVBMEUvbhhGOe06DQCPJ1Oz1dKXT7uu8NGFm/2P38Bm8ftUqxpU30AAAAASUVORK5CYII=" width="23" height="18" /></span><span>, the orbital energy is defined as </span><span texencoding="\langle\phi|\hat{\mathcal{H}}_{\rm DFT}|\phi\rangle" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="78" height="24.5" /></span><span> with </span><span texencoding="\hat{\mathcal{H}}_{\rm DFT}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="38" height="24.5" /></span><span> the DFT Hamiltonian operator.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outEnergyOrbital.time</span><span> defines the precise times at which the Kohn-Sham-orbital energies are computed</span></li><li  class = 'S9'><span>For spin-restricted models, each row of </span><span style=' font-family: monospace;'>outEnergyOrbital.orbital</span><span> contains the energies of the corresponding Kohn-Sham orbital</span></li><li  class = 'S9'><span>For spin-polarized models, each row of </span><span style=' font-family: monospace;'>outEnergyOrbital.orbitalUp</span><span> and </span><span style=' font-family: monospace;'>outEnergyOrbital.orbitalDown</span><span> contains the energies of the corresponding Kohn-Sham orbital for the up- and down-spin channels, respectively.</span></li><li  class = 'S9'><span>In </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>, </span><span style=' font-family: monospace;'>outEnergyOrbital</span><span> also contains a handful of additional fields relevant for run-time calculations. These fields are saved in the MATALB restart file but </span><a href = "#H_5904178E"><span>removed</span></a><span> upon completion of the TDDFT propagation.</span></li></ul><h4  class = 'S7' id = 'H_E1C662FA' ><span style=' font-family: monospace;'>outIonization (oIon)</span></h4><div  class = 'S1'><span>Result of the ionization calculations during the TDDFT propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>TDDFT propagation that do track ionization (</span><a href = "#H_6B566C83"><span style=' font-family: monospace;'>saveIonization</span></a><span style=' font-family: monospace;'> = false</span><span>) leave </span><span style=' font-family: monospace;'>outIonization</span><span> empty. Otherwise</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outIonization.time</span><span> defines the precise times at which the ionization is computed</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outIonization.total</span><span> contains the total ionization</span></li><li  class = 'S9'><span>For spin-polarized models, </span><span style=' font-family: monospace;'>outIonization.totalUp</span><span> and </span><span style=' font-family: monospace;'>outIonization.totalDown</span><span> contain the total ionization for the up- and down-spin channels, respectively.</span></li><li  class = 'S9'><span>Orbital-resolved ionization signals are stored in </span><span style=' font-family: monospace;'>outIonization.orbital</span><span>, </span><span style=' font-family: monospace;'>outIonization.orbitalUp</span><span>, and </span><span style=' font-family: monospace;'>outIonization.orbitalDown</span><span>. The indexes of the orbitals associated with each of these are included in </span><span style=' font-family: monospace;'>outIonization.indexOrbital</span><span>, </span><span style=' font-family: monospace;'>outIonization.indexOrbitalUp</span><span>, and </span><span style=' font-family: monospace;'>outIonization.indexOrbitalDown</span></li><li  class = 'S9'><span>In </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>, </span><span style=' font-family: monospace;'>outIonization</span><span> also contains a handful of additional fields relevant for run-time calculations. These fields are saved in the MATALB restart file but </span><a href = "#H_5904178E"><span>removed</span></a><span> upon completion of the TDDFT propagation.</span></li></ul><h4  class = 'S7' id = 'H_D6D335DD' ><span style=' font-family: monospace;'>outDensity (oRho)</span></h4><div  class = 'S1'><span>One-body densities during the TDDFT propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>TDDFT propagation that do not save the one-body density (</span><a href = "#H_B3D550CC"><span style=' font-family: monospace;'>saveDensity</span></a><span style=' font-family: monospace;'> = false</span><span>) leave </span><span style=' font-family: monospace;'>outDensity</span><span> empty. Otherwise</span></li><li  class = 'S9'><span>The specific shape of the saved one-body densities is implementation dependent -- see the corresponding documentation for details. At minimum, each implementation defines</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outDensity.time</span><span> defines the precise times at which the one-body density is saved</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outDensity.total</span><span> contains the corresponding one-body densities and, for spin-polarized DFT models, </span><span style=' font-family: monospace;'>outDensity.totalUp</span><span> and </span><span style=' font-family: monospace;'>outDensity.totalDown</span><span> contain the one-body densities in the up- and down-spin channels respectively.</span></li><li  class = 'S9'><span>In </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>, </span><span style=' font-family: monospace;'>outDensity</span><span> also contains a handful of additional fields relevant for run-time calculations. These fields are saved in the MATALB restart file but </span><a href = "#H_5904178E"><span>removed</span></a><span> upon completion of the TDDFT propagation.</span></li></ul><h4  class = 'S7' id = 'H_371940E8' ><span style=' font-family: monospace;'>outOrbital (oKSO)</span></h4><div  class = 'S1'><span>Kohn-Sham orbitals during the TDDFT propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>TDDFT propagation that do not save the Kohn-Sham orbitals (</span><a href = "#H_2A78E237"><span style=' font-family: monospace;'>saveOrbital</span></a><span style=' font-family: monospace;'> = false</span><span>) leave </span><span style=' font-family: monospace;'>outOrbital</span><span> empty. Otherwise</span></li><li  class = 'S9'><span>The specific shape of the saved Kohn-Sham orbitals is implementation dependent -- see the corresponding documentation for details. At minimum, each implementation defines</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outOrbital.time</span><span> defines the precise times at which the one-body density is saved</span></li><li  class = 'S9'><span>For spin-restricted models, </span><span style=' font-family: monospace;'>outOrbital.orbital</span><span> contains the saved Kohn-Sham orbitals and </span><span style=' font-family: monospace;'>outOrbital.indexOrbital</span><span> the corresponding orbital indexes</span></li><li  class = 'S9'><span>For spin-polarized models, </span><span style=' font-family: monospace;'>outOrbital.orbitalUp</span><span> and </span><span style=' font-family: monospace;'>outOrbital.orbitalDown</span><span> contains the saved Kohn-Sham orbitals for the up- and down-spin channels, respectively, and </span><span style=' font-family: monospace;'>outOrbital.indexOrbitalUp</span><span> and </span><span style=' font-family: monospace;'>outOrbital.indexOrbitalDown</span><span> the corresponding orbital indexes</span></li><li  class = 'S9'><span>In </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>, </span><span style=' font-family: monospace;'>outOrbital</span><span> also contains a handful of additional fields relevant for run-time calculations. These fields are saved in the MATALB restart file but </span><a href = "#H_5904178E"><span>removed</span></a><span> upon completion of the TDDFT propagation.</span></li></ul><h4  class = 'S7' id = 'H_5096ABA5' ><span style=' font-family: monospace;'>outOrbitalProjection (oKSOP)</span></h4><div  class = 'S1'><span>Projection of the Kohn-Sham orbitals during the TDDFT propagation </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>TDDFT propagation that do not save the projection of the Kohn-Sham orbitals (</span><a href = "#H_0A85DA1C"><span style=' font-family: monospace;'>saveOrbitalProjection</span></a><span style=' font-family: monospace;'> = false</span><span>) leave </span><span style=' font-family: monospace;'>outOrbitalProjection</span><span> empty. Otherwise</span></li><li  class = 'S9'><span>The specific shape of the saved Kohn-Sham orbitals' projection is implementation dependent -- see the corresponding documentation for details. At minimum, each implementation defines</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outOrbitalProjection.time</span><span> defines the precise times at which the one-body density is saved</span></li><li  class = 'S9'><span>For spin-restricted models, </span><span style=' font-family: monospace;'>outOrbitalProjection.orbital</span><span> contains the saved Kohn-Sham orbitals' projection and </span><span style=' font-family: monospace;'>outOrbitalProjection.indexOrbital</span><span> the corresponding orbital indexes</span></li><li  class = 'S9'><span>For spin-polarized models, </span><span style=' font-family: monospace;'>outOrbitalProjection.orbitalUp</span><span> and </span><span style=' font-family: monospace;'>outOrbitalProjection.orbitalDown</span><span> contains the saved Kohn-Sham orbitals' projection for the up- and down-spin channels, respectively, and </span><span style=' font-family: monospace;'>outOrbitalProjection.indexOrbitalUp</span><span> and </span><span style=' font-family: monospace;'>outOrbitalProjection.indexOrbitalDown</span><span> the corresponding orbital indexes</span></li><li  class = 'S9'><span>The structure also retains a copy of the projection basis</span></li><li  class = 'S9'><span>In </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>, </span><span style=' font-family: monospace;'>outOrbitalProjection</span><span> also contains a handful of additional fields relevant for run-time calculations. These fields are saved in the MATALB restart file but </span><a href = "#H_5904178E"><span>removed</span></a><span> upon completion of the TDDFT propagation.</span></li></ul><h4  class = 'S7' id = 'H_9F79DF61' ><span style=' font-family: monospace;'>outOutputFunctionDensity (oFRho)</span></h4><div  class = 'S1'><span>Result of the installable output function of the one-body density </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>TDDFT propagation that do not define an installabe output function of the density (</span><a href = "#H_D1715482"><span style=' font-family: monospace;'>saveOutputFunctionDensity</span></a><span style=' font-family: monospace;'> = []</span><span>) leave </span><span style=' font-family: monospace;'>outOutputFunctionDensity</span><span> empty. Otherwise</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outOutputFunctionDensity.time</span><span> defines the precise times at which the result of the output function is saved</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outOutputFunctionDensity.result</span><span> contains the results of the output functions. If the installable function returns a scalar or a column vector, </span><span style=' font-family: monospace;'>outOutputFunctionDensity.result</span><span> is a </span><span style=' font-family: monospace;'>N-by-numel(outOutputFunctionDensity.time)</span><span> matrix with </span><span style=' font-family: monospace;'>N</span><span> the numer of elements in the output. Otherwise, </span><span style=' font-family: monospace;'>outOutputFunctionDensity.result</span><span> is an </span><span style=' font-family: monospace;'>M-by-numel(outOutputFunctionDensity.time)</span><span> array with </span><span style=' font-family: monospace;'>M</span><span> the size of the output.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outOutputFunctionDensity.shape</span><span> contains the shape of the output function (</span><span style=' font-family: monospace;'>N</span><span> or </span><span style=' font-family: monospace;'>M</span><span>, as defined in the previous bullet point).</span></li></ul><h4  class = 'S7' id = 'H_25C1C7F6' ><span style=' font-family: monospace;'>outOutputFunctionOrbital (oFKSO)</span></h4><div  class = 'S1'><span>Result of the installable output function of the Kohn-Sham orbitals </span><span style=' font-family: monospace;'>[ [] | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>TDDFT propagation that do not define an installabe output function of the orbitals (</span><a href = "#H_13D0EA88"><span style=' font-family: monospace;'>saveOutputFunctionOrbital</span></a><span style=' font-family: monospace;'> = []</span><span>) leave </span><span style=' font-family: monospace;'>outOutputFunctionOrbital</span><span> empty. Otherwise</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outOutputFunctionOrbital.time</span><span> defines the precise times at which the result of the output function is saved</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outOutputFunctionOrbital.result</span><span> contains the results of the output functions. If the installable function returns a scalar or a column vector, </span><span style=' font-family: monospace;'>outOutputFunctionOrbital.result</span><span> is a </span><span style=' font-family: monospace;'>N-by-numel(outOutputFunctionOrbital.time)</span><span> matrix with </span><span style=' font-family: monospace;'>N</span><span> the numer of elements in the output. Otherwise, </span><span style=' font-family: monospace;'>outOutputFunctionOrbital.result</span><span> is an </span><span style=' font-family: monospace;'>M-by-numel(outOutputFunctionOrbital.time)</span><span> array with </span><span style=' font-family: monospace;'>M</span><span> the size of the output.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>outOutputFunctionOrbital.shape</span><span> contains the shape of the output function (</span><span style=' font-family: monospace;'>N</span><span> or </span><span style=' font-family: monospace;'>M</span><span>, as defined in the previous bullet point).</span></li></ul><h4  class = 'S7' id = 'H_B2980914' ><span style=' font-family: monospace;'>outRestart (oRest)</span></h4><div  class = 'S1'><span>Support for enabling </span><a href = "#H_5CD2979A"><span>restart of the TDDFT propagation</span></a><span> </span><span style=' font-family: monospace;'>[ [] (default) | structure ]</span></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>outRestart</span><span> is only relevant during TDDFT time propagation and in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>. It is automatically cleared at the end of the propagation.</span></li></ul><h3  class = 'S6' id = 'H_C8F30381' ><span>Other hidden class properties</span></h3><div  class = 'S1'><span style=' font-family: monospace;'>QMol_TDDFT</span><span> defines a handful of additional hidden properties used for the time propagation. These properties cannot be edited with the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method, nor by any function outisde of the object (</span><span style=' font-family: monospace;'>SetAccess=protected</span><span> attribute).</span></div><h4  class = 'S7' id = 'H_37454CF9' ><span style=' font-family: monospace;'>DFT</span></h4><div  class = 'S1'><span>DFT-model object </span><span style=' font-family: monospace;'>[ [] (default) | </span><a href = "./QMol_DFT_spinPol.html"><span style=' font-family: monospace;'>QMol_DFT_spinPol</span></a><span style=' font-family: monospace;'> handle object | </span><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span style=' font-family: monospace;'> handle object ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>This is a copy of the </span><a href = "./DFT.html"><span>DFT-model</span></a><span> handle object passed to </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>. </span></li></ul><h4  class = 'S7' id = 'H_110A8982' ><span style=' font-family: monospace;'>tspan</span></h4><div  class = 'S1'><span>Propagation time vector </span><span style=' font-family: monospace;'>[ [] (default) | vector ]</span><span> </span></div><ul  class = 'S8'><li  class = 'S9'><span>After the class is </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d, it is defined as </span><span style=' font-family: monospace;'>uniquetol([obj.</span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>T</span></a><span style=' font-family: monospace;'>(1):obj.</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>dt</span></a><span style=' font-family: monospace;'>:obj.</span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>T</span></a><span style=' font-family: monospace;'>(end), obj.</span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>T</span></a><span style=' font-family: monospace;'>(end)],1e-10,'DataScale',1)</span></li></ul><h4  class = 'S7' id = 'H_8882E7D7' ><span style=' font-family: monospace;'>iref</span></h4><div  class = 'S1'><span>Indexes of </span><a href = "#H_110A8982"><span style=' font-family: monospace;'>tspan</span></a><span> matching the input time vector </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>T</span></a><span> </span><span style=' font-family: monospace;'>[ [] (default) | index vector ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>After the class is </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d, it is defined as </span><a href = "#H_63C6DA3F"><span style=' font-family: monospace;'>getOutputIndex</span></a><span style=' font-family: monospace;'>(</span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>T</span></a><span style=' font-family: monospace;'>)</span></li></ul><h4  class = 'S7' id = 'H_4F8B0111' ><span style=' font-family: monospace;'>restart</span></h4><div  class = 'S1'><span>Restart structure </span><span style=' font-family: monospace;'>[ [] (default) | restart ]</span></div><ul  class = 'S8'><li  class = 'S9'><span>Collect all the variables and information required for the </span><a href = "#H_5CD2979A"><span>restart mode</span></a></li><li  class = 'S9'><span style=' font-family: monospace;'>QMol_TDDFT</span><span> uses the following fields (therefore not available for implementation-specific TDDFT propagators overloading the class): </span><span style=' font-family: monospace;'>kstart</span><span>, </span><span style=' font-family: monospace;'>ndisp</span><span>, and </span><span style=' font-family: monospace;'>idp</span></li></ul><h2  class = 'S2' id = 'H_444F9B6D' ><span>Class methods</span></h2><h3  class = 'S6' id = 'H_A7EA7D3E' ><span>Creation</span></h3><h4  class = 'S7' id = 'H_0783E8B1' ><span>constructor</span></h4><div  class = 'S1'><span>Create a TDDFT-model object with empty class properties.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj = QMol_TDDFT;</span></span></div></div></div><div  class = 'S11'><span>Create a TDDFT-model object with the </span><span style=' font-family: monospace;'>name</span><span> properties set to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the TDDFT </span><a href = "#H_24F205D3"><span>class properties</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >obj = QMol_TDDFT(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span >obj = QMol_TDDFT(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><h3  class = 'S6' id = 'H_87F4F901' ><span>Changing class properties</span></h3><h4  class = 'S7' id = 'H_4405B79D' ><span style=' font-family: monospace;'>set</span></h4><div  class = 'S1'><span>Update the </span><span style=' font-family: monospace;'>name</span><span> properties of a TDDFT-model object to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the TDDFT </span><a href = "#H_24F205D3"><span>class properties</span></a><span> and is case insensitive. In restart mode, </span><a href = "#H_D533B953"><span>output results</span></a><span> structures can also be edited with </span><span style=' font-family: monospace;'>set</span><span>. </span><span style=' font-family: monospace;'>QMol_TDDFT</span><span> does not check the integrity of its input/output component during a restart and this feature should only be considered by advanced users.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >obj.set(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span >obj.set(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S11'><span>This is the common name-value pair assignment method used throughout the QMol-grid package.</span></div><h4  class = 'S7' id = 'H_C729A888' ><span style=' font-family: monospace;'>clear</span></h4><div  class = 'S1'><span>Clear all class properties</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.clear;</span></span></div></div></div><div  class = 'S11'><span>Clear a specific set of the class properties. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the TDDFT </span><a href = "#H_24F205D3"><span>class properties</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.clear(name1,name2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S11'><span>This is the common </span><span style=' font-family: monospace;'>clear</span><span> method available to all classes throughout the QMol-grid package. The </span><span style=' font-family: monospace;'>clear</span><span> method can be used to delete specific properties before saving an instance of the </span><span style=' font-family: monospace;'>QMol_TDDFT</span><span> class.</span></div><h3  class = 'S6' id = 'H_686ACD09' ><span>Initializing the object</span></h3><div  class = 'S1'><span style=' font-family: monospace;'>QMol_TDDFT</span><span> defines a main </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span> interface (with public access attribute) and a suite of individual initaialization properties (with protected access attributes) for each of the </span><a href = "#H_D533B953"><span>output results</span></a><span>.</span></div><h4  class = 'S7' id = 'H_85EFED0A' ><span style=' font-family: monospace;'>initialize</span></h4><div  class = 'S1'><span>Initialize a TDDFT-model object without allocating the </span><a href = "#H_D533B953"><span>output-result</span></a><span> structures</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.initialize(DFT);</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>DFT</span><span> is the </span><a href = "./DFT.html"><span>DFT-model</span></a><span> handle object, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "./QMol_DFT_spinPol.html"><span style=' font-family: monospace;'>QMol_DFT_spinPol</span></a><span style=' font-family: monospace;'> </span><span>or </span><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span>, that describes the DFT systems to propagate.</span></li><li  class = 'S9'><span style=' text-decoration: underline;'>For developers:</span><span> </span><span style=' font-family: monospace;'>initialize</span><span> also has a specific interface when called from the </span><a href = "#H_5CD9DA16"><span style=' font-family: monospace;'>propagate</span></a><span> method that initializes the </span><a href = "#H_8CAFC83D"><span>absorbing boundaries</span></a><span> (if any) and determines whether the </span><a href = "#H_D533B953"><span>output-result</span></a><span> structures should be initialized too. Overloading classes should avoid redefining </span><span style=' font-family: monospace;'>initialize</span><span>; If the overloading class needs to perform some initialization (at the beginning of a TDDFT propagation or upon restart), overload the </span><a href = "#H_3FFF1372"><span style=' font-family: monospace;'>initializeChildren</span></a><span> method instead.</span></li></ul><h4  class = 'S7' id = 'H_3FFF1372' ><span style=' font-family: monospace;'>initializeChildren</span></h4><div  class = 'S1'><span>Initialize implementation-specific part of overloading class at the beginning of a TDDFT propagation (from scratch)</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.initializeChildren(false);</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>QMol_TDDFT</span><span> calls the </span><span style=' font-family: monospace;'>initializeChildren</span><span> method </span><span style=' text-decoration: underline;'>after</span><span> having initialized all its member properties (including the DFT object being propagated).</span></li><li  class = 'S9'><span>This should </span><span style=' text-decoration: underline;'>not</span><span> initialize implementation-specific additional output, which are initialized with </span><a href = "#H_D3F27113"><span style=' font-family: monospace;'>setOutputChildren</span></a></li></ul><div  class = 'S1'><span>Initialize implementation-specific part of overloading class in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.initializeChildren(true);</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>QMol_TDDFT</span><span> calls the </span><span style=' font-family: monospace;'>initializeChildren</span><span> method </span><span style=' text-decoration: underline;'>after</span><span> having reinitialized all its member properties (including the DFT object being propagated).</span></li><li  class = 'S9'><span>Note that the </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span> does not call </span><a href = "#H_8328AE09"><span style=' font-family: monospace;'>setTimeStep</span></a><span> during the initialization. All relevant time step information should be stored with the class of in the </span><a href = "#H_4F8B0111"><span style=' font-family: monospace;'>restart</span></a><span> structure and </span><span style=' font-family: monospace;'>initializeChildren</span><span> should bring them back to a working configuration.</span></li></ul><h4  class = 'S7' id = 'H_63C6DA3F' ><span style=' font-family: monospace;'>getOutputIndex</span></h4><div  class = 'S1'><span>Get the time-propagation index for when to save a given result.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >ind = obj.getOutputIndex(t);</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>Vector </span><span style=' font-family: monospace;'>t = [t_1, t_2, ___ ]</span><span>  returns the indexes of the iteration time steps closest to the listed times </span><span style=' font-family: monospace;'>t_1</span><span>, </span><span style=' font-family: monospace;'>t_2</span><span>, ... </span></li><li  class = 'S9'><span>Scalar </span><span style=' font-family: monospace;'>t</span><span> &gt; 0 returns the indexes of the iteration time steps closest to the time sampling </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)</span><span>, </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)+t</span><span>, </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)+2*t</span><span>, ... for forward time propagations and </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)</span><span>, </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)-t</span><span>, </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)-2*t</span><span>, ... for backward ones</span></li><li  class = 'S9'><span>Integer </span><span style=' font-family: monospace;'>t</span><span> &lt; 0 returns the indexes of the iteration time steps of </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)</span><span>, </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)-</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>*t</span><span>, </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)-2*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>*t</span><span>, ... for forward time propagations and </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)</span><span>, </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)+</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>*t</span><span>, </span><a href = "#H_3B6C8431"><span style=' font-family: monospace;'>time</span></a><span style=' font-family: monospace;'>(1)+2*</span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span style=' font-family: monospace;'>*t</span><span>, ... for backward ones</span></li></ul><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >ind = obj.getOutputIndex(</span><span style="color: #a709f5;">'all'</span><span >);</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>Returns the indexes associated with all the iteration time steps</span></li></ul><h4  class = 'S7' id = 'H_D3F27113' ><span style=' font-family: monospace;'>setOutputChildren</span></h4><div  class = 'S1'><span>Initialize additional output results defined in an specific implementation of the TDDFT propagator (the children class should then </span><a href = "#H_675447D6"><span>overload this method</span></a><span>)</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputChildren(</span><span style="color: #a709f5;">'init'</span><span >);</span></span></div></div></div><div  class = 'S11'><span>Cleanup the additional output results defined in an specific implementation of the TDDFT propagator at the end of the computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputChildren(</span><span style="color: #a709f5;">'clean'</span><span >);</span></span></div></div></div><div  class = 'S11'><span style=' font-family: monospace;'>setOutputChildren</span><span> should not be called in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span> (all relevant parameters should be saved with the QMol_TDDFT object in the restart MATLAB file).</span></div><h4  class = 'S7' id = 'H_12E03134' ><span style=' font-family: monospace;'>setOutputDFT</span></h4><div  class = 'S1'><span>Initialize the </span><a href = "#H_28F8C3A4"><span style=' font-family: monospace;'>outDFT</span></a><span> structure before running a TDDFT computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputDFT(</span><span style="color: #a709f5;">'init'</span><span >);</span></span></div></div></div><div  class = 'S11'><span>Cleanup the </span><a href = "#H_28F8C3A4"><span style=' font-family: monospace;'>outDFT</span></a><span> structure at the end of the TDDFT computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputDFT(</span><span style="color: #a709f5;">'clean'</span><span >);</span></span></div></div></div><div  class = 'S11'><span style=' font-family: monospace;'>setOutputDFT</span><span> should not be called in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span> (all relevant parameters should be saved with the QMol_TDDFT object in the restart MATLAB file).</span></div><h4  class = 'S7' id = 'H_5D387730' ><span style=' font-family: monospace;'>setOutputDipole</span></h4><div  class = 'S1'><span>Initialize the </span><a href = "#H_F65810AA"><span style=' font-family: monospace;'>outDipole</span></a><span>, </span><a href = "#H_95407807"><span style=' font-family: monospace;'>outDipoleVelocity</span></a><span>, and </span><a href = "#H_02629977"><span style=' font-family: monospace;'>outDipoleAcceleration</span></a><span>  structures before running a TDDFT computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputDipole(</span><span style="color: #a709f5;">'init'</span><span >);</span></span></div></div></div><div  class = 'S11'><span>Cleanup the </span><a href = "#H_F65810AA"><span style=' font-family: monospace;'>outDipole</span></a><span>, </span><a href = "#H_95407807"><span style=' font-family: monospace;'>outDipoleVelocity</span></a><span>, and </span><a href = "#H_02629977"><span style=' font-family: monospace;'>outDipoleAcceleration</span></a><span> structures at the end of the TDDFT computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputDipole(</span><span style="color: #a709f5;">'clean'</span><span >);</span></span></div></div></div><div  class = 'S11'><span style=' font-family: monospace;'>setOutputDipole</span><span> should not be called in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span> (all relevant parameters should be saved with the QMol_TDDFT object in the restart MATLAB file).</span></div><h4  class = 'S7' id = 'H_C32F9472' ><span style=' font-family: monospace;'>setOutputEnergy</span></h4><div  class = 'S1'><span>Initialize the </span><a href = "#H_B6B04F7C"><span style=' font-family: monospace;'>outEnergyDFT</span></a><span> and </span><a href = "#H_02629977"><span style=' font-family: monospace;'>outEnergyOrbital</span></a><span>  structures before running a TDDFT computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputEnergy(</span><span style="color: #a709f5;">'init'</span><span >);</span></span></div></div></div><div  class = 'S11'><span>Cleanup the </span><a href = "#H_B6B04F7C"><span style=' font-family: monospace;'>outEnergyDFT</span></a><span> and </span><a href = "#H_02629977"><span style=' font-family: monospace;'>outEnergyOrbital</span></a><span> structures at the end of the TDDFT computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputEnergy(</span><span style="color: #a709f5;">'clean'</span><span >);</span></span></div></div></div><div  class = 'S11'><span style=' font-family: monospace;'>setOutputEnergy</span><span> should not be called in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span> (all relevant parameters should be saved with the QMol_TDDFT object in the restart MATLAB file).</span></div><h4  class = 'S7' id = 'H_C219079B' ><span style=' font-family: monospace;'>setOutputFunction</span></h4><div  class = 'S1'><span>Initialize the </span><a href = "#H_25C1C7F6"><span style=' font-family: monospace;'>outOutputFunctionDensity</span></a><span> and </span><a href = "#H_25C1C7F6"><span style=' font-family: monospace;'>outOutputFunctionOrbital</span></a><span> structures before running a TDDFT computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputFunction(</span><span style="color: #a709f5;">'init'</span><span >);</span></span></div></div></div><div  class = 'S11'><span>Cleanup the </span><a href = "#H_25C1C7F6"><span style=' font-family: monospace;'>outOutputFunctionDensity</span></a><span> and </span><a href = "#H_25C1C7F6"><span style=' font-family: monospace;'>outOutputFunctionOrbital</span></a><span> structures at the end of the TDDFT computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputFunction(</span><span style="color: #a709f5;">'clean'</span><span >);</span></span></div></div></div><div  class = 'S11'><span style=' font-family: monospace;'>setOutputFunction</span><span> should not be called in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span> (all relevant parameters should be saved with the QMol_TDDFT object in the restart MATLAB file).</span></div><h4  class = 'S7' id = 'H_EA0844B5' ><span style=' font-family: monospace;'>setOutputIonization</span></h4><div  class = 'S1'><span>Initialize the </span><a href = "#H_E1C662FA"><span style=' font-family: monospace;'>outIonization</span></a><span> structure before running a TDDFT computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputIonization(</span><span style="color: #a709f5;">'init'</span><span >);</span></span></div></div></div><div  class = 'S11'><span>Cleanup the </span><a href = "#H_E1C662FA"><span style=' font-family: monospace;'>outIonization</span></a><span> structure at the end of the TDDFT computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputIonization(</span><span style="color: #a709f5;">'clean'</span><span >);</span></span></div></div></div><div  class = 'S11'><span style=' font-family: monospace;'>setOutputIonization</span><span> should not be called in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span> (all relevant parameters should be saved with the QMol_TDDFT object in the restart MATLAB file).</span></div><h4  class = 'S7' id = 'H_D7894DE5' ><span style=' font-family: monospace;'>setOutputOrbitalDensity</span></h4><div  class = 'S1'><span>Initialize the </span><a href = "#H_D6D335DD"><span style=' font-family: monospace;'>outDensity</span></a><span>, </span><a href = "#H_371940E8"><span style=' font-family: monospace;'>outOrbital</span></a><span>, and </span><a href = "#H_5096ABA5"><span style=' font-family: monospace;'>outOrbitalProjection</span></a><span> structures before running a TDDFT computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputOrbitalDensity(</span><span style="color: #a709f5;">'init'</span><span >);</span></span></div></div></div><div  class = 'S11'><span>Cleanup the </span><a href = "#H_D6D335DD"><span style=' font-family: monospace;'>outDensity</span></a><span>, </span><a href = "#H_371940E8"><span style=' font-family: monospace;'>outOrbital</span></a><span>, and </span><a href = "#H_5096ABA5"><span style=' font-family: monospace;'>outOrbitalProjection</span></a><span> structures at the end of the TDDFT computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputOrbitalDensity(</span><span style="color: #a709f5;">'clean'</span><span >);</span></span></div></div></div><div  class = 'S11'><span style=' font-family: monospace;'>setOutputOrbitalDensity</span><span> should not be called in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span> (all relevant parameters should be saved with the QMol_TDDFT object in the restart MATLAB file).</span></div><div  class = 'S1'><span style=' font-family: monospace;'>setOutputOrbitalDensity</span><span> is implementation dependent and must be defined by each overloading TDDFT propagation classes -- see the </span><a href = "#H_CBF28755"><span>required signature and behavior</span></a><span> below.</span></div><h4  class = 'S7' id = 'H_C640DA93' ><span style=' font-family: monospace;'>setOutputRestart</span></h4><div  class = 'S1'><span>Initialize the </span><a href = "#H_B2980914"><span style=' font-family: monospace;'>outRestart</span></a><span> structure before running a TDDFT computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputRestart(</span><span style="color: #a709f5;">'init'</span><span >);</span></span></div></div></div><div  class = 'S11'><span>Cleanup the </span><a href = "#H_B2980914"><span style=' font-family: monospace;'>outRestart</span></a><span> structure and delete the restart file at the end of the TDDFT computation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.setOutputRestart(</span><span style="color: #a709f5;">'clean'</span><span >);</span></span></div></div></div><div  class = 'S11'><span style=' font-family: monospace;'>setOutputRestart</span><span> should not be called in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span> (all relevant parameters should be saved with the QMol_TDDFT object in the restart MATLAB file).</span></div><h4  class = 'S7' id = 'H_5904178E' ><span style=' font-family: monospace;'>finalize</span></h4><div  class = 'S1'><span>At the end of a TDDFT propagation, performs the appropriate finalization, including cleanup of the output structures.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.finalize;</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>This calls the </span><span style=' font-family: monospace;'>'clean'</span><span> mode for </span><a href = "#H_D3F27113"><span style=' font-family: monospace;'>setOutputChildren</span></a><span>, </span><a href = "#H_12E03134"><span style=' font-family: monospace;'>setOutputDFT</span></a><span>, </span><a href = "#H_5D387730"><span style=' font-family: monospace;'>setOutputDipole</span></a><span>, </span><a href = "#H_C32F9472"><span style=' font-family: monospace;'>setOutputEnergy</span></a><span>, </span><a href = "#H_EA0844B5"><span style=' font-family: monospace;'>setOutputIonization</span></a><span>, </span><a href = "#H_D7894DE5"><span style=' font-family: monospace;'>setOutputOrbitalDensity</span></a><span>, </span><a href = "#H_C219079B"><span style=' font-family: monospace;'>setOutputFunction</span></a><span>, and </span><a href = "#H_C640DA93"><span style=' font-family: monospace;'>setOutputRestart</span></a><span>.</span></li></ul><h3  class = 'S6' id = 'H_B2D31FE3' ><span>Run-time documentation</span></h3><h4  class = 'S7' id = 'H_E3988947' ><span style=' font-family: monospace;'>getMemoryProfile</span></h4><div  class = 'S1'><span>Get an estimate of the memory help by a </span><span style=' font-family: monospace;'>QMol_TDDFT</span><span> object with either</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >mem = obj.getMemoryProfile;</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span >mem = obj.getMemoryProfile(false);</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>The object must be </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d for the memory footprint evaluation. If not arleady, </span><span style=' font-family: monospace;'>getMemoryProfile</span><span> initializes the </span><a href = "#H_37454CF9"><span style=' font-family: monospace;'>DFT</span></a><span> model object.</span></li><li  class = 'S9'><span>The estimate includes (1) </span><a href = "#H_37454CF9"><span style=' font-family: monospace;'>DFT</span></a><span> model, (2) TDDFT propagator, and (3) </span><a href = "#H_D533B953"><span>output results</span></a><span>. Note that all these components may not be used in actual simulations and the memory estimate tries to be conservative. On the other hand, it only includes the discretization of member components on the domain grid and ignores other (small) properties.</span></li><li  class = 'S9'><span>The output </span><span style=' font-family: monospace;'>mem</span><span> is the estimated size in bytes.</span></li></ul><div  class = 'S1'><span>Additionally display the detail of the memory footprint with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >mem = obj.getMemoryProfile(true);</span></span></div></div></div><h4  class = 'S7' id = 'H_ABD08C91' ><span style=' font-family: monospace;'>showDocumentation</span></h4><div  class = 'S1'><span>Display the run-time documentation for the specific configuration of a </span><span style=' font-family: monospace;'>QMol_TDDFT</span><span> object, wich must have been </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d beforehand</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.showDocumentation;</span></span></div></div></div><div  class = 'S11'><span>The run-time documentation performs the following steps</span></div><ul  class = 'S8'><li  class = 'S9'><span>Display the QMol-grid package header (showing the kernel, external component versions)</span></li><li  class = 'S9'><span>Call the TDDFT-propagator implementation-specific run-time documentation with the propety </span><a href = "#H_9AAF0342"><span style=' font-family: monospace;'>showDoc</span></a><span>.</span></li><li  class = 'S9'><span>Display the time-propagation information</span></li><li  class = 'S9'><span>Display the list of output calculated and saved during the TDDFT propagation</span></li><li  class = 'S9'><span>Display the bibliography associated with the list of cited references (from the previous steps)</span></li><li  class = 'S9'><span>Display the funding information</span></li><li  class = 'S9'><span>Display the QMol-grid package footer</span></li></ul><h3  class = 'S6' id = 'H_AEFB66DB' ><span>TDDFT propagation</span></h3><h4  class = 'S7' id = 'H_5CD9DA16' ><span style=' font-family: monospace;'>propagate</span></h4><div  class = 'S1'><span>Propagate the TDDFT dynamics starting from a DFT model object (from scratch)</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.propagate(DFT);</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>DFT</span><span> is the </span><a href = "./DFT.html"><span>DFT-model</span></a><span> handle object, </span><span style=' font-style: italic;'>i.e.</span><span>, </span><a href = "./QMol_DFT_spinPol.html"><span style=' font-family: monospace;'>QMol_DFT_spinPol</span></a><span style=' font-family: monospace;'> </span><span>or </span><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span>, that describes the DFT systems to propagate.</span></li></ul><div  class = 'S1'><span>Restart a TDDFT propagation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.propagate(</span><span style="color: #a709f5;">'restart'</span><span >);</span></span></div></div></div><h4  class = 'S7' id = 'H_DC96BD5E' ><span style=' font-family: monospace;'>saveOutputDFT</span></h4><div  class = 'S1'><span>Trigger the saving of the </span><a href = "#H_37454CF9"><span>DFT</span></a><span> object into a separate MATLAB file</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.saveOutputDFT(obj,t);</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>t</span><span> is the current time when the saving is performed</span></li><li  class = 'S9'><span>Each output file contains </span><span style=' font-family: monospace;'>DFT</span><span> (DFT-model object), </span><span style=' font-family: monospace;'>t</span><span> (current time), and </span><span style=' font-family: monospace;'>externalField</span><span> (</span><a href = "#H_2EA3F8EC"><span>external field</span></a><span> object)</span></li><li  class = 'S9'><span>For developers: </span><span style=' font-family: monospace;'>saveOutputDFT</span><span> is also responsible for updating the counter </span><span style=' font-family: monospace;'>obj.oDFT.n</span><span> when it is called</span></li></ul><h4  class = 'S7' id = 'H_9ED0647B' ><span style=' font-family: monospace;'>setOutputEnergy</span></h4><div  class = 'S1'><span>Trigger the saving of the DFT and Kohn-Sham orbital energies</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.saveOutputEnergy(k,t);</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>k</span><span> is the current time-propagation step index</span></li><li  class = 'S9'><span style=' font-family: monospace;'>t</span><span> is the current time when the saving is performed</span></li><li  class = 'S9'><span>If requested, the DFT energy calls </span><a href = "#H_FDA44F8F"><span>getExternalFieldEnergy</span></a><span> to get the contribution from any external field and autonomization variable</span></li></ul><h4  class = 'S7' id = 'H_1C92546A' ><span style=' font-family: monospace;'>saveOutputFunction</span></h4><div  class = 'S1'><span>Trigger the computation and saving of the installable </span><a href = "#H_236395D1"><span>output functions</span></a></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.saveOutputFunction(obj,k,t);</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>k</span><span> is the current time-propagation step index</span></li><li  class = 'S9'><span style=' font-family: monospace;'>t</span><span> is the current time when the saving is performed</span></li><li  class = 'S9'><span>For developers: saveOutputFunction is also responsible for updating the counter </span><span style=' font-family: monospace;'>obj.oFRho.n</span><span> and </span><span style=' font-family: monospace;'>obj.oFKSO.n</span><span> when it is called</span></li></ul><h2  class = 'S2' id = 'H_2FB9B214' ><span>Overloading the class</span></h2><div  class = 'S1'><span style=' font-family: monospace;'>QMol_TDDFT</span><span> is an abstract class and only define the common steps and features for all TDDFT propagators. Implementation-specific propagators must define specific methods and additional optional methods overload</span></div><h3  class = 'S6' id = 'H_B9A8411A' ><span>Methods that must be overloaded</span></h3><div  class = 'S1'><span>To define a specific implementation of a TDDFT propagation scheme, overloading classes must define the following methods with the specified signature and attributes</span></div><h4  class = 'S7' id = 'H_884CFDF5' ><span style=' font-family: monospace;'>propertyNames</span></h4><div  class = 'S1'><span>To enable name-value pair </span><a href = "#H_0783E8B1"><span>constructor</span></a><span>, name-value pair </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span>, and the </span><a href = "#H_C729A888"><span style=' font-family: monospace;'>clear</span></a><span> methods</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Static=true,Access=?QMol_suite)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >[ClassName,PropNames] = propertyNames()</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%propertyNames returns the names of member properties that can be set</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%   through name-value assignment</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Parent-class components</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    [~,PropNames]       =   QMol_TDDFT.propertyNames;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    ClassName           =   </span><span style="color: #a709f5;">'QMol_child_class'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    PropNames           =   [PropNames,{</span><span style="color: #a709f5;">'property1'</span><span >,</span><span style="color: #a709f5;">'property2'</span><span >}];</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><h4  class = 'S7' id = 'H_D8A9FEA5' ><span style=' font-family: monospace;'>showDoc</span></h4><div  class = 'S1'><span>Display the </span><a href = "#H_ABD08C91"><span>run-time documentation</span></a><span> for the specific implementation of the molecular potential.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=?QMol_DFT)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >ref = showDoc(obj)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%showDoc displays the documentation reflecting the specific implementation</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%   of the TDDFT propagator</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Add specific documentation here</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>If no reference is cited, return </span><span style=' font-family: monospace;'>ref = {}</span><span> otherwise </span><span style=' font-family: monospace;'>ref = {'ref 1','ref 2',___}</span><span>, where each of the </span><span style=' font-family: monospace;'>ref</span><span> corresponds to the bibliographic code for the reference (generally of the form </span><span style=' font-family: monospace;'>'name_of_first_author publication_year'</span><span>) and is case insensitive -- see the </span><a href = "./Documentation.html"><span>documentation page</span></a><span> for a list of citable references.</span></li><li  class = 'S9'><span>Note that only implementation-specific properties should be covered here. All properties common to all TDDFT propagators (e.g., time step) are handled in the parent </span><span style=' font-family: monospace;'>QMol_TDDFT</span><span> class run-time documentation.</span></li><li  class = 'S9'><span>Only document the TDDFT propagator. Is additional ouput are implemented, document those with the </span><a href = "#H_B96633C8"><span style=' font-family: monospace;'>docOutputChildren</span></a><span> method</span></li></ul><h4  class = 'S7' id = 'H_CBF28755' ><span style=' font-family: monospace;'>setOutputOrbitalDensity</span></h4><div  class = 'S1'><span>Initialize the </span><a href = "#H_D6D335DD"><span style=' font-family: monospace;'>outDensity</span></a><span>, </span><a href = "#H_371940E8"><span style=' font-family: monospace;'>outOrbital</span></a><span>, and </span><a href = "#H_5096ABA5"><span style=' font-family: monospace;'>outOrbitalProjection</span></a><span> structures before running a TDDFT computation and clean them up at the end of the computation. The method should have the following signature and features</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >setOutputOrbitalDensity(obj,opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%setOutputOrbitalDensity</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">switch </span><span >lower(opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">case </span><span >{</span><span style="color: #a709f5;">'init'</span><span >,</span><span style="color: #a709f5;">'initialize'</span><span >,</span><span style="color: #a709f5;">'initialization'</span><span >} </span><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Clean up any old data ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    obj.oRho            =   [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    obj.oKSO            =   [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    obj.oKSOP           =   [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% One-body density ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >obj.sRho</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% When to save the DFT energies</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oRho.ind    =   [obj.getOutputIndex(obj.sRhoT),NaN];</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oRho.time   =   obj.tspan(obj.oRho.ind(1:end-1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oRho.n      =   1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Density output initialization</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oRho.ind    =   NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oRho.n      =   1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Kohn-Sham orbitals ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >obj.sKSO</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% When to save the DFT energies</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oKSO.ind    =   [obj.getOutputIndex(obj.sKSOT),NaN];</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oKSO.time   =   obj.tspan(obj.oKSO.ind(1:end-1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oKSO.n      =   1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Kohn-Sham orbitals output initialization</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oKSO.ind    =   NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oKSO.n      =   1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Kohn-Sham orbitals' projection ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >obj.sKSOP</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% When to save the DFT energies</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oKSOP.ind   =   [obj.getOutputIndex(obj.sKSOPT),NaN];</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oKSOP.time  =   obj.tspan(obj.oKSOP.ind(1:end-1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oKSOP.n     =   1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Kohn-Sham orbitals' projection output initialization</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oKSOP.ind   =   NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oKSOP.n     =   1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">case </span><span >{</span><span style="color: #a709f5;">'clean'</span><span >,</span><span style="color: #a709f5;">'finalize'</span><span >,</span><span style="color: #a709f5;">'finalization'</span><span >} </span><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    obj.oRho            =   rmfield(obj.oRho,{</span><span style="color: #a709f5;">'ind'</span><span >,</span><span style="color: #a709f5;">'n'</span><span >});</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    obj.oKSO            =   rmfield(obj.oKSO,{</span><span style="color: #a709f5;">'ind'</span><span >,</span><span style="color: #a709f5;">'n'</span><span >});</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    obj.oKSOP           =   rmfield(obj.oKSOP,{</span><span style="color: #a709f5;">'ind'</span><span >,</span><span style="color: #a709f5;">'n'</span><span >});</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">otherwise </span><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Unexpected option</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    error(</span><span style="color: #a709f5;">'QMol:TDDFT:setOutputOrbitalDensity'</span><span >,[</span><span style="color: #a709f5;">'Unknown option ' </span><span >opt]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><div  class = 'S11'><span>At minimum, the method should initialize</span></div><ul  class = 'S8'><li  class = 'S9'><span>In </span><a href = "#H_D6D335DD"><span style=' font-family: monospace;'>obj.oRho</span></a><span>, </span><span style=' font-family: monospace;'>outDensity.total</span><span>, </span><span style=' font-family: monospace;'>outDensity.totalUp</span><span> and </span><span style=' font-family: monospace;'>outDensity.totalDown</span><span> </span></li><li  class = 'S9'><span>in </span><a href = "#H_371940E8"><span style=' font-family: monospace;'>obj.sKSO</span></a><span>, </span><span style=' font-family: monospace;'>outOrbital.orbital</span><span>, </span><span style=' font-family: monospace;'>outOrbital.indexOrbital</span><span>, </span><span style=' font-family: monospace;'>outOrbital.orbitalUp</span><span>, </span><span style=' font-family: monospace;'>outOrbital.orbitalDown</span><span>, </span><span style=' font-family: monospace;'>outOrbital.indexOrbitalUp</span><span>, and </span><span style=' font-family: monospace;'>outOrbital.indexOrbitalDown</span></li><li  class = 'S9'><span>In </span><a href = "#H_5096ABA5"><span style=' font-family: monospace;'>obj.sKSOP</span></a><span>, </span><span style=' font-family: monospace;'>outOrbital.orbital</span><span>, </span><span style=' font-family: monospace;'>outOrbital.indexOrbital</span><span>, </span><span style=' font-family: monospace;'>outOrbital.orbitalUp</span><span>, </span><span style=' font-family: monospace;'>outOrbital.orbitalDown</span><span>, </span><span style=' font-family: monospace;'>outOrbital.indexOrbitalUp</span><span>, and </span><span style=' font-family: monospace;'>outOrbital.indexOrbitalDown</span><span>. The structure should also retain a copy of the projection basis.</span></li></ul><h4  class = 'S7' id = 'H_8328AE09' ><span style=' font-family: monospace;'>setTimeStep</span></h4><div  class = 'S1'><span>(Re)set the time step to be used in the TDDFT propagation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >setTimeStep(obj,dt,t)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%setTimeStep</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Perform the proper (re)initialization </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>dt</span><span> is the value of the time step to be used and </span><span style=' font-family: monospace;'>t</span><span> the current time. Impementation-specific TDDFT propagators will often need to keep a copy of </span><span style=' font-family: monospace;'>dt</span><span> (as it may vady from </span><a href = "#H_3CC0FE7C"><span style=' font-family: monospace;'>timeStep</span></a><span>).</span></li><li  class = 'S9'><span style=' font-family: monospace;'>setTimeStep</span><span> is called at the very beginning of the TDDFT propagation and</span></li><li  class = 'S9'><span style=' font-family: monospace;'>setTimeStep</span><span> may also be called before performing the last iteration if a rescaling is required to reach the requested final time</span></li></ul><h4  class = 'S7' id = 'H_BE45A424' ><span style=' font-family: monospace;'>applyTimeStep</span></h4><div  class = 'S1'><span>Propagate the TDDFT dynamics for exactly one time step</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >applyTimeStep(obj,t)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%setTimeStep</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Perform the time propagation</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>t</span><span> is the current time, from which to perform the one-time-step propagation</span></li></ul><h4  class = 'S7' id = 'H_3FBF0B69' ><span style=' font-family: monospace;'>saveOutputDipole</span></h4><div  class = 'S1'><span>Save the dipole, dipole velocity, and/or dipole acceleration signal</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >saveOutputDipole(obj,k,t)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%setTimeStep</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Save the dipole signal</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >k == obj.oDip.ind(obj.oDip.n)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Total dipole</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Orbital-resolved dipole (if any)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Add external field</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">if </span><span >obj.sEF,         obj.addOutputExternalField(</span><span style="color: #a709f5;">'oDip'</span><span >,k,t);         </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Update counter</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oDip.n      =   obj.oDip.n + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Save the dipole-velocity signal</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >k == obj.oVel.ind(obj.oVel.n)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Total dipole velocity</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Orbital-resolved dipole velocity (if any)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Add external field</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">if </span><span >obj.sEF,         obj.addOutputExternalField(</span><span style="color: #a709f5;">'oVel'</span><span >,k,t);         </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Update counter</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oVel.n      =   obj.oVel.n + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Save the dipole acceleration signal</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >k == obj.oAcc.ind(obj.oAcc.n)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Total dipole acceleration</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Orbital-resolved dipole acceleration (if any)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Add external field</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">if </span><span >obj.sEF,         obj.addOutputExternalField(</span><span style="color: #a709f5;">'oAcc'</span><span >,k,t);         </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Update counter</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oAcc.n      =   obj.oAcc.n + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>saveOutputDipole</span><span> is called is any of the dipole, dipole velocity, or dipole acceleration needs to be computed and saved. It must therefore determine which one(s) actually need to be.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>saveOutputDipole</span><span> is also responsible for updating the counters in </span><a href = "#H_F65810AA"><span style=' font-family: monospace;'>obj.oDip</span></a><span>, </span><a href = "#H_95407807"><span style=' font-family: monospace;'>obj.oVel</span></a><span> and </span><a href = "#H_02629977"><span style=' font-family: monospace;'>obj.oAcc</span></a><span> (see their respective documentation entry for the name convention in what/how each should be saved).</span></li></ul><h4  class = 'S7' id = 'H_FDA44F8F' ><span style=' font-family: monospace;'>getExternalFieldEnergy</span></h4><div  class = 'S1'><span>Compute the contributions from any external field and autonomization variable</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >[E,DE] = getExternalFieldEnergy(obj,t)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%getExternalFieldEnergy </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% External field energy</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Autonomization variable</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>E</span><span> is the contribution to the DFT-functional energy from any external field. For spin-polarized models, it is a 2-vector with the up- and down-spin energy contributions, respectively. If not field is applied, or it does not contribute an explicit terms to the DFT energy (</span><span style=' font-style: italic;'>e.g.</span><span>, velocity Gauge dipole approximation), return </span><span style=' font-family: monospace;'>E = [0;0]</span></li><li  class = 'S9'><span style=' font-family: monospace;'>DE</span><span> is the autonomization energy variable, which tracks how mucg energy is put into or withdrawn from the DFT system</span></li><li  class = 'S9'><span>The </span><a href = "#H_37454CF9"><span style=' font-family: monospace;'>DFT</span></a><span> object contains an accurate one-body density</span></li></ul><h4  class = 'S7' id = 'H_4BB23773' ><span style=' font-family: monospace;'>saveOutputIonization</span></h4><div  class = 'S1'><span>Compute the ionization statistics</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >saveOutputIonization(obj,k,t)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%saveOutputIonization </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Total ionization signal</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Orbital-resolved ionization signal</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Add external field</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >obj.sEF,         obj.addOutputExternalField(</span><span style="color: #a709f5;">'oIon'</span><span >,k,t);         </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Update counter</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    obj.oIon.n      =   obj.oIon.n + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>saveOutputIonization</span><span> is also responsible for updating the counters in </span><a href = "#H_E1C662FA"><span style=' font-family: monospace;'>obj.oIon</span></a><span> (see the documentation entry for the name convention in what/how each should be saved).</span></li></ul><h4  class = 'S7' id = 'H_24EF3880' ><span style=' font-family: monospace;'>saveOutputOrbitalDensity</span></h4><div  class = 'S1'><span>Save the Kohn-Sham orbitals (projection) and one-body density</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >saveOutputOrbitalDensity(obj,k,t)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%setTimeStep</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Save Kohn-Sham orbitals</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >k == obj.oKSO.ind(obj.oKSO.n)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Kohn-Sham orbitals</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Add external field</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">if </span><span >obj.sEF,         obj.addOutputExternalField(</span><span style="color: #a709f5;">'oKSO'</span><span >,k,t);         </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Update counter</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oKSO.n      =   obj.oKSO.n + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Save the projection of the Kohn-Sham orbitals</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >k == obj.oKSOP.ind(obj.oKSOP.n)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Kohn-Sham orbitals' projection</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Add external field</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">if </span><span >obj.sEF,         obj.addOutputExternalField(</span><span style="color: #a709f5;">'oKSOP'</span><span >,k,t);        </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Update counter</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oKSOP.n     =   obj.oKSOP.n + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Save the one-body density</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >k == obj.oRho.ind(obj.oRho.n)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% One-body density</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Add external field</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #0e00ff;">if </span><span >obj.sEF,         obj.addOutputExternalField(</span><span style="color: #a709f5;">'oRho'</span><span >,k,t);         </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        </span><span style="color: #008013;">% Update counter</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >        obj.oRho.n      =   obj.oRho.n + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>saveOutputOrbitalDensity</span><span> is called is any of the Kohn-Sham orbitals, their projection, or one-body density needs to be saved. It must therefore determine which one(s) actually need to be.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>saveOutputOrbitalDensity</span><span> is also responsible for updating the counters in </span><a href = "#H_371940E8"><span style=' font-family: monospace;'>obj.oKSO</span></a><span>, </span><a href = "#H_5096ABA5"><span style=' font-family: monospace;'>obj.oKSOP</span></a><span> and </span><a href = "#H_D6D335DD"><span style=' font-family: monospace;'>obj.oRho</span></a><span> (see their respective documentation entry for the name convention in what/how each should be saved).</span></li></ul><h3  class = 'S6' id = 'H_C9A49DFA' ><span>Additional optional methods to overload</span></h3><h4  class = 'S7' id = 'H_DC4E9FF3' ><span style=' font-family: monospace;'>getMemoryProfilePropagator</span></h4><div  class = 'S1'><span>Estimate the memory footprint of the implementation-specific part of the TDDFT propagator</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >mem = getMemoryProfilePropagator(obj,opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%getMemoryProfilePropagator </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Initialization</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >nargin &lt; 2,  opt     =   false;  </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Estimate of the memory footprint</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>Use </span><a href = "./QMol_DFT_profiler.html"><span style=' font-family: monospace;'>QMol_DFT_profiler</span></a><span style=' font-family: monospace;'>.showMemoryFootprint</span><span> to display the memory foorprint of the propagator's components (when </span><span style=' font-family: monospace;'>opt == true</span><span>)</span></li><li  class = 'S9'><span style=' font-family: monospace;'>getMemoryProfilePropagator</span><span> should only list the memory footprint of the propagation part of the implementation-specific class. Estimate of the memory footprint for the output results is handled with the </span><a href = "#H_483AC36A"><span style=' font-family: monospace;'>getMemoryProfileOrbitalDensity</span></a><span> and </span><a href = "#H_A5C2DE6E"><span style=' font-family: monospace;'>getMemoryProfileChildren</span></a><span> properties.</span></li><li  class = 'S9'><span>The </span><a href = "#H_37454CF9"><span style=' font-family: monospace;'>DFT</span></a><span> object is initialized when </span><span style=' font-family: monospace;'>getMemoryProfilePropagator</span><span> is called</span></li></ul><h4  class = 'S7' id = 'H_483AC36A' ><span style=' font-family: monospace;'>getMemoryProfileOrbitalDensity</span></h4><div  class = 'S1'><span>Estimate the memory footprint for saving of the Kohn-Sham orbitals and one-body density in the implementation-specific TDDFT propagator</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >mem = getMemoryProfileOrbitalDensity(obj,opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%getMemoryProfileOrbitalDensity</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Initialization</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >nargin &lt; 2,  opt     =   false;  </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Estimate of the memory footprint</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>Use </span><a href = "./QMol_DFT_profiler.html"><span style=' font-family: monospace;'>QMol_DFT_profiler</span></a><span style=' font-family: monospace;'>.showMemoryFootprint</span><span> to display the memory foorprint of saving the Kohn-Sham orbitals ans/or one-body density (when </span><span style=' font-family: monospace;'>opt == true</span><span>)</span></li><li  class = 'S9'><span style=' font-family: monospace;'>getMemoryProfileOrbitalDensity</span><span> should only list the memory footprint of the requested Kohn-Sham orbitals and/or one-body density. Estimate of the memory footprint for any additional implementation-specific output results with </span><a href = "#H_A5C2DE6E"><span style=' font-family: monospace;'>getMemoryProfileChildren</span></a><span>.</span></li><li  class = 'S9'><span>The </span><a href = "#H_37454CF9"><span style=' font-family: monospace;'>DFT</span></a><span> object is initialized when </span><span style=' font-family: monospace;'>getMemoryProfileOrbitalDensity</span><span> is called</span></li></ul><h4  class = 'S7' id = 'H_A5C2DE6E' ><span style=' font-family: monospace;'>getMemoryProfileChildren</span></h4><div  class = 'S1'><span>Estimate the memory footprint of additional output defined by the implementation-specific part of the TDDFT propagator</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >mem = getMemoryProfileChildren(obj,opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%getMemoryProfilePropagator </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Initialization</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >nargin &lt; 2,  opt     =   false;  </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Estimate of the memory footprint</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>Use </span><a href = "./QMol_DFT_profiler.html"><span style=' font-family: monospace;'>QMol_DFT_profiler</span></a><span style=' font-family: monospace;'>.showMemoryFootprint</span><span> to display the memory foorprint of the additional outputs (when </span><span style=' font-family: monospace;'>opt == true</span><span>)</span></li><li  class = 'S9'><span style=' font-family: monospace;'>getMemoryProfileChildren</span><span> should only list the memory footprint of additional output defined by the implementation-specific TDDFT propagator. Estimate of the memory footprint for the Kohn-Sham orbitals and one-body density output results is handled with </span><a href = "#H_483AC36A"><span style=' font-family: monospace;'>getMemoryProfileOrbitalDensity</span></a></li><li  class = 'S9'><span>The </span><a href = "#H_37454CF9"><span style=' font-family: monospace;'>DFT</span></a><span> object is initialized when </span><span style=' font-family: monospace;'>getMemoryProfileChildren</span><span> is called</span></li></ul><h4  class = 'S7' id = 'H_B96633C8' ><span style=' font-family: monospace;'>docOutputChildren</span></h4><div  class = 'S1'><span>Run-time documentation for additional implementation-specific output variables</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >ref = docOutputChildren(obj)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%docOutputChildren </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Add specific documentation</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>If no reference is cited, return </span><span style=' font-family: monospace;'>ref = {}</span><span> otherwise </span><span style=' font-family: monospace;'>ref = {'ref 1','ref 2',___}</span><span>, where each of the </span><span style=' font-family: monospace;'>ref</span><span> corresponds to the bibliographic code for the reference (generally of the form </span><span style=' font-family: monospace;'>'name_of_first_author publication_year'</span><span>) and is case insensitive -- see the </span><a href = "./Documentation.html"><span>documentation page</span></a><span> for a list of citable references.</span></li><li  class = 'S9'><span>For consistency with the other output available to all TDDFT propagators, only list the additional output that are being calculated during the TDDFT propagation (following user-defined properties).</span></li><li  class = 'S9'><span>Only implementation-specific additional properties should be covered here. All properties common to all TDDFT propagators (e.g., time step) are handled in the parent </span><span style=' font-family: monospace;'>QMol_TDDFT</span><span> class run-time documentation.</span></li><li  class = 'S9'><span>Run-time documentation for the implementation-specific TDDFT propagator is handled with </span><a href = "#H_D8A9FEA5"><span style=' font-family: monospace;'>showDoc</span></a><span> and therefore should not be included here.</span></li></ul><h4  class = 'S7' id = 'H_675447D6' ><span style=' font-family: monospace;'>setOutputChildren</span></h4><div  class = 'S1'><span>Implementation-specific TDDFT propagation classes that overload QMol_TDDFT may define additional run-time results to save during the propagation. Those are initialized with the </span><span style=' font-family: monospace;'>setOutputChildren</span><span> method with the following signature (see also the example </span><a href = "#H_CBF28755"><span>above</span></a><span> for a more fleshed out template)</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >setOutputChildren(obj,opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%setOutputChildren</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">switch </span><span >lower(opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">case </span><span >{</span><span style="color: #a709f5;">'init'</span><span >,</span><span style="color: #a709f5;">'initialize'</span><span >,</span><span style="color: #a709f5;">'initialization'</span><span >} </span><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Clean up any old data ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Initialize output structure(s) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">case </span><span >{</span><span style="color: #a709f5;">'clean'</span><span >,</span><span style="color: #a709f5;">'finalize'</span><span >,</span><span style="color: #a709f5;">'finalization'</span><span >} </span><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Clean output structures at the end of the TDDFT propagation</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">otherwise </span><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Unexpected option</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    error(</span><span style="color: #a709f5;">'QMol:TDDFT:setOutputChildren'</span><span >,[</span><span style="color: #a709f5;">'Unknown option ' </span><span >opt]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><h4  class = 'S7' id = 'H_DF38E3D0' ><span style=' font-family: monospace;'>setOutputExternalField</span></h4><div  class = 'S1'><span>Enable saving of the </span><a href = "#H_48DDF558"><span>external-field information</span></a><span> in a given </span><a href = "#H_D533B953"><span>output structure</span></a></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >setOutputExternalField(obj,structName,opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%setOutputExternalField</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">switch </span><span >lower(opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">case </span><span >{</span><span style="color: #a709f5;">'init'</span><span >,</span><span style="color: #a709f5;">'initialize'</span><span >,</span><span style="color: #a709f5;">'initialization'</span><span >} </span><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Add proper field for external field information</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">case </span><span >{</span><span style="color: #a709f5;">'clean'</span><span >,</span><span style="color: #a709f5;">'finalize'</span><span >,</span><span style="color: #a709f5;">'finalization'</span><span >} </span><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Clean output structures at the end of the TDDFT propagation</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% (for the external-field information only)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">otherwise </span><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Unexpected option</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    error(</span><span style="color: #a709f5;">'QMol:TDDFT:setOutputExternalField'</span><span >,[</span><span style="color: #a709f5;">'Unknown option ' </span><span >opt]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>setOutputExternalField</span><span> is called in the initialization and cleanup of each of the </span><a href = "#H_5D387730"><span style=' font-family: monospace;'>setOutputDipole</span></a><span>, </span><a href = "#H_C32F9472"><span style=' font-family: monospace;'>setOutputEnergy</span></a><span>, </span><a href = "#H_C219079B"><span style=' font-family: monospace;'>setOutputFunction</span></a><span>, </span><a href = "#H_EA0844B5"><span style=' font-family: monospace;'>setOutputIonization</span></a><span>, and </span><a href = "#H_D7894DE5"><span style=' font-family: monospace;'>setOutputOrbitalDensity</span></a></li><li  class = 'S9'><span style=' font-family: monospace;'>structName</span><span> is the name of the </span><a href = "#H_D533B953"><span>output structure</span></a><span> to which the external field info are to be initialized. </span><span style=' font-family: monospace;'>obj.(structName)</span><span> gives access to the corresponding property in the class.</span></li></ul><h4  class = 'S7' id = 'H_F3159701' ><span style=' font-family: monospace;'>setRestartChildren</span></h4><div  class = 'S1'><span>Perform the necessary initialization of the implementation-specific TDDFT propagator in </span><a href = "#H_5CD2979A"><span>restart mode</span></a><span> </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >setRestartChildren(obj)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%setRestartChildren</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Initialize upon restart</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>setRestartChildren</span><span> is called </span><span style=' text-decoration: underline;'>after</span><span> the QMol_TDDFT has performed its own reinitialization, notably </span><a href = "#H_37454CF9"><span style=' font-family: monospace;'>DFT</span></a><span> object has been initialized </span></li></ul><h4  class = 'S7' id = 'H_E5FC9CB8' ><span style=' font-family: monospace;'>saveOutputChildren</span></h4><div  class = 'S1'><span>Save additional implementation-specific output</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >saveOutputChildren(obj,k,t)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%saveOutputChildren</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Save additional output</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>k</span><span> is the current time-propagation step index</span></li><li  class = 'S9'><span style=' font-family: monospace;'>t</span><span> is the current time when the saving is performed</span></li><li  class = 'S9'><span style=' font-family: monospace;'>saveOutputChildren</span><span> is called for every time step (including the starting and final times) of the TDDFT propagation. The class is responsible for checking which additional data must be saved, if any, and doing the actual saving.</span></li></ul><h4  class = 'S7' id = 'H_B478C7F5' ><span style=' font-family: monospace;'>addOutputExternalField</span></h4><div  class = 'S1'><span>Adds the </span><a href = "#H_48DDF558"><span>external-field information</span></a><span> to a given </span><a href = "#H_D533B953"><span>output structure</span></a></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >addOutputExternalField(obj,structName,k,t)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%addOutputExternalField</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Add external-field information to output structure</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>addOutputExternalField is called by </span><a href = "#H_3FBF0B69"><span style=' font-family: monospace;'>saveOutputDipole</span></a><span>, </span><a href = "#H_9ED0647B"><span style=' font-family: monospace;'>saveOutputEnergy</span></a><span>, </span><a href = "#H_1C92546A"><span style=' font-family: monospace;'>saveOutputFunction</span></a><span>, </span><a href = "#H_4BB23773"><span style=' font-family: monospace;'>saveOutputIonization</span></a><span>, and </span><a href = "#H_24EF3880"><span style=' font-family: monospace;'>saveOutputOrbitalDensity</span></a></li><li  class = 'S9'><span style=' font-family: monospace;'>structName</span><span> is the name of the </span><a href = "#H_D533B953"><span>output structure</span></a><span> to which the external field info are to be saved. </span><span style=' font-family: monospace;'>obj.(structName)</span><span> gives access to the corresponding property in the class.</span></li><li  class = 'S9'><span style=' font-family: monospace;'>k</span><span> is the current time-propagation step index</span></li><li  class = 'S9'><span style=' font-family: monospace;'>t</span><span> is the current time when the saving is performed</span></li></ul><h4  class = 'S7' id = 'H_9D80AD2B' ><span style=' font-family: monospace;'>saveRestartChildren</span></h4><div  class = 'S1'><span>Save implementation-specific info needed for restarting a TDDFT calculation to the </span><a href = "#H_4F8B0111"><span style=' font-family: monospace;'>restart</span></a><span> structure</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >methods (Access=protected)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >saveRestartChildren(obj,k,t)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%saveOutputChildren</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Save additional output</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>k</span><span> is the current time-propagation step index</span></li><li  class = 'S9'><span style=' font-family: monospace;'>t</span><span> is the current time when the saving is performed</span></li><li  class = 'S9'><span style=' font-family: monospace;'>saveRestartChildren</span><span> is called at the end of a time-step propagation (and the index </span><span style=' font-family: monospace;'>k</span><span> and time </span><span style=' font-family: monospace;'>t</span><span> have been updated accordingly before calling the function)</span></li></ul><h2  class = 'S2' id = 'H_8CAFC83D' ><span>Bourdary absorber</span></h2><div  class = 'S1'><span>TDDFT propagators support both mask and complex absorbing bondary conditions. The template for absorbing boundayr classes is</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span style="color: #0e00ff;">classdef</span><span style="color: #0e00ff;"> </span><span >QMol_DFT_absorber &lt; QMol_suite</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%QMol_DFT_absorber </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%% Documentation %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">methods </span><span >(Static,Access=private)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >version</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    QMol_doc.showVersion(</span><span style="color: #a709f5;">'##.##.###'</span><span >,</span><span style="color: #a709f5;">'##/##/####'</span><span >,</span><span style="color: #a709f5;">'Author Name'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">methods </span><span >(Static,Access={?QMol_doc,?QMol_DFT_absorber})</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >showInfo</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    fprintf( </span><span style="color: #a709f5;">'  * QMol_DFT_absorber:\n'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    fprintf([</span><span style="color: #a709f5;">'      &gt; Absorbing boundaries\n'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >             </span><span style="color: #a709f5;">'      &gt; Type of absorber\n'</span><span >]); </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    QMol_DFT_absorber.version;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">methods </span><span >(Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >ref = showDocumentation(obj)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%showDocumentation displays the documentation reflecting member property </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%   values</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Initialization</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    ref                 =   {};</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Header</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    fprintf(</span><span style="color: #a709f5;">'  * Absorbing boundaries                                  type of absorber\n'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Details of the absorber</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Version</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    obj.version;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >mem = getMemoryProfile(obj,opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%getMemoryProfile computes and returns an estimate of the total memory</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%   footprint (in bytes) of the absorber with all its components</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%   initialized and used.</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Initialization</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #0e00ff;">if </span><span >nargin &lt; 2,  opt =   false;  </span><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Evaluate (and display) estimate of memory footprint</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%% Properties %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">properties </span><span >(Transient,Hidden,GetAccess=?QMol_suite,SetAccess={?QMol_DFT_absorber,?QMol_DFT})</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Linked objects</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    DFT                             </span><span style="color: #008013;">% DFT.disc always defines the domain</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Other properties of the class</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%% Alias handling %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Mapping between user-facing long variable names and internal's short</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%% Initialization %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">methods </span><span >(Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >reset(obj)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%reset clears all temporary (transient) properties of the object. Should be</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%   overloaded by each subclasses to perform proper reset actions.</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Run-time variables</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    obj.DFT             =   [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Initialization status</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    obj.isInit          =   false;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >initialize(obj,DFT,isFwd)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%initialize initializes the object</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Initialization</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    obj.reset;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Set links</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    obj.DFT             =   DFT;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Initialize the absorber</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Miscellaneous</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    obj.isInit          =   true;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">methods </span><span >(Static=true,Access=?QMol_suite)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >[ClassName,PropNames] = propertyNames()</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%propertyNames returns the names of member properties that can be set</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%   through name-value assignment</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    ClassName           =   </span><span style="color: #a709f5;">'QMol_DFT_absorber'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    PropNames           =   {};</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%% Absorber %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">methods </span><span >(Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    applyMask(obj,KSO)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    V = getPotential(obj,V)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>Upon initialization, the class shoud retain a copy of the </span><a href = "#H_37454CF9"><span style=' font-family: monospace;'>DFT</span></a><span> object with the access-right signature specified above (required for memory profiling)</span></li><li  class = 'S9'><span>In the </span><span style=' font-family: monospace;'>initialize</span><span> method, </span><span style=' font-family: monospace;'>isFwd</span><span> indicates whether the TDDFT propagation is is a forward (</span><span style=' font-family: monospace;'>true</span><span>) or backward (</span><span style=' font-family: monospace;'>false</span><span>) in time (to adjust the sign of the CAP)</span></li></ul><h3  class = 'S6' id = 'H_CA02FC07' ><span>Mask function</span></h3><div  class = 'S1'><span>Mask absorbers correspond to a given mask function that is multipled to the Kohn-Sham orbitals after each propagation time step. Their signature is</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >applyMask(obj,KSO)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%applyMask</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Multiply the orbitals in KSO by the mask</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >V = getPotential(~,V)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%getPotential no complex potential, return the object untouched</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>Even when no complex absorbing potential is defined, </span><span style=' font-family: monospace;'>getPotential</span><span> must still be defined, leaving the input DFT potential untouched</span></li></ul><h3  class = 'S6' id = 'H_64DC68BD' ><span>Complex absorbing potential (CAP)</span></h3><div  class = 'S1'><span>Complex absorbing potentials correspond to an imaginary component added to the DFT potential that dampen the Kohn-Sham orbitals at the boundaries. Their signature is</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >applyMask(~,~)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%applyMask no mask applied, do nothing</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >V = getPotential(obj,V)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span style="color: #008013;">%getPotential</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Add the complex potential to the DFT-potential object V</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S8'><li  class = 'S9'><span>Even when no mask is defined, </span><span style=' font-family: monospace;'>applyMask</span><span> must still be defined, doing nothing</span></li><li  class = 'S9'><span>V is a compatible DFT potential; use its </span><span style=' font-family: monospace;'>add</span><span> property to add the CAP</span></li></ul><h2  class = 'S2' id = 'H_D431B55B' ><span>Test suite</span></h2><div  class = 'S1'><span>For consistency with the rest of the QMol-grid package, </span><span style=' font-family: monospace;'>QMol_DFT</span><span> defines an associated test suite. Run the test suite for the class in normal or </span><a href = "./Test_suite.html"><span>summary mode</span></a><span> respectively with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'TDDFT'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'-summary'</span><span >,</span><span style="color: #a709f5;">'TDDFT'</span><span >);</span></span></div></div></div><div  class = 'S11'><span>See </span><a href = "./QMol_test.html"><span style=' font-family: monospace;'>QMol_test</span></a><span> for details regarding how to create a test suite for new classes.</span></div><h2  class = 'S2' id = 'H_2E204287' ><span>Notes</span></h2><ul  class = 'S8'><li  class = 'S9'><span style=' font-family: monospace;'>QMol_TDDFT</span><span> was intorduced in version 01.00 but version 01.10 drastically redesigned its interface and supported features</span></li><li  class = 'S9'><a href = "#H_E3988947"><span style=' font-family: monospace;'>getMemoryProfile</span></a><span> was introduced in version 01.10</span></li></ul>
<br>
<!-- 
##### SOURCE BEGIN #####
%% |QMol_TDDFT|
% Parent class for time-dependent density-functional theory (TDDFT) model objects.
%% Description
% |QMol_TDDFT| defines an abstract class for the time propagation of DFT models. 
% It is designed to be agnostic of (i) the model dimension, (ii) the chosen discretization 
% (Cartesian grid or basis), and (ii) spin polarized or restricted configuration. 
% These are to be handled by the specific TDDFT-implementation classes and their 
% components.
% 
% |QMol_TDDFT| defines many peoperties and methods. Here we only document the 
% ones visible to end users and implementation-specific overloading classes (public 
% or protected access attributes). We provide a quick overview of the requirements 
% of implementation-specific classes for defining actual TDDFT propagation schemes.
%% Class properties
% Time propagation
% |display (disp)|
% Whether to display progress of the TDDFT calculations as they go on |[ true 
% (default) | false ]|
% |time (T)|
% Time propagation vector |[ vector (default []) ]|
%% 
% * In all TDDFT propagation simulations |T(1)| specifies the starting time 
% and |T(end)| the ending time.
% * In forward time propagation simulations (|timeStep| |> 0|) time values in 
% |T| must be all increasing, while for backward time propagation (|timeStep| 
% |< 0|) they must be all decreasing. Time increments in the vector |T| need not 
% be equally spaced.
% * When |display| is activated, |T| specifies the intermediary times for the 
% time-propagation progress display.
% * |T| is also the default time sampling for saved results that do not define 
% their own.
% * Note that the time step used in TDDFT propagations is set independently 
% of |T|.
% |timeStep (dt)|
% Time step used for the time propagation  |[ scalar (default 0.01) ]|
%% 
% * Positive (resp. negative) |timeStep| define forward (resp. ackward) time 
% propagation.
% |absorbingBoundary (ABC)|
% Absorber at the edges of the domain |[ [] (default) | mask object | CAP object 
% ]|
%% 
% * The boundary absorber aims at eliminating outgoing wave packets from the 
% discretization domain and avoid spurious reflections at the edges of the domain.
% * Empty |absorbingBoundary| does not implement any absorbing boundary method 
% and any part of the wave packet reaching the edges of the domain will be reflected 
% (or articifially reappears on the other side of the domain through periodic 
% effects).
% * Mask absorbers are applied at the end of each propagation step. They are 
% the easiest to use and implement but are first order, irrespective of the order 
% of the time propagation scheme. See below for details on the required interface 
% for absorbing mask classes.
% * Complex absorbing potentials (CAPs) are integrated within the propagation 
% scheme, as an imaginary potential term that causes exponential decay of the 
% wave packet at the edges.Under the rihgt circumstances, CAPs can preserve the 
% order of the propagation schemes. See below for details on the required interface 
% for CAP classes.
% |externalField (EF)|
% External driving field |[ [] (default) | field object ]|
%% 
% * Empty |externalField| performs field-free TDDFT simulations.
% * The specific type and interface for compatible field objects is left to 
% the implementation-specific TDDFT propagator REPLACE_WITH_DASH_DASH see the corresponding documentation 
% for details.
% Save the DFT object into individual files
% During the time propagation, copies of the DFT object can be saved in separate 
% MATLAB files.
% |saveDFT (sDFT)|
% Activate saving the DFT object into separate files |[ true | false (default) 
% ]|
% |saveDFTFileName (sDFTF)|
% Name for the files in which the DFT objects are saved |[ chracter array (default 
% 'QMolGridREPLACE_WITH_DASH_DASHTDDFTREPLACE_WITH_DASH_DASHDFT') ]|
%% 
% * The DFT objects saved at different times are put in separate MATLAB (.mat.) 
% file, with names starting with |saveDFTFileName| to which the iteration index 
% is appended. Each file produced also contains a scalar variable |t| with the 
% time information.
% * One may specify a location where to create the files by indicating the folder 
% path in |saveDFTFileName|
% * |saveDFTFileName| is irrelevant when |saveDFT| |== false|
% |saveDFTTime (sDFTT)|
% Times at which to save the DFT object into a file |[ [] (default) | positive 
% scalar | negative integer | vector | 'all' ]|
%% 
% * Empty |saveDFTTime| uses the same values as in |time| for when to save the 
% DFT object into MATLAB files.
% * A positive scalar specifies the sampling time step when to save the DFT 
% object into MATLAB files. For forward time propagation, it is equivalent to 
% time|(1):saveDFTTime:|time|(end)|, and for backward ones to time|(1):-saveDFTTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% saves. For forward time propagation, it is equivalent to time|(1):abs(saveDFTTime)*||timeStep||:|time|(end)|, 
% and for backward ones to time|(1):-abs(saveDFTTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to save the DFT object to 
% a MATLAB file.
% * |'all'| saves the DFT object into a MATLAB file after every time step. Warning: 
% this is slow and may result in a very large number of file and/or large disk 
% usage.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% Save the dipole, dipole velocity, and dipole acceleration signals
% |saveDipole (sDip)|
% Whether to calculate and save the dipole signal during the TDDFT propagation 
% |[ true | false (default) ]|
% |saveDipoleOrbitalIndex (sDipI)|
% Index of the Kohn-Sham orbitals for which to compute the orbital-resolved 
% dipole signal |[ [] (default) | index vector | cell | 'all' ]|
%% 
% * This is irrelevant if |saveDipole| is |false|
% * Empty |saveDipoleOrbitalIndex| disables the orbital-resolved dipole signal 
% calculation
% * For spin restricted models, specify the indexes of the orbitals for which 
% to compute the orbital-resolved dipole signal
% * For spin polarized models, combine the up- and down-spin channel orbital 
% indexes in a cell of the form |{ind_up,ind_down}|
% * |'all'| computes the orbital-resolved dipole for all orbitals
% |saveDipoleTime (sDipT)|
% Times at which to compute and save the dipole signal |[ [] (default) | positive 
% scalar | negative integer | vector | 'all' ]|
%% 
% * Empty |saveDipoleTime| uses the same values as in |time| for when to compute 
% and save the dipole signal.
% * A positive scalar specifies the sampling time step between successive computations 
% of the dipole signal. For forward time propagation, it is equivalent to time|(1):saveDipoleTime:|time|(end)|, 
% and for backward ones to time|(1):-saveDipoleTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% dipole-signal computations. For forward time propagation, it is equivalent to 
% time|(1):abs(saveDipoleTime)*||timeStep||:|time|(end)|, and for backward ones 
% to time|(1):-abs(saveDipoleTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to compute and save the dipole 
% signal.
% * |'all'| computes and saves the dipole signal after every time step. Warning: 
% this is may be slow.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% |saveDipoleVelocity (sVel)|
% Whether to calculate and save the dipole velocity signal during the TDDFT 
% propagation |[ true | false (default) ]|
% |saveDipoleVelocityOrbitalIndex (sVelI)|
% Index of the Kohn-Sham orbitals for which to compute the orbital-resolved 
% dipole velocity signal |[ [] (default) | index vector | cell | 'all' ]|
%% 
% * This is irrelevant if |saveDipoleVelocity| is |false|
% * Empty |saveDipoleVelocityOrbitalIndex| disables the orbital-resolved dipole 
% velocity signal calculation
% * For spin restricted models, specify the indexes of the orbitals for which 
% to compute the orbital-resolved dipole velocity signal
% * For spin polarized models, combine the up- and down-spin channel orbital 
% indexes in a cell of the form |{ind_up,ind_down}|
% * |'all'| computes the orbital-resolved dipole velocity for all orbitals
% |saveDipoleVelocityTime (sVelT)|
% Times at which to compute and save the dipole velocity signal |[ 'dipole' 
% (default) | positive scalar | negative integer | vector | 'all' ]|
%% 
% * |'dipole'| |saveDipoleVelocityTime| uses the same times as for |saveDipoleTime| 
% * A positive scalar specifies the sampling time step between successive computations 
% of the dipole velocity signal. For forward time propagation, it is equivalent 
% to time|(1):saveDipoleVelocityTime:|time|(end)|, and for backward ones to time|(1):-saveDipoleVelocityTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% dipole-velocity-signal computations. For forward time propagation, it is equivalent 
% to time|(1):abs(saveDipoleVelocityTime)*||timeStep||:|time|(end)|, and for backward 
% ones to time|(1):-abs(saveDipoleVelocityTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to compute and save the dipole 
% velocity signal.
% * |'all'| computes and saves the dipole velocity signal after every time step. 
% Warning: this is may be slow.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% |saveDipoleAcceleration (sAcc)|
% Whether to calculate and save the dipole acceleration signal during the TDDFT 
% propagation |[ true | false (default) ]|
% |saveDipoleAccelerationOrbitalIndex (sAccI)|
% Index of the Kohn-Sham orbitals for which to compute the orbital-resolved 
% dipole acceleration signal |[ [] (default) | index vector | cell | 'all' ]|
%% 
% * This is irrelevant if |saveDipoleAcceleration| is |false|
% * Empty |saveDipoleAccelerationOrbitalIndex| disables the orbital-resolved 
% dipole acceleration signal calculation
% * For spin restricted models, specify the indexes of the orbitals for which 
% to compute the orbital-resolved dipole acceleration signal
% * For spin polarized models, combine the up- and down-spin channel orbital 
% indexes in a cell of the form |{ind_up,ind_down}|
% * |'all'| computes the orbital-resolved dipole acceleration for all orbitals
% |saveDipoleAccelerationTime (sAccT)|
% Times at which to compute and save the dipole acceleration signal |[ 'dipole' 
% (default) | positive scalar | negative integer | vector | 'all' ]|
%% 
% * |'dipole'| |saveDipoleAccelerationTime| uses the same times as for |saveDipoleTime| 
% * A positive scalar specifies the sampling time step between successive computations 
% of the dipole acceleration signal. For forward time propagation, it is equivalent 
% to time|(1):saveDipoleAccelerationTime:|time|(end)|, and for backward ones to 
% time|(1):-saveDipoleAccelerationTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% dipole-acceleration-signal computations. For forward time propagation, it is 
% equivalent to time|(1):abs(saveDipoleAccelerationTime)*||timeStep||:|time|(end)|, 
% and for backward ones to time|(1):-abs(saveDipoleAccelerationTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to compute and save the dipole 
% acceleration signal.
% * |'all'| computes and saves the dipole acceleration signal after every time 
% step. Warning: this is may be slow.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% Save DFT and orbital energies
% |saveEnergyDFT (sEDFT)|
% Whether to track the DFT energy during the TDDFT propagation |[ true | false 
% (default) ]|
% |saveEnergyDFTTime (sEDFTT)|
% Times at which to compute and save the DFT energy |[ [] (default) | positive 
% scalar | negative integer | vector | 'all' ]|
%% 
% * Empty |saveEnergyDFTTime| uses the same values as in |time| for when to 
% compute and save the DFT energy
% * A positive scalar specifies the sampling time step between successive computations 
% of the DFT energy. For forward time propagation, it is equivalent to time|(1):saveEnergyDFTTime:|time|(end)|, 
% and for backward ones to time|(1):-saveEnergyDFTTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% DFT-energy computations. For forward time propagation, it is equivalent to time|(1):abs(saveEnergyDFTTime)*||timeStep||:|time|(end)|, 
% and for backward ones to time|(1):-abs(saveEnergyDFTTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to compute and save the DFT 
% energy.
% * |'all'| computes and saves the DFT energy after every time step. Warning: 
% this is may be slow.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% |saveEnergyOrbital (sEKSO)|
% Whether to track the orbital energies during the TDDFT propagation |[ true 
% | false (default) ]|
% |saveEnergyOrbitalTime (sEKSOT)|
% Times at which to compute and save the Kohn-Sham orbital energies |[ [] (default) 
% | positive scalar | negative integer | vector | 'all' ]|
%% 
% * For a Kohn-Sham orbital $|\phi\rangle$, the orbital energy is defined as 
% $\langle\phi|\hat{\mathcal{H}}_{\rm DFT}|\phi\rangle$ with $\hat{\mathcal{H}}_{\rm 
% DFT}$ the DFT Hamiltonian operator.
% * Empty |saveEnergyOrbitalTime| uses the same values as in |time| for when 
% to compute and save the Kohn-Sham orbital energies
% * A positive scalar specifies the sampling time step between successive computations 
% of the Kohn-Sham orbital energies. For forward time propagation, it is equivalent 
% to time|(1):saveEnergyOrbitalTime:|time|(end)|, and for backward ones to time|(1):-saveEnergyOrbitalTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% Kohn-Sham-orbital-energy computations. For forward time propagation, it is equivalent 
% to time|(1):abs(saveEnergyOrbitalTime)*||timeStep||:|time|(end)|, and for backward 
% ones to time|(1):-abs(saveEnergyOrbitalTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to compute and save the Kohn-Sham-orbital 
% energies.
% * |'all'| computes and saves the Kohn-Sham orbital energies after every time 
% step. Warning: this is may be slow.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% Save the external field information
% |saveExternalField (sEF)|
% For TDDFT simulation with and external driving field, save the external field 
% in output structures |[ true | false (default) ]|
%% 
% * When activated (|saveExternalField = true|), the information about the external 
% driving field at the sampled times is added to each of the output structures 
% (except |outDFT|).
% * For practical reasons, the values for the external driving field may be 
% slightly different than that of |externalField|. This features enables keeping 
% the actual external-field values used throughout the propagation.
% Save the ionization signal
% The ionization signal tracks how much density leaves the simulation domain 
% by being absorbed at the boundaries.
% |saveIonization (sIon)|
% Whether to calculate and save the ionization signal during the TDDFT propagation 
% |[ true | false (default) ]|
% |saveIonizationOrbitalIndex (sIKSOI)|
% Index of the Kohn-Sham orbitals for which to compute the orbital-resolved 
% ionization signal |[ [] (default) | index vector | cell | 'all' ]|
%% 
% * This is irrelevant if |saveIonization| is |false|
% * Empty |saveIonizationOrbitalIndex| disables the orbital-resolved ionization 
% signal calculation
% * For spin restricted models, specify the indexes of the orbitals for which 
% to compute the orbital-resolved ionization signal
% * For spin polarized models, combine the up- and down-spin channel orbital 
% indexes in a cell of the form |{ind_up,ind_down}|
% * |'all'| computes the orbital-resolved ionization for all orbitals
% |saveIonizationTime (sIonT)|
% Times at which to compute and save the ionization signal |[ [] (default) | 
% positive scalar | negative integer | vector | 'all' ]|
%% 
% * Empty |saveIonizationTime| uses the same values as in |time| for when to 
% compute and save the ionization signal.
% * A positive scalar specifies the sampling time step between successive computations 
% of the ionization signal. For forward time propagation, it is equivalent to 
% time|(1):saveIonizationTime:|time|(end)|, and for backward ones to time|(1):-saveIonizationTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% ionization-signal computations. For forward time propagation, it is equivalent 
% to time|(1):abs(saveIonizationTime)*||timeStep||:|time|(end)|, and for backward 
% ones to time|(1):-abs(saveIonizationTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to compute and save the ionization 
% signal.
% * |'all'| computes and saves the ionization signal after every time step. 
% Warning: this is may be slow.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% Save the Kohn-Sham orbitals (projection) and one-body density
% Warning: The memory requirements for saving the orbitals or density throughout 
% the TDDFT propagation may grow very fast and trigger an error (if MATLAB runs 
% out of memory). Instead, if the full orbital/one-body density is required consider 
% saving the DFT object in separate files, or if only the result of a specify 
% calculation on the orbital/one-body density is required consider consider using 
% installabe output functions.
% |saveDensity (sRho)|
% Whether to save the one-body density during the TDDFT propagation |[ true 
% | false (default) ]|
% |saveDensityTime (sRhoT)|
% Times at which to save the one-body density |[ [] (default) | positive scalar 
% | negative integer | vector | 'all' ]|
%% 
% * Empty |saveDensityTime| uses the same values as in |time| for when to save 
% the one-body density.
% * A positive scalar specifies the sampling time step between successive saving 
% of the one-body density. For forward time propagation, it is equivalent to time|(1):saveDensityTime:|time|(end)|, 
% and for backward ones to time|(1):-saveDensityTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% saving the one-body density. For forward time propagation, it is equivalent 
% to time|(1):abs(saveDensityTime)*||timeStep||:|time|(end)|, and for backward 
% ones to time|(1):-abs(saveDensityTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to save the one-body density.
% * |'all'| saves the one-body density after every time step. Warning: generally 
% discouraged as it likely results in very large memory requirements or cause 
% an out-of-memory error REPLACE_WITH_DASH_DASH see the warning above.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% |saveOrbital (sKSO)|
% Whether to save the Kohn-Sham orbitals during the TDDFT propagation |[ true 
% | false (default) ]|
% |saveOrbitalIndex (sKSOI)|
% Index of the Kohn-Sham orbitals to save |[ [] (default) | index vector | cell 
% | 'all' ]|
%% 
% * This is irrelevant if |saveOrbital| is |false|
% * Empty |saveOrbitalIndex| disables saving of the Kohn-Sham orbitals and is 
% technically equivalent to |saveOrbital| |= false|
% * For spin restricted models, specify the indexes of the orbitals to save
% * For spin polarized models, combine the up- and down-spin channel orbital 
% indexes in a cell of the form |{ind_up,ind_down}|
% * |'all'| saves all the Kohn-Sham orbitals
% |saveOrbitalTime (sKSOT)|
% Times at which to save the Kohn-Sham orbitals |[ [] (default) | positive scalar 
% | negative integer | vector | 'all' ]|
%% 
% * Empty |saveOrbitalTime| uses the same values as in |time| for when to save 
% the Kohn-Sham orbitals.
% * A positive scalar specifies the sampling time step between successive saving 
% of the Kohn-Sham orbitals. For forward time propagation, it is equivalent to 
% time|(1):saveOrbitalTime:|time|(end)|, and for backward ones to time|(1):-saveOrbitalTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% saving Kohn-Sham orbitals. For forward time propagation, it is equivalent to 
% time|(1):abs(saveOrbitalTime)*||timeStep||:|time|(end)|, and for backward ones 
% to time|(1):-abs(saveOrbitalTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to save the Kohn-Sham orbitals.
% * |'all'| saves the Kohn-Sham orbitals after every time step. Warning: generally 
% discouraged as it likely results in very large memory requirements or cause 
% an out-of-memory error REPLACE_WITH_DASH_DASH see the warning above.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% |saveOrbitalProjection (sKSOP)|
% Whether to save the projection of the Kohn-Sham orbitals onto a specific basis 
% during the TDDFT propagation |[ true | false (default) ]|
% |saveOrbitalProjectionBasis (sKSOPB)|
% Projection basis |[ [] (default) | basis ]|
%% 
% * Empty |saveOrbitalProjectionBasis| uses the initial Kohn-Sham orbitals as 
% the projection basis
% * User-defined |basis| is implementation dependent REPLACE_WITH_DASH_DASH see the respective documentations 
% for details
% |saveOrbitalProjectionIndex (sKSOPI)|
% Index of the Kohn-Sham orbitals for which to perform the projection |[ [] 
% (default) | index vector | cell | 'all' ]|
%% 
% * This is irrelevant if |saveOrbitalProjectionBasis| is |false|
% * Empty |saveOrbitalProjectionIndex| disables saving of the Kohn-Sham orbitals 
% and is technically equivalent to |saveOrbitalProjectionBasis| |= false|
% * For spin restricted models, specify the indexes of the orbitals for which 
% to perform the projection
% * For spin polarized models, combine the up- and down-spin channel orbital 
% indexes in a cell of the form |{ind_up,ind_down}|
% * |'all'| saves the projection for all the Kohn-Sham orbitals
% |saveOrbitalProjectionTime (sKSOPT)|
% Times at which to save the projection of the Kohn-Sham orbitals |[ [] (default) 
% | positive scalar | negative integer | vector | 'all' ]|
%% 
% * Empty |saveOrbitalProjectionTime| uses the same values as in |time| for 
% when to save the projection of the Kohn-Sham orbitals.
% * A positive scalar specifies the sampling time step between successive saving 
% of the Kohn-Sham orbitals' projection. For forward time propagation, it is equivalent 
% to time|(1):saveOrbitalProjectionTime:|time|(end)|, and for backward ones to 
% time|(1):-saveOrbitalProjectionTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% saving Kohn-Sham orbitals' projection. For forward time propagation, it is equivalent 
% to time|(1):abs(saveOrbitalProjectionTime)*||timeStep||:|time|(end)|, and for 
% backward ones to time|(1):-abs(saveOrbitalProjectionTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to save the Kohn-Sham orbitals' 
% projection.
% * |'all'| saves the Kohn-Sham orbitals' projection after every time step. 
% Warning: this may be slow.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% Save output functions of the one-body density and Kohn-Sham orbitals
% |saveOutputFunctionDensity (sFRho)|
% Installable output function of the one-body density |[ [] (default) | function 
% handle ]|
%% 
% * Leave empty to disable the feature
% * Provide a function handle to enable the feature. The signature for the function 
% is |fun(rho,t)| where |rho| is a one-body density object and |t| is the time 
% (scalar). The functiona handle may return an array of arbitrary size and shape, 
% but must return at least a scalar.
% |saveOutputFunctionDensityTime (sFRhoT)|
% Times at which to evaluate and save the installable output function of the 
% one-body density |[ [] (default) | positive scalar | negative integer | vector 
% | 'all' ]|
%% 
% * Empty |saveOutputFunctionDensityTime| uses the same values as in |time| 
% for when to evaluate and save the output function.
% * A positive scalar specifies the sampling time step between successive evaluation 
% and saving of the output function. For forward time propagation, it is equivalent 
% to time|(1):saveOutputFunctionDensityTime:|time|(end)|, and for backward ones 
% to time|(1):-saveOutputFunctionDensityTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% evaluations and saving of the output function. For forward time propagation, 
% it is equivalent to time|(1):abs(saveOutputFunctionDensityTime)*||timeStep||:|time|(end)|, 
% and for backward ones to time|(1):-abs(saveOutputFunctionDensityTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to evaluate and save the output 
% function.
% * |'all'| evaluates and saves the output function after every time step. Warning: 
% this may be slow.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% |saveOutputFunctionOrbital (sFKSO)|
% Installable output function of the Kohn-Sham orbitals |[ [] (default) | function 
% handle ]|
%% 
% * Leave empty to disable the feature
% * Provide a function handle to enable the feature. The signature for the function 
% is |fun(KSO,t)| where |KSO| is a Kohn-Sham orbital object and |t| is the time 
% (scalar). The functiona handle may return an array of arbitrary size and shape, 
% but must return at least a scalar.
% * Warning: The DFT model Kohn-Sham orbitals are passed by reference to the 
% output function. Thus modifying the Kohn-Sham orbitals in the output function 
% will also modify them for the DFT model (and thus TDDFT propagation) and will 
% likely result in erroneous results or produce an error.
% |saveOutputFunctionOrbitalTime (sFKSOT)|
% Times at which to evaluate and save the installable output function of the 
% Kohn-Sham orbitals |[ [] (default) | positive scalar | negative integer | vector 
% | 'all' ]|
%% 
% * Empty |saveOutputFunctionOrbitalTime| uses the same values as in |time| 
% for when to evaluate and save the output function.
% * A positive scalar specifies the sampling time step between successive evaluation 
% and saving of the output function. For forward time propagation, it is equivalent 
% to time|(1):saveOutputFunctionOrbitalTime:|time|(end)|, and for backward ones 
% to time|(1):-saveOutputFunctionOrbitalTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% evaluations and saving of the output function. For forward time propagation, 
% it is equivalent to time|(1):abs(saveOutputFunctionOrbitalTime)*||timeStep||:|time|(end)|, 
% and for backward ones to time|(1):-abs(saveOutputFunctionOrbitalTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to evaluate and save the output 
% function.
% * |'all'| evaluates and saves the output function after every time step. Warning: 
% this may be slow.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% Save restart data file
% During the time propagation, a restart file can be generated to enable resuming 
% the simulation if it is cut short. Stopping the TDDFT simulation while it writes 
% the restart info may lead to a corrupted file from which restart will not be 
% possible. The restart file contains a copy of the TDDFT-propagator and DFT-model 
% objects, respectively called |TDDFT| and |DFT| in the MATLAB restart file.
% |saveRestart (sRest)|
% Activate the generation of a restart file |[ true | false (default) ]|
% |saveRestartFileName (sRestF)|
% Name for the restart file |[ chracter array (default 'QMolGridREPLACE_WITH_DASH_DASHTDDFTREPLACE_WITH_DASH_DASHRestart.mat') 
% ]|
%% 
% * |saveDFTFileName| must be a valid MATLAB file name ('.mat' extension).
% * |saveDFTFileName| is irrelevant when |saveRestart| |== false|
% |saveRestartTime (sRestT)|
% Times at which to generate or update the restart file |[ [] (default) | positive 
% scalar | negative integer | vector | 'all' ]|
%% 
% * Empty |saveRestartTime| uses the same values as in |time| for when to generate 
% and update the restart file.
% * A positive scalar specifies the sampling time step when to generate and 
% update the restart file. For forward time propagation, it is equivalent to time|(1):saveRestartTime:|time|(end)|, 
% and for backward ones to time|(1):-saveRestartTime:|time|(end)|.
% * A negative integer specifies the number of propagation time steps between 
% the generation and update of the restart file. For forward time propagation, 
% it is equivalent to time|(1):abs(saveRestartTime)*||timeStep||:|time|(end)|, 
% and for backward ones to time|(1):-abs(saveRestartTime)*||timeStep||:|time|(end)|.
% * A vector provides user-defined times at which to generate and update the 
% restart file.
% * |'all'| generates and updates the restart file after each time step. Warning: 
% this is very slow and is strongly discouraged.
% * Note: In all cases no restart file is generated for the initial time and 
% final propagation time-step.
% * See the note on how intermediate time saving is performed during the TDDFT 
% propagation below.
% Output results
% During a TDDFT propagation, the results of on-the-fly calculations are strored 
% in structures in the |QMol_TDDFT| object. Note that |QMol_TDDFT| does not interpolate 
% its time propagation to fit user-supplied sample times, Insatead, the results 
% are saved at the closest propagation time steps, excluding duplicate times. 
% This may result in sampled times that are different, or have a different (smaller) 
% number of elements, than the ones specified above. Notably, using a sampling 
% time that is not a multiple of the propagation time step may result in uneven 
% saved time sampling. The actual times at with output are saved is included in 
% each of the output structure.
% 
% In restart mode, each output structure in the |QMol_TDDFT| object contains 
% the fields |ind| and |n|, respectively with the propagation time indexes at 
% which to save the associated results and the next index in |ind| at which saving 
% should be performed. These two fields are removed from each output structure 
% upon completion of the TDDFT propagation.
% |outDFT (oDFT)|
% Support for saving the DFT object into individual MATLAB files during propagation 
% |[ [] (default) | structure ]|
%% 
% * |outDFT| is only relevant during TDDFT time propagation and in restart mode. 
% It is automatically cleared at the end of the propagation.
% |outDipole (oDip)|
% Result of dipole-signal calculations during the TDDFT propagation |[ [] | 
% structure ]|
%% 
% * TDDFT propagation that do not compute the dipole signal (|saveDipole| |= 
% false|) leave |outDipole| empty. Otherwise
% * |outDipole.time| defines the precise times at which the dipole signal is 
% computed
% * |outDipole.total| contains the corresponding total dipole signal and, for 
% spin-polarized DFT models, |outDipole.totalUp| and |outDipole.totalDown| contain 
% the total dipole signal in the up- and down-spin channels respectively, Each 
% successive row contains the dipole signal in the x, y, and z directions, respectively.
% * Orbital-resolved dipole signals are stored in |outDipole.orbital_x|, |outDipole.orbital_y|, 
% |outDipole.orbital_z|, |outDipole.orbitalUp_x|, |outDipole.orbitalUp_y|, |outDipole.orbitalUp_z|, 
% |outDipole.orbitalDown_x|, |outDipole.orbitalDown_y|, and |outDipole.orbitalDown_z|. 
% The indexes of the orbitals associated with each of these are included in |outDipole.indexOrbital|, 
% |outDipole.indexOrbitalUp|, and |outDipole.indexOrbitalDown|
% * In restart mode, |outDipole| also contains a handful of additional fields 
% relevant for run-time calculations. These fields are saved in the MATALB restart 
% file but removed upon completion of the TDDFT propagation.
% |outDipoleVelocity (oVel)|
% Result of dipole-velocity-signal calculations during the TDDFT propagation 
% |[ [] | structure ]|
%% 
% * TDDFT propagation that do not compute the dipole signal (|saveDipoleVelocity| 
% |= false|) leave |outDipoleVelocity| empty. Otherwise
% * |outDipole.time| defines the precise times at which the dipole velocity 
% signal is computed
% * |outDipoleVelocity.total| contains the corresponding total dipole velocity 
% signal and, for spin-polarized DFT models, |outDipoleVelocity.totalUp| and |outDipoleVelocity.totalDown| 
% contain the total dipole velocity signal in the up- and down-spin channels respectively, 
% Each successive row contains the dipole velocity signal in the x, y, and z directions, 
% respectively.
% * Orbital-resolved dipole velocity signals are stored in |outDipoleVelocity.orbital_x|, 
% |outDipoleVelocity.orbital_y|, |outDipoleVelocity.orbital_z|, |outDipoleVelocity.orbitalUp_x|, 
% |outDipoleVelocity.orbitalUp_y|, |outDipoleVelocity.orbitalUp_z|, |outDipoleVelocity.orbitalDown_x|, 
% |outDipoleVelocity.orbitalDown_y|, and |outDipoleVelocity.orbitalDown_z|. The 
% indexes of the orbitals associated with each of these are included in |outDipole.indexOrbital|, 
% |outDipole.indexOrbitalUp|, and |outDipole.indexOrbitalDown|
% * In restart mode, |outDipoleVelocity| also contains a handful of additional 
% fields relevant for run-time calculations. These fields are saved in the MATALB 
% restart file but removed upon completion of the TDDFT propagation.
% |outDipoleAcceleration (oAcc)|
% Result of dipole-acceleration-signal calculations during the TDDFT propagation 
% |[ [] | structure ]|
%% 
% * TDDFT propagation that do not compute the dipole signal (|saveDipoleAcceleration| 
% |= false|) leave |outDipoleAcceleration| empty. Otherwise
% * |outDipoleAcceleration.time| defines the precise times at which the dipole 
% acceleration signal is computed
% * |outDipoleAcceleration.total| contains the corresponding total dipole acceleration 
% signal and, for spin-polarized DFT models, |outDipoleAcceleration.totalUp| and 
% |outDipoleAcceleration.totalDown| contain the total dipole acceleration signal 
% in the up- and down-spin channels respectively, Each successive row contains 
% the dipole acceleration signal in the x, y, and z directions, respectively.
% * Orbital-resolved dipole velocity signals are stored in |outDipoleAcceleration.orbital_x|, 
% |outDipoleAcceleration.orbital_y|, |outDipoleAcceleration.orbital_z|, |outDipoleAcceleration.orbitalUp_x|, 
% |outDipoleAcceleration.orbitalUp_y|, |outDipoleAcceleration.orbitalUp_z|, |outDipoleAcceleration.orbitalDown_x|, 
% |outDipoleAcceleration.orbitalDown_y|, and |outDipoleAcceleration.orbitalDown_z|. 
% The indexes of the orbitals associated with each of these are included in |outDipole.indexOrbital|, 
% |outDipole.indexOrbitalUp|, and |outDipole.indexOrbitalDown|
% * In restart mode, |outDipoleAcceleration| also contains a handful of additional 
% fields relevant for run-time calculations. These fields are saved in the MATALB 
% restart file but removed upon completion of the TDDFT propagation.
% |outEnergyDFT (oEDFT)|
% Result of the DFT-energy calculations during the TDDFT propagation |[ [] | 
% structure ]|
%% 
% * TDDFT propagation that do track the DFT energy (|saveEnergyDFT| |= false|) 
% leave |outEnergyDFT| empty. Otherwise
% * |outEnergyDFT.time| defines the precise times at which the DFT energies 
% are computed
% * |outEnergyDFT.total| contains the total DFT energy, which should be constant 
% (within the precision of the propagation scheme)
% * |outEnergyDFT.kinetic| contains the kinetic-energy component. For spin-polarized 
% models each the two rows contain the up- and down-spin kinetic energy components, 
% respectively
% * |outEnergyDFT.external| contains the external-energy component. For spin-polarized 
% models each the two rows contain the up- and down-spin external energy components, 
% respectively
% * |outEnergyDFT.Hartree| contains the Hartree-energy component. 
% * |outEnergyDFT.exchangeCorrelation| contains the exchange-correlation-energy 
% component. 
% * |outEnergyDFT.externalField| contains the energy contribution from external 
% fields (if any). For spin-polarized models each the two rows contain the up- 
% and down-spin energy components, respectively
% * |outEnergyDFT.autonomization| contains the energy brought in and out of 
% the system by the external driving field (if any).
% * In restart mode, |outEnergyDFT| also contains a handful of additional fields 
% relevant for run-time calculations. These fields are saved in the MATALB restart 
% file but removed upon completion of the TDDFT propagation.
% |outEnergyOrbital (oEKSO)|
% Result of the Kohn-Sham-orbital-energy calculations during the TDDFT propagation 
% |[ [] | structure ]|
%% 
% * TDDFT propagation that do track the DFT energy (|saveEnergyOrbital| |= false|) 
% leave |outEnergyDFT| empty. Otherwise
% * For a Kohn-Sham orbital $|\phi\rangle$, the orbital energy is defined as 
% $\langle\phi|\hat{\mathcal{H}}_{\rm DFT}|\phi\rangle$ with $\hat{\mathcal{H}}_{\rm 
% DFT}$ the DFT Hamiltonian operator.
% * |outEnergyOrbital.time| defines the precise times at which the Kohn-Sham-orbital 
% energies are computed
% * For spin-restricted models, each row of |outEnergyOrbital.orbital| contains 
% the energies of the corresponding Kohn-Sham orbital
% * For spin-polarized models, each row of |outEnergyOrbital.orbitalUp| and 
% |outEnergyOrbital.orbitalDown| contains the energies of the corresponding Kohn-Sham 
% orbital for the up- and down-spin channels, respectively.
% * In restart mode, |outEnergyOrbital| also contains a handful of additional 
% fields relevant for run-time calculations. These fields are saved in the MATALB 
% restart file but removed upon completion of the TDDFT propagation.
% |outIonization (oIon)|
% Result of the ionization calculations during the TDDFT propagation |[ [] | 
% structure ]|
%% 
% * TDDFT propagation that do track ionization (|saveIonization| |= false|) 
% leave |outIonization| empty. Otherwise
% * |outIonization.time| defines the precise times at which the ionization is 
% computed
% * |outIonization.total| contains the total ionization
% * For spin-polarized models, |outIonization.totalUp| and |outIonization.totalDown| 
% contain the total ionization for the up- and down-spin channels, respectively.
% * Orbital-resolved ionization signals are stored in |outIonization.orbital|, 
% |outIonization.orbitalUp|, and |outIonization.orbitalDown|. The indexes of the 
% orbitals associated with each of these are included in |outIonization.indexOrbital|, 
% |outIonization.indexOrbitalUp|, and |outIonization.indexOrbitalDown|
% * In restart mode, |outIonization| also contains a handful of additional fields 
% relevant for run-time calculations. These fields are saved in the MATALB restart 
% file but removed upon completion of the TDDFT propagation.
% |outDensity (oRho)|
% One-body densities during the TDDFT propagation |[ [] | structure ]|
%% 
% * TDDFT propagation that do not save the one-body density (|saveDensity| |= 
% false|) leave |outDensity| empty. Otherwise
% * The specific shape of the saved one-body densities is implementation dependent 
% REPLACE_WITH_DASH_DASH see the corresponding documentation for details. At minimum, each implementation 
% defines
% * |outDensity.time| defines the precise times at which the one-body density 
% is saved
% * |outDensity.total| contains the corresponding one-body densities and, for 
% spin-polarized DFT models, |outDensity.totalUp| and |outDensity.totalDown| contain 
% the one-body densities in the up- and down-spin channels respectively.
% * In restart mode, |outDensity| also contains a handful of additional fields 
% relevant for run-time calculations. These fields are saved in the MATALB restart 
% file but removed upon completion of the TDDFT propagation.
% |outOrbital (oKSO)|
% Kohn-Sham orbitals during the TDDFT propagation |[ [] | structure ]|
%% 
% * TDDFT propagation that do not save the Kohn-Sham orbitals (|saveOrbital| 
% |= false|) leave |outOrbital| empty. Otherwise
% * The specific shape of the saved Kohn-Sham orbitals is implementation dependent 
% REPLACE_WITH_DASH_DASH see the corresponding documentation for details. At minimum, each implementation 
% defines
% * |outOrbital.time| defines the precise times at which the one-body density 
% is saved
% * For spin-restricted models, |outOrbital.orbital| contains the saved Kohn-Sham 
% orbitals and |outOrbital.indexOrbital| the corresponding orbital indexes
% * For spin-polarized models, |outOrbital.orbitalUp| and |outOrbital.orbitalDown| 
% contains the saved Kohn-Sham orbitals for the up- and down-spin channels, respectively, 
% and |outOrbital.indexOrbitalUp| and |outOrbital.indexOrbitalDown| the corresponding 
% orbital indexes
% * In restart mode, |outOrbital| also contains a handful of additional fields 
% relevant for run-time calculations. These fields are saved in the MATALB restart 
% file but removed upon completion of the TDDFT propagation.
% |outOrbitalProjection (oKSOP)|
% Projection of the Kohn-Sham orbitals during the TDDFT propagation |[ [] | 
% structure ]|
%% 
% * TDDFT propagation that do not save the projection of the Kohn-Sham orbitals 
% (|saveOrbitalProjection| |= false|) leave |outOrbitalProjection| empty. Otherwise
% * The specific shape of the saved Kohn-Sham orbitals' projection is implementation 
% dependent REPLACE_WITH_DASH_DASH see the corresponding documentation for details. At minimum, each 
% implementation defines
% * |outOrbitalProjection.time| defines the precise times at which the one-body 
% density is saved
% * For spin-restricted models, |outOrbitalProjection.orbital| contains the 
% saved Kohn-Sham orbitals' projection and |outOrbitalProjection.indexOrbital| 
% the corresponding orbital indexes
% * For spin-polarized models, |outOrbitalProjection.orbitalUp| and |outOrbitalProjection.orbitalDown| 
% contains the saved Kohn-Sham orbitals' projection for the up- and down-spin 
% channels, respectively, and |outOrbitalProjection.indexOrbitalUp| and |outOrbitalProjection.indexOrbitalDown| 
% the corresponding orbital indexes
% * The structure also retains a copy of the projection basis
% * In restart mode, |outOrbitalProjection| also contains a handful of additional 
% fields relevant for run-time calculations. These fields are saved in the MATALB 
% restart file but removed upon completion of the TDDFT propagation.
% |outOutputFunctionDensity (oFRho)|
% Result of the installable output function of the one-body density |[ [] | 
% structure ]|
%% 
% * TDDFT propagation that do not define an installabe output function of the 
% density (|saveOutputFunctionDensity| |= []|) leave |outOutputFunctionDensity| 
% empty. Otherwise
% * |outOutputFunctionDensity.time| defines the precise times at which the result 
% of the output function is saved
% * |outOutputFunctionDensity.result| contains the results of the output functions. 
% If the installable function returns a scalar or a column vector, |outOutputFunctionDensity.result| 
% is a |N-by-numel(outOutputFunctionDensity.time)| matrix with |N| the numer of 
% elements in the output. Otherwise, |outOutputFunctionDensity.result| is an |M-by-numel(outOutputFunctionDensity.time)| 
% array with |M| the size of the output.
% * |outOutputFunctionDensity.shape| contains the shape of the output function 
% (|N| or |M|, as defined in the previous bullet point).
% |outOutputFunctionOrbital (oFKSO)|
% Result of the installable output function of the Kohn-Sham orbitals |[ [] 
% | structure ]|
%% 
% * TDDFT propagation that do not define an installabe output function of the 
% orbitals (|saveOutputFunctionOrbital| |= []|) leave |outOutputFunctionOrbital| 
% empty. Otherwise
% * |outOutputFunctionOrbital.time| defines the precise times at which the result 
% of the output function is saved
% * |outOutputFunctionOrbital.result| contains the results of the output functions. 
% If the installable function returns a scalar or a column vector, |outOutputFunctionOrbital.result| 
% is a |N-by-numel(outOutputFunctionOrbital.time)| matrix with |N| the numer of 
% elements in the output. Otherwise, |outOutputFunctionOrbital.result| is an |M-by-numel(outOutputFunctionOrbital.time)| 
% array with |M| the size of the output.
% * |outOutputFunctionOrbital.shape| contains the shape of the output function 
% (|N| or |M|, as defined in the previous bullet point).
% |outRestart (oRest)|
% Support for enabling restart of the TDDFT propagation |[ [] (default) | structure 
% ]|
%% 
% * |outRestart| is only relevant during TDDFT time propagation and in restart 
% mode. It is automatically cleared at the end of the propagation.
% Other hidden class properties
% |QMol_TDDFT| defines a handful of additional hidden properties used for the 
% time propagation. These properties cannot be edited with the |set| method, nor 
% by any function outisde of the object (|SetAccess=protected| attribute).
% |DFT|
% DFT-model object |[ [] (default) || <./QMol_DFT_spinPol.html |QMol_DFT_spinPol|> 
% |handle object || <./QMol_DFT_spinRes.html |QMol_DFT_spinRes|> |handle object 
% ]|
%% 
% * This is a copy of the <./DFT.html DFT-model> handle object passed to |initialize|. 
% |tspan|
% Propagation time vector |[ [] (default) | vector ]| 
%% 
% * After the class is |initialize|d, it is defined as |uniquetol([obj.||T||(1):obj.||dt||:obj.||T||(end), 
% obj.||T||(end)],1e-10,'DataScale',1)|
% |iref|
% Indexes of |tspan| matching the input time vector |T| |[ [] (default) | index 
% vector ]|
%% 
% * After the class is |initialize|d, it is defined as |getOutputIndex||(||T||)|
% |restart|
% Restart structure |[ [] (default) | restart ]|
%% 
% * Collect all the variables and information required for the restart mode
% * |QMol_TDDFT| uses the following fields (therefore not available for implementation-specific 
% TDDFT propagators overloading the class): |kstart|, |ndisp|, and |idp|
%% Class methods
% Creation
% constructor
% Create a TDDFT-model object with empty class properties.

obj = QMol_TDDFT;
%% 
% Create a TDDFT-model object with the |name| properties set to the specified 
% |value|. Several |name-value| pairs can be specified consecutively. Suitable 
% |name| is any of the TDDFT class properties and is case insensitive.

obj = QMol_TDDFT(name1,value1);
obj = QMol_TDDFT(name1,value1,name2,value2,___);
% Changing class properties
% |set|
% Update the |name| properties of a TDDFT-model object to the specified |value|. 
% Several |name-value| pairs can be specified consecutively. Suitable |name| is 
% any of the TDDFT class properties and is case insensitive. In restart mode, 
% output results structures can also be edited with |set|. |QMol_TDDFT| does not 
% check the integrity of its input/output component during a restart and this 
% feature should only be considered by advanced users.

obj.set(name1,value1);
obj.set(name1,value1,name2,value2,___);
%% 
% This is the common name-value pair assignment method used throughout the QMol-grid 
% package.
% |clear|
% Clear all class properties

obj.clear;
%% 
% Clear a specific set of the class properties. Suitable |name| is any of the 
% TDDFT class properties and is case insensitive.

obj.clear(name1,name2,___);
%% 
% This is the common |clear| method available to all classes throughout the 
% QMol-grid package. The |clear| method can be used to delete specific properties 
% before saving an instance of the |QMol_TDDFT| class.
% Initializing the object
% |QMol_TDDFT| defines a main |initialize| interface (with public access attribute) 
% and a suite of individual initaialization properties (with protected access 
% attributes) for each of the output results.
% |initialize|
% Initialize a TDDFT-model object without allocating the output-result structures

obj.initialize(DFT);
%% 
% * |DFT| is the <./DFT.html DFT-model> handle object, _i.e._, <./QMol_DFT_spinPol.html 
% |QMol_DFT_spinPol|> or <./QMol_DFT_spinRes.html |QMol_DFT_spinRes|>, that describes 
% the DFT systems to propagate.
% * For developers: |initialize| also has a specific interface when called from 
% the |propagate| method that initializes the absorbing boundaries (if any) and 
% determines whether the output-result structures should be initialized too. Overloading 
% classes should avoid redefining |initialize|; If the overloading class needs 
% to perform some initialization (at the beginning of a TDDFT propagation or upon 
% restart), overload the |initializeChildren| method instead.
% |initializeChildren|
% Initialize implementation-specific part of overloading class at the beginning 
% of a TDDFT propagation (from scratch)

obj.initializeChildren(false);
%% 
% * |QMol_TDDFT| calls the |initializeChildren| method after having initialized 
% all its member properties (including the DFT object being propagated).
% * This should not initialize implementation-specific additional output, which 
% are initialized with |setOutputChildren|
%% 
% Initialize implementation-specific part of overloading class in restart mode.

obj.initializeChildren(true);
%% 
% * |QMol_TDDFT| calls the |initializeChildren| method after having reinitialized 
% all its member properties (including the DFT object being propagated).
% * Note that the restart mode does not call |setTimeStep| during the initialization. 
% All relevant time step information should be stored with the class of in the 
% |restart| structure and |initializeChildren| should bring them back to a working 
% configuration.
% |getOutputIndex|
% Get the time-propagation index for when to save a given result.

ind = obj.getOutputIndex(t);
%% 
% * Vector |t = [t_1, t_2, ___ ]|  returns the indexes of the iteration time 
% steps closest to the listed times |t_1|, |t_2|, ... 
% * Scalar |t| > 0 returns the indexes of the iteration time steps closest to 
% the time sampling |time||(1)|, |time||(1)+t|, |time||(1)+2*t|, ... for forward 
% time propagations and |time||(1)|, |time||(1)-t|, |time||(1)-2*t|, ... for backward 
% ones
% * Integer |t| < 0 returns the indexes of the iteration time steps of |time||(1)|, 
% |time||(1)-||timeStep||*t|, |time||(1)-2*||timeStep||*t|, ... for forward time 
% propagations and |time||(1)|, |time||(1)+||timeStep||*t|, |time||(1)+2*||timeStep||*t|, 
% ... for backward ones

ind = obj.getOutputIndex('all');
%% 
% * Returns the indexes associated with all the iteration time steps
% |setOutputChildren|
% Initialize additional output results defined in an specific implementation 
% of the TDDFT propagator (the children class should then overload this method)

obj.setOutputChildren('init');
%% 
% Cleanup the additional output results defined in an specific implementation 
% of the TDDFT propagator at the end of the computation

obj.setOutputChildren('clean');
%% 
% |setOutputChildren| should not be called in restart mode (all relevant parameters 
% should be saved with the QMol_TDDFT object in the restart MATLAB file).
% |setOutputDFT|
% Initialize the |outDFT| structure before running a TDDFT computation

obj.setOutputDFT('init');
%% 
% Cleanup the |outDFT| structure at the end of the TDDFT computation

obj.setOutputDFT('clean');
%% 
% |setOutputDFT| should not be called in restart mode (all relevant parameters 
% should be saved with the QMol_TDDFT object in the restart MATLAB file).
% |setOutputDipole|
% Initialize the |outDipole|, |outDipoleVelocity|, and |outDipoleAcceleration|  
% structures before running a TDDFT computation

obj.setOutputDipole('init');
%% 
% Cleanup the |outDipole|, |outDipoleVelocity|, and |outDipoleAcceleration| 
% structures at the end of the TDDFT computation

obj.setOutputDipole('clean');
%% 
% |setOutputDipole| should not be called in restart mode (all relevant parameters 
% should be saved with the QMol_TDDFT object in the restart MATLAB file).
% |setOutputEnergy|
% Initialize the |outEnergyDFT| and |outEnergyOrbital|  structures before running 
% a TDDFT computation

obj.setOutputEnergy('init');
%% 
% Cleanup the |outEnergyDFT| and |outEnergyOrbital| structures at the end of 
% the TDDFT computation

obj.setOutputEnergy('clean');
%% 
% |setOutputEnergy| should not be called in restart mode (all relevant parameters 
% should be saved with the QMol_TDDFT object in the restart MATLAB file).
% |setOutputFunction|
% Initialize the |outOutputFunctionDensity| and |outOutputFunctionOrbital| structures 
% before running a TDDFT computation

obj.setOutputFunction('init');
%% 
% Cleanup the |outOutputFunctionDensity| and |outOutputFunctionOrbital| structures 
% at the end of the TDDFT computation

obj.setOutputFunction('clean');
%% 
% |setOutputFunction| should not be called in restart mode (all relevant parameters 
% should be saved with the QMol_TDDFT object in the restart MATLAB file).
% |setOutputIonization|
% Initialize the |outIonization| structure before running a TDDFT computation

obj.setOutputIonization('init');
%% 
% Cleanup the |outIonization| structure at the end of the TDDFT computation

obj.setOutputIonization('clean');
%% 
% |setOutputIonization| should not be called in restart mode (all relevant parameters 
% should be saved with the QMol_TDDFT object in the restart MATLAB file).
% |setOutputOrbitalDensity|
% Initialize the |outDensity|, |outOrbital|, and |outOrbitalProjection| structures 
% before running a TDDFT computation

obj.setOutputOrbitalDensity('init');
%% 
% Cleanup the |outDensity|, |outOrbital|, and |outOrbitalProjection| structures 
% at the end of the TDDFT computation

obj.setOutputOrbitalDensity('clean');
%% 
% |setOutputOrbitalDensity| should not be called in restart mode (all relevant 
% parameters should be saved with the QMol_TDDFT object in the restart MATLAB 
% file).
% 
% |setOutputOrbitalDensity| is implementation dependent and must be defined 
% by each overloading TDDFT propagation classes REPLACE_WITH_DASH_DASH see the required signature 
% and behavior below.
% |setOutputRestart|
% Initialize the |outRestart| structure before running a TDDFT computation

obj.setOutputRestart('init');
%% 
% Cleanup the |outRestart| structure and delete the restart file at the end 
% of the TDDFT computation

obj.setOutputRestart('clean');
%% 
% |setOutputRestart| should not be called in restart mode (all relevant parameters 
% should be saved with the QMol_TDDFT object in the restart MATLAB file).
% |finalize|
% At the end of a TDDFT propagation, performs the appropriate finalization, 
% including cleanup of the output structures.

obj.finalize;
%% 
% * This calls the |'clean'| mode for |setOutputChildren|, |setOutputDFT|, |setOutputDipole|, 
% |setOutputEnergy|, |setOutputIonization|, |setOutputOrbitalDensity|, |setOutputFunction|, 
% and |setOutputRestart|.
% Run-time documentation
% |getMemoryProfile|
% Get an estimate of the memory help by a |QMol_TDDFT| object with either

mem = obj.getMemoryProfile;
mem = obj.getMemoryProfile(false);
%% 
% * The object must be |initialize|d for the memory footprint evaluation. If 
% not arleady, |getMemoryProfile| initializes the |DFT| model object.
% * The estimate includes (1) |DFT| model, (2) TDDFT propagator, and (3) output 
% results. Note that all these components may not be used in actual simulations 
% and the memory estimate tries to be conservative. On the other hand, it only 
% includes the discretization of member components on the domain grid and ignores 
% other (small) properties.
% * The output |mem| is the estimated size in bytes.
%% 
% Additionally display the detail of the memory footprint with

mem = obj.getMemoryProfile(true);
% |showDocumentation|
% Display the run-time documentation for the specific configuration of a |QMol_TDDFT| 
% object, wich must have been |initialize|d beforehand

obj.showDocumentation;
%% 
% The run-time documentation performs the following steps
%% 
% * Display the QMol-grid package header (showing the kernel, external component 
% versions)
% * Call the TDDFT-propagator implementation-specific run-time documentation 
% with the propety |showDoc|.
% * Display the time-propagation information
% * Display the list of output calculated and saved during the TDDFT propagation
% * Display the bibliography associated with the list of cited references (from 
% the previous steps)
% * Display the funding information
% * Display the QMol-grid package footer
% TDDFT propagation
% |propagate|
% Propagate the TDDFT dynamics starting from a DFT model object (from scratch)

obj.propagate(DFT);
%% 
% * |DFT| is the <./DFT.html DFT-model> handle object, _i.e._, <./QMol_DFT_spinPol.html 
% |QMol_DFT_spinPol|> or <./QMol_DFT_spinRes.html |QMol_DFT_spinRes|>, that describes 
% the DFT systems to propagate.
%% 
% Restart a TDDFT propagation

obj.propagate('restart');
% |saveOutputDFT|
% Trigger the saving of the DFT object into a separate MATLAB file

obj.saveOutputDFT(obj,t);
%% 
% * |t| is the current time when the saving is performed
% * Each output file contains |DFT| (DFT-model object), |t| (current time), 
% and |externalField| (external field object)
% * For developers: |saveOutputDFT| is also responsible for updating the counter 
% |obj.oDFT.n| when it is called
% |setOutputEnergy|
% Trigger the saving of the DFT and Kohn-Sham orbital energies

obj.saveOutputEnergy(k,t);
%% 
% * |k| is the current time-propagation step index
% * |t| is the current time when the saving is performed
% * If requested, the DFT energy calls getExternalFieldEnergy to get the contribution 
% from any external field and autonomization variable
% |saveOutputFunction|
% Trigger the computation and saving of the installable output functions

obj.saveOutputFunction(obj,k,t);
%% 
% * |k| is the current time-propagation step index
% * |t| is the current time when the saving is performed
% * For developers: saveOutputFunction is also responsible for updating the 
% counter |obj.oFRho.n| and |obj.oFKSO.n| when it is called
%% Overloading the class
% |QMol_TDDFT| is an abstract class and only define the common steps and features 
% for all TDDFT propagators. Implementation-specific propagators must define specific 
% methods and additional optional methods overload
% Methods that must be overloaded
% To define a specific implementation of a TDDFT propagation scheme, overloading 
% classes must define the following methods with the specified signature and attributes
% |propertyNames|
% To enable name-value pair constructor, name-value pair |set|, and the |clear| 
% methods

methods (Static=true,Access=?QMol_suite)
function [ClassName,PropNames] = propertyNames()
%propertyNames returns the names of member properties that can be set
%   through name-value assignment
    
    % Parent-class components
    [~,PropNames]       =   QMol_TDDFT.propertyNames;

    ClassName           =   'QMol_child_class';
    PropNames           =   [PropNames,{'property1','property2'}];
end
end
% |showDoc|
% Display the run-time documentation for the specific implementation of the 
% molecular potential.

methods (Access=?QMol_DFT)
function ref = showDoc(obj)
%showDoc displays the documentation reflecting the specific implementation
%   of the TDDFT propagator
    
    % Add specific documentation here

end
end
%% 
% * If no reference is cited, return |ref = {}| otherwise |ref = {'ref 1','ref 
% 2',___}|, where each of the |ref| corresponds to the bibliographic code for 
% the reference (generally of the form |'name_of_first_author publication_year'|) 
% and is case insensitive REPLACE_WITH_DASH_DASH see the <./Documentation.html documentation page> 
% for a list of citable references.
% * Note that only implementation-specific properties should be covered here. 
% All properties common to all TDDFT propagators (e.g., time step) are handled 
% in the parent |QMol_TDDFT| class run-time documentation.
% * Only document the TDDFT propagator. Is additional ouput are implemented, 
% document those with the |docOutputChildren| method
% |setOutputOrbitalDensity|
% Initialize the |outDensity|, |outOrbital|, and |outOrbitalProjection| structures 
% before running a TDDFT computation and clean them up at the end of the computation. 
% The method should have the following signature and features

methods (Access=protected)
function setOutputOrbitalDensity(obj,opt)
%setOutputOrbitalDensity

switch lower(opt)
case {'init','initialize','initialization'} %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    % Clean up any old data ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    obj.oRho            =   [];
    obj.oKSO            =   [];
    obj.oKSOP           =   [];
    
    % One-body density ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    if obj.sRho
        % When to save the DFT energies
        obj.oRho.ind    =   [obj.getOutputIndex(obj.sRhoT),NaN];
        obj.oRho.time   =   obj.tspan(obj.oRho.ind(1:end-1));
        obj.oRho.n      =   1;

        % Density output initialization
    else
        obj.oRho.ind    =   NaN;
        obj.oRho.n      =   1;
    end
    
    % Kohn-Sham orbitals ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    if obj.sKSO
        % When to save the DFT energies
        obj.oKSO.ind    =   [obj.getOutputIndex(obj.sKSOT),NaN];
        obj.oKSO.time   =   obj.tspan(obj.oKSO.ind(1:end-1));
        obj.oKSO.n      =   1;

        % Kohn-Sham orbitals output initialization
    else
        obj.oKSO.ind    =   NaN;
        obj.oKSO.n      =   1;
    end
    
    % Kohn-Sham orbitals' projection ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    if obj.sKSOP
        % When to save the DFT energies
        obj.oKSOP.ind   =   [obj.getOutputIndex(obj.sKSOPT),NaN];
        obj.oKSOP.time  =   obj.tspan(obj.oKSOP.ind(1:end-1));
        obj.oKSOP.n     =   1;

        % Kohn-Sham orbitals' projection output initialization
    else
        obj.oKSOP.ind   =   NaN;
        obj.oKSOP.n     =   1;
    end
    
case {'clean','finalize','finalization'} %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    obj.oRho            =   rmfield(obj.oRho,{'ind','n'});
    obj.oKSO            =   rmfield(obj.oKSO,{'ind','n'});
    obj.oKSOP           =   rmfield(obj.oKSOP,{'ind','n'});

otherwise %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % Unexpected option
    error('QMol:TDDFT:setOutputOrbitalDensity',['Unknown option ' opt]);
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
end
end
%% 
% At minimum, the method should initialize
%% 
% * In |obj.oRho|, |outDensity.total|, |outDensity.totalUp| and |outDensity.totalDown| 
% * in |obj.sKSO|, |outOrbital.orbital|, |outOrbital.indexOrbital|, |outOrbital.orbitalUp|, 
% |outOrbital.orbitalDown|, |outOrbital.indexOrbitalUp|, and |outOrbital.indexOrbitalDown|
% * In |obj.sKSOP|, |outOrbital.orbital|, |outOrbital.indexOrbital|, |outOrbital.orbitalUp|, 
% |outOrbital.orbitalDown|, |outOrbital.indexOrbitalUp|, and |outOrbital.indexOrbitalDown|. 
% The structure should also retain a copy of the projection basis.
% |setTimeStep|
% (Re)set the time step to be used in the TDDFT propagation

methods (Access=protected)
function setTimeStep(obj,dt,t)
%setTimeStep
    
    % Perform the proper (re)initialization 

end
end
%% 
% * |dt| is the value of the time step to be used and |t| the current time. 
% Impementation-specific TDDFT propagators will often need to keep a copy of |dt| 
% (as it may vady from |timeStep|).
% * |setTimeStep| is called at the very beginning of the TDDFT propagation and
% * |setTimeStep| may also be called before performing the last iteration if 
% a rescaling is required to reach the requested final time
% |applyTimeStep|
% Propagate the TDDFT dynamics for exactly one time step

methods (Access=protected)
function applyTimeStep(obj,t)
%setTimeStep
    
    % Perform the time propagation

end
end
%% 
% * |t| is the current time, from which to perform the one-time-step propagation
% |saveOutputDipole|
% Save the dipole, dipole velocity, and/or dipole acceleration signal

methods (Access=protected)
function saveOutputDipole(obj,k,t)
%setTimeStep
    
    % Save the dipole signal
    if k == obj.oDip.ind(obj.oDip.n)
        % Total dipole

        % Orbital-resolved dipole (if any)
        
        % Add external field
        if obj.sEF,         obj.addOutputExternalField('oDip',k,t);         end

        % Update counter
        obj.oDip.n      =   obj.oDip.n + 1;
    end
    
    % Save the dipole-velocity signal
    if k == obj.oVel.ind(obj.oVel.n)
        % Total dipole velocity

        % Orbital-resolved dipole velocity (if any)
        
        % Add external field
        if obj.sEF,         obj.addOutputExternalField('oVel',k,t);         end

        % Update counter
        obj.oVel.n      =   obj.oVel.n + 1;
    end
    
    % Save the dipole acceleration signal
    if k == obj.oAcc.ind(obj.oAcc.n)
        % Total dipole acceleration

        % Orbital-resolved dipole acceleration (if any)
        
        % Add external field
        if obj.sEF,         obj.addOutputExternalField('oAcc',k,t);         end

        % Update counter
        obj.oAcc.n      =   obj.oAcc.n + 1;
    end

end
end
%% 
% * |saveOutputDipole| is called is any of the dipole, dipole velocity, or dipole 
% acceleration needs to be computed and saved. It must therefore determine which 
% one(s) actually need to be.
% * |saveOutputDipole| is also responsible for updating the counters in |obj.oDip|, 
% |obj.oVel| and |obj.oAcc| (see their respective documentation entry for the 
% name convention in what/how each should be saved).
% |getExternalFieldEnergy|
% Compute the contributions from any external field and autonomization variable

methods (Access=protected)
function [E,DE] = getExternalFieldEnergy(obj,t)
%getExternalFieldEnergy 
    
    % External field energy

    % Autonomization variable

end
end
%% 
% * |E| is the contribution to the DFT-functional energy from any external field. 
% For spin-polarized models, it is a 2-vector with the up- and down-spin energy 
% contributions, respectively. If not field is applied, or it does not contribute 
% an explicit terms to the DFT energy (_e.g._, velocity Gauge dipole approximation), 
% return |E = [0;0]|
% * |DE| is the autonomization energy variable, which tracks how mucg energy 
% is put into or withdrawn from the DFT system
% * The |DFT| object contains an accurate one-body density
% |saveOutputIonization|
% Compute the ionization statistics

methods (Access=protected)
function saveOutputIonization(obj,k,t)
%saveOutputIonization 
    
    % Total ionization signal

    % Orbital-resolved ionization signal
        
    % Add external field
    if obj.sEF,         obj.addOutputExternalField('oIon',k,t);         end


    % Update counter
    obj.oIon.n      =   obj.oIon.n + 1;

end
end
%% 
% * |saveOutputIonization| is also responsible for updating the counters in 
% |obj.oIon| (see the documentation entry for the name convention in what/how 
% each should be saved).
% |saveOutputOrbitalDensity|
% Save the Kohn-Sham orbitals (projection) and one-body density

methods (Access=protected)
function saveOutputOrbitalDensity(obj,k,t)
%setTimeStep
    
    % Save Kohn-Sham orbitals
    if k == obj.oKSO.ind(obj.oKSO.n)
        % Kohn-Sham orbitals
        
        % Add external field
        if obj.sEF,         obj.addOutputExternalField('oKSO',k,t);         end

        % Update counter
        obj.oKSO.n      =   obj.oKSO.n + 1;
    end
    
    % Save the projection of the Kohn-Sham orbitals
    if k == obj.oKSOP.ind(obj.oKSOP.n)
        % Kohn-Sham orbitals' projection
        
        % Add external field
        if obj.sEF,         obj.addOutputExternalField('oKSOP',k,t);        end

        % Update counter
        obj.oKSOP.n     =   obj.oKSOP.n + 1;
    end
    
    % Save the one-body density
    if k == obj.oRho.ind(obj.oRho.n)
        % One-body density
        
        % Add external field
        if obj.sEF,         obj.addOutputExternalField('oRho',k,t);         end

        % Update counter
        obj.oRho.n      =   obj.oRho.n + 1;
    end

end
end
%% 
% * |saveOutputOrbitalDensity| is called is any of the Kohn-Sham orbitals, their 
% projection, or one-body density needs to be saved. It must therefore determine 
% which one(s) actually need to be.
% * |saveOutputOrbitalDensity| is also responsible for updating the counters 
% in |obj.oKSO|, |obj.oKSOP| and |obj.oRho| (see their respective documentation 
% entry for the name convention in what/how each should be saved).
% Additional optional methods to overload
% |getMemoryProfilePropagator|
% Estimate the memory footprint of the implementation-specific part of the TDDFT 
% propagator

methods (Access=protected)
function mem = getMemoryProfilePropagator(obj,opt)
%getMemoryProfilePropagator 
    
    % Initialization
    if nargin < 2,  opt     =   false;  end

    % Estimate of the memory footprint

end
end
%% 
% * Use <./QMol_DFT_profiler.html |QMol_DFT_profiler|>|.showMemoryFootprint| 
% to display the memory foorprint of the propagator's components (when |opt == 
% true|)
% * |getMemoryProfilePropagator| should only list the memory footprint of the 
% propagation part of the implementation-specific class. Estimate of the memory 
% footprint for the output results is handled with the |getMemoryProfileOrbitalDensity| 
% and |getMemoryProfileChildren| properties.
% * The |DFT| object is initialized when |getMemoryProfilePropagator| is called
% |getMemoryProfileOrbitalDensity|
% Estimate the memory footprint for saving of the Kohn-Sham orbitals and one-body 
% density in the implementation-specific TDDFT propagator

methods (Access=protected)
function mem = getMemoryProfileOrbitalDensity(obj,opt)
%getMemoryProfileOrbitalDensity
    
    % Initialization
    if nargin < 2,  opt     =   false;  end

    % Estimate of the memory footprint

end
end
%% 
% * Use <./QMol_DFT_profiler.html |QMol_DFT_profiler|>|.showMemoryFootprint| 
% to display the memory foorprint of saving the Kohn-Sham orbitals ans/or one-body 
% density (when |opt == true|)
% * |getMemoryProfileOrbitalDensity| should only list the memory footprint of 
% the requested Kohn-Sham orbitals and/or one-body density. Estimate of the memory 
% footprint for any additional implementation-specific output results with |getMemoryProfileChildren|.
% * The |DFT| object is initialized when |getMemoryProfileOrbitalDensity| is 
% called
% |getMemoryProfileChildren|
% Estimate the memory footprint of additional output defined by the implementation-specific 
% part of the TDDFT propagator

methods (Access=protected)
function mem = getMemoryProfileChildren(obj,opt)
%getMemoryProfilePropagator 
    
    % Initialization
    if nargin < 2,  opt     =   false;  end

    % Estimate of the memory footprint

end
end
%% 
% * Use <./QMol_DFT_profiler.html |QMol_DFT_profiler|>|.showMemoryFootprint| 
% to display the memory foorprint of the additional outputs (when |opt == true|)
% * |getMemoryProfileChildren| should only list the memory footprint of additional 
% output defined by the implementation-specific TDDFT propagator. Estimate of 
% the memory footprint for the Kohn-Sham orbitals and one-body density output 
% results is handled with |getMemoryProfileOrbitalDensity|
% * The |DFT| object is initialized when |getMemoryProfileChildren| is called
% |docOutputChildren|
% Run-time documentation for additional implementation-specific output variables

methods (Access=protected)
function ref = docOutputChildren(obj)
%docOutputChildren 
    
    % Add specific documentation

end
end
%% 
% * If no reference is cited, return |ref = {}| otherwise |ref = {'ref 1','ref 
% 2',___}|, where each of the |ref| corresponds to the bibliographic code for 
% the reference (generally of the form |'name_of_first_author publication_year'|) 
% and is case insensitive REPLACE_WITH_DASH_DASH see the <./Documentation.html documentation page> 
% for a list of citable references.
% * For consistency with the other output available to all TDDFT propagators, 
% only list the additional output that are being calculated during the TDDFT propagation 
% (following user-defined properties).
% * Only implementation-specific additional properties should be covered here. 
% All properties common to all TDDFT propagators (e.g., time step) are handled 
% in the parent |QMol_TDDFT| class run-time documentation.
% * Run-time documentation for the implementation-specific TDDFT propagator 
% is handled with |showDoc| and therefore should not be included here.
% |setOutputChildren|
% Implementation-specific TDDFT propagation classes that overload QMol_TDDFT 
% may define additional run-time results to save during the propagation. Those 
% are initialized with the |setOutputChildren| method with the following signature 
% (see also the example above for a more fleshed out template)

methods (Access=protected)
function setOutputChildren(obj,opt)
%setOutputChildren
switch lower(opt)
case {'init','initialize','initialization'} %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    % Clean up any old data ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    
    % Initialize output structure(s) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    
case {'clean','finalize','finalization'} %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % Clean output structures at the end of the TDDFT propagation

otherwise %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % Unexpected option
    error('QMol:TDDFT:setOutputChildren',['Unknown option ' opt]);
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
end
end
% |setOutputExternalField|
% Enable saving of the external-field information in a given output structure

methods (Access=protected)
function setOutputExternalField(obj,structName,opt)
%setOutputExternalField
switch lower(opt)
case {'init','initialize','initialization'} %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    % Add proper field for external field information
    
case {'clean','finalize','finalization'} %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % Clean output structures at the end of the TDDFT propagation
    % (for the external-field information only)

otherwise %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % Unexpected option
    error('QMol:TDDFT:setOutputExternalField',['Unknown option ' opt]);
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
end
end
%% 
% * |setOutputExternalField| is called in the initialization and cleanup of 
% each of the |setOutputDipole|, |setOutputEnergy|, |setOutputFunction|, |setOutputIonization|, 
% and |setOutputOrbitalDensity|
% * |structName| is the name of the output structure to which the external field 
% info are to be initialized. |obj.(structName)| gives access to the corresponding 
% property in the class.
% |setRestartChildren|
% Perform the necessary initialization of the implementation-specific TDDFT 
% propagator in restart mode 

methods (Access=protected)
function setRestartChildren(obj)
%setRestartChildren
    
    % Initialize upon restart
end
end
%% 
% * |setRestartChildren| is called after the QMol_TDDFT has performed its own 
% reinitialization, notably |DFT| object has been initialized 
% |saveOutputChildren|
% Save additional implementation-specific output

methods (Access=protected)
function saveOutputChildren(obj,k,t)
%saveOutputChildren
    
    % Save additional output
end
end
%% 
% * |k| is the current time-propagation step index
% * |t| is the current time when the saving is performed
% * |saveOutputChildren| is called for every time step (including the starting 
% and final times) of the TDDFT propagation. The class is responsible for checking 
% which additional data must be saved, if any, and doing the actual saving.
% |addOutputExternalField|
% Adds the external-field information to a given output structure

methods (Access=protected)
function addOutputExternalField(obj,structName,k,t)
%addOutputExternalField

    % Add external-field information to output structure
end
end
%% 
% * addOutputExternalField is called by |saveOutputDipole|, |saveOutputEnergy|, 
% |saveOutputFunction|, |saveOutputIonization|, and |saveOutputOrbitalDensity|
% * |structName| is the name of the output structure to which the external field 
% info are to be saved. |obj.(structName)| gives access to the corresponding property 
% in the class.
% * |k| is the current time-propagation step index
% * |t| is the current time when the saving is performed
% |saveRestartChildren|
% Save implementation-specific info needed for restarting a TDDFT calculation 
% to the |restart| structure

methods (Access=protected)
function saveRestartChildren(obj,k,t)
%saveOutputChildren
    
    % Save additional output
end
end
%% 
% * |k| is the current time-propagation step index
% * |t| is the current time when the saving is performed
% * |saveRestartChildren| is called at the end of a time-step propagation (and 
% the index |k| and time |t| have been updated accordingly before calling the 
% function)
%% Bourdary absorber
% TDDFT propagators support both mask and complex absorbing bondary conditions. 
% The template for absorbing boundayr classes is

classdef QMol_DFT_absorber < QMol_suite
%QMol_DFT_absorber 

%% Documentation %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
methods (Static,Access=private)
function version
    QMol_doc.showVersion('##.##.###','##/##/####','Author Name')
end
end
methods (Static,Access={?QMol_doc,?QMol_DFT_absorber})
function showInfo
    fprintf( '  * QMol_DFT_absorber:\n');
    fprintf(['      > Absorbing boundaries\n',...
             '      > Type of absorber\n']); 
    QMol_DFT_absorber.version;
end
end
methods (Access=public)
function ref = showDocumentation(obj)
%showDocumentation displays the documentation reflecting member property 
%   values
    
    % Initialization
    ref                 =   {};

    % Header
    fprintf('  * Absorbing boundaries                                  type of absorber\n');

    % Details of the absorber

    % Version
    obj.version;

end
function mem = getMemoryProfile(obj,opt)
%getMemoryProfile computes and returns an estimate of the total memory
%   footprint (in bytes) of the absorber with all its components
%   initialized and used.
    
    % Initialization
    if nargin < 2,  opt =   false;  end

    % Evaluate (and display) estimate of memory footprint

end
end
%% Properties %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
properties (Transient,Hidden,GetAccess=?QMol_suite,SetAccess={?QMol_DFT_absorber,?QMol_DFT})
    % Linked objects
    DFT                             % DFT.disc always defines the domain
end
    % Other properties of the class

%% Alias handling %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % Mapping between user-facing long variable names and internal's short

%% Initialization %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
methods (Access=public)
function reset(obj)
%reset clears all temporary (transient) properties of the object. Should be
%   overloaded by each subclasses to perform proper reset actions.
    
    % Run-time variables
    obj.DFT             =   [];
    
    % Initialization status
    obj.isInit          =   false;
end
function initialize(obj,DFT,isFwd)
%initialize initializes the object

    % Initialization
    obj.reset;
    
    % Set links
    obj.DFT             =   DFT;

    % Initialize the absorber
    
    % Miscellaneous
    obj.isInit          =   true;

end
end
methods (Static=true,Access=?QMol_suite)
function [ClassName,PropNames] = propertyNames()
%propertyNames returns the names of member properties that can be set
%   through name-value assignment
    
    ClassName           =   'QMol_DFT_absorber';
    PropNames           =   {};
end
end
%% Absorber %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
methods (Access=public)
    applyMask(obj,KSO)
    V = getPotential(obj,V)
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
end
%% 
% * Upon initialization, the class shoud retain a copy of the |DFT| object with 
% the access-right signature specified above (required for memory profiling)
% * In the |initialize| method, |isFwd| indicates whether the TDDFT propagation 
% is is a forward (|true|) or backward (|false|) in time (to adjust the sign of 
% the CAP)
% Mask function
% Mask absorbers correspond to a given mask function that is multipled to the 
% Kohn-Sham orbitals after each propagation time step. Their signature is

function applyMask(obj,KSO)
%applyMask
    
    % Multiply the orbitals in KSO by the mask
end
function V = getPotential(~,V)
%getPotential no complex potential, return the object untouched

end
%% 
% * Even when no complex absorbing potential is defined, |getPotential| must 
% still be defined, leaving the input DFT potential untouched
% Complex absorbing potential (CAP)
% Complex absorbing potentials correspond to an imaginary component added to 
% the DFT potential that dampen the Kohn-Sham orbitals at the boundaries. Their 
% signature is

function applyMask(~,~)
%applyMask no mask applied, do nothing

end
function V = getPotential(obj,V)
%getPotential

    % Add the complex potential to the DFT-potential object V

end
%% 
% * Even when no mask is defined, |applyMask| must still be defined, doing nothing
% * V is a compatible DFT potential; use its |add| property to add the CAP
%% Test suite
% For consistency with the rest of the QMol-grid package, |QMol_DFT| defines 
% an associated test suite. Run the test suite for the class in normal or <./Test_suite.html 
% summary mode> respectively with

QMol_test.test('TDDFT');
QMol_test.test('-summary','TDDFT');
%% 
% See <./QMol_test.html |QMol_test|> for details regarding how to create a test 
% suite for new classes.
%% Notes
%% 
% * |QMol_TDDFT| was intorduced in version 01.00 but version 01.10 drastically 
% redesigned its interface and supported features
% * |getMemoryProfile| was introduced in version 01.10
##### SOURCE END #####
-->
</div></body></html>