<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2025a"><title>QMol_CI_conv</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 25px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S3 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-size: 14px;  }
.S4 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.S5 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 20.4px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.S6 { margin: 10px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 15px; font-weight: 700; text-align: left;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block; min-width: 100%; }
.S7 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0.666667px solid rgb(217, 217, 217); border-bottom: 0.666667px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S9 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0.666667px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S10 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0.666667px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S11 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S12 { border-left: 0px none rgb(33, 33, 33); border-right: 0px none rgb(33, 33, 33); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px; line-height: 15.6px; min-height: 16px; white-space: pre; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span style=' font-family: monospace;'>QMol_CI_conv</span></h1><div  class = 'S1'><span>CI model, using an explicit convolution scheme to calculate the electron-electron repulsion integrals.</span></div><div  class = 'S1'><span style=' font-style: italic; text-decoration: underline;'>Warning:</span><span style=' font-style: italic;'> </span><span style=' font-style: italic; font-family: monospace;'>QMol_CI_conv</span><span style=' font-style: italic;'> is a new feature of the QMol-grid package, and has not been fully tested and benchmarked.</span></div><h2  class = 'S2'><span>Description</span></h2><div  class = 'S1'><span>Use </span><span style=' font-family: monospace;'>QMol_CI_conv</span><span> to describe a configuration-interaction (CI) model associated with a spin-restricted set of orbitals, typically obtained via a </span><a href = "./DFT.html"><span>density-functional theory (DFT)</span></a><span> or </span><a href = "./HF.html"><span>Hartree-Fock (HF)</span></a><span> ground state calculation. The class also provides functionalities for calculating the CI matrix and its associated ground- and excited-state wave functions, as well as the dipole-coupling matrix.</span></div><h2  class = 'S2'><span>Class at a glance</span></h2><div  class = 'S1'><span style=' font-weight: bold;'>Editable properties:</span></div><ul  class = 'S3'><li  class = 'S4'><span>Domain discretization: </span><a href = "#H_6EFEF984"><span style=' font-family: monospace;'>discretization</span></a><span>, </span><a href = "#H_3CD5E6FD"><span style=' font-family: monospace;'>xspan</span></a></li><li  class = 'S4'><span>Electronic structure: </span><a href = "#H_25FA49BA"><span style=' font-family: monospace;'>numberElectron</span></a><span>, </span><a href = "#M_1F9482EA"><span style=' font-family: monospace;'>orbitalBasis</span></a><span>, </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span>, </span><a href = "#H_241A5E49"><span style=' font-family: monospace;'>waveFunction</span></a></li><li  class = 'S4'><span>Potential: </span><a href = "#H_8D5C5371"><span style=' font-family: monospace;'>externalPotential</span></a><span>, </span><a href = "#H_C9D9F4E3"><span style=' font-family: monospace;'>interactionPotential</span></a></li><li  class = 'S4'><span>CI calculation: </span><a href = "#H_CFCAE00D"><span style=' font-family: monospace;'>display</span></a><span>, </span><a href = "#H_BF9CB463"><span style=' font-family: monospace;'>tolerance</span></a><span>, </span><a href = "#H_DF90D098"><span style=' font-family: monospace;'>CImatrix</span></a><span>, </span><a href = "#H_0F7B48EA"><span style=' font-family: monospace;'>DXmatrix</span></a><span>, </span><a href = "#H_5B0C4647"><span style=' font-family: monospace;'>isDipole</span></a></li><li  class = 'S4'><span>Configuration basis: </span><a href = "#H_19D8F0C2"><span style=' font-family: monospace;'>type</span></a><span>, </span><a href = "#H_C361E917"><span style=' font-family: monospace;'>reference</span></a><span>, </span><a href = "#H_7A72D8B8"><span style=' font-family: monospace;'>active</span></a><span>, </span><a href = "#H_8362394D"><span style=' font-family: monospace;'>frozen</span></a><span>, </span><a href = "#H_28F24796"><span style=' font-family: monospace;'>noDouble</span></a><span>, </span><a href = "#H_15255EE0"><span style=' font-family: monospace;'>noEmpty</span></a></li></ul><div  class = 'S1'><span style=' font-weight: bold;'>Uneditable properties (read only):</span></div><ul  class = 'S3'><li  class = 'S4'><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span>, </span><a href = "#H_C672E0F8"><span style=' font-family: monospace;'>isSetConfigBasis</span></a><span>, </span><a href = "#H_81B294E3"><span style=' font-family: monospace;'>isSpinPol</span></a><span>, </span><a href = "#H_9057FE3F"><span style=' font-family: monospace;'>dim</span></a></li></ul><div  class = 'S1'><span style=' font-weight: bold;'>Methods: </span></div><ul  class = 'S3'><li  class = 'S4'><span>Changing class properties: </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span>, </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span>, </span><a href = "#H_C729A888"><span style=' font-family: monospace;'>clear</span></a></li><li  class = 'S4'><span>Initialization: </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>, </span><a href = "#H_283B85DD"><span style=' font-family: monospace;'>setConfigurationBasis</span></a><span>, </span><a href = "#H_E576F5B1"><span style=' font-family: monospace;'>cleanConfigurationBasis</span></a></li><li  class = 'S4'><span>Run-time documentation: </span><a href = "#H_4D7CFC3D"><span style=' font-family: monospace;'>showDocumentation</span></a><span>, </span><a href = "#H_E3988947"><span style=' font-family: monospace;'>getMemoryProfile</span></a></li><li  class = 'S4'><span>CI calculation: </span><a href = "#H_17C8E8B2"><span style=' font-family: monospace;'>computeCImatrix</span></a><span>, </span><a href = "#H_0C1CE1B9"><span style=' font-family: monospace;'>sparsify</span></a><span>, </span><a href = "#H_CE83FED1"><span style=' font-family: monospace;'>computeGroundState</span></a><span>, </span><a href = "#H_E7462FAD"><span style=' font-family: monospace;'>getEnergy</span></a><span>, </span><a href = "#H_853C5373"><span style=' font-family: monospace;'>showEnergy</span></a><span>, </span><a href = "#H_809EA2C9"><span style=' font-family: monospace;'>analyzeCIspectrum</span></a></li><li  class = 'S4'><span>Density: </span><a href = "#M_828CCEBA"><span style=' font-family: monospace;'>getDensityMatrix</span></a><span>, </span><a href = "#H_C85EDB6F"><span style=' font-family: monospace;'>getDensity</span></a></li></ul><div  class = 'S1'><span style=' font-weight: bold;'>Jump to </span><a href = "#H_B96E4244"><span style=' font-weight: bold;'>examples</span></a></div><h2  class = 'S2'><span>Class properties</span></h2><h3  class = 'S5' id = 'H_27AB3DA4' ><span>CI model</span></h3><div  class = 'S1'><span>The </span><span style=' font-family: monospace;'>QMol_CI_conv</span><span> class defines the following public get-access properties for CI calculation; each can be changed using the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method:</span></div><h4  class = 'S6' id = 'H_6EFEF984' ><span style=' font-family: monospace;'>discretization (disc)</span></h4><div  class = 'S1'><a href = "./Discretization.html"><span>Domain discretization</span></a><span> object </span><span style=' font-family: monospace;'>[ handle object (default []) ]</span></div><h4  class = 'S6' id = 'H_3CD5E6FD' ><span style=' font-family: monospace;'>xspan (x)</span></h4><div  class = 'S1'><span>Cartesian grid for the domain discretization </span><span style=' font-family: monospace;'>[ vector (default []) ]</span></div><ul  class = 'S3'><li  class = 'S4'><span style=' text-decoration: underline;'>Before</span><span> the </span><span style=' font-family: monospace;'>QMol_CI_conv</span><span> object is </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d, as a substitute for the </span><a href = "#H_6EFEF984"><span style=' font-family: monospace;'>discretization</span></a><span> object, </span><span style=' font-family: monospace;'>xspan</span><span> is used to directly provide the Cartesian grid (all-increasing, equally-spaces, vector) for the domain discretization. Upon initialization, </span><span style=' font-family: monospace;'>xspan</span><span> is converted into the proper </span><a href = "#H_6EFEF984"><span style=' font-family: monospace;'>discretization</span></a><span> object.</span></li><li  class = 'S4'><span style=' text-decoration: underline;'>After</span><span> the </span><span style=' font-family: monospace;'>QMol_CI_conv</span><span> object is </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d, fetches </span><a href = "#H_6EFEF984"><span style=' font-family: monospace;'>discretization</span></a><span style=' font-family: monospace;'>.xspan</span><span>.</span></li><li  class = 'S4'><span>Irrespective of the initialization status, </span><span style=' font-family: monospace;'>xspan</span><span> consistently provides the Cartesian-grid discretization vector for the CI model.</span></li></ul><h4  class = 'S6' id = 'H_25FA49BA' ><span style=' font-family: monospace;'>numberElectron (N)</span></h4><div  class = 'S1'><span>Number of electrons </span><span style=' font-family: monospace;'>[ integer| (default []) ]</span></div><h4  class = 'S6' id = 'M_1F9482EA' ><span style=' font-family: monospace;'>orbitalBasis (SOB)</span></h4><div  class = 'S1'><span>Basis of spatial orbitals </span><span texencoding="\phi_1({\bf r}),\phi_2({\bf r}),\ldots,\phi_K({\bf r})" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="136" height="19.5" /></span><span> </span><span style=' font-family: monospace;'>[ matrix (default []) ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Each column of </span><span style=' font-family: monospace;'>orbitalBasis</span><span> defines the discretization of one spatial orbital basis on the </span><a href = "#H_6EFEF984"><span style=' font-family: monospace;'>discretization</span></a><span> domain.</span></li><li  class = 'S4'><span>Spatial orbitals are assumed to form an orthonormal basis </span><span texencoding="\int{\phi_k({\bf r})^*\phi_l({\bf r})\ \text{d}{\bf r}=\delta_{kl}" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARIAAAAuCAYAAADk+JZBAAAAAXNSR0IArs4c6QAAEl9JREFUeF7tXXuYHFWVP+dWT2c6IREWISRMpqtq2mQJHwgLqywraz4fGB4m4G4CYcHw8TDyMuEhPgirUdkN2agraIwGkEVdFlnUoCKI7OILEY2vT4KE7qrqySSKD1jB7ZDprnu2z3xV/d2pVPd0Vdc8mqn6c6bq1r2/e+vcc3/nd04jpFeKQIpAikCHCGCHz6ePpwikCKQIQGpI0kWQIpAi0DECqSHpGMK0gRSBFIHUkKRrIEUgRaBjBFJD0jGEaQMpAikCqSFJ10CKQIpAxwikhqRjCNMGUgRSBFJDkq6BFIEUgY4RSMSQzJ07d9asWbOuIqJ3AMDBAHBbLpf70M6dO//ccQ/TBlIEUgSmPAIdG5J8Pj9PCHEnEdWI6EYhxMcB4G8Q8Q2WZX1/yiMwyR00TXMhEW0ioo2O4zw+yd1JX58iEAuBjgxJoVCYIaX8BBG9VUr5Vk3TZhLRf9cNyUPVanX10NDQc7F6FXioUCjMqdVqfwUAMwDgTy+nD840zTcS0bcBYIVt2/8VF6+XM0ZxMQk+t3jx4mylUjkZEefYtn1/Uu2m7UBnytaBgYGTpZQPEtHXhoeHL927d+++QqEwu6+vr/Loo4/WkgJY1/XXI+LD3B4RvdlxnO8k1Ta309fXl8tms2uJqGTb9r1x2i4UCgOu614DAJts2y63aAMNw7gOAN4MAFdJKYeFEJ/XNG2N67qM2a0A8LBt25t5uO32JWmMJhiTdocZ+T7e7Gq12tmIeC4AvAUAehHxZsuy3hu5se58AE3TLEgpL0PEswDAAIDnAeAJAPiYbdu8iclOhxbbI1myZEmmXC7fDADXIOLFlmXd0Wlnmj1vGMb7AeAmAPh5tVo9c2hoaE9S71qwYMF8TdNuRcTttm1/PsrHG+xDPp83hBC3ENFmx3G+26wt0zT/noj4CLiPjQkAnElEX0TEjwLAYYj4fsuy7osyxiQxmgxMoow14r2ir6/v4Gw2u5iI7gGA+dPIkPCmdQEink1EW6SUv9I07WQi4nWWB4AqES1zHOfBiJgecHtsQ9LX13dkT0/P13lipJRLy+XyzzrtTNjzixYtmj08PMwf+HIA2JbL5a7cuXPncBLvMgxjUR3QzyHiNsuy7uzEiPj9KRQKR7uu+wVEvM6yrEfG8Ez6AeASALiMiG5xXfe23bt3/yZqP5LEaJIxSWJaQ9tYuHDhK6vVKq/X104XQ2IYxrFExJ7X5Y7j/K8PjGmaZxDRVzwPf3INiXK2/6GmacuLxeLvx2MV5PP5o4QQ32QLmqTn45HEdxPRY7qu/1OSRzEPm82app1fLBafDOLC3tzg4OBRUsq3CSGOk1JmhRC/A4Cn61zQ/aZp7orSn6QwmkxMxmPtqG1OR0NimuZFUsp/rNVqKwJ8JS5YsGBeJpPpsW1796QebRRX+tZ8Pn9NlIUfZdEYhvEPAMC8xe+S8nwUkvg1QojlpVKJwUzs8gzFZinlMZqmrSqVSmwkGpeC3Rdc1/1AfUJvklJuQMTLAOBdAPAR27ZvbLdDSWA02Zi0O9a4901HQ6Lr+lJEZFL5M5qm3VAsFl+Ii99Yz8U62rBuZObMmbcDwDlJeglhO3e5XP6YxyM8TEQrVRdtrME1+7/v2iHiOsuytsRtp9Vz7FbW3Wj2pDbatv1J9bgyMDDA5Ne8Ot/zE03T/lII8XVEPGd4eHhH/bh4ohDCade4eVxVxxhNNibjMQfT3SNZvHjxQfv27fsUALwdAL4nhLi6VCrtGA+sYxkSj1T8Bgc8vCjKj5LuHJ/7q9XqEUTE/Mhr6yTkpzRN26Bp2ktPP/30i3Hfx+BWKpV/R8TXhXk4uq6PsPoAwOK6Xv89RPQfHJmaMWPGbER8LxGtBoA/E9H1juN8KegeKrxFfyuvx9s12OC83SN72x5aUhhNNUzaBiD8RmEYxpsA4Nr6TjyPiJhP2wUAtyDivwU5El3XmTO524tmNFokoiWO43wvn8+/BRE/jIjHIuJ91Wr12t27d+/tsI8T9riv8wKAUwHgJQBYr2naJ4vF4v4kOxHLkCihxl8IIc4Iuu5xO8ieTi6XOx8ROYzqIOLPiOg93B7/jYiE5528QETvdhznW1GJST9kDQCPt/JwFEKqh9/PhoTZbiHEpwHgNcoYn0fEUy3L+klw3P4RppXXxkeKarW62HXdXw8NDXEUp+U1HhhNNUzGwqDZ/70dmI3FMYh4pT8n+Xz+JBZNAsBCby2NCv+apvkKAGBRJYdHRy5EfBMRHQ8A/1yPGI6sAe/aksvlrk6K8I871ijPHXnkkYf29PR8FhHf5j131/Dw8DV79uz5Y5R2Wt0b15Cs9ax7YlEUL9rBIeR+IrrMcZz7dV2/ynvPU1LKM8rlsu0RmSNaD0RcMUZk5ICxK/xEy76rBKb3rv9hnYmU8g4hBE8Ia0H4qjZT8frche/N7N27t9LJxI0XRt2MiY+nd8TbCAAXEdHpQdGiruvsWfC6YY/yAB2JaZob/U3Lm++tnifzSw6d+kYIAO4iojWO4/Du3vQKrp+4895JhMkwjLkAcAURnSeEYGqAvbOVAHAEjyOXy12RVBpLZEMyf/78mdlsdhsinsfuv23b2+KC5D9nGMYpAMBHmDm+cVDfo36IbYQ6RaFQmM+gBT2lALfTUpQUshAaMXfewaSUWzwMbs/lcuvCJsTz3B6tc0kNQxgXq6QwYlx7e3tfSUTHcV8qlcojCt/VVZioWPrEIh+FM5nM5UHXfWBg4HApJR/HT2zHkBDRl2fOnLma59U0Tdb5jKxzRDy/nc1rkg2JME3zXPag6173TiK6hDdh7r+u6+d6R7lQDYm3Pvr6+/utsAAKf3+u6x5eq9WYy9vjp8FENiSKfmQgCX6EFaG1Wm17fbc4miMWPjGp8DBHEdE6x3E+wUAEDNmPenp6zty1a9cfdF3XeZK9o09OCLG0VCo9pi62AHPfUkQXshAii+E8D4L5jyM6yT1KCiNP5XkSIl7NuhwiWpXNZr+t6Cu6BhN1Xr1xsWG/qNnmNlbUJuiRqGsurvGfjOc8z2yddyR7TEq5qlwuszZp5FK/KwDYbNv29SeccELmueeeOw0ALvXEkXeEGWNOw5BSnsI5dQCwWP3GIhsS0zRf5+XTPNmpylQJOa4BgO8S0TmO4/yWB+xxFCwgelE1WH19fX/R09PDIa2/rcvMf1CtVpf5MXJd1w9GRCY+5/B512/LB5ET5KSUDyDiwFjRphBD0jBa7S6QQBuxcmmSxojzTfbt28dRpFOFELzTDncbJkH8lc3tOI8kPSCFIqohGWt9tLsGJvo+wzA4QnMbE6tEtMJxnIeababBI7ciI7jEtm2mGQ5I0Wj2jUU2JLqu+/xIW2fFVkAqJN9s3h0dx/lP737Udf0mRHxfPT9ilOBN2eUXBJWuiqF4KJ/Prw26ZlGEW0kbkrgLM2mMFBf/t3XO5wIi4uzttgR/UwWT4JrK5/PHCyFY5n34dDYkqudKRKFehXrEC34/hmF8mD06RDzTsqwfh327yvf3NfUbi2RIvNDoZzhU2anrp+bqBDkExepxYtsowZtyxuPz6ihX3PdiAkapgUe3GZLxwMgLdz6MiJ+2LOt9+Xx+UbcbEoWLGom2hHEY08EjMU3zciJi3QjjwMaAOaFRlz//TDrXAwU32LbNUSnwucc6rzI7RAnbaKOZ1xLJkCgu5NGdnPm5VwF3dESj4Uc11B1GTa8P8CO7NE07vVgslgJezMXNLGqAcIvKB3R0tGk2sa08tnHAiMm2EY/SO/pt7zZMwvAKfByhAYCJNiQTTbaqm3wrcl85UbyochxKf78R5s0z7or4kYWoo7yWSIZEmbBSp/xIYPJHScI5R4CIWDlbllKeVi6Xn+KB6LrOROEDAHAIH3ssy2Lh2Mg5zvdiiEhji6pp2is0TbueiE5DxGvrJNEjM2bMcJUEwJYy9ITceN/lzsUhpscBIxbbsUd5km+EA1GwKY9JmCEJEPOhLv3L3ZCo4wOA7dls9oKgcFPXdSb9OQP679SoFGOqSBVWZTKZr9RqNf5uWJPzLUTczFGcYrE4h/lJItof9FoiGRLDMJjV/WwSuoiAO9rwDhQykN/VAEQlHZnsDeaw+F4MIt7puexzhRDrGQzLsp4J4V5GGOtmgrYkDIkyxsgRH884ch0WDh+POsbFxUjxcJ7JZrMXewtN5aOmPCZhhiTgqe7lIlvlcvmnzUjGdsK/cTmtiSZX/fepQYgm3yeXFOCoFhOxz6taG8XTWMYEfKlUepLLDxBRLpPJ3OmH0v1vjEteOI7DOqpGHZO2DUlg8TbOVnGBC3yoDXdUdefVM5yvNK2La3ZJKVcODg7uVN+tWNSziOiXQohVdYn91mCVNiUaFGq1/TaTMCQ8GZ6AKXSXHAu7pDFSFMkbvLPxiDfXTZg0w8wbG6fGHwIA3xFCXKDkK2E+n18qhODdmIn9A+YjRJA2rjV2xpr7qP8P8GkH5KV5JOmXWfAJAGvU2jsKJ7lf07SLXNflUPBvbNvmMhgNY+GfFMI4yLYNiXKWfnUSVcpUDwMRv1qXxF9oWdafwip9KWKsX7FSL1iBTLGoZ3nnf67DwNqTRg0Gf2K4aE8mk9kOALN8tWzYpAUl8px9TETLI5R55B1gEytgm5G/Yy2WJDHy3FcuEPVBRDxNJSS7CZNmmHkZ1+8gInbHWdK+m3fO+s77hBBiST1P5hgiMr2CPpzywOUdPsKRwiYS+a1CiHVJ56SMNeed/F8xFvOklOeUy2WOZJF39GPBJ+fGsSp3VGqJ4mkwOfuSEOIBj6hthH+DsoFSqcTfYuNq25Ao5/WhVh9gFCC8BcwTv8IzJux2sbbhnbwQOMGIhWpExCKYTZlM5pthE1soFA5zXZeNw4ksWedkuhYlB7j03HuI6F/C6qQ2S9rzxsWy6B8IId5ZKpWKrcaq9IkVhA19TBR8+N6kMFJUvSwk4vwotXRCV2HSAkP2PI5HxCsQ8WT+RYN6BTA+4txVq9W+n81muXzlE67rfrVcLnM5TNksac97h01EWx3H4Q2hK65CodDnuu6767lkS4mI879eqkfoWCr/pUqlct+zzz77f8GBKJwkp3CwEd4aLA0SlA0EN+m2DYnysnsqlcrFYR2KizQTfrVajQnJY6WUGxHxBCaDiOi63t7eP4yV7auGNKWUP0VE1qM0rZMyMDCwQEq5vf6BP6VGi+L2v4VHw+K4C+PWgVXb7RQjn5Csl937RW9v76VBSX83YpLkfE3XtlRPwys3sB4AXh3ciIOygWC2e1uGJFDzomN+pNmkRdF5qG2oIU3XdX/MRxciOkQIcTqzzfV6sv2Dg4Oca9Bw1QzDWMEZn4i4Mize3snC8oivuxHRFkKsTdI9jouRz4NwFnW1Wr1H07Rlhx566O07duxgD27k6lZMOpmr6f6swkkOsUBRCHEea1EQcYNlWRsGBgbY2+dkv9W+bKBede2Z+jd2vGVZX/Txa8uQKG46/15NqNAliQmJU+lLYexP9EOaivf0UUT8IcvAbdtmuX3DkHhn6huJ6I21Wm1lUjUmlHZPklJeqOY5TBZGnpEYKaBNRGczZyCE2BYsA9mtmCSB63RtI0jA67o+1wsRG1LK1ZqmvZ6IuHQGq16Xco1hLibtuu6H1LXdliFRBGJ/TIofCU5c3EpfvkWt/9zAr32X3atL8QEA4Nomm4QQW5pwKzPqPwHBPExh//79VyZQn4G5hgsBYBkirkmqTouPVVyMFG+Dd5DHmUOwLIvJsgNyKZjg7SZMpqsBSGrcnjf/ryoB7+XTbSGi32cymXcVi8WdCq94rxDi2mAFv7YMiR/GbCZ0SWJQqtfDRKjjODdELVoUpx/8cTqOw2rYU4aHh9fGNSbebn6plPJVmUzmg+NRH3OiMOomTOLMefpM8giMaUgCu2CkosRRuquqOMfz+NSsT/39/aYQYo7jOD+P0m//Xma1AaBQKpX4Zzc7/sGhsD5MNEbdgEmcuUqfSR6BMQ2JmkA3nh84cx0HHXTQzEqlIguFwgvjVZU+eQgnrsUUo4nDOn1TNATGNCQKPzJYq9WWJ0VKRutmeneKQIrAVEYgzJCg+vu9SmryelVWPZUHlfYtRSBFYGIRCBoS/weu+Xd2b65Wqx/PZDL3IiJrMhL/IamJHWr6thSBFIHxQmCUIVEyCPnHnbj+6V97ceO2Ct6OVyfTdlMEUgSmNgJhHgkrPll8chgRPSilXD84OGhN7WGkvUsRSBGYTATGJFsns3Ppu1MEUgS6A4HUkHTHPKW9TBGY0gj8P21DPxA44LOaAAAAAElFTkSuQmCC" width="137" height="23" /></span><span> and no check is performed on this.</span></li></ul><h4  class = 'S6' id = 'H_726B4267' ><span style=' font-family: monospace;'>configurationBasis (CSB)</span></h4><div  class = 'S1'><span>Configuration-state basis </span><span style=' font-family: monospace;'>[matrix (default []) ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Each row of </span><span style=' font-family: monospace;'>configurationBasis</span><span> defines a configuration state, as </span><a href = "#H_25FA49BA"><span style=' font-family: monospace;'>numberElectron</span></a><span> vector containing the indexes for the spatial orbitals in </span><a href = "#M_1F9482EA"><span style=' font-family: monospace;'>orbitalBasis</span></a><span> and the sign defining the spin (negative for down and positive for up spins). For instance </span><span style=' font-family: monospace;'>[-1 -2 1 3]</span><span> corresponds to the Slater determinant formed by the first two spatial orbitals in </span><a href = "#M_1F9482EA"><span style=' font-family: monospace;'>orbitalBasis</span></a><span> with down spin and orbitals 1 and 3 in </span><a href = "#M_1F9482EA"><span style=' font-family: monospace;'>orbitalBasis</span></a><span> with up spin.</span></li><li  class = 'S4'><span>Each row in </span><span style=' font-family: monospace;'>configurationBasis</span><span> is assumed to define a unique configuration state and no check is performed on this. </span><span style=' text-decoration: underline;'>Warning:</span><span> keep in mind that two products of spin orbitals that only differ by the order of the orbitals define linearly dependent configuration states, i.e., </span><span style=' font-family: monospace;'>[-1 -2 1 3]</span><span> and </span><span style=' font-family: monospace;'>[-1 -2 3 1]</span><span> should not be both included in the </span><span style=' font-family: monospace;'>configurationBasis</span><span>; use </span><a href = "#H_E576F5B1"><span style=' font-family: monospace;'>cleanConfigurationBasis</span></a><span> to automatically remove duplicates like these.</span></li><li  class = 'S4'><span>In most cases, </span><span style=' font-family: monospace;'>configurationBasis</span><span> is built automatically using </span><a href = "#H_283B85DD"><span style=' font-family: monospace;'>setConfigurationBasis</span></a><span>, to match the </span><a href = "#H_D2FDD0C6"><span>Configuration-state basis</span></a><span> properties.</span></li></ul><h4  class = 'S6' id = 'H_8D5C5371' ><span style=' font-family: monospace;'>externalPotential (Vext)</span></h4><div  class = 'S1'><span>External functional object </span><span style=' font-family: monospace;'>[ </span><a href = "./QMol_DFT_Vext.html"><span style=' font-family: monospace;'>QMol_DFT_Vext</span></a><span style=' font-family: monospace;'> object | </span><a href = "./Pseudopotential.html"><span style=' font-family: monospace;'>pseudopotential</span></a><span style=' font-family: monospace;'> | cell of </span><a href = "./Pseudopotential.html"><span style=' font-family: monospace;'>pseudopotential</span></a><span style=' font-family: monospace;'>s | function handle | vector (default []) ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>A </span><a href = "./QMol_DFT_Vext.html"><span style=' font-family: monospace;'>QMol_DFT_Vext</span></a><span> object describes the external potential in a similar fashion as for </span><a href = "./DFT.html"><span>DFT</span></a><span> and </span><a href = "./HF.html"><span>HF</span></a><span> calculations.</span></li><li  class = 'S4'><span>A </span><a href = "./Pseudopotential.html"><span style=' font-family: monospace;'>pseudopotential</span></a><span> object implicitly describes the external potential as a single </span><a href = "./Pseudopotential.html"><span style=' font-family: monospace;'>pseudopotential</span></a><span>.</span></li><li  class = 'S4'><span>A </span><span style=' font-family: monospace;'>cell of </span><a href = "./Pseudopotential.html"><span style=' font-family: monospace;'>pseudopotential</span></a><span style=' font-family: monospace;'>s</span><span> object implicitly describes the external potential as the potential formed by the sum of the provided </span><a href = "./Pseudopotential.html"><span style=' font-family: monospace;'>pseudopotential</span></a><span>s.</span></li><li  class = 'S4'><span>A </span><span style=' font-family: monospace;'>function handle</span><span> specifies the external potential with the signature </span><span style=' font-family: monospace;'>V = funV(x)</span><span>,  where the output </span><span style=' font-family: monospace;'>V</span><span> has the same shape as the input vector </span><span style=' font-family: monospace;'>x</span><span> and contains element-wise values of the potential at the query points </span><span style=' font-family: monospace;'>x</span><span>.</span></li><li  class = 'S4'><a href = "./Pseudopotential.html"><span style=' font-family: monospace;'>pseudopotential</span></a><span>, </span><span style=' font-family: monospace;'>cell of </span><a href = "./Pseudopotential.html"><span style=' font-family: monospace;'>pseudopotential</span></a><span style=' font-family: monospace;'>s</span><span>, and </span><span style=' font-family: monospace;'>function handle</span><span> are converted into a </span><a href = "./QMol_DFT_Vext.html"><span style=' font-family: monospace;'>QMol_DFT_Vext</span></a><span> object when the CI object is </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d.</span></li></ul><h4  class = 'S6' id = 'H_C9D9F4E3' ><span style=' font-family: monospace;'>interactionPotential (Vee)</span></h4><div  class = 'S1'><span>Electron-electron interaction potential </span><span style=' font-family: monospace;'>[ function handle (@(x) 1./sqrt(x.^2+2)) ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>The signature for the (effective) electron-electron interaction potential is </span><span style=' font-family: monospace;'>V = funV(x)</span><span>, where the output </span><span style=' font-family: monospace;'>V</span><span> has the same shape as the input vector </span><span style=' font-family: monospace;'>x</span><span> and contains element-wise values of the potential at the query points </span><span style=' font-family: monospace;'>x</span><span>.</span></li><li  class = 'S4'><span>Because the computations of the electron-electron integrals are performed over an (internally handled) extended domain, a user-defined discretization of the electron-electron interaction potential is not supported (only function handle).</span></li></ul><h4  class = 'S6' id = 'H_241A5E49' ><span style=' font-family: monospace;'>waveFunction (wfcn)</span></h4><div  class = 'S1'><span>Wave function </span><span style=' font-family: monospace;'>[ [] (default) | column vector | matrix ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>CI wave functions are specified as column vectors of the (complex) amplitudes of the configuration states in the </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span>. For example, </span><span style=' font-family: monospace;'>[1/sqrt(2); 1/sqrt(2); 0; 0; __]</span><span>, with length </span><span style=' font-family: monospace;'>size(</span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span style=' font-family: monospace;'>,1)</span><span>, has equal population in the first two configuration states.</span></li><li  class = 'S4'><span>Several wave functions can be combined in a matrix, which each column corresponding to a different wave function.</span></li></ul><h4  class = 'S6' id = 'H_CFCAE00D' ><span style=' font-family: monospace;'>display (disp)</span></h4><div  class = 'S1'><span>Whether to display the progress of CI calculations </span><span style=' font-family: monospace;'>[ true (default) | false ]</span></div><ul  class = 'S3'><li  class = 'S4'><span style=' font-family: monospace;'>display</span><span> is used by </span><a href = "#H_283B85DD"><span style=' font-family: monospace;'>setConfigurationBasis</span></a><span> and </span><a href = "#H_17C8E8B2"><span style=' font-family: monospace;'>computeCImatrix</span></a><span>.</span></li></ul><h4  class = 'S6' id = 'H_BF9CB463' ><span style=' font-family: monospace;'>tolerance (tol)</span></h4><div  class = 'S1'><span>Threshold for setting CI matrix elements to zero </span><span style=' font-family: monospace;'>[ scalar (default 1e-10) ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>When calculating the CI and dipole-coupling matrices, elements with magnitude smaller than </span><span style=' font-family: monospace;'>tolerance</span><span> are forced to zero.</span></li><li  class = 'S4'><span>Set a negative </span><span style=' font-family: monospace;'>tolerance</span><span> to disable the feature.</span></li></ul><h4  class = 'S6' id = 'H_DF90D098' ><span style=' font-family: monospace;'>CImatrix (CI) </span></h4><div  class = 'S1'><span>CI matrix </span><span style=' font-family: monospace;'>[ matrix (default []) ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>At the end of a </span><a href = "#H_17C8E8B2"><span>CI calculation</span></a><span>, </span><span style=' font-family: monospace;'>CImatrix</span><span> contains a copy of the CI matrix.</span></li></ul><h4  class = 'S6' id = 'H_5B0C4647' ><span style=' font-family: monospace;'>isDipole (isDip)</span></h4><div  class = 'S1'><span>Whether to calculate the dipole-coupling matrix together with the CI one </span><span style=' font-family: monospace;'>[ true (default) | false ]</span></div><h4  class = 'S6' id = 'H_0F7B48EA' ><span style=' font-family: monospace;'>DXmatrix (DX)</span></h4><div  class = 'S1'><span>Dipole-coupling matrix </span><span style=' font-family: monospace;'>[ matrix (default []) ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>When </span><span style=' font-family: monospace;'>isDipole</span><span> is </span><span style=' font-family: monospace;'>true</span><span>, at the end of a CI calculation, </span><span style=' font-family: monospace;'>DXmatrix</span><span> contains a copy of the dipole coupling matrix.</span></li></ul><h3  class = 'S5' id = 'H_D2FDD0C6' ><span>Configuration-state basis</span></h3><div  class = 'S1'><span>The </span><span style=' font-family: monospace;'>QMol_CI_conv</span><span> class defines the following public get-access properties for automatized building of the configuration-state basis; each can be changed using the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method:</span></div><h4  class = 'S6' id = 'H_19D8F0C2' ><span style=' font-family: monospace;'>type</span></h4><div  class = 'S1'><span>Type of CI calculation </span><span style=' font-family: monospace;'>[ 'CIS' (default) | 'CISD' | 'RAS' ]</span></div><ul  class = 'S3'><li  class = 'S4'><span style=' font-family: monospace;'>CIS</span><span> corresponds to CI with single excitations.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>CISD</span><span> corresponds to CI with single and double excitations. </span><span style=' text-decoration: underline;'>Note:</span><span> this typically leads to a much bigger configuration state basis.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>RAS</span><span> corresponds to CI with a restricted active space. If no </span><a href = "#H_28F24796"><span style=' font-family: monospace;'>noDouble</span></a><span> or </span><a href = "#H_15255EE0"><span style=' font-family: monospace;'>noEmpty</span></a><span> are specified, this corresponds to a complete active space (CAS). </span><span style=' text-decoration: underline;'>Warning:</span><span> the size of the configuration state basis grows exponentially fast with the size of the active space.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>type</span><span> is used by </span><a href = "#H_283B85DD"><span style=' font-family: monospace;'>setConfigurationBasis</span></a><span> when building </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span>.</span></li></ul><h4  class = 'S6' id = 'H_C361E917' ><span style=' font-family: monospace;'>reference (ref)</span></h4><div  class = 'S1'><span>Configuration state reference </span><span style=' font-family: monospace;'>[ vector (default []) ]</span></div><ul  class = 'S3'><li  class = 'S4'><a href = "#H_25FA49BA"><span style=' font-family: monospace;'>numberElectron</span></a><span> vector containing the indexes for the spatial orbitals in </span><a href = "#M_1F9482EA"><span style=' font-family: monospace;'>orbitalBasis</span></a><span> and the sign defining the spin (negative for down and positive for up spins). For instance </span><span style=' font-family: monospace;'>[-1 -2 1 3]</span><span> corresponds to the Slater determinant formed by the first two spatial orbitals in </span><a href = "#M_1F9482EA"><span style=' font-family: monospace;'>orbitalBasis</span></a><span> with down spin and orbitals 1 and 3 in </span><a href = "#M_1F9482EA"><span style=' font-family: monospace;'>orbitalBasis</span></a><span> with up spin.</span></li><li  class = 'S4'><span>If left empty, a spin-restricted system is assumed and the first </span><a href = "#H_25FA49BA"><span style=' font-family: monospace;'>numberElectron</span></a><span style=' font-family: monospace;'>/2</span><span> spatial orbitals in </span><a href = "#M_1F9482EA"><span style=' font-family: monospace;'>orbitalBasis</span></a><span> are used for the reference. If </span><a href = "#H_25FA49BA"><span style=' font-family: monospace;'>numberElectron</span></a><span> is an odd number an error is throwed when building the </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span>.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>reference</span><span> is used by </span><a href = "#H_283B85DD"><span style=' font-family: monospace;'>setConfigurationBasis</span></a><span> when building </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span>.</span></li><li  class = 'S4'><span>For CIS(D) calculations, </span><span style=' font-family: monospace;'>reference</span><span> defines the spin orbitals from which the excitations should be considered.</span></li><li  class = 'S4'><span>For RAS calculations, a </span><span style=' font-family: monospace;'>reference</span><span> is still required and used to define the number of electrons to include in each spin channel.  For instance </span><span style=' font-family: monospace;'>[-1 -2 1 3 4]</span><span> indicates that 2 electrons should be put in the down-spin channel and 3 in the up one.</span></li></ul><h4  class = 'S6' id = 'H_7A72D8B8' ><span style=' font-family: monospace;'>active (act)</span></h4><div  class = 'S1'><span>List of spin orbitals that may contain an electron </span><span style=' font-family: monospace;'>[ vector (default []) ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Vector containing the "active" spin orbitals in the CIS(D)/RAS basis, defined as the indexes for the spatial orbitals in </span><a href = "#M_1F9482EA"><span style=' font-family: monospace;'>orbitalBasis</span></a><span> and the sign indicating the spin (negative for down and positive for up spins). For instance </span><span style=' font-family: monospace;'>[-1 -2 -3 -4 1 2 3]</span><span> indicates that the spin orbitals formed by the first 4 spatial orbitals with down spin and only the first 3 spatial orbitals with up spin should be considered for building the </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span>.</span></li><li  class = 'S4'><span>The largest index magnitude in the </span><span style=' font-family: monospace;'>active</span><span> vector must not be larger than the number of spatial orbitals in </span><a href = "#M_1F9482EA"><span style=' font-family: monospace;'>orbitalBasis</span></a><span>.</span></li><li  class = 'S4'><span>If left empty, all the spatial orbitals in </span><a href = "#M_1F9482EA"><span style=' font-family: monospace;'>orbitalBasis</span></a><span> with both up and down spins are included in the active space.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>active</span><span> is used by </span><a href = "#H_283B85DD"><span style=' font-family: monospace;'>setConfigurationBasis</span></a><span> when building </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span>.</span></li><li  class = 'S4'><span>For CIS(D) calculations, only </span><span style=' font-family: monospace;'>active</span><span> spin orbitals that are different from the </span><a href = "#H_C361E917"><span style=' font-family: monospace;'>reference</span></a><span> are relevant for building building the </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span>. Duplicates with the </span><a href = "#H_C361E917"><span style=' font-family: monospace;'>reference</span></a><span> are ignored (including the in the run-time documentation).</span></li><li  class = 'S4'><span>For RAS calculations, all </span><span style=' font-family: monospace;'>active</span><span> spin orbitals must be listed as the </span><a href = "#H_C361E917"><span style=' font-family: monospace;'>reference</span></a><span> is only used to determine the number of electrons in each spin channel.</span></li></ul><h4  class = 'S6' id = 'H_8362394D' ><span style=' font-family: monospace;'>frozen (frz)</span></h4><div  class = 'S1'><span>List of spin orbitals that must contain an electron </span><span style=' font-family: monospace;'>[ vector (default []) ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Vector containing the "frozen" spin orbitals, which are included in all the vectors in the CIS(D)/RAS basis. Frozen orbitals are defined via the indexes for the spatial orbitals in </span><a href = "#M_1F9482EA"><span style=' font-family: monospace;'>orbitalBasis</span></a><span> and the sign indicating the spin (negative for down and positive for up spins). For instance </span><span style=' font-family: monospace;'>[-1 1 2]</span><span> indicates all configuration states in the </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span> must include the spin orbitals formed by the first spatial orbitals with down spin and the first 2 spatial orbitals with up spin.</span></li><li  class = 'S4'><span>The largest index magnitude in the </span><span style=' font-family: monospace;'>frozen</span><span> vector must not be larger than the number of spatial orbitals in </span><a href = "#M_1F9482EA"><span style=' font-family: monospace;'>orbitalBasis</span></a><span>.</span></li><li  class = 'S4'><span>If left empty, no orbitals are frozen.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>frozen</span><span> is used by </span><a href = "#H_283B85DD"><span style=' font-family: monospace;'>setConfigurationBasis</span></a><span> when building </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span>.</span></li><li  class = 'S4'><span>For CIS(D) calculations, all </span><span style=' font-family: monospace;'>frozen</span><span> orbitals should also be included in the </span><a href = "#H_C361E917"><span style=' font-family: monospace;'>reference</span></a><span>.</span></li><li  class = 'S4'><span>For RAS calculations, the number of </span><span style=' font-family: monospace;'>frozen</span><span> orbitals in each spin channel must be compatible with the number of electron each hold (defined via the </span><a href = "#H_C361E917"><span style=' font-family: monospace;'>reference</span></a><span>).</span></li></ul><h4  class = 'S6' id = 'H_28F24796' ><span style=' font-family: monospace;'>noDouble (noDbl)</span></h4><div  class = 'S1'><span>List of spatial orbitals that must not contain two electrons </span><span style=' font-family: monospace;'>[ vector (default) ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Vector containing the indexes of the </span><span style=' text-decoration: underline;'>spatial</span><span> orbitals that may be empty or contain one electron but should not hold two electrons. For instance </span><span style=' font-family: monospace;'>[5 6]</span><span> indicates that spatial orbitals 5 and 6 may not be fully occupied.</span></li><li  class = 'S4'><span>If left empty, the feature is disabled.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>noDouble</span><span> is used by </span><a href = "#H_283B85DD"><span style=' font-family: monospace;'>setConfigurationBasis</span></a><span> when building </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span>.</span></li><li  class = 'S4'><span>For CIS(D) calculations, the constraint is not imposed on the reference configuration.</span></li><li  class = 'S4'><span>After building the CIS(D)/RAS basis associated with the </span><a href = "#H_C361E917"><span style=' font-family: monospace;'>reference</span></a><span>, </span><a href = "#H_7A72D8B8"><span style=' font-family: monospace;'>active</span></a><span>, and </span><a href = "#H_8362394D"><span style=' font-family: monospace;'>frozen</span></a><span> spin orbitals, configuration states that allocate two electrons in the </span><span style=' font-family: monospace;'>noDouble</span><span> spatial orbitals are removed from the </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span>.</span></li></ul><h4  class = 'S6' id = 'H_15255EE0' ><span style=' font-family: monospace;'>noEmpty (noEmp)</span></h4><div  class = 'S1'><span>List of spatial orbitals that must not be empty </span><span style=' font-family: monospace;'>[ vector (default) ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Vector containing the indexes of the </span><span style=' text-decoration: underline;'>spatial</span><span> orbitals that may contain one or two electrons but should not be empty. For instance </span><span style=' font-family: monospace;'>[1 2]</span><span> indicates that the first two spatial orbitals should always hold at least one electron.</span></li><li  class = 'S4'><span>If left empty, the feature is disabled.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>noEmpty</span><span> is used by </span><a href = "#H_283B85DD"><span style=' font-family: monospace;'>setConfigurationBasis</span></a><span> when building </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span>.</span></li><li  class = 'S4'><span>For CIS(D) calculations, the constraint is not imposed on the reference configuration.</span></li><li  class = 'S4'><span>After building the CIS(D)/RAS basis associated with the </span><a href = "#H_C361E917"><span style=' font-family: monospace;'>reference</span></a><span>, </span><a href = "#H_7A72D8B8"><span style=' font-family: monospace;'>active</span></a><span>, and </span><a href = "#H_8362394D"><span style=' font-family: monospace;'>frozen</span></a><span> spin orbitals, configuration states that do not allocate any electron in the </span><span style=' font-family: monospace;'>noEmpty</span><span> spatial orbitals are removed from the </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span>.</span></li></ul><h3  class = 'S5'><span>Other properties</span></h3><div  class = 'S1'><span>To facilitate simulations, </span><span style=' font-family: monospace;'>QMol_CI_conv</span><span> defines a handful of additional transient properties. These </span><span style=' text-decoration: underline;'>cannot</span><span> be edited with the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method.</span></div><h4  class = 'S6' id = 'H_0ED64D82' ><span style=' font-family: monospace;'>isInitialized (isInit)</span></h4><div  class = 'S1'><span>Whether the CI-model object is properly initialized. This is used throughout the QMol-grid package to check that the CI-model object holds meaningful information and is ready for use.</span></div><h4  class = 'S6' id = 'H_C672E0F8' ><span style=' font-family: monospace;'>isSetConfigBasis</span></h4><div  class = 'S1'><span>Tacks whether the configuration basis </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span> was build using [what] or user defined </span><span style=' font-family: monospace;'>[ true | false (default) ]</span></div><h3  class = 'S5'><span>Constant properties</span></h3><h4  class = 'S6' id = 'H_81B294E3' ><span style=' font-family: monospace;'>isSpinPol (true)</span></h4><ul  class = 'S3'><li  class = 'S4'><span>Indicates that, by construction, the CI model is spin polarized.</span></li></ul><h4  class = 'S6' id = 'H_9057FE3F' ><span style=' font-family: monospace;'>dim (1)</span></h4><ul  class = 'S3'><li  class = 'S4'><span>Indicates that the CI model dimension is one.</span></li></ul><h2  class = 'S2'><span>Class methods</span></h2><h3  class = 'S5'><span>Creation</span></h3><h4  class = 'S6'><span>constructor</span></h4><div  class = 'S1'><span>Create a CI-model object with empty class properties.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj = QMol_CI_conv;</span></span></div></div></div><div  class = 'S8'><span>Create a CI-model object with the </span><span style=' font-family: monospace;'>name</span><span> properties set to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_27AB3DA4"><span>CI-model</span></a><span> and </span><a href = "#H_D2FDD0C6"><span>Configuration-state basis</span></a><span> properties, and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj = QMol_CI_conv(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj = QMol_CI_conv(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S8'><span>Create a CI-model object with the </span><a href = "#H_6EFEF984"><span style=' font-family: monospace;'>discretization</span></a><span> (domain discretization), </span><a href = "#H_25FA49BA"><span style=' font-family: monospace;'>numberElectron</span></a><span> (number of electrons), </span><a href = "#M_1F9482EA"><span style=' font-family: monospace;'>orbitalBasis</span></a><span> (spatial-orbital basis), </span><a href = "#H_8D5C5371"><span style=' font-family: monospace;'>externalPotential</span></a><span> (external potential), and </span><a href = "#H_C9D9F4E3"><span style=' font-family: monospace;'>interactionPotential</span></a><span> (electron-electron interaction potential) properties are imported from a </span><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span> </span><span style=' font-family: monospace;'>DFT</span><span> object by passing it as the first argument of the constructor. Additional or overwriting parameters can be specified as a list of name-value pair arguments.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj = QMol_CI_conv(DFT);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj = QMol_CI_conv(DFT,name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S8'><span>For basis-set </span><a href = "./DFT.html"><span>DFT</span></a><span> and </span><a href = "./HF.html"><span>HF</span></a><span> models, </span><a href = "#M_1F9482EA"><span style=' font-family: monospace;'>orbitalBasis</span></a><span> contains the reconstructed spatial orbitals over the </span><a href = "#H_6EFEF984"><span style=' font-family: monospace;'>discretization</span></a><span> domain.</span></div><h3  class = 'S5'><span>Changing class properties</span></h3><h4  class = 'S6' id = 'H_4405B79D' ><span style=' font-family: monospace;'>set</span></h4><div  class = 'S1'><span>Update the </span><span style=' font-family: monospace;'>name</span><span> properties of a CI-model object to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_27AB3DA4"><span>CI-model</span></a><span> and </span><a href = "#H_D2FDD0C6"><span>Configuration-state basis</span></a><span> properties, and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj.set(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.set(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S8'><span>Update the </span><a href = "#H_6EFEF984"><span style=' font-family: monospace;'>discretization</span></a><span> (domain discretization), </span><a href = "#H_25FA49BA"><span style=' font-family: monospace;'>numberElectron</span></a><span> (number of electrons), </span><a href = "#M_1F9482EA"><span style=' font-family: monospace;'>orbitalBasis</span></a><span> (spatial-orbital basis), </span><a href = "#H_8D5C5371"><span style=' font-family: monospace;'>externalPotential</span></a><span> (external potential), and </span><a href = "#H_C9D9F4E3"><span style=' font-family: monospace;'>interactionPotential</span></a><span> (electron-electron interaction potential) properties from a </span><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span> </span><span style=' font-family: monospace;'>DFT</span><span> object by passing it as the first argument. Additional or overwriting parameters can be specified as a list of name-value pair arguments.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj.set(DFT);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.set(DFT,name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S8'><span>This is the common name-value pair assignment method used throughout the QMol-grid package. The </span><span style=' font-family: monospace;'>set</span><span> method also </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the class. After running, the </span><span style=' font-family: monospace;'>set</span><span> property updates the </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to a </span><span style=' font-family: monospace;'>false</span><span> value.</span></div><h4  class = 'S6' id = 'H_BF84FCE7' ><span style=' font-family: monospace;'>reset</span></h4><div  class = 'S1'><span>Reset the object by deleting/re-initializing all run-time properties of the class and updating the </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span> and </span><a href = "#H_C672E0F8"><span style=' font-family: monospace;'>isSetConfigBasis</span></a><span> flags to </span><span style=' font-family: monospace;'>false</span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.reset;</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>This is the common </span><span style=' font-family: monospace;'>reset</span><span> method available to all classes throughout the QMol-grid package.</span></li><li  class = 'S4'><span>To avoid any mismatch in the CI component internal properties, this also </span><span style=' font-family: monospace;'>reset</span><span>s the </span><a href = "#H_6EFEF984"><span style=' font-family: monospace;'>discretization</span></a><span> (domain discretization) and </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>externalPotential</span></a><span> (external potential) components objects.</span></li></ul><h4  class = 'S6' id = 'H_C729A888' ><span style=' font-family: monospace;'>clear</span></h4><div  class = 'S1'><span>Clear all class properties.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.clear;</span></span></div></div></div><div  class = 'S8'><span>Clear a specific set of the class properties. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_27AB3DA4"><span>CI-model properties</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.clear(name1,name2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S8'><span>This is the common </span><span style=' font-family: monospace;'>clear</span><span> method available to all classes throughout the QMol-grid package. The </span><span style=' font-family: monospace;'>clear</span><span> method also </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the class. The </span><span style=' font-family: monospace;'>clear</span><span> method can be used to delete specific properties before saving an instance of the </span><span style=' font-family: monospace;'>QMol_CI_conv</span><span> class.</span></div><h3  class = 'S5'><span>Initializing the object</span></h3><h4  class = 'S6' id = 'H_85EFED0A' ><span style=' font-family: monospace;'>initialize</span></h4><div  class = 'S1'><span>Initialize a CI-model object in silent mode, </span><span style=' font-style: italic;'>i.e.</span><span>, without displaying any initialization status, and set the </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to </span><span style=' font-family: monospace;'>true</span><span> with either</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj.initialize;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.initialize(0)</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>This </span><span style=' font-family: monospace;'>initialize</span><span>s the </span><a href = "#H_6EFEF984"><span style=' font-family: monospace;'>discretization</span></a><span> (domain discretization) and </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>externalPotential</span></a><span> (external potential)component objects as well as the internal discretization of </span><a href = "#H_C9D9F4E3"><span style=' font-family: monospace;'>interactionPotential</span></a><span> on the extended domain used to calculate electron-electron interaction integrals.</span></li><li  class = 'S4'><span>To avoid any mismatch in internal properties, </span><span style=' font-family: monospace;'>initialize</span><span> first </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the object before performing the initialization.</span></li></ul><div  class = 'S1'><span>To perform the same initialization but with displaying the status of the object initialization, including the QMol-grid package header and footer, </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.initialize(1);</span></span></div></div></div><div  class = 'S8'><span>To perform the initialization and display and display the status of the object initialization, without the QMol-grid package header and footer, </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.initialize(2);  </span><span style="color: rgb(0, 128, 19);">% 2 or any integer larger than 1</span></span></div></div></div><h4  class = 'S6' id = 'H_283B85DD' ><span style=' font-family: monospace;'>setConfigurationBasis</span></h4><div  class = 'S1'><span>Set </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span> to match the </span><a href = "#H_D2FDD0C6"><span>Configuration-state basis</span></a><span> properties.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.setConfigurationBasis;</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span style=' font-family: monospace;'>setConfigurationBasis</span><span> is typically used between the creation of the CI object and the calculation of the CI matrix, using </span><a href = "#H_17C8E8B2"><span style=' font-family: monospace;'>computeCImatrix</span></a><span>.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>setConfigurationBasis</span><span> first (re)</span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>s the CI-model object before building </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span>.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>setConfigurationBasis</span><span> sets </span><a href = "#H_C672E0F8"><span style=' font-family: monospace;'>isSetConfigBasis</span></a><span> to </span><span style=' font-family: monospace;'>true</span><span>, to indicate that </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span> matches the </span><a href = "#H_D2FDD0C6"><span>Configuration-state basis</span></a><span> properties.</span></li><li  class = 'S4'><span>If </span><a href = "#H_CFCAE00D"><span style=' font-family: monospace;'>display</span></a><span> is </span><span style=' font-family: monospace;'>true</span><span>, </span><span style=' font-family: monospace;'>setConfigurationBasis</span><span> also prints out a summary of the configuration state basis.</span></li></ul><h4  class = 'S6' id = 'H_E576F5B1' ><span style=' font-family: monospace;'>cleanConfigurationBasis</span></h4><div  class = 'S1'><span>Clean the configuration state basis by removing duplicate configuration states in </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span>, including those related by a permutation of the spin orbitals in the index vector. </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.cleanConfigurationBasis;</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>The cleaning process preserves the order of (i) configuration states in the basis, keeping only the first unique instance of each state, and (ii) the order of the spin-orbital withing each configuration state. </span></li><li  class = 'S4'><span>For instance, the </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span> </span><span style=' font-family: monospace;'>[-1 -2 1 2; -1 -3 1 2; -2 -1 1 2;-1 -2 1 3]</span><span> is cleaned to </span><span style=' font-family: monospace;'>[-1 -2 1 2; -1 -3 1 2; -1 -2 1 3]</span><span> since </span><span style=' font-family: monospace;'>[-2 -1 1 2]</span><span> is a duplicate of </span><span style=' font-family: monospace;'>[-1 -2 1 2]</span><span>, and thus removed from the set.</span></li></ul><h3  class = 'S5'><span>Run-time documentation</span></h3><h4  class = 'S6' id = 'H_E3988947' ><span style=' font-family: monospace;'>getMemoryProfile</span></h4><div  class = 'S1'><span>Get an estimate of the memory held by a </span><span style=' font-family: monospace;'>QMol_CI_conv</span><span> object with either</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >mem = obj.getMemoryProfile;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >mem = obj.getMemoryProfile(false);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>The object does not need to be </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d for the memory footprint evaluation.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>getMemoryProfile</span><span> makes efforts to return the object in the same configuration as before the profiling but small side effects cannot be entirely excluded: all the </span><a href = "#H_27AB3DA4"><span>CI-model</span></a><span> and </span><a href = "#H_D2FDD0C6"><span>Configuration-state basis</span></a><span> properties are left unchanged while run-time properties (</span><a href = "#H_80F201DB"><span>for developers</span></a><span>) may be altered. </span></li><li  class = 'S4'><span>The estimate includes the (1) </span><a href = "#H_6EFEF984"><span>domain discretization</span></a><span>, (2) </span><a href = "#H_8D5C5371"><span>external potential</span></a><span>, (3) </span><a href = "#H_C9D9F4E3"><span>electron-electron interaction potential</span></a><span>, (4) </span><a href = "#M_1F9482EA"><span>spatial orbital basis</span></a><span>, (5) </span><a href = "#H_726B4267"><span>configuration state basis</span></a><span>, (6) </span><a href = "#H_DF90D098"><span>CI matrix</span></a><span>, and (7) </span><a href = "#H_0F7B48EA"><span>dipole-coupling matrix</span></a><span> if </span><a href = "#H_5B0C4647"><span style=' font-family: monospace;'>isDipole</span></a><span> is set to </span><span style=' font-family: monospace;'>true</span><span>. Note that all these components may not be used in actual simulations and the memory estimate tries to be conservative. On the other hand, it only includes the discretization of member components on the domain grid and ignores other (small) properties.</span></li><li  class = 'S4'><span>If </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span> is empty, the profiling assumes that the configuration state basis will be built using the </span><a href = "#H_283B85DD"><span style=' font-family: monospace;'>setConfigurationBasis</span></a><span> method. Otherwise, the profiling uses </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span> to estimate the memory footprint.</span></li><li  class = 'S4'><span>The output </span><span style=' font-family: monospace;'>mem</span><span> is the estimated size in bytes.</span></li></ul><div  class = 'S1'><span>Additionally display the detail of the memory footprint with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >mem = obj.getMemoryProfile(true);</span></span></div></div></div><h4  class = 'S6' id = 'H_4D7CFC3D' ><span style=' font-family: monospace;'>showDocumentation</span></h4><div  class = 'S1'><span>Display the run-time documentation for the specific configuration of a </span><span style=' font-family: monospace;'>QMol_CI_conv</span><span> object, which must have been </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d beforehand</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.showDocumentation;</span></span></div></div></div><div  class = 'S8'><span>The run-time documentation performs the following steps</span></div><ul  class = 'S3'><li  class = 'S4'><span>Display the QMol-grid package header (showing the kernel, external component versions)</span></li><li  class = 'S4'><span>Display the </span><a href = "#H_6EFEF984"><span style=' font-family: monospace;'>discretization</span></a><span> (domain discretization) object run-time documentation</span></li><li  class = 'S4'><span>Display the electronic structure</span></li><li  class = 'S4'><span>Display the configuration state basis properties</span></li><li  class = 'S4'><span>Display the </span><a href = "#H_8D5C5371"><span style=' font-family: monospace;'>externalPotential</span></a><span> (external functional and potential) object run-time documentation</span></li><li  class = 'S4'><span>Display the </span><a href = "#H_FE7D957E"><span style=' font-family: monospace;'>HartreePotential</span></a><span> object run-time documentation</span></li><li  class = 'S4'><span>Display the </span><a href = "#H_C9D9F4E3"><span style=' font-family: monospace;'>interactionPotential</span></a><span> </span></li><li  class = 'S4'><span>Display the bibliography associated with the list of cited references (from the previous steps)</span></li><li  class = 'S4'><span>Display the funding information</span></li><li  class = 'S4'><span>Display the QMol-grid package footer</span></li></ul><h3  class = 'S5'><span>CI calculation</span></h3><div  class = 'S1'><span>All the following methods require the object to have been </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d.</span></div><h4  class = 'S6' id = 'H_17C8E8B2' ><span style=' font-family: monospace;'>computeCImatrix</span></h4><div  class = 'S1'><span>Computes the CI matrix associted with the </span><a href = "#H_27AB3DA4"><span>CI-model</span></a><span> properties.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.computeCImatrix;</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>The calculation first precomputes the core Hamiltonian matrix and two-electron 4-tensor, which are then used to build the CI matrix.</span></li><li  class = 'S4'><span>The </span><span style=' font-family: monospace;'>QMol_CI_conv</span><span> object must have a properly defined </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span>, </span><span style=' font-style: italic;'>e.g.</span><span>, built with </span><a href = "#H_283B85DD"><span style=' font-family: monospace;'>setConfigurationBasis</span></a><span>, to perform the CI matrix calculation.</span></li><li  class = 'S4'><span>The CI matrix is stored in the </span><a href = "#H_DF90D098"><span style=' font-family: monospace;'>CImatrix</span></a><span> member property. If </span><a href = "#H_5B0C4647"><span style=' font-family: monospace;'>isDipole</span></a><span> is </span><span style=' font-family: monospace;'>true</span><span>, the dipole-coupling matrix is also calculated and stored in the </span><a href = "#H_0F7B48EA"><span style=' font-family: monospace;'>DXmatrix</span></a><span> member property. Both </span><a href = "#H_DF90D098"><span style=' font-family: monospace;'>CImatrix</span></a><span> and </span><a href = "#H_0F7B48EA"><span style=' font-family: monospace;'>DXmatrix</span></a><span> are </span><span style=' font-family: monospace;'>size(</span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span style=' font-family: monospace;'>,1)-by-size(</span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span style=' font-family: monospace;'>,1)</span><span> matrices.</span></li><li  class = 'S4'><span>If </span><a href = "#H_CFCAE00D"><span style=' font-family: monospace;'>display</span></a><span> is </span><span style=' font-family: monospace;'>true</span><span>, </span><span style=' font-family: monospace;'>computeCImatrix</span><span> also prints out the progress of the CI-matrix calculation.</span></li><li  class = 'S4'><span>In the core Hamiltonian, CI, and dipole-coupling matrices as well as the two-electron 4-tensor, elements with magnitude smaller than </span><a href = "#H_BF9CB463"><span style=' font-family: monospace;'>tolerance</span></a><span> are forced to zero (set </span><a href = "#H_BF9CB463"><span style=' font-family: monospace;'>tolerance</span></a><span> to a negative value to disable this feature). </span></li></ul><div  class = 'S1'><span>Get a copy of the CI matrix with </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >CI = obj.computeCImatrix;</span></span></div></div></div><div  class = 'S8'><span style=' font-family: monospace;'>When</span><span> </span><a href = "#H_5B0C4647"><span style=' font-family: monospace;'>isDipole</span></a><span> is </span><span style=' font-family: monospace;'>true</span><span>, get a copy of the dipole-coupling matrix with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >[CI,DX] = obj.computeCImatrix;</span></span></div></div></div><h4  class = 'S6' id = 'H_0C1CE1B9' ><span style=' font-family: monospace;'>sparsify</span></h4><div  class = 'S1'><span>Convert the CI and dipole-coupling into sparse matrices</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.sparsify;</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>This can accelerate some calculations when the </span><a href = "#H_DF90D098"><span style=' font-family: monospace;'>CImatrix</span></a><span> is large.</span></li></ul><h4  class = 'S6' id = 'H_CE83FED1' ><span style=' font-family: monospace;'>computeGroundState</span></h4><div  class = 'S1'><span>Compute the </span><a href = "#H_DF90D098"><span style=' font-family: monospace;'>CImatrix</span></a><span> ground state with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj.computeGroundState;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.computeGroundState(1);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>The result is stored in </span><a href = "#H_241A5E49"><span style=' font-family: monospace;'>waveFunction</span></a><span>. </span></li><li  class = 'S4'><span>The CI object must contain a valid </span><a href = "#H_DF90D098"><span style=' font-family: monospace;'>CImatrix</span></a><span>.</span></li></ul><div  class = 'S1'><span>Additionally compute a set of lowest-energy excited states with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.computeGroundState(n);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>The integer </span><span style=' font-family: monospace;'>n</span><span> specifies the number of states to calculate, thus corresponding to </span><span style=' font-family: monospace;'>n-1</span><span> excited states.</span></li></ul><h4  class = 'S6' id = 'H_E7462FAD' ><span style=' font-family: monospace;'>getEnergy</span></h4><div  class = 'S1'><span>Compute the member wave function energy and error</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >[E,DE] = obj.getEnergy;</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>For each wave function </span><span texencoding="|\psi\rangle" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAAkCAYAAAD2IghRAAAAAXNSR0IArs4c6QAABNVJREFUWEftWFtoHFUY/v6Z2dVdLai0pMQkM7O7JjaWWgUpKmh8EJK2tAi2FrVqG6pQ460vYhV9sVVf4qU2oNFCFWpFfUiNbaEPRvCOaBHcmrqZS7IJxDtUd7u7s/ObAzNhXDbZ3Vxqgt2n5cw5/3znO///f98ZwiL90SLFjfPAz/XJnWf8f8m4pmlXEtGyQqHwTTqdzlZDQtlUaWlpWZLL5TolSYoUCoWDIyMjY9UEm+mceDx+g+u6x5n5fsuyDlcTpyzw5ubmpYVCoR/Actd1O2zbPlVNsJnOaW1tvTiTyRwU66PR6L3JZPKvSrEWBHABUtO0LUT0FjNvsCzr+KIB3tDQcHkoFOqfAP6toig7U6lUbjrwC4bxtrY2xbbtFwBsY+a1lmV9uSiAC5B+kQLoVVX18YGBAWcq8AuGcQHQL1IiWinL8tpUKjW0KIAHivQdAE+ZprkXAJcDXxPjsVjsOmbeB+BaAB8DeNg0zcFgYFVVb5NleTUz/5rJZA6Mj4//7T0nVVWvIaIHiaidiL4uFou7bNs2g+sbGxvrFUXpE2OO42ycSkNqAi6CJRKJeLFYPAqgGUBPJBJ5LJlM5sUzIVz5fP5tABsB7FNVdZeXp6Tr+lYArwHIMvM2y7KOTMGmmLsbwLNik4Zh9MyacRGgvr4+Gg6He4noTgCfFQqFDel0+nfxTFXVFZIkHRN/AWwyTfP90nFmfkbTtL3TFZ6u66sAHGPmHx3H2eTHD26gZsanA67r+u0A3ptoaXZAcScZBHC6UtF5p3qB4zg9RCRO6S7TNEXMf/1qBp5IJJYVi0WRg9cDEEr3gGVZZ70+3A3gIQB94XB46+Dg4JmS+b2RSKTLT63p+rSmaaIOjjDzh+VsQM3ANU1bQ0QnACwB8KRX+SL3gxuaHA/OJ6JOwzAOVJJzr7ssB9BPREvL+aWageu6vmMi1V8XwYlovWEYH3kv8jd0ITPfalnWJ974I0T0EoAz3vhXVQKfO8ZbW1vD2Wz2VQAC/Igsyx2pVOqHEoAnJ3z1+nQ6PZpIJPxc3Q7gC1mWN6ZSqV8qAQ+sm5scb2houCwUCok2dmOwo5QU7GQel7TO7koy7m9ozrtKwKevYeZD+Xx+x9jYWEZVVV2SJJEyKwJ5LLpJF4BXAPxRjXHyhSrQx6esiZpyvK6u7qJoNPomgDsmQL6byWQ6hTLGYrF1zCwuHj+7rttu2/Z3gm3HcfqI6Cpmfk7TtKen690+2/OmnLFYbCcz7w/0ZEPTtD1E9MRECp1g5s2KorjFYlHMuZuIDudyua7R0dHfKuV20KuIeIZhCJs7e68iAgsHl81mBah7vD7+oiRJ3cx8C4D9AigzC3N0BRHtliTpUKVLgb+heXeHQmxM01wly/LVAG5i5vu8l7/huu7RUCh0OhwO/1SN0ARP4Zz68Vgstp2ZRd6fcl13XanbqyY9xJzADWgLgA7TNL+fbm1NxVkaKNjXg12mWrDBeX7rZOZP5/3O6V9wAQj//ahlWS/PBLRY4xX985IktQ8NDX1eKc6sGNc07WbPt5ytRc5LQQlhUxRFOMA/Z/VdpdovWZ5Q7KlFzssx6TnBD4hos+99ZsR4pUV+MQ0PD68GcIlgqqmp6WQ1AlMudjweX+m67qWz/nZYDfD/es4/YYC5UvTX2AQAAAAASUVORK5CYII=" width="23" height="18" /></span><span> in </span><a href = "#H_241A5E49"><span style=' font-family: monospace;'>waveFunction</span></a><span>, the energy is defined as the real </span><span texencoding="E=\langle\psi|\hat{\mathcal{H}}|\psi\rangle" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="86.5" height="23" /></span><span> and the error as the positive real </span><span texencoding="\|(\hat{\mathcal{H}}-E)|\psi\rangle\|" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="91.5" height="23" /></span><span>, where </span><span texencoding="\hat{\mathcal{H}}" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="18" height="23" /></span><span> is the CI Hamiltonian operator (defined via the </span><a href = "#H_DF90D098"><span style=' font-family: monospace;'>CImatrix</span></a><span>).</span></li><li  class = 'S4'><span>The CI object must contain a valid </span><a href = "#H_DF90D098"><span style=' font-family: monospace;'>CImatrix</span></a><span>.</span></li></ul><h4  class = 'S6' id = 'H_853C5373' ><span style=' font-family: monospace;'>showEnergy</span></h4><div  class = 'S1'><span>Display the member wave function energy and error</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.showEnergy;</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>The energy and error are obtained from </span><a href = "#H_E7462FAD"><span style=' font-family: monospace;'>getEnergy</span></a><span>.</span></li></ul><h4  class = 'S6' id = 'H_809EA2C9' ><span style=' font-family: monospace;'>analyzeCIspectrum</span></h4><div  class = 'S1'><span>After </span><a href = "#H_17C8E8B2"><span>calculating the CI matrix</span></a><span>, use </span><span style=' font-family: monospace;'>analyzeCIspectrum</span><span> to print out the energies and wave function composition of eigen states of the CI model. Display the analysis for the </span><span style=' font-family: monospace;'>n</span><span> lowest energy eigen states with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.analyzeCIspectrum(n);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>For each eigen state, </span><span style=' font-family: monospace;'>analyzeCIspectrum</span><span> prints out the total electronic energy for the state as well as the configuration states in </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span> that substantially contribute to the state (with population larger than 1%).</span></li><li  class = 'S4'><span>For excited state, </span><span style=' font-family: monospace;'>analyzeCIspectrum</span><span> also prints out the excitation energy, defined as the energy difference with the ground state.</span></li></ul><h3  class = 'S5'><span>One-body density and one-particle density matrices</span></h3><h4  class = 'S6' id = 'H_C85EDB6F' ><span style=' font-family: monospace;'>getDensity</span></h4><div  class = 'S1'><span>Compute the one-body density associated with a wave function of a CI model, defined as </span><span texencoding="\rho({\bf r})=\int{|\psi({\bf r},\omega,{\bf x}_2\ldots{\bf x}_N)|^2\ d\omega d{\bf x}_2\ldots d{\bf x}_N}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="262.5" height="23" /></span><span>, with the integration running over (i) the first electron spin coordinate and (ii) all the following electronic and spin coordinates. The one-body density is further decomposed between its up- and down-spin contributions.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >rho = obj.getDensity;</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>Returns the one-body density of the </span><a href = "#H_241A5E49"><span style=' font-family: monospace;'>waveFunction</span></a><span> property, which must contain a single wave function.</span></li><li  class = 'S4'><span>The output </span><span style=' font-family: monospace;'>rho</span><span> is a </span><a href = "./QMol_DFT_density.html"><span style=' font-family: monospace;'>QMol_DFT_density</span></a><span> object containing the discretization of the up- and down-spin one-body density components. The density object is initialized.</span></li><li  class = 'S4'><span>Internally, the one-particle reduced density matrices associated with </span><span style=' font-family: monospace;'>psi</span><span> are calculated, using </span><span style=' font-family: monospace;'>getDensityMatrix</span><span>, from which the one-body density is reconstructed.</span></li></ul><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >rho = obj.getDensity(psi);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>Returns the one-body density for the input wave function </span><span style=' font-family: monospace;'>psi</span><span> instead of </span><a href = "#H_241A5E49"><span style=' font-family: monospace;'>waveFunction</span></a><span>. </span></li><li  class = 'S4'><span>The input wave function </span><span style=' font-family: monospace;'>psi</span><span> is specified as a column vector of population coefficients in the configuration state basis </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span>.</span></li></ul><div  class = 'S1'><span>Instead of the wave function, the one-body density can be defined via the one-particle density matrices</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >rho = obj.getDensity(rhoUp,rhoDown);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>The two input </span><span style=' font-family: monospace;'>rhoUp</span><span> and </span><span style=' font-family: monospace;'>rhoDown</span><span> matrices are typically obtained using </span><a href = "#M_828CCEBA"><span style=' font-family: monospace;'>getDensityMatrix</span></a><span>.</span></li></ul><div  class = 'S1'><span>Optionally specify the </span><a href = "./QMol_DFT_density.html"><span style=' font-family: monospace;'>QMol_DFT_density</span></a><span> object in which to store the one-body density with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.getDensity(</span><span style="color: rgb(225, 27, 20);">___</span><span >,rho);</span></span></div></div></div><h4  class = 'S6' id = 'M_828CCEBA' ><span style=' font-family: monospace;'>getDensityMatrix</span></h4><div  class = 'S1'><span>Computes the one-particle reduced density matrix (1-RDM) associated with the wave function(s) of a CI model. The matrix elements </span><span texencoding="\rho_{m,n}" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAAnCAYAAABAOmveAAAAAXNSR0IArs4c6QAABWJJREFUaEPtV2uIVGUYft7vzI67kRVFkbuj5zIHNrf6EUSa/UgqSVMyNDONTEor0zDMKCOkLLtJ0VJKZAmhrZHSxbK0KIwuFBWBeQGdc2MvhpB03d25fW/zyTlxdnY2d0SWQWb+DHzzXd7neZ/nfd8hnGYfOs3woA6o1jNaz1A9QyPMQF1yI0x41c/VM1Q1ZSN8oJ6hESa86ufqGaqashE+MKwMpVKppmQyOUtKOZ+IMgAmALgAwJZcLtfe3d392wjHPeRzJwSk67pJRK8LIY5ms9llKvixY8c2JxKJdwBcRUTvA1jouu4ftQDqfwHpuj5GCLFVBSqlnBcEwZEoaNM0nwTwGIA8EV3juu7XNQ2oubn5jMbGxvXMPJOZb/B9/7t4wJZl3cnMb6g1IrrLdd1NNQ3INM05AN5i5s2JROK+TCaTjQdsmuZiAK+Faws8z9tcs4BSqdS5iURim5ISgDme520vC5ZM03wewEoAfzHzFN/3v69ZQIZhTCWiHQAyUsrpQRB48WANwziHiFRRmMLMXxQKhTldXV3HahLQ5MmTE0EQPAdgBTN35HK5xT09Pb3xYNPp9CQp5S4Ao4loqeu6G2oBzHE/lwdi2/b5xWLxAwBXMvMDvu+3x/fYtj1KStnOzPcA+DSfz88LsyPS6fREKeVsVc5VdpPJ5JJsNjuJiNYBuAjAbUq+lmVdLqV8VkmaiFa5rqsI5PJY0um0zcw3SilVexgvhFgkpewuEfkCgBtLMe7O5/N3xNUxCJBhGBOI6DMAjaE3viyT2/VEtA3AEU3TZmUymf2Vqh8RPSilPCaEaALQycwflqr/agABgFYi+kQpgJm/qqSC6E7bttPFYvFjZu4ioicAzCYiVX3XAFAETguC4GC0vxKg5UT0EoCD5f6xbfviYrH4rjrMzAsqFYKwPy1n5vVEdNDzvC2WZS1k5lcBbAyJWCelvI6ZPyKiFa7rqvcGZUi9ExHMzNuFEDkiWpvNZv9paGjYQUSH+/v7l8YtMQCQ6j3JZHIjEc0H8KMQYrrjOEeVNNXFANTEcFhJ0fM8xfSAT2tr6+hcLqfK90wAL2ua9lAqlSoGQfAigPvVqKRp2tJMJvNnBFwIMdVxnG+H8qBhGBHBh8KKu1fX9cuEELtCMjriZAwApMYcIcROAONLQf3MzJ4CAOAKZlbfGzzP+0UNDpUC0HVd6VxJ6W8hxCzXdQ/FPNkshJjhOM6+GPALmfkm3/d/rXRfnGBmvtf3fZVhGTb11dF98bMDABmGcXXon/6T6S2GYdxKRFuZ+XHf99VoJCPJENGmcePGrdyzZ08hAg5gp67ry9XaEARFBB8rFAq3dHZ29rS1tSX7+vpeATCGmW/3ff/3IQGZpvkogLVlchtWRY49NJOIZriu+0PoASWZdUQ0zXXdz9WaaZo3A9jGzPOEED8R0SjHcfYbhnG2+t33fTXosmVZ05XP1Mzoed7Tai2VSrU0NDSote1q9NI0Le04zjeDikKZ/jc2NTUtO3DgQG5YaErmij3UFTHX1tZ2Zm9v75tE1BKTVjRlzCWiR6SUlyYSiWdKpr8k7G2NABbput4Rem9h3GcRGaWiNZeZx2uatslxnM5BgGIy0E9m2IzkSkQPR1WrkrTCTKq+dLfyZD6fX6v6SChN9VdE+apDCLGKmd9m5r74JBK+8x6AfZqmLSlvG/95KDY99wCY5nne3uFm51TusyzrWmaeGEms2ruPA2ppaTkvmUyq7quq225d19cMZdRqH6hmv23bZxWLxac0TWvPZDJONWeHbKwnc8mpOKM8nM/nlym5Vepxw33jhH/Bh3tRreyrA6qVTAwVx2mXoX8BJla4RulsxGoAAAAASUVORK5CYII=" width="26" height="19.5" /></span><span> of the 1-RDM are associated with the one-particle density operators </span><span texencoding="|m\rangle\langle n|" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="41" height="18" /></span><span> of the </span><span texencoding="m^\text{th}" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAoCAYAAACFFRgXAAAAAXNSR0IArs4c6QAABINJREFUWEftmGtoXEUUx/9n7t2Fu7WgfjA07uY+sjQYRS0UK1YhikFraxVpBS2iEPoltKhRU0QQX61VqBhaBC2miuAr/dCiVqE+Igj6QfABbknZvY+aRFIR0RqX3N2dYwZ24WaTuLukxg1sPmbOzPzuf/7nzJklrLA/WmG8aAH/1yfWUrhBhSmVSq3RNG0rEX3hed5Yrfn/m8JtbW2rDMPoI6IBACYz9/i+/2VTAafT6ctLpVIxqqTjOPuZeU/TASeTyYtjsdg7zLwvqmRTAieTSSMWiz0N4LFqJZsRWHMc504p5QARXUdEbwA4A+Ck67pfRYBvFUI4zPw4gBQzf05E/dWJuGxJt5iSlf8D+JaIhkul0jEiup2IDjHzB4lE4v5MJvNXJRmbBlhKeVcQBMcAsGVZFxLR+wCSUsrNQRB4TQcc9XZ7e3siHo8fJqKNUspNQRCcagHXKvi1PNxSuJaCtcZXnMK2be8E8BqAQSnlUSLaCuBVIcRT6momoptd1/1MfbjqMxKJxOsArq2ZdN3d3fEwDFPFYnG9EEJNuIGI3vQ87yAAYZrmLUT0LBFdOdu0HDEM45FynSTHcdYz83MAbgRwTAixK5fLnVUQpmmuEUIo4I1E9J6U8gUhxBXM/AyAdQBGmPkAM58p1+H9AC4iIhV3IJvN/qrWmVeHOzs71SJdzDwI4BoA55i5N5FI/JTP5/cC2ACgqDYGUCCimzo6Or7xfb9PXb0AflAbAogB2O553tFadmlkfLGLg2zbfhHAo+oK1TRtR7FY7AeQ13V9SEp5PTN/CuCsOjJN066SUvYWCoXduq5fIoT4WIm6bMBdXV2rwzB8C8Ad6kgAnJZSpizL2js6Olq0LOtBInoZwNcAXgHQo2naQDab/dNxnM3M/CGAoNp/jSi5WOyCCjuOs1ZKeYKIOpl5mIhKhmEMKK8qj+fz+UMAVBIdV5aRUg4GQfCLspj6KCJSDczxeDx+39jY2LnzAfqvN11EpcKsyt8JIbblcrmf1aRkMnlpLBZTCl4N4Hci2l7J7ujJzPr7Cc/z9p1P2AWTrkolBbzD87yRysaWZW2YveNPAljNzM9blvWkskm5ElxW9m+7StR6njyNftA8S6iXga7rIyr7iUh1Tw+4rvtHBLji30kAmzzP+7EyZtv2NlWeAHxfKBS2jI+PTzQKVCt+HnBUQSLqc113uLJIpIu6F8BhwzB2ZTKZUI339PToQRC8BGB39VgtiEbGFwKuKHha07TbstlsrrJgOp3uLJVKJwCsJaItrut+FFG+0sP2lj/0iG3bvapa1PN8rxd6DnBUQVUddF3vz2azMwsc+anqxto0zXWzN+MnAAzlXyHEBcx898zMzMOTk5N/1wtUK24OsGmalaRRvxPc4/v+u5UFokfOzG+HYbgzChLxr7qK1bxVYRjumZiY+K0WRCPjc4Ajm84r+qlUql3XdVV3Vb/wkO/7Q9GNyt5XSQoiGpqenj44NTU13QhMPbHL9qarB6aemBZwPSotJaal8FLUq2duS+F6VFpKzIpT+B9vosVHWvKcSAAAAABJRU5ErkJggg==" width="22" height="20" /></span><span> and </span><span texencoding="n^\text{th}" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAoCAYAAACSN4jeAAAAAXNSR0IArs4c6QAAA85JREFUWEftl11oW2UYx//PeXOaRtiNoGBtez4SqeuVU1AcMgMqqJVNcEUQEdlWBxNREbeh80ac1pvioFeKAxUEES/8YoIiEXHzQpjCiCDnI8eUShX0wpk2Oee8j3khR7ImpTklXQbmvUvej+f3/p+v9xCu0EFXKBeGYGk98/9WbHp6eqRWq+0moolcLvdBuVxubKbgtiuWz+dvkVI+D+BhZn6/0WjMLS8v1y47WKFQyMZxvCeXy32TKGMYxk5N084w83cDA7MsaxbAvnq9/kSizMDBTNO8jYjeZeYf2pUZKFg+n5+I4/hZIjrEzL8C+ATA79ls9u21tbXxxJVCiAVmPsHMMwAuMvPLpmkulkqlqD3u+hr8GynT9n+GiM5KKeeFEArqTQC7mXlvpVL5YmBgAC6EYfjY0tLSnwrCsqz9AD4E8KLv+68ODGx9VpqmeScRlYjodc/zjg/BNisXQ8V6yMpLKv9lUyyfz18rpfwcQBbALBHdzMyulPJvVccAfF+r1Q6urKz8owLdtu27mPmrnoK/WCxmqtXqdVLKXQBuBbCHiM54njcPgCzLupuIjjcPvIOZvxVCHHZd12lllJp/FMApZvY0TXstDMMfdV2fY+ZjAP5iZrX3UyKaJKLn1AWaLew8ER2dnJwsJYW2o8AahmER0V4iehzATQDUbe+t1+vnM5nMS830LhLRCjM/2ILpqEGbvRx6md+w8tu2Pd+65bkoivbrun642T40IcQrYRjaLdcYzPxMpVI51YuxNGu6gk1NTe1oNBrvqVeC8j+AX6SUE6ZpnlRS27at3Pg1gDWlpuu6Z9MY7WVtV7AkuwCMqXgBcEMYhgfaWslcc071uXNCiH2O4/zRi7E0a7qCtfWwEICvadpDruteUAerZ/Lq6uoiAAW3YBjGsfUvgzQAG63tAFNZGQTBAoCnWpsO+b5/GgCr3+Pj49fruv6ZSgwiesDzPFUe+j46wAqFwjVxHH8M4HYVR1EUzSYuVNZbRfFLAI6UciYIAr/vVKourT+09QpVhncQ0UHP85Ra/w3Lsl4AcDLNh8VWwLuBPU1Eb6hMFELc7ziOmxzcnq1JmbAsSxXhuu/7P20FoKcYGxsbu2pkZOQtInqEmU9nMpkjjuPUk81t2Xp18211DxGtEtGB0dHRE+Vy+eK2gamqr2maCuad3dyYNF3VDZh5UdO0G+M4fjIIgt/6CaXOusSVtm3PMLPKuEBKeV8QBD+3G2w16XcAFAF8FEXR0Wq1utxvqA6w7TCw1TP7+pW0VYhu+4ZgadUcKjZULK0Cadf/C7D4eUc+VtLTAAAAAElFTkSuQmCC" width="19" height="20" /></span><span> spin orbitals in the basis. The one-body density </span><span style="font-family: STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);"></span><span> is recovered from the 1-RDM as </span><span texencoding="\rho=\sum_{m,n}\rho_{m,n}\chi_m^*\chi_n" style="vertical-align:-10px"><img src="data:image/png;base64,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" width="113.5" height="26" /></span><span>. The 1-RDM is further decomposed between its up- and down-spin contributions (since the two spin channels do not mix in the joint 1-RDM space).</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >[rhoUp,rhoDown] = obj.getDensityMatrix;</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>Returns the 1-RDM matrices for the up (</span><span style=' font-family: monospace;'>rhoUp</span><span>) and down (</span><span style=' font-family: monospace;'>rhoDown</span><span>) spin channels of the </span><a href = "#H_241A5E49"><span style=' font-family: monospace;'>waveFunction</span></a><span> property. </span></li><li  class = 'S4'><span>For a single wave function (column vector </span><a href = "#H_241A5E49"><span style=' font-family: monospace;'>waveFunction</span></a><span>), the 1-RDM are </span><span style=' font-family: monospace;'>size(</span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span style=' font-family: monospace;'>,1)</span><span>-by-</span><span style=' font-family: monospace;'>size(</span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span style=' font-family: monospace;'>,1)</span><span> matrices. </span></li><li  class = 'S4'><span>If </span><a href = "#H_241A5E49"><span style=' font-family: monospace;'>waveFunction</span></a><span> contains several wave functions, the  output </span><span style=' font-family: monospace;'>rhoUp</span><span> and </span><span style=' font-family: monospace;'>rhoDown</span><span> are</span><span style=' font-family: monospace;'> size(</span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span style=' font-family: monospace;'>,1)</span><span>-by-</span><span style=' font-family: monospace;'>size(</span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span style=' font-family: monospace;'>,1)</span><span>- by-</span><span style=' font-family: monospace;'>size(</span><a href = "#H_241A5E49"><span style=' font-family: monospace;'>waveFunction</span></a><span style=' font-family: monospace;'>,2)</span><span> arrays. One can recover the 1-RDM matrices for the </span><span style=' font-family: monospace;'>k</span><span texencoding="^\text{th}" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAnCAYAAAALkrgzAAAAAXNSR0IArs4c6QAAAZ1JREFUSEvtlT9IG1Ecx7/fS3NdBKGbcBByHA4HBSF7OREHB1HoYunWopRugsUxOlhEUBRcRPwDTp0c3KSLoIPtYMDBpXl3l0C34HhDcu9XA6aEBD1IGwS5B2968Pm99/1+f79H9GmxT1w8Y7BlWa9M05wAECqlzpMkTJSiUChka7XaW5KLAEZIflRK7fcEdhzH0loPKaV+tgC2bX8Qkb2ewY7jvNRabwH40X6zfwJ7nveiUqnMicgmyU//DZzL5UYNw5gHMAnghORVHMelMAyPWzcGMEvyVkSKAF4DuCb5udPQLvMeenIb+EZEvhmGcdAEi8gRgHKj0ZiqVqu/W570Av7i+/4GAO26rhlF0TaAGREZD4LgsmdwZyps214VkUUR8YIgOEvBTyvFmIh8J7mjtV4i+b5erx+YpjndbGkAc77v796bxHw+vwZgIdE813UHoihaB/AOwGkcx8VsNjvYLAJg/G5fAFjOZDIlrfUbEfkKYJjkIcmVcrn8q1k0cbolTbGHzlPwX2VSKVIputskTUWaijQVj3wvfWuQP8fbTTfpMu8oAAAAAElFTkSuQmCC" width="11" height="19.5" /></span><span> wave function component with </span><span style=' font-family: monospace;'>rhoUp(:,:,k)</span><span> and </span><span style=' font-family: monospace;'>rhoDown(:,:,k)</span><span>, which are all Hermitian matrices.</span></li><li  class = 'S4'><span>To speed up calculations of the density matrices, contributions smaller than </span><a href = "#H_BF9CB463"><span style=' font-family: monospace;'>tolerance</span></a><span> are skipped in 1-RDM calculation. This may lead to slight difference when the 1-RDM for a collection of wave functions are calculated together (matrix </span><span style=' font-family: monospace;'>psi</span><span>) vs. separately (vector </span><span style=' font-family: monospace;'>psi</span><span>). Set </span><a href = "#H_BF9CB463"><span style=' font-family: monospace;'>tolerance</span></a><span> to a negative value to disable this feature.</span></li><li  class = 'S4'><span>Note: the calculation of the 1-RDM can be time consuming, especially when using large configuration state bases (the algorithm shares a similar outline as when </span><a href = "#H_17C8E8B2"><span>calculating the CI matrix</span></a><span>).</span></li></ul><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >[rhoUp,rhoDown] = obj.getDensityMatrix(psi);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>Returns the 1-RDM matrices for the input wave function(s) </span><span style=' font-family: monospace;'>psi</span><span> instead of </span><a href = "#H_241A5E49"><span style=' font-family: monospace;'>waveFunction</span></a><span>. </span></li><li  class = 'S4'><span>Each column in </span><span style=' font-family: monospace;'>psi</span><span> specifies the population coefficients in the configuration state basis </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>configurationBasis</span></a><span>.</span></li></ul><h2  class = 'S2' id = 'H_B96E4244' ><span>Examples</span></h2><h3  class = 'S5'><span>Build the spatial orbital basis set</span></h3><div  class = 'S1'><span>To define the spatial-orbital basis set for our CI calculations, we first run a </span><a href = "./QMol_DFT_spinRes.html"><span>spin-restricted DFT</span></a><span> calculation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Molecular model</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >x       =   -50:.1:50;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >A1      =   QMol_Va_softCoulomb(</span><span style="color: rgb(167, 9, 245);">'name'</span><span >,</span><span style="color: rgb(167, 9, 245);">'atom 1'</span><span >,</span><span style="color: rgb(167, 9, 245);">'charge'</span><span >,3,</span><span style="color: rgb(167, 9, 245);">'position'</span><span >,-3);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >A2      =   QMol_Va_softCoulomb(</span><span style="color: rgb(167, 9, 245);">'name'</span><span >,</span><span style="color: rgb(167, 9, 245);">'atom 2'</span><span >,</span><span style="color: rgb(167, 9, 245);">'charge'</span><span >,3,</span><span style="color: rgb(167, 9, 245);">'position'</span><span >,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% DFT model</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >Vext    =   QMol_DFT_Vext(</span><span style="color: rgb(167, 9, 245);">'atom'</span><span >,{A1,A2});</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >Vh      =   QMol_DFT_Vh_conv;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >Vxc     =   {QMol_DFT_Vx_LDA_soft,QMol_DFT_Vc_LDA_soft};</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >DFT     =   QMol_DFT_spinRes(                                   </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >                </span><span style="color: rgb(167, 9, 245);">'xspan'</span><span >,                        x,              </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >                </span><span style="color: rgb(167, 9, 245);">'occupation'</span><span >,                   [2 2 2 0 0 0],  </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >                </span><span style="color: rgb(167, 9, 245);">'externalPotential'</span><span >,            Vext,           </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >                </span><span style="color: rgb(167, 9, 245);">'HartreePotential'</span><span >,             Vh,             </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >                </span><span style="color: rgb(167, 9, 245);">'exchangeCorrelationPotential'</span><span >, Vxc,            </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >                </span><span style="color: rgb(167, 9, 245);">'selfInteractionCorrection'</span><span >,    </span><span style="color: rgb(167, 9, 245);">'ADSIC'</span><span >         );</span></span></div></div></div><div  class = 'S8'><span>Note that we include 3 virtual orbitals (with occupation 0) in the DFT model, which will define the active space for the CI calculations. Finally, we run a DFT-ground state calculation to obtain our spatial orbital basis set.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >SCF     =   QMol_DFT_SCF_Anderson;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >SCF.solveSCF(DFT);</span></span></div></div></div><div  class = 'S8'><span>yielding</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S12'><span style="white-space: pre"><span >(...)</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >=== Orbital energies =====================================================</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Orbital      Occ. (elec.)         Energy (-eV)               Error(a.u.)</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  -------      ------------         ------------               -----------</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >      1            2.00                29.364                   2.051e-12</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >      2            2.00                28.874                   2.104e-12</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >      3            2.00                10.650                   4.065e-12</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >      4            0.00                 7.672                   8.120e-12</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >      5            0.00                 3.807                   1.381e-11</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >      6            0.00                 2.101                   1.294e-11</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  ------------------------------------------------------------------------</span></span></div><div  class = 'S12'>&nbsp;</div><div  class = 'S12'><span style="white-space: pre"><span >=== DFT-component energies ===============================================</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Component      Energy (a.u.)      Energy (eV)</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  -----------    -------------     -------------</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Kinetic             1.352             36.802</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  External          -17.135           -466.274</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Hartree             5.521            150.243</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Exch.-corr.        -0.557            -15.170</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  -----------    -------------     -------------</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Total             -10.819           -294.398</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  ----------------------------------------------</span></span></div></div><h3  class = 'S5'><span>Set the CI model</span></h3><div  class = 'S1'><span>We now aim to define our CI model associated with the basis of DFT spatial orbitals above. To do so, we let </span><span style=' font-family: monospace;'>QMol_CI_conv</span><span> read the relevant properties off the </span><span style=' font-family: monospace;'>DFT</span><span> object.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >CI      =   QMol_CI_conv(DFT);</span></span></div></div></div><div  class = 'S8'><span>Next, we aim to perform a CISD calculation using the occupied DFT orbitals as our reference and all the virtual DFT orbitals for the active space. These correspond to the default values for the </span><a href = "#H_C361E917"><span style=' font-family: monospace;'>reference</span></a><span> and </span><a href = "#H_7A72D8B8"><span style=' font-family: monospace;'>active</span></a><span> properties, and thus only need to set the </span><a href = "#H_19D8F0C2"><span style=' font-family: monospace;'>type</span></a><span> of CI.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >CI.set(</span><span style="color: rgb(167, 9, 245);">'type'</span><span >,</span><span style="color: rgb(167, 9, 245);">'CISD'</span><span >);</span></span></div></div></div><div  class = 'S8'><span>Before building the configuration space basis, we check the memory footprint of our CI model with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >CI.getMemoryProfile(true);</span></span></div></div></div><div  class = 'S8'><span>that prints out</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S12'><span style="white-space: pre"><span >  * Domain discretization                                        </span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt; domain                                                        7.8 KB</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt; gradient                                                     15.6 KB</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt; Laplacian                                                     7.8 KB</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt; Laplacian (velocity gauge)                                   15.6 KB</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * External functional                                          </span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt; potential                                                     7.8 KB</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt; potential gradient                                            7.8 KB</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Electron-electron interaction                                  15.6 KB</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Spatial orbital basis                                          46.9 KB</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Configuration state basis                                       5.5 KB</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * CI matrix                                                     108.8 KB</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Dipole-coupling matrix                                        108.8 KB</span></span></div></div><div  class = 'S1'><span>Finally, we build the CISD basis with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >CI.setConfigurationBasis;</span></span></div></div></div><div  class = 'S8'><span>that prints out</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S12'><span style="white-space: pre"><span >(...)</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >=== Build the configuration-interaction (CI) model [Visentin 2025] =======</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Discretization                                                      OK</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * External (atomic or molecular) potential                            OK</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Electron-electron interaction potential                             OK</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >=== References ===========================================================</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  [Mauger 2024b] F. Mauger and C. Chandre, "QMol-grid : A MATLAB package</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    for quantum-mechanical simulations in atomic and molecular systems," </span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    SoftwareX 28, 101968 (2024).</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  [Visentin 2025] G. Visentin et al., in preparation (2025).</span></span></div><div  class = 'S12'>&nbsp;</div><div  class = 'S12'><span style="white-space: pre"><span >=== Funding ==============================================================</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    The original development of the QMol-grid package, and its (TD)DFT</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  features, was supported by the U.S. Department of Energy, Office of</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Science, Office of Basic Energy Sciences, under Award No. DE-SC0012462.</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Addition of the (TD)SE and CI features was supported by the National</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Science Foundation under Grant No. PHY-2207656.</span></span></div><div  class = 'S12'>&nbsp;</div><div  class = 'S12'><span style="white-space: pre"><span >##########################################################################</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >=== Set the configuration-state basis ====================================</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Initialization                                                    DONE</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Configuration-state basis</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Type         = CISD</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Total spin   = 0</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Reference(s) = -1 -2 -3 1 2 3</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Active       = 4 5 6</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >                   -6 -5 -4</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    118 configuration-state basis elements</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    V-01.22.000 (05/20/2025)                       G. Visentin &amp; F. Mauger</span></span></div><div  class = 'S12'>&nbsp;</div><div  class = 'S12'><span style="white-space: pre"><span >##########################################################################</span></span></div></div><h3  class = 'S5'><span>Compute the CI matrix and analyze its spectrum</span></h3><div  class = 'S1'><span>We now have all the elements in place to calculate the CI matrix with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >CI.computeCImatrix;</span></span></div></div></div><div  class = 'S8'><span>that prints out</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S12'><span style="white-space: pre"><span >(...)</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >=== Build the configuration-interaction (CI) model [Visentin 2025] =======</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Discretization                                                      OK</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * External (atomic or molecular) potential                            OK</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Electron-electron interaction potential                             OK</span></span></div><div  class = 'S12'>&nbsp;</div><div  class = 'S12'><span style="white-space: pre"><span >=== References ===========================================================</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  [Mauger 2024b] F. Mauger and C. Chandre, "QMol-grid : A MATLAB package</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    for quantum-mechanical simulations in atomic and molecular systems," </span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    SoftwareX 28, 101968 (2024).</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  [Visentin 2025] G. Visentin et al., in preparation (2025).</span></span></div><div  class = 'S12'>&nbsp;</div><div  class = 'S12'><span style="white-space: pre"><span >=== Funding ==============================================================</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    The original development of the QMol-grid package, and its (TD)DFT</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  features, was supported by the U.S. Department of Energy, Office of</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Science, Office of Basic Energy Sciences, under Award No. DE-SC0012462.</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Addition of the (TD)SE and CI features was supported by the National</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Science Foundation under Grant No. PHY-2207656.</span></span></div><div  class = 'S12'>&nbsp;</div><div  class = 'S12'><span style="white-space: pre"><span >##########################################################################</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >=== CI-matrix calculation ================================================</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >                                       Calculation progress (%)</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Calculation step          0       20       40       60       80      100</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  ----------------------    ----------------------------------------------</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Core integrals            ||||||||||||||||||||||||||||||||||||||||||||||</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Dipole coupling elements  ||||||||||||||||||||||||||||||||||||||||||||||</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Two-electron integrals    ||||||||||||||||||||||||||||||||||||||||||||||</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  CI matrix                 ||||||||||||||||||||||||||||||||||||||||||||||</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  ------------------------------------------------------------------------</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >                                            CI-matrix calculation complete</span></span></div><div  class = 'S12'>&nbsp;</div><div  class = 'S12'><span style="white-space: pre"><span >##########################################################################</span></span></div></div><div  class = 'S1'><span>Finally, we inspect the ground and first 2 excited states of our CI model with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >CI.analyzeCIspectrum(3);</span></span></div></div></div><div  class = 'S8'><span>that prints out</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S12'><span style="white-space: pre"><span >=== CI matrix spectrum ===================================================</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * CI matrix</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    size = 118 x 118 with 3374 nonzero elements</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Ground state</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Total energy      =    -10.838 a.u. =   -294.920 eV</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt;  92.581 % [  -1  -2  -3  1  2  3  ]</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt;   6.250 % [  -1  -2  -4  1  2  4  ]</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Excited state</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Total energy      =    -10.769 a.u. =   -293.039 eV</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Excitation energy =      0.069 a.u. =      1.881 eV</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt;  49.018 % [  -1  -2  -4  1  2  3  ]</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt;  49.018 % [  -1  -2  -3  1  2  4  ]</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Excited state</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Total energy      =    -10.623 a.u. =   -289.062 eV</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Excitation energy =      0.215 a.u. =      5.857 eV</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt;   3.828 % [  -1  -2  -6  1  2  3  ]</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt;  38.990 % [  -1  -2  -4  1  2  3  ]</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt;  38.990 % [  -1  -2  -3  1  2  4  ]</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt;   3.828 % [  -1  -2  -3  1  2  6  ]</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt;   7.014 % [  -1  -2  -5  1  2  4  ]</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt;   7.014 % [  -1  -2  -4  1  2  5  ]</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >==========================================================================</span></span></div></div><div  class = 'S1'><span>In the ground state, we notice a substantial (&gt;6%) contribution from the double excitation from the highest-occupied (HOMO, index +/- 3) to the lowest unoccupied (LUMO, index +/-4) molecular orbitals. The first excited state sits less than 2 eV above the ground one, and is almost fully composed of single excitations from the HOMO to the LUMO orbitals (one in each spin channel). On the other hand, the second excited state contains substantial contributions from single excitations from the HOMO to LUMO and LUMO+2 (index +/- 6), as well as double excitations from the HOMO to the LUMO and LUMO+1 (index +/-5).</span></div><h4  class = 'S6'><span>Plot the ground state one-body density</span></h4><div  class = 'S1'><span>To get a better visualization of the ground state, we now want to plot its one-body density. First, we calculate the ground state vector, which corresponds to the eigen vector of the CI matrix with the smallest energy</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >CI.computeGroundState;</span></span></div></div></div><div  class = 'S8'><span>from which we can recover the one-body density (and that of the parent DFT model for comparison)</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >rho_CI  = CI.getDensity(CI.waveFunction);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >rho_DFT = DFT.getDensity;</span></span></div></div></div><div  class = 'S8'><span>Finally, we plot the results</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >figure</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    subplot(3,1,[1 2]), hold </span><span style="color: rgb(167, 9, 245);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >        plot(CI.xspan,rho_CI.densityUp+rho_CI.densityDown,</span><span style="color: rgb(167, 9, 245);">'-'</span><span >,</span><span style="color: rgb(167, 9, 245);">'LineWidth'</span><span >,2,</span><span style="color: rgb(167, 9, 245);">'DisplayName'</span><span >,</span><span style="color: rgb(167, 9, 245);">'CI'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >        plot(DFT.xspan,rho_DFT.density,</span><span style="color: rgb(167, 9, 245);">':'</span><span >,</span><span style="color: rgb(167, 9, 245);">'LineWidth'</span><span >,2,</span><span style="color: rgb(167, 9, 245);">'DisplayName'</span><span >,</span><span style="color: rgb(167, 9, 245);">'DFT'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >        xlim(DFT.xspan([1 end]));</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >        ylabel(</span><span style="color: rgb(167, 9, 245);">'densty (elec./a.u.)'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >        legend </span><span style="color: rgb(167, 9, 245);">show</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    subplot(3,1,3), hold </span><span style="color: rgb(167, 9, 245);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >        plot(CI.xspan,rho_CI.densityUp+rho_CI.densityDown-rho_DFT.density,</span><span style="color: rgb(167, 9, 245);">'-'</span><span >,</span><span style="color: rgb(167, 9, 245);">'LineWidth'</span><span >,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >        xlabel(</span><span style="color: rgb(167, 9, 245);">'position (a.u.)'</span><span >); xlim(DFT.xspan([1 end]));</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >        ylabel(</span><span style="color: rgb(167, 9, 245);">'difference'</span><span >)</span></span></div></div></div><div  class = 'S8'><img class = "imageNode" src = "data:image/png;base64,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" width = "420" height = "315" alt = "fig_CI_density_comparison.png" style = "vertical-align: baseline; width: 420px; height: 315px;"></img></div><h3  class = 'S5'><span>Basis-set discretization example</span></h3><div  class = 'S1'><span>To illustrate CI calculations starting from a basis-set discretization, we consider a HF set of orbitals obtained with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Domain and atomic centers</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >x       =   -20:.1:15;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >A1      =   QMol_Va_softCoulomb(</span><span style="color: rgb(167, 9, 245);">'name'</span><span >,</span><span style="color: rgb(167, 9, 245);">'atom 1'</span><span >,</span><span style="color: rgb(167, 9, 245);">'charge'</span><span >,3,</span><span style="color: rgb(167, 9, 245);">'position'</span><span >,-3);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >A2      =   QMol_Va_softCoulomb(</span><span style="color: rgb(167, 9, 245);">'name'</span><span >,</span><span style="color: rgb(167, 9, 245);">'atom 2'</span><span >,</span><span style="color: rgb(167, 9, 245);">'charge'</span><span >,3,</span><span style="color: rgb(167, 9, 245);">'position'</span><span >,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Common shape for atomic orbitals</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >AO      =   @(s,n,x0,x) (x(:)-x0).^n .*exp(-(x(:)-x0).^2 * .5/s^2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Atomic orbital basis</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >V       =  [AO(1.3,0,A1.position,x),AO(1.7,1,A1.position,x),AO(0.8,2,A1.position,x), </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >            AO(1.3,0,A2.position,x),AO(1.7,1,A2.position,x),AO(0.8,2,A2.position,x)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Orthonormalize the basis</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >disc                =   QMol_disc_basis(</span><span style="color: rgb(167, 9, 245);">'xspan'</span><span >,x,</span><span style="color: rgb(167, 9, 245);">'basis'</span><span >,V);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >disc.orthonormalizeBasis;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% HF model</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >Vext    =   QMol_DFT_Vext(</span><span style="color: rgb(167, 9, 245);">'atom'</span><span >,{A1,A2});</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >Vh      =   QMol_DFT_Vh_conv;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >Vxc     =   QMol_DFT_Vx_XX_conv;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >HF      =   QMol_DFT_spinRes(                                   </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >                            </span><span style="color: rgb(167, 9, 245);">'discretization'</span><span >,               disc,           </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >                            </span><span style="color: rgb(167, 9, 245);">'occupation'</span><span >,                   [2 2 2 0 0 0],  </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >                            </span><span style="color: rgb(167, 9, 245);">'externalPotential'</span><span >,            Vext,           </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >                            </span><span style="color: rgb(167, 9, 245);">'HartreePotential'</span><span >,             Vh,             </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >                            </span><span style="color: rgb(167, 9, 245);">'exchangeCorrelationPotential'</span><span >, Vxc);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% DFT ground state</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >SCF     =   QMol_DFT_SCF_Anderson;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >SCF.solveSCF(HF);</span></span></div></div></div><div  class = 'S8'><span>yielding</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S12'><span style="white-space: pre"><span >(...)</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >=== Orbital energies =====================================================</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Orbital      Occ. (elec.)         Energy (-eV)               Error(a.u.)</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  -------      ------------         ------------               -----------</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >      1            2.00                34.843                   3.274e-12</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >      2            2.00                34.125                   2.177e-12</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >      3            2.00                 9.103                   4.466e-12</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >      4            0.00                -0.350                   3.637e-12</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >      5            0.00               -48.715                   3.166e-12</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >      6            0.00               -49.452                   3.523e-12</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  ------------------------------------------------------------------------</span></span></div><div  class = 'S12'>&nbsp;</div><div  class = 'S12'><span style="white-space: pre"><span >=== DFT-component energies ===============================================</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Component      Energy (a.u.)      Energy (eV)</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  -----------    -------------     -------------</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Kinetic             1.262             34.338</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  External          -16.974           -461.887</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Hartree             6.639            180.650</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Exch.-corr.        -1.652            -44.945</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  -----------    -------------     -------------</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Total             -10.725           -291.844</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  ----------------------------------------------</span></span></div></div><div  class = 'S1'><span>Note that the LUMO+1 and LUMO+2 orbitals have very large energies and may not make much sense to include in practical CI calculations. We keep them here for illustration purposes.</span></div><div  class = 'S1'><span>Next, we set the CI model with a complete active space (RAS </span><a href = "#H_19D8F0C2"><span style=' font-family: monospace;'>type</span></a><span> with no additional restrictions) over all the calculated HF molecular orbitals and check the memory footprint of the system</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >CI      =   QMol_CI_conv(HF,</span><span style="color: rgb(167, 9, 245);">'type'</span><span >,</span><span style="color: rgb(167, 9, 245);">'RAS'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >CI.getMemoryProfile(true);</span></span></div></div></div><div  class = 'S8'><span>yielding</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S12'><span style="white-space: pre"><span >(...)</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Domain discretization                                        </span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt; domain                                                        2.7 KB</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt; gradient                                                      5.5 KB</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt; Laplacian                                                     2.7 KB</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt; Laplacian (velocity gauge)                                    5.5 KB</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt; basis                                                        16.5 KB</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt; gradient matrix                                               288  B</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt; Laplacian matrix                                              288  B</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt; Laplacian matrix (velocity gauge)                             576  B</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * External functional                                          </span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt; potential                                                     2.7 KB</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt; potential gradient                                            2.7 KB</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Electron-electron interaction                                   5.5 KB</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Spatial orbital basis                                          16.5 KB</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Configuration state basis                                      18.8 KB</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * CI matrix                                                       1.2 MB</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Dipole-coupling matrix                                          1.2 MB</span></span></div></div><div  class = 'S1' id = 'M_7F63DB59' ><span>Note that the HF basis-set discretization domain has been converted to a regular discretization grid as the spatial-orbital basis is rebuilt over the discretization grid in </span><span style=' font-family: monospace;'>QMol_CI_conv</span><span>.</span></div><div  class = 'S1'><span>From there, the steps are identical to the grid-based example above. We first build the configuration state basis with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >CI.setConfigurationBasis;</span></span></div></div></div><div  class = 'S8'><span>that prints out</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S12'><span style="white-space: pre"><span >(...)</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >=== Build the configuration-interaction (CI) model [Visentin 2025] =======</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Discretization                                                      OK</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * External (atomic or molecular) potential                            OK</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Electron-electron interaction potential                             OK</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >=== References ===========================================================</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  [Mauger 2024b] F. Mauger and C. Chandre, "QMol-grid : A MATLAB package</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    for quantum-mechanical simulations in atomic and molecular systems," </span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    SoftwareX 28, 101968 (2024).</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  [Visentin 2025] G. Visentin et al., in preparation (2025).</span></span></div><div  class = 'S12'>&nbsp;</div><div  class = 'S12'><span style="white-space: pre"><span >=== Funding ==============================================================</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    The original development of the QMol-grid package, and its (TD)DFT</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  features, was supported by the U.S. Department of Energy, Office of</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Science, Office of Basic Energy Sciences, under Award No. DE-SC0012462.</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Addition of the (TD)SE and CI features was supported by the National</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Science Foundation under Grant No. PHY-2207656.</span></span></div><div  class = 'S12'>&nbsp;</div><div  class = 'S12'><span style="white-space: pre"><span >##########################################################################</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >=== Set the configuration-state basis ====================================</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Initialization                                                    DONE</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Configuration-state basis</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Type         = RAS</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Total spin   = 0</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Active       = 1 2 3 4 5 6</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >                   -6 -5 -4 -3 -2 -1</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    400 configuration-state basis elements</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    V-01.22.000 (05/20/2025)                       G. Visentin &amp; F. Mauger</span></span></div><div  class = 'S12'>&nbsp;</div><div  class = 'S12'><span style="white-space: pre"><span >##########################################################################</span></span></div></div><div  class = 'S1'><span>Next, we calculate the CI matrix with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >CI.computeCImatrix;</span></span></div></div></div><div  class = 'S8'><span>that prints out</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S12'><span style="white-space: pre"><span >(...)</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >=== Build the configuration-interaction (CI) model [Visentin 2025] =======</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Discretization                                                      OK</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * External (atomic or molecular) potential                            OK</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Electron-electron interaction potential                             OK</span></span></div><div  class = 'S12'>&nbsp;</div><div  class = 'S12'><span style="white-space: pre"><span >=== References ===========================================================</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  [Mauger 2024b] F. Mauger and C. Chandre, "QMol-grid : A MATLAB package</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    for quantum-mechanical simulations in atomic and molecular systems," </span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    SoftwareX 28, 101968 (2024).</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  [Visentin 2025] G. Visentin et al., in preparation (2025).</span></span></div><div  class = 'S12'>&nbsp;</div><div  class = 'S12'><span style="white-space: pre"><span >=== Funding ==============================================================</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    The original development of the QMol-grid package, and its (TD)DFT</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  features, was supported by the U.S. Department of Energy, Office of</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Science, Office of Basic Energy Sciences, under Award No. DE-SC0012462.</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Addition of the (TD)SE and CI features was supported by the National</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Science Foundation under Grant No. PHY-2207656.</span></span></div><div  class = 'S12'>&nbsp;</div><div  class = 'S12'><span style="white-space: pre"><span >##########################################################################</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >=== CI-matrix calculation ================================================</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >                                       Calculation progress (%)</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Calculation step          0       20       40       60       80      100</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  ----------------------    ----------------------------------------------</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Core integrals            ||||||||||||||||||||||||||||||||||||||||||||||</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Dipole coupling elements  ||||||||||||||||||||||||||||||||||||||||||||||</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  Two-electron integrals    ||||||||||||||||||||||||||||||||||||||||||||||</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  CI matrix                 ||||||||||||||||||||||||||||||||||||||||||||||</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  ------------------------------------------------------------------------</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >                                            CI-matrix calculation complete</span></span></div><div  class = 'S12'>&nbsp;</div><div  class = 'S12'><span style="white-space: pre"><span >##########################################################################</span></span></div></div><div  class = 'S1'><span>Finally, we inspect the ground and first 2 excited states of our CI model with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >CI.analyzeCIspectrum(3);</span></span></div></div></div><div  class = 'S8'><span>that prints out</span></div><div class = 'preformatted-plain' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S12'><span style="white-space: pre"><span >=== CI matrix spectrum ===================================================</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * CI matrix</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    size = 400 x 400 with 24432 nonzero elements</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Ground state</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Total energy      =    -10.758 a.u. =   -292.741 eV</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt;  91.904 % [  -3  -2  -1  1  2  3  ]</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt;   7.859 % [  -4  -2  -1  1  2  4  ]</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Excited state</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Total energy      =    -10.698 a.u. =   -291.114 eV</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Excitation energy =      0.060 a.u. =      1.627 eV</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt;  49.753 % [  -4  -2  -1  1  2  3  ]</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt;  49.753 % [  -3  -2  -1  1  2  4  ]</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >  * Excited state</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Total energy      =    -10.499 a.u. =   -285.686 eV</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    Excitation energy =      0.259 a.u. =      7.055 eV</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt;  49.766 % [  -4  -2  -1  1  2  3  ]</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >    &gt;  49.766 % [  -3  -2  -1  1  2  4  ]</span></span></div><div  class = 'S12'><span style="white-space: pre"><span >==========================================================================</span></span></div></div><div  class = 'S1'><span>Without much surprise, we see that none of the ground and first 3 excited state involve the LUMO+1 (index +/-5) and LUMO+2 (index +/- 6), which are very far apart energetically (see the comment </span><a href = "#M_7F63DB59"><span>above</span></a><span>).</span></div><h2  class = 'S2'><span>Test suite</span></h2><div  class = 'S1'><span>For consistency with the rest of the QMol-grid package, </span><span style=' font-family: monospace;'>QMol_CI_conv</span><span> defines an associated test suite. Run the test suite for the class in normal or </span><a href = "./Test_suite.html"><span>summary mode</span></a><span> respectively with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: rgb(167, 9, 245);">'CI_conv'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: rgb(167, 9, 245);">'-summary'</span><span >,</span><span style="color: rgb(167, 9, 245);">'CI_conv'</span><span >);</span></span></div></div></div><h2  class = 'S2' id = 'H_80F201DB' ><span>For developers</span></h2><div  class = 'S1'><span>For internal use </span><span style=' font-family: monospace;'>QMol_CI_conv</span><span> defines additional transient properties. These </span><span style=' text-decoration: underline;'>cannot</span><span> be edited with the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method but can be directly edited by classes in the QMol-grig package.</span></div><h4  class = 'S6' id = 'H_C4662A68' ><span>V2e</span></h4><div  class = 'S1'><span>Internal electron-electron interaction potential </span><span style=' font-family: monospace;'>[ vector (default []) ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>Discretization of </span><a href = "#H_C9D9F4E3"><span style=' font-family: monospace;'>interactionPotential</span></a><span> over the extended domain used to calculate electron-electron interaction integrals.</span></li><li  class = 'S4'><span>This property is set when the CI object is </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d.</span></li></ul><h4  class = 'S6' id = 'H_CCC6DA6D' ><span style=' font-family: monospace;'>isReal</span></h4><div  class = 'S1'><span>Whether the spatial orbitals are real valued </span><span style=' font-family: monospace;'>[ true | false | (default []) ]</span></div><ul  class = 'S3'><li  class = 'S4'><span>This property is set when the CI object is </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d.</span></li></ul><h4  class = 'S6'><span>getDiscCopy</span></h4><div  class = 'S1'><span>Returns a minimally initialized discretization object</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >disc = getDiscCopy(obj);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>If the domain discretization is implicitly defined via </span><a href = "#H_3CD5E6FD"><span style=' font-family: monospace;'>x</span></a><span>, it is converted into a </span><a href = "./QMol_disc.html"><span style=' font-family: monospace;'>QMol_disc</span></a><span> object, otherwise returns a copy of the </span><a href = "./Discretization.html"><span>Domain discretization</span></a><span>. In either case, the output </span><span style=' font-family: monospace;'>disc</span><span> is </span><span style=' text-decoration: underline;'>not</span><span> initialized to limit memory use.</span></li></ul><h4  class = 'S6'><span>getConfigurationBasisParameters</span></h4><div  class = 'S1'><span>Parsing of the flavor of CI (CIS, CISD, or RAS) and their associated number of electrons, reference, active space, and frozen spin orbitals. It provides a common interface for building the configuration-space basis and run-time documentation.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >[algo,locN,locRef,locAct,locFrz] = obj.getConfigurationBasisParameters(isBld)</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span style=' font-family: monospace;'>algo = 1</span><span> corresponds to CIS, </span><span style=' font-family: monospace;'>algo = 2</span><span> corresponds to CISD, and </span><span style=' font-family: monospace;'>algo = 0</span><span> corresponds to RAS.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>locN</span><span> is the number of electrons.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>locRef</span><span> are the indexes for the spin orbitals forming the reference configuration state.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>locAct</span><span> are the indexes for the spin orbitals forming the active space.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>locFrz</span><span> are the indexes for the frozen spin orbitals.</span></li><li  class = 'S4'><span>Set </span><span style=' font-family: monospace;'>isBld = true</span><span> when called inside </span><span style=' font-family: monospace;'>setConfigurationBasis</span><span> and </span><span style=' font-family: monospace;'>isBld = false</span><span> otherwise for proper run-time documentation display.</span></li></ul><h2  class = 'S2'><span>Notes</span></h2><div  class = 'S1'><span>The results displayed in this documentation page were generated using version 01.22 of the QMol-grid package.</span></div><ul  class = 'S3'><li  class = 'S4'><span style=' font-family: monospace;'>QMol_CI_conv</span><span> was introduced in version 01.22</span></li></ul>
<br>
<!-- 
##### SOURCE BEGIN #####
%% |QMol_CI_conv|
% CI model, using an explicit convolution scheme to calculate the electron-electron 
% repulsion integrals.
% 
% _Warning: |QMol_CI_conv| is a new feature of the QMol-grid package, and has 
% not been fully tested and benchmarked._
%% Description
% Use |QMol_CI_conv| to describe a configuration-interaction (CI) model associated 
% with a spin-restricted set of orbitals, typically obtained via a <./DFT.html 
% density-functional theory (DFT)> or <./HF.html Hartree-Fock (HF)> ground state 
% calculation. The class also provides functionalities for calculating the CI 
% matrix and its associated ground- and excited-state wave functions, as well 
% as the dipole-coupling matrix.
%% Class at a glance
% *Editable properties:*
%% 
% * Domain discretization: |discretization|, |xspan|
% * Electronic structure: |numberElectron|, |orbitalBasis|, |configurationBasis|, 
% |waveFunction|
% * Potential: |externalPotential|, |interactionPotential|
% * CI calculation: |display|, |tolerance|, |CImatrix|, |DXmatrix|, |isDipole|
% * Configuration basis: |type|, |reference|, |active|, |frozen|, |noDouble|, 
% |noEmpty|
%% 
% *Uneditable properties (read only):*
%% 
% * |isInitialized|, |isSetConfigBasis|, |isSpinPol|, |dim|
%% 
% *Methods:* 
%% 
% * Changing class properties: |set|, |reset|, |clear|
% * Initialization: |initialize|, |setConfigurationBasis|, |cleanConfigurationBasis|
% * Run-time documentation: |showDocumentation|, |getMemoryProfile|
% * CI calculation: |computeCImatrix|, |sparsify|, |computeGroundState|, |getEnergy|, 
% |showEnergy|, |analyzeCIspectrum|
% * Density: |getDensityMatrix|, |getDensity|
%% 
% *Jump to* *examples*
%% Class properties
% CI model
% The |QMol_CI_conv| class defines the following public get-access properties 
% for CI calculation; each can be changed using the |set| method:
% |discretization (disc)|
% <./Discretization.html Domain discretization> object |[ handle object (default 
% []) ]|
% |xspan (x)|
% Cartesian grid for the domain discretization |[ vector (default []) ]|
%% 
% * Before the |QMol_CI_conv| object is |initialize|d, as a substitute for the 
% |discretization| object, |xspan| is used to directly provide the Cartesian grid 
% (all-increasing, equally-spaces, vector) for the domain discretization. Upon 
% initialization, |xspan| is converted into the proper |discretization| object.
% * After the |QMol_CI_conv| object is |initialize|d, fetches |discretization||.xspan|.
% * Irrespective of the initialization status, |xspan| consistently provides 
% the Cartesian-grid discretization vector for the CI model.
% |numberElectron (N)|
% Number of electrons |[ integer| (default []) ]|
% |orbitalBasis (SOB)|
% Basis of spatial orbitals $\phi_1({\bf r}),\phi_2({\bf r}),\ldots,\phi_K({\bf 
% r})$ |[ matrix (default []) ]|
%% 
% * Each column of |orbitalBasis| defines the discretization of one spatial 
% orbital basis on the |discretization| domain.
% * Spatial orbitals are assumed to form an orthonormal basis $\int{\phi_k({\bf 
% r})^*\phi_l({\bf r})\ \text{d}{\bf r}=\delta_{kl}$ and no check is performed 
% on this.
% |configurationBasis (CSB)|
% Configuration-state basis |[matrix (default []) ]|
%% 
% * Each row of |configurationBasis| defines a configuration state, as |numberElectron| 
% vector containing the indexes for the spatial orbitals in |orbitalBasis| and 
% the sign defining the spin (negative for down and positive for up spins). For 
% instance |[-1 -2 1 3]| corresponds to the Slater determinant formed by the first 
% two spatial orbitals in |orbitalBasis| with down spin and orbitals 1 and 3 in 
% |orbitalBasis| with up spin.
% * Each row in |configurationBasis| is assumed to define a unique configuration 
% state and no check is performed on this. Warning: keep in mind that two products 
% of spin orbitals that only differ by the order of the orbitals define linearly 
% dependent configuration states, i.e., |[-1 -2 1 3]| and |[-1 -2 3 1]| should 
% not be both included in the |configurationBasis|; use |cleanConfigurationBasis| 
% to automatically remove duplicates like these.
% * In most cases, |configurationBasis| is built automatically using |setConfigurationBasis|, 
% to match the Configuration-state basis properties.
% |externalPotential (Vext)|
% External functional object |[| <./QMol_DFT_Vext.html |QMol_DFT_Vext|> |object 
% || <./Pseudopotential.html |pseudopotential|> || cell of| <./Pseudopotential.html 
% |pseudopotential|>|s | function handle | vector (default []) ]|
%% 
% * A <./QMol_DFT_Vext.html |QMol_DFT_Vext|> object describes the external potential 
% in a similar fashion as for <./DFT.html DFT> and <./HF.html HF> calculations.
% * A <./Pseudopotential.html |pseudopotential|> object implicitly describes 
% the external potential as a single <./Pseudopotential.html |pseudopotential|>.
% * A |cell of| <./Pseudopotential.html |pseudopotential|>|s| object implicitly 
% describes the external potential as the potential formed by the sum of the provided 
% <./Pseudopotential.html |pseudopotential|>s.
% * A |function handle| specifies the external potential with the signature 
% |V = funV(x)|,  where the output |V| has the same shape as the input vector 
% |x| and contains element-wise values of the potential at the query points |x|.
% * <./Pseudopotential.html |pseudopotential|>, |cell of| <./Pseudopotential.html 
% |pseudopotential|>|s|, and |function handle| are converted into a <./QMol_DFT_Vext.html 
% |QMol_DFT_Vext|> object when the CI object is |initialize|d.
% |interactionPotential (Vee)|
% Electron-electron interaction potential |[ function handle (@(x) 1./sqrt(x.^2+2)) 
% ]|
%% 
% * The signature for the (effective) electron-electron interaction potential 
% is |V = funV(x)|, where the output |V| has the same shape as the input vector 
% |x| and contains element-wise values of the potential at the query points |x|.
% * Because the computations of the electron-electron integrals are performed 
% over an (internally handled) extended domain, a user-defined discretization 
% of the electron-electron interaction potential is not supported (only function 
% handle).
% |waveFunction (wfcn)|
% Wave function |[ [] (default) | column vector | matrix ]|
%% 
% * CI wave functions are specified as column vectors of the (complex) amplitudes 
% of the configuration states in the |configurationBasis|. For example, |[1/sqrt(2); 
% 1/sqrt(2); 0; 0; __]|, with length |size(||configurationBasis||,1)|, has equal 
% population in the first two configuration states.
% * Several wave functions can be combined in a matrix, which each column corresponding 
% to a different wave function.
% |display (disp)|
% Whether to display the progress of CI calculations |[ true (default) | false 
% ]|
%% 
% * |display| is used by |setConfigurationBasis| and |computeCImatrix|.
% |tolerance (tol)|
% Threshold for setting CI matrix elements to zero |[ scalar (default 1e-10) 
% ]|
%% 
% * When calculating the CI and dipole-coupling matrices, elements with magnitude 
% smaller than |tolerance| are forced to zero.
% * Set a negative |tolerance| to disable the feature.
% |CImatrix (CI)| 
% CI matrix |[ matrix (default []) ]|
%% 
% * At the end of a CI calculation, |CImatrix| contains a copy of the CI matrix.
% |isDipole (isDip)|
% Whether to calculate the dipole-coupling matrix together with the CI one |[ 
% true (default) | false ]|
% |DXmatrix (DX)|
% Dipole-coupling matrix |[ matrix (default []) ]|
%% 
% * When |isDipole| is |true|, at the end of a CI calculation, |DXmatrix| contains 
% a copy of the dipole coupling matrix.
% Configuration-state basis
% The |QMol_CI_conv| class defines the following public get-access properties 
% for automatized building of the configuration-state basis; each can be changed 
% using the |set| method:
% |type|
% Type of CI calculation |[ 'CIS' (default) | 'CISD' | 'RAS' ]|
%% 
% * |CIS| corresponds to CI with single excitations.
% * |CISD| corresponds to CI with single and double excitations. Note: this 
% typically leads to a much bigger configuration state basis.
% * |RAS| corresponds to CI with a restricted active space. If no |noDouble| 
% or |noEmpty| are specified, this corresponds to a complete active space (CAS). 
% Warning: the size of the configuration state basis grows exponentially fast 
% with the size of the active space.
% * |type| is used by |setConfigurationBasis| when building |configurationBasis|.
% |reference (ref)|
% Configuration state reference |[ vector (default []) ]|
%% 
% * |numberElectron| vector containing the indexes for the spatial orbitals 
% in |orbitalBasis| and the sign defining the spin (negative for down and positive 
% for up spins). For instance |[-1 -2 1 3]| corresponds to the Slater determinant 
% formed by the first two spatial orbitals in |orbitalBasis| with down spin and 
% orbitals 1 and 3 in |orbitalBasis| with up spin.
% * If left empty, a spin-restricted system is assumed and the first |numberElectron||/2| 
% spatial orbitals in |orbitalBasis| are used for the reference. If |numberElectron| 
% is an odd number an error is throwed when building the |configurationBasis|.
% * |reference| is used by |setConfigurationBasis| when building |configurationBasis|.
% * For CIS(D) calculations, |reference| defines the spin orbitals from which 
% the excitations should be considered.
% * For RAS calculations, a |reference| is still required and used to define 
% the number of electrons to include in each spin channel.  For instance |[-1 
% -2 1 3 4]| indicates that 2 electrons should be put in the down-spin channel 
% and 3 in the up one.
% |active (act)|
% List of spin orbitals that may contain an electron |[ vector (default []) 
% ]|
%% 
% * Vector containing the "active" spin orbitals in the CIS(D)/RAS basis, defined 
% as the indexes for the spatial orbitals in |orbitalBasis| and the sign indicating 
% the spin (negative for down and positive for up spins). For instance |[-1 -2 
% -3 -4 1 2 3]| indicates that the spin orbitals formed by the first 4 spatial 
% orbitals with down spin and only the first 3 spatial orbitals with up spin should 
% be considered for building the |configurationBasis|.
% * The largest index magnitude in the |active| vector must not be larger than 
% the number of spatial orbitals in |orbitalBasis|.
% * If left empty, all the spatial orbitals in |orbitalBasis| with both up and 
% down spins are included in the active space.
% * |active| is used by |setConfigurationBasis| when building |configurationBasis|.
% * For CIS(D) calculations, only |active| spin orbitals that are different 
% from the |reference| are relevant for building building the |configurationBasis|. 
% Duplicates with the |reference| are ignored (including the in the run-time documentation).
% * For RAS calculations, all |active| spin orbitals must be listed as the |reference| 
% is only used to determine the number of electrons in each spin channel.
% |frozen (frz)|
% List of spin orbitals that must contain an electron |[ vector (default []) 
% ]|
%% 
% * Vector containing the "frozen" spin orbitals, which are included in all 
% the vectors in the CIS(D)/RAS basis. Frozen orbitals are defined via the indexes 
% for the spatial orbitals in |orbitalBasis| and the sign indicating the spin 
% (negative for down and positive for up spins). For instance |[-1 1 2]| indicates 
% all configuration states in the |configurationBasis| must include the spin orbitals 
% formed by the first spatial orbitals with down spin and the first 2 spatial 
% orbitals with up spin.
% * The largest index magnitude in the |frozen| vector must not be larger than 
% the number of spatial orbitals in |orbitalBasis|.
% * If left empty, no orbitals are frozen.
% * |frozen| is used by |setConfigurationBasis| when building |configurationBasis|.
% * For CIS(D) calculations, all |frozen| orbitals should also be included in 
% the |reference|.
% * For RAS calculations, the number of |frozen| orbitals in each spin channel 
% must be compatible with the number of electron each hold (defined via the |reference|).
% |noDouble (noDbl)|
% List of spatial orbitals that must not contain two electrons |[ vector (default) 
% ]|
%% 
% * Vector containing the indexes of the spatial orbitals that may be empty 
% or contain one electron but should not hold two electrons. For instance |[5 
% 6]| indicates that spatial orbitals 5 and 6 may not be fully occupied.
% * If left empty, the feature is disabled.
% * |noDouble| is used by |setConfigurationBasis| when building |configurationBasis|.
% * For CIS(D) calculations, the constraint is not imposed on the reference 
% configuration.
% * After building the CIS(D)/RAS basis associated with the |reference|, |active|, 
% and |frozen| spin orbitals, configuration states that allocate two electrons 
% in the |noDouble| spatial orbitals are removed from the |configurationBasis|.
% |noEmpty (noEmp)|
% List of spatial orbitals that must not be empty |[ vector (default) ]|
%% 
% * Vector containing the indexes of the spatial orbitals that may contain one 
% or two electrons but should not be empty. For instance |[1 2]| indicates that 
% the first two spatial orbitals should always hold at least one electron.
% * If left empty, the feature is disabled.
% * |noEmpty| is used by |setConfigurationBasis| when building |configurationBasis|.
% * For CIS(D) calculations, the constraint is not imposed on the reference 
% configuration.
% * After building the CIS(D)/RAS basis associated with the |reference|, |active|, 
% and |frozen| spin orbitals, configuration states that do not allocate any electron 
% in the |noEmpty| spatial orbitals are removed from the |configurationBasis|.
% Other properties
% To facilitate simulations, |QMol_CI_conv| defines a handful of additional 
% transient properties. These cannot be edited with the |set| method.
% |isInitialized (isInit)|
% Whether the CI-model object is properly initialized. This is used throughout 
% the QMol-grid package to check that the CI-model object holds meaningful information 
% and is ready for use.
% |isSetConfigBasis|
% Tacks whether the configuration basis |configurationBasis| was build using 
% [what] or user defined |[ true | false (default) ]|
% Constant properties
% |isSpinPol (true)|
%% 
% * Indicates that, by construction, the CI model is spin polarized.
% |dim (1)|
%% 
% * Indicates that the CI model dimension is one.
%% Class methods
% Creation
% constructor
% Create a CI-model object with empty class properties.

obj = QMol_CI_conv;
%% 
% Create a CI-model object with the |name| properties set to the specified |value|. 
% Several |name-value| pairs can be specified consecutively. Suitable |name| is 
% any of the CI-model and Configuration-state basis properties, and is case insensitive.

obj = QMol_CI_conv(name1,value1);
obj = QMol_CI_conv(name1,value1,name2,value2,___);
%% 
% Create a CI-model object with the |discretization| (domain discretization), 
% |numberElectron| (number of electrons), |orbitalBasis| (spatial-orbital basis), 
% |externalPotential| (external potential), and |interactionPotential| (electron-electron 
% interaction potential) properties are imported from a <./QMol_DFT_spinRes.html 
% |QMol_DFT_spinRes|> |DFT| object by passing it as the first argument of the 
% constructor. Additional or overwriting parameters can be specified as a list 
% of name-value pair arguments.

obj = QMol_CI_conv(DFT);
obj = QMol_CI_conv(DFT,name1,value1,name2,value2,___);
%% 
% For basis-set <./DFT.html DFT> and <./HF.html HF> models, |orbitalBasis| contains 
% the reconstructed spatial orbitals over the |discretization| domain.
% Changing class properties
% |set|
% Update the |name| properties of a CI-model object to the specified |value|. 
% Several |name-value| pairs can be specified consecutively. Suitable |name| is 
% any of the CI-model and Configuration-state basis properties, and is case insensitive.

obj.set(name1,value1);
obj.set(name1,value1,name2,value2,___);
%% 
% Update the |discretization| (domain discretization), |numberElectron| (number 
% of electrons), |orbitalBasis| (spatial-orbital basis), |externalPotential| (external 
% potential), and |interactionPotential| (electron-electron interaction potential) 
% properties from a <./QMol_DFT_spinRes.html |QMol_DFT_spinRes|> |DFT| object 
% by passing it as the first argument. Additional or overwriting parameters can 
% be specified as a list of name-value pair arguments.

obj.set(DFT);
obj.set(DFT,name1,value1,name2,value2,___);
%% 
% This is the common name-value pair assignment method used throughout the QMol-grid 
% package. The |set| method also |reset| the class. After running, the |set| property 
% updates the |isInitialized| flag to a |false| value.
% |reset|
% Reset the object by deleting/re-initializing all run-time properties of the 
% class and updating the |isInitialized| and |isSetConfigBasis| flags to |false|.

obj.reset;
%% 
% * This is the common |reset| method available to all classes throughout the 
% QMol-grid package.
% * To avoid any mismatch in the CI component internal properties, this also 
% |reset|s the |discretization| (domain discretization) and |externalPotential| 
% (external potential) components objects.
% |clear|
% Clear all class properties.

obj.clear;
%% 
% Clear a specific set of the class properties. Suitable |name| is any of the 
% CI-model properties and is case insensitive.

obj.clear(name1,name2,___);
%% 
% This is the common |clear| method available to all classes throughout the 
% QMol-grid package. The |clear| method also |reset| the class. The |clear| method 
% can be used to delete specific properties before saving an instance of the |QMol_CI_conv| 
% class.
% Initializing the object
% |initialize|
% Initialize a CI-model object in silent mode, _i.e._, without displaying any 
% initialization status, and set the |isInitialized| flag to |true| with either

obj.initialize;
obj.initialize(0)
%% 
% * This |initialize|s the |discretization| (domain discretization) and |externalPotential| 
% (external potential)component objects as well as the internal discretization 
% of |interactionPotential| on the extended domain used to calculate electron-electron 
% interaction integrals.
% * To avoid any mismatch in internal properties, |initialize| first |reset| 
% the object before performing the initialization.
%% 
% To perform the same initialization but with displaying the status of the object 
% initialization, including the QMol-grid package header and footer, 

obj.initialize(1);
%% 
% To perform the initialization and display and display the status of the object 
% initialization, without the QMol-grid package header and footer, 

obj.initialize(2);  % 2 or any integer larger than 1
% |setConfigurationBasis|
% Set |configurationBasis| to match the Configuration-state basis properties.

obj.setConfigurationBasis;
%% 
% * |setConfigurationBasis| is typically used between the creation of the CI 
% object and the calculation of the CI matrix, using |computeCImatrix|.
% * |setConfigurationBasis| first (re)|initialize|s the CI-model object before 
% building |configurationBasis|.
% * |setConfigurationBasis| sets |isSetConfigBasis| to |true|, to indicate that 
% |configurationBasis| matches the Configuration-state basis properties.
% * If |display| is |true|, |setConfigurationBasis| also prints out a summary 
% of the configuration state basis.
% |cleanConfigurationBasis|
% Clean the configuration state basis by removing duplicate configuration states 
% in |configurationBasis|, including those related by a permutation of the spin 
% orbitals in the index vector. 

obj.cleanConfigurationBasis;
%% 
% * The cleaning process preserves the order of (i) configuration states in 
% the basis, keeping only the first unique instance of each state, and (ii) the 
% order of the spin-orbital withing each configuration state. 
% * For instance, the |configurationBasis| |[-1 -2 1 2; -1 -3 1 2; -2 -1 1 2;-1 
% -2 1 3]| is cleaned to |[-1 -2 1 2; -1 -3 1 2; -1 -2 1 3]| since |[-2 -1 1 2]| 
% is a duplicate of |[-1 -2 1 2]|, and thus removed from the set.
% Run-time documentation
% |getMemoryProfile|
% Get an estimate of the memory held by a |QMol_CI_conv| object with either

mem = obj.getMemoryProfile;
mem = obj.getMemoryProfile(false);
%% 
% * The object does not need to be |initialize|d for the memory footprint evaluation.
% * |getMemoryProfile| makes efforts to return the object in the same configuration 
% as before the profiling but small side effects cannot be entirely excluded: 
% all the CI-model and Configuration-state basis properties are left unchanged 
% while run-time properties (for developers) may be altered. 
% * The estimate includes the (1) domain discretization, (2) external potential, 
% (3) electron-electron interaction potential, (4) spatial orbital basis, (5) 
% configuration state basis, (6) CI matrix, and (7) dipole-coupling matrix if 
% |isDipole| is set to |true|. Note that all these components may not be used 
% in actual simulations and the memory estimate tries to be conservative. On the 
% other hand, it only includes the discretization of member components on the 
% domain grid and ignores other (small) properties.
% * If |configurationBasis| is empty, the profiling assumes that the configuration 
% state basis will be built using the |setConfigurationBasis| method. Otherwise, 
% the profiling uses |configurationBasis| to estimate the memory footprint.
% * The output |mem| is the estimated size in bytes.
%% 
% Additionally display the detail of the memory footprint with

mem = obj.getMemoryProfile(true);
% |showDocumentation|
% Display the run-time documentation for the specific configuration of a |QMol_CI_conv| 
% object, which must have been |initialize|d beforehand

obj.showDocumentation;
%% 
% The run-time documentation performs the following steps
%% 
% * Display the QMol-grid package header (showing the kernel, external component 
% versions)
% * Display the |discretization| (domain discretization) object run-time documentation
% * Display the electronic structure
% * Display the configuration state basis properties
% * Display the |externalPotential| (external functional and potential) object 
% run-time documentation
% * Display the |HartreePotential| object run-time documentation
% * Display the |interactionPotential| 
% * Display the bibliography associated with the list of cited references (from 
% the previous steps)
% * Display the funding information
% * Display the QMol-grid package footer
% CI calculation
% All the following methods require the object to have been |initialize|d.
% |computeCImatrix|
% Computes the CI matrix associted with the CI-model properties.

obj.computeCImatrix;
%% 
% * The calculation first precomputes the core Hamiltonian matrix and two-electron 
% 4-tensor, which are then used to build the CI matrix.
% * The |QMol_CI_conv| object must have a properly defined |configurationBasis|, 
% _e.g._, built with |setConfigurationBasis|, to perform the CI matrix calculation.
% * The CI matrix is stored in the |CImatrix| member property. If |isDipole| 
% is |true|, the dipole-coupling matrix is also calculated and stored in the |DXmatrix| 
% member property. Both |CImatrix| and |DXmatrix| are |size(||configurationBasis||,1)-by-size(||configurationBasis||,1)| 
% matrices.
% * If |display| is |true|, |computeCImatrix| also prints out the progress of 
% the CI-matrix calculation.
% * In the core Hamiltonian, CI, and dipole-coupling matrices as well as the 
% two-electron 4-tensor, elements with magnitude smaller than |tolerance| are 
% forced to zero (set |tolerance| to a negative value to disable this feature). 
%% 
% Get a copy of the CI matrix with 

CI = obj.computeCImatrix;
%% 
% |When| |isDipole| is |true|, get a copy of the dipole-coupling matrix with

[CI,DX] = obj.computeCImatrix;
% |sparsify|
% Convert the CI and dipole-coupling into sparse matrices

obj.sparsify;
%% 
% * This can accelerate some calculations when the |CImatrix| is large.
% |computeGroundState|
% Compute the |CImatrix| ground state with

obj.computeGroundState;
obj.computeGroundState(1);
%% 
% * The result is stored in |waveFunction|. 
% * The CI object must contain a valid |CImatrix|.
%% 
% Additionally compute a set of lowest-energy excited states with

obj.computeGroundState(n);
%% 
% * The integer |n| specifies the number of states to calculate, thus corresponding 
% to |n-1| excited states.
% |getEnergy|
% Compute the member wave function energy and error

[E,DE] = obj.getEnergy;
%% 
% * For each wave function $|\psi\rangle$ in |waveFunction|, the energy is defined 
% as the real $E=\langle\psi|\hat{\mathcal{H}}|\psi\rangle$ and the error as the 
% positive real $\|(\hat{\mathcal{H}}-E)|\psi\rangle\|$, where $\hat{\mathcal{H}}$ 
% is the CI Hamiltonian operator (defined via the |CImatrix|).
% * The CI object must contain a valid |CImatrix|.
% |showEnergy|
% Display the member wave function energy and error

obj.showEnergy;
%% 
% * The energy and error are obtained from |getEnergy|.
% |analyzeCIspectrum|
% After calculating the CI matrix, use |analyzeCIspectrum| to print out the 
% energies and wave function composition of eigen states of the CI model. Display 
% the analysis for the |n| lowest energy eigen states with

obj.analyzeCIspectrum(n);
%% 
% * For each eigen state, |analyzeCIspectrum| prints out the total electronic 
% energy for the state as well as the configuration states in |configurationBasis| 
% that substantially contribute to the state (with population larger than 1%).
% * For excited state, |analyzeCIspectrum| also prints out the excitation energy, 
% defined as the energy difference with the ground state.
% One-body density and one-particle density matrices
% |getDensity|
% Compute the one-body density associated with a wave function of a CI model, 
% defined as $\rho({\bf r})=\int{|\psi({\bf r},\omega,{\bf x}_2\ldots{\bf x}_N)|^2\ 
% d\omega d{\bf x}_2\ldots d{\bf x}_N}$, with the integration running over (i) 
% the first electron spin coordinate and (ii) all the following electronic and 
% spin coordinates. The one-body density is further decomposed between its up- 
% and down-spin contributions.

rho = obj.getDensity;
%% 
% * Returns the one-body density of the |waveFunction| property, which must 
% contain a single wave function.
% * The output |rho| is a <./QMol_DFT_density.html |QMol_DFT_density|> object 
% containing the discretization of the up- and down-spin one-body density components. 
% The density object is initialized.
% * Internally, the one-particle reduced density matrices associated with |psi| 
% are calculated, using |getDensityMatrix|, from which the one-body density is 
% reconstructed.

rho = obj.getDensity(psi);
%% 
% * Returns the one-body density for the input wave function |psi| instead of 
% |waveFunction|. 
% * The input wave function |psi| is specified as a column vector of population 
% coefficients in the configuration state basis |configurationBasis|.
%% 
% Instead of the wave function, the one-body density can be defined via the 
% one-particle density matrices

rho = obj.getDensity(rhoUp,rhoDown);
%% 
% * The two input |rhoUp| and |rhoDown| matrices are typically obtained using 
% |getDensityMatrix|.
%% 
% Optionally specify the <./QMol_DFT_density.html |QMol_DFT_density|> object 
% in which to store the one-body density with

obj.getDensity(___,rho);
% |getDensityMatrix|
% Computes the one-particle reduced density matrix (1-RDM) associated with the 
% wave function(s) of a CI model. The matrix elements $\rho_{m,n}$ of the 1-RDM 
% are associated with the one-particle density operators $|m\rangle\langle n|$ 
% of the $m^\text{th}$ and $n^\text{th}$ spin orbitals in the basis. The one-body 
% density $\rho$ is recovered from the 1-RDM as $\rho=\sum_{m,n}\rho_{m,n}\chi_m^*\chi_n$. 
% The 1-RDM is further decomposed between its up- and down-spin contributions 
% (since the two spin channels do not mix in the joint 1-RDM space).

[rhoUp,rhoDown] = obj.getDensityMatrix;
%% 
% * Returns the 1-RDM matrices for the up (|rhoUp|) and down (|rhoDown|) spin 
% channels of the |waveFunction| property. 
% * For a single wave function (column vector |waveFunction|), the 1-RDM are 
% |size(||configurationBasis||,1)|-by-|size(||configurationBasis||,1)| matrices. 
% * If |waveFunction| contains several wave functions, the  output |rhoUp| and 
% |rhoDown| are |size(||configurationBasis||,1)|-by-|size(||configurationBasis||,1)|- 
% by-|size(||waveFunction||,2)| arrays. One can recover the 1-RDM matrices for 
% the |k|$^\text{th}$ wave function component with |rhoUp(:,:,k)| and |rhoDown(:,:,k)|, 
% which are all Hermitian matrices.
% * To speed up calculations of the density matrices, contributions smaller 
% than |tolerance| are skipped in 1-RDM calculation. This may lead to slight difference 
% when the 1-RDM for a collection of wave functions are calculated together (matrix 
% |psi|) vs. separately (vector |psi|). Set |tolerance| to a negative value to 
% disable this feature.
% * Note: the calculation of the 1-RDM can be time consuming, especially when 
% using large configuration state bases (the algorithm shares a similar outline 
% as when calculating the CI matrix).

[rhoUp,rhoDown] = obj.getDensityMatrix(psi);
%% 
% * Returns the 1-RDM matrices for the input wave function(s) |psi| instead 
% of |waveFunction|. 
% * Each column in |psi| specifies the population coefficients in the configuration 
% state basis |configurationBasis|.
%% Examples
% Build the spatial orbital basis set
% To define the spatial-orbital basis set for our CI calculations, we first 
% run a <./QMol_DFT_spinRes.html spin-restricted DFT> calculation

% Molecular model
x       =   -50:.1:50;
A1      =   QMol_Va_softCoulomb('name','atom 1','charge',3,'position',-3);
A2      =   QMol_Va_softCoulomb('name','atom 2','charge',3,'position',2);

% DFT model
Vext    =   QMol_DFT_Vext('atom',{A1,A2});
Vh      =   QMol_DFT_Vh_conv;
Vxc     =   {QMol_DFT_Vx_LDA_soft,QMol_DFT_Vc_LDA_soft};

DFT     =   QMol_DFT_spinRes(                                   ...
                'xspan',                        x,              ...
                'occupation',                   [2 2 2 0 0 0],  ...
                'externalPotential',            Vext,           ...
                'HartreePotential',             Vh,             ...
                'exchangeCorrelationPotential', Vxc,            ...
                'selfInteractionCorrection',    'ADSIC'         );
%% 
% Note that we include 3 virtual orbitals (with occupation 0) in the DFT model, 
% which will define the active space for the CI calculations. Finally, we run 
% a DFT-ground state calculation to obtain our spatial orbital basis set.

SCF     =   QMol_DFT_SCF_Anderson;
SCF.solveSCF(DFT);
%% 
% yielding
%%
% 
%  (...)
%  === Orbital energies =====================================================
%    Orbital      Occ. (elec.)         Energy (-eV)               Error(a.u.)
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-      REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH         REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH               REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
%        1            2.00                29.364                   2.051e-12
%        2            2.00                28.874                   2.104e-12
%        3            2.00                10.650                   4.065e-12
%        4            0.00                 7.672                   8.120e-12
%        5            0.00                 3.807                   1.381e-11
%        6            0.00                 2.101                   1.294e-11
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%  
%  === DFT-component energies ===============================================
%    Component      Energy (a.u.)      Energy (eV)
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-     REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
%    Kinetic             1.352             36.802
%    External          -17.135           -466.274
%    Hartree             5.521            150.243
%    Exch.-corr.        -0.557            -15.170
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-     REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
%    Total             -10.819           -294.398
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%
% Set the CI model
% We now aim to define our CI model associated with the basis of DFT spatial 
% orbitals above. To do so, we let |QMol_CI_conv| read the relevant properties 
% off the |DFT| object.

CI      =   QMol_CI_conv(DFT);
%% 
% Next, we aim to perform a CISD calculation using the occupied DFT orbitals 
% as our reference and all the virtual DFT orbitals for the active space. These 
% correspond to the default values for the |reference| and |active| properties, 
% and thus only need to set the |type| of CI.

CI.set('type','CISD');
%% 
% Before building the configuration space basis, we check the memory footprint 
% of our CI model with

CI.getMemoryProfile(true);
%% 
% that prints out
%%
% 
%    * Domain discretization                                        
%      > domain                                                        7.8 KB
%      > gradient                                                     15.6 KB
%      > Laplacian                                                     7.8 KB
%      > Laplacian (velocity gauge)                                   15.6 KB
%    * External functional                                          
%      > potential                                                     7.8 KB
%      > potential gradient                                            7.8 KB
%    * Electron-electron interaction                                  15.6 KB
%    * Spatial orbital basis                                          46.9 KB
%    * Configuration state basis                                       5.5 KB
%    * CI matrix                                                     108.8 KB
%    * Dipole-coupling matrix                                        108.8 KB
%
%% 
% Finally, we build the CISD basis with

CI.setConfigurationBasis;
%% 
% that prints out
%%
% 
%  (...)
%  === Build the configuration-interaction (CI) model [Visentin 2025] =======
%    * Discretization                                                      OK
%    * External (atomic or molecular) potential                            OK
%    * Electron-electron interaction potential                             OK
%  === References ===========================================================
%    [Mauger 2024b] F. Mauger and C. Chandre, "QMol-grid : A MATLAB package
%      for quantum-mechanical simulations in atomic and molecular systems," 
%      SoftwareX 28, 101968 (2024).
%    [Visentin 2025] G. Visentin et al., in preparation (2025).
%  
%  === Funding ==============================================================
%      The original development of the QMol-grid package, and its (TD)DFT
%    features, was supported by the U.S. Department of Energy, Office of
%    Science, Office of Basic Energy Sciences, under Award No. DE-SC0012462.
%      Addition of the (TD)SE and CI features was supported by the National
%    Science Foundation under Grant No. PHY-2207656.
%  
%  ##########################################################################
%  === Set the configuration-state basis ====================================
%    * Initialization                                                    DONE
%    * Configuration-state basis
%      Type         = CISD
%      Total spin   = 0
%      Reference(s) = -1 -2 -3 1 2 3
%      Active       = 4 5 6
%                     -6 -5 -4
%      118 configuration-state basis elements
%      V-01.22.000 (05/20/2025)                       G. Visentin & F. Mauger
%  
%  ##########################################################################
%
% Compute the CI matrix and analyze its spectrum
% We now have all the elements in place to calculate the CI matrix with

CI.computeCImatrix;
%% 
% that prints out
%%
% 
%  (...)
%  === Build the configuration-interaction (CI) model [Visentin 2025] =======
%    * Discretization                                                      OK
%    * External (atomic or molecular) potential                            OK
%    * Electron-electron interaction potential                             OK
%  
%  === References ===========================================================
%    [Mauger 2024b] F. Mauger and C. Chandre, "QMol-grid : A MATLAB package
%      for quantum-mechanical simulations in atomic and molecular systems," 
%      SoftwareX 28, 101968 (2024).
%    [Visentin 2025] G. Visentin et al., in preparation (2025).
%  
%  === Funding ==============================================================
%      The original development of the QMol-grid package, and its (TD)DFT
%    features, was supported by the U.S. Department of Energy, Office of
%    Science, Office of Basic Energy Sciences, under Award No. DE-SC0012462.
%      Addition of the (TD)SE and CI features was supported by the National
%    Science Foundation under Grant No. PHY-2207656.
%  
%  ##########################################################################
%  === CI-matrix calculation ================================================
%                                         Calculation progress (%)
%    Calculation step          0       20       40       60       80      100
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%    Core integrals            ||||||||||||||||||||||||||||||||||||||||||||||
%    Dipole coupling elements  ||||||||||||||||||||||||||||||||||||||||||||||
%    Two-electron integrals    ||||||||||||||||||||||||||||||||||||||||||||||
%    CI matrix                 ||||||||||||||||||||||||||||||||||||||||||||||
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%                                              CI-matrix calculation complete
%  
%  ##########################################################################
%
%% 
% Finally, we inspect the ground and first 2 excited states of our CI model 
% with

CI.analyzeCIspectrum(3);
%% 
% that prints out
%%
% 
%  === CI matrix spectrum ===================================================
%    * CI matrix
%      size = 118 x 118 with 3374 nonzero elements
%    * Ground state
%      Total energy      =    -10.838 a.u. =   -294.920 eV
%      >  92.581 % [  -1  -2  -3  1  2  3  ]
%      >   6.250 % [  -1  -2  -4  1  2  4  ]
%    * Excited state
%      Total energy      =    -10.769 a.u. =   -293.039 eV
%      Excitation energy =      0.069 a.u. =      1.881 eV
%      >  49.018 % [  -1  -2  -4  1  2  3  ]
%      >  49.018 % [  -1  -2  -3  1  2  4  ]
%    * Excited state
%      Total energy      =    -10.623 a.u. =   -289.062 eV
%      Excitation energy =      0.215 a.u. =      5.857 eV
%      >   3.828 % [  -1  -2  -6  1  2  3  ]
%      >  38.990 % [  -1  -2  -4  1  2  3  ]
%      >  38.990 % [  -1  -2  -3  1  2  4  ]
%      >   3.828 % [  -1  -2  -3  1  2  6  ]
%      >   7.014 % [  -1  -2  -5  1  2  4  ]
%      >   7.014 % [  -1  -2  -4  1  2  5  ]
%  ==========================================================================
%
%% 
% In the ground state, we notice a substantial (>6%) contribution from the double 
% excitation from the highest-occupied (HOMO, index +/- 3) to the lowest unoccupied 
% (LUMO, index +/-4) molecular orbitals. The first excited state sits less than 
% 2 eV above the ground one, and is almost fully composed of single excitations 
% from the HOMO to the LUMO orbitals (one in each spin channel). On the other 
% hand, the second excited state contains substantial contributions from single 
% excitations from the HOMO to LUMO and LUMO+2 (index +/- 6), as well as double 
% excitations from the HOMO to the LUMO and LUMO+1 (index +/-5).
% Plot the ground state one-body density
% To get a better visualization of the ground state, we now want to plot its 
% one-body density. First, we calculate the ground state vector, which corresponds 
% to the eigen vector of the CI matrix with the smallest energy

CI.computeGroundState;
%% 
% from which we can recover the one-body density (and that of the parent DFT 
% model for comparison)

rho_CI  = CI.getDensity(CI.waveFunction);
rho_DFT = DFT.getDensity;
%% 
% Finally, we plot the results

figure
    subplot(3,1,[1 2]), hold on
        plot(CI.xspan,rho_CI.densityUp+rho_CI.densityDown,'-','LineWidth',2,'DisplayName','CI')
        plot(DFT.xspan,rho_DFT.density,':','LineWidth',2,'DisplayName','DFT')
        xlim(DFT.xspan([1 end]));
        ylabel('densty (elec./a.u.)')
        legend show
    subplot(3,1,3), hold on
        plot(CI.xspan,rho_CI.densityUp+rho_CI.densityDown-rho_DFT.density,'-','LineWidth',2)
        xlabel('position (a.u.)'); xlim(DFT.xspan([1 end]));
        ylabel('difference')
%% 
% 
% Basis-set discretization example
% To illustrate CI calculations starting from a basis-set discretization, we 
% consider a HF set of orbitals obtained with

% Domain and atomic centers
x       =   -20:.1:15;
A1      =   QMol_Va_softCoulomb('name','atom 1','charge',3,'position',-3);
A2      =   QMol_Va_softCoulomb('name','atom 2','charge',3,'position',2);
    
% Common shape for atomic orbitals
AO      =   @(s,n,x0,x) (x(:)-x0).^n .*exp(-(x(:)-x0).^2 * .5/s^2);

% Atomic orbital basis
V       =  [AO(1.3,0,A1.position,x),AO(1.7,1,A1.position,x),AO(0.8,2,A1.position,x), ...
            AO(1.3,0,A2.position,x),AO(1.7,1,A2.position,x),AO(0.8,2,A2.position,x)];
    
% Orthonormalize the basis
disc                =   QMol_disc_basis('xspan',x,'basis',V);
disc.orthonormalizeBasis;

% HF model
Vext    =   QMol_DFT_Vext('atom',{A1,A2});
Vh      =   QMol_DFT_Vh_conv;
Vxc     =   QMol_DFT_Vx_XX_conv;

HF      =   QMol_DFT_spinRes(                                   ...
                            'discretization',               disc,           ...
                            'occupation',                   [2 2 2 0 0 0],  ...
                            'externalPotential',            Vext,           ...
                            'HartreePotential',             Vh,             ...
                            'exchangeCorrelationPotential', Vxc);

% DFT ground state
SCF     =   QMol_DFT_SCF_Anderson;
SCF.solveSCF(HF);
%% 
% yielding
%%
% 
%  (...)
%  === Orbital energies =====================================================
%    Orbital      Occ. (elec.)         Energy (-eV)               Error(a.u.)
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-      REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH         REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH               REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
%        1            2.00                34.843                   3.274e-12
%        2            2.00                34.125                   2.177e-12
%        3            2.00                 9.103                   4.466e-12
%        4            0.00                -0.350                   3.637e-12
%        5            0.00               -48.715                   3.166e-12
%        6            0.00               -49.452                   3.523e-12
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%  
%  === DFT-component energies ===============================================
%    Component      Energy (a.u.)      Energy (eV)
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-     REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
%    Kinetic             1.262             34.338
%    External          -16.974           -461.887
%    Hartree             6.639            180.650
%    Exch.-corr.        -1.652            -44.945
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-     REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
%    Total             -10.725           -291.844
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%
%% 
% Note that the LUMO+1 and LUMO+2 orbitals have very large energies and may 
% not make much sense to include in practical CI calculations. We keep them here 
% for illustration purposes.
% 
% Next, we set the CI model with a complete active space (RAS |type| with no 
% additional restrictions) over all the calculated HF molecular orbitals and check 
% the memory footprint of the system

CI      =   QMol_CI_conv(HF,'type','RAS');
CI.getMemoryProfile(true);
%% 
% yielding
%%
% 
%  (...)
%    * Domain discretization                                        
%      > domain                                                        2.7 KB
%      > gradient                                                      5.5 KB
%      > Laplacian                                                     2.7 KB
%      > Laplacian (velocity gauge)                                    5.5 KB
%      > basis                                                        16.5 KB
%      > gradient matrix                                               288  B
%      > Laplacian matrix                                              288  B
%      > Laplacian matrix (velocity gauge)                             576  B
%    * External functional                                          
%      > potential                                                     2.7 KB
%      > potential gradient                                            2.7 KB
%    * Electron-electron interaction                                   5.5 KB
%    * Spatial orbital basis                                          16.5 KB
%    * Configuration state basis                                      18.8 KB
%    * CI matrix                                                       1.2 MB
%    * Dipole-coupling matrix                                          1.2 MB
%
%% 
% Note that the HF basis-set discretization domain has been converted to a regular 
% discretization grid as the spatial-orbital basis is rebuilt over the discretization 
% grid in |QMol_CI_conv|.
% 
% From there, the steps are identical to the grid-based example above. We first 
% build the configuration state basis with

CI.setConfigurationBasis;
%% 
% that prints out
%%
% 
%  (...)
%  === Build the configuration-interaction (CI) model [Visentin 2025] =======
%    * Discretization                                                      OK
%    * External (atomic or molecular) potential                            OK
%    * Electron-electron interaction potential                             OK
%  === References ===========================================================
%    [Mauger 2024b] F. Mauger and C. Chandre, "QMol-grid : A MATLAB package
%      for quantum-mechanical simulations in atomic and molecular systems," 
%      SoftwareX 28, 101968 (2024).
%    [Visentin 2025] G. Visentin et al., in preparation (2025).
%  
%  === Funding ==============================================================
%      The original development of the QMol-grid package, and its (TD)DFT
%    features, was supported by the U.S. Department of Energy, Office of
%    Science, Office of Basic Energy Sciences, under Award No. DE-SC0012462.
%      Addition of the (TD)SE and CI features was supported by the National
%    Science Foundation under Grant No. PHY-2207656.
%  
%  ##########################################################################
%  === Set the configuration-state basis ====================================
%    * Initialization                                                    DONE
%    * Configuration-state basis
%      Type         = RAS
%      Total spin   = 0
%      Active       = 1 2 3 4 5 6
%                     -6 -5 -4 -3 -2 -1
%      400 configuration-state basis elements
%      V-01.22.000 (05/20/2025)                       G. Visentin & F. Mauger
%  
%  ##########################################################################
%
%% 
% Next, we calculate the CI matrix with

CI.computeCImatrix;
%% 
% that prints out
%%
% 
%  (...)
%  === Build the configuration-interaction (CI) model [Visentin 2025] =======
%    * Discretization                                                      OK
%    * External (atomic or molecular) potential                            OK
%    * Electron-electron interaction potential                             OK
%  
%  === References ===========================================================
%    [Mauger 2024b] F. Mauger and C. Chandre, "QMol-grid : A MATLAB package
%      for quantum-mechanical simulations in atomic and molecular systems," 
%      SoftwareX 28, 101968 (2024).
%    [Visentin 2025] G. Visentin et al., in preparation (2025).
%  
%  === Funding ==============================================================
%      The original development of the QMol-grid package, and its (TD)DFT
%    features, was supported by the U.S. Department of Energy, Office of
%    Science, Office of Basic Energy Sciences, under Award No. DE-SC0012462.
%      Addition of the (TD)SE and CI features was supported by the National
%    Science Foundation under Grant No. PHY-2207656.
%  
%  ##########################################################################
%  === CI-matrix calculation ================================================
%                                         Calculation progress (%)
%    Calculation step          0       20       40       60       80      100
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%    Core integrals            ||||||||||||||||||||||||||||||||||||||||||||||
%    Dipole coupling elements  ||||||||||||||||||||||||||||||||||||||||||||||
%    Two-electron integrals    ||||||||||||||||||||||||||||||||||||||||||||||
%    CI matrix                 ||||||||||||||||||||||||||||||||||||||||||||||
%    REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%                                              CI-matrix calculation complete
%  
%  ##########################################################################
%
%% 
% Finally, we inspect the ground and first 2 excited states of our CI model 
% with

CI.analyzeCIspectrum(3);
%% 
% that prints out
%%
% 
%  === CI matrix spectrum ===================================================
%    * CI matrix
%      size = 400 x 400 with 24432 nonzero elements
%    * Ground state
%      Total energy      =    -10.758 a.u. =   -292.741 eV
%      >  91.904 % [  -3  -2  -1  1  2  3  ]
%      >   7.859 % [  -4  -2  -1  1  2  4  ]
%    * Excited state
%      Total energy      =    -10.698 a.u. =   -291.114 eV
%      Excitation energy =      0.060 a.u. =      1.627 eV
%      >  49.753 % [  -4  -2  -1  1  2  3  ]
%      >  49.753 % [  -3  -2  -1  1  2  4  ]
%    * Excited state
%      Total energy      =    -10.499 a.u. =   -285.686 eV
%      Excitation energy =      0.259 a.u. =      7.055 eV
%      >  49.766 % [  -4  -2  -1  1  2  3  ]
%      >  49.766 % [  -3  -2  -1  1  2  4  ]
%  ==========================================================================
%
%% 
% Without much surprise, we see that none of the ground and first 3 excited 
% state involve the LUMO+1 (index +/-5) and LUMO+2 (index +/- 6), which are very 
% far apart energetically (see the comment above).
%% Test suite
% For consistency with the rest of the QMol-grid package, |QMol_CI_conv| defines 
% an associated test suite. Run the test suite for the class in normal or <./Test_suite.html 
% summary mode> respectively with

QMol_test.test('CI_conv');
QMol_test.test('-summary','CI_conv');
%% For developers
% For internal use |QMol_CI_conv| defines additional transient properties. These 
% cannot be edited with the |set| method but can be directly edited by classes 
% in the QMol-grig package.
% V2e
% Internal electron-electron interaction potential |[ vector (default []) ]|
%% 
% * Discretization of |interactionPotential| over the extended domain used to 
% calculate electron-electron interaction integrals.
% * This property is set when the CI object is |initialize|d.
% |isReal|
% Whether the spatial orbitals are real valued |[ true | false | (default []) 
% ]|
%% 
% * This property is set when the CI object is |initialize|d.
% getDiscCopy
% Returns a minimally initialized discretization object

disc = getDiscCopy(obj);
%% 
% * If the domain discretization is implicitly defined via |x|, it is converted 
% into a <./QMol_disc.html |QMol_disc|> object, otherwise returns a copy of the 
% <./Discretization.html Domain discretization>. In either case, the output |disc| 
% is not initialized to limit memory use.
% getConfigurationBasisParameters
% Parsing of the flavor of CI (CIS, CISD, or RAS) and their associated number 
% of electrons, reference, active space, and frozen spin orbitals. It provides 
% a common interface for building the configuration-space basis and run-time documentation.

[algo,locN,locRef,locAct,locFrz] = obj.getConfigurationBasisParameters(isBld)
%% 
% * |algo = 1| corresponds to CIS, |algo = 2| corresponds to CISD, and |algo 
% = 0| corresponds to RAS.
% * |locN| is the number of electrons.
% * |locRef| are the indexes for the spin orbitals forming the reference configuration 
% state.
% * |locAct| are the indexes for the spin orbitals forming the active space.
% * |locFrz| are the indexes for the frozen spin orbitals.
% * Set |isBld = true| when called inside |setConfigurationBasis| and |isBld 
% = false| otherwise for proper run-time documentation display.
%% Notes
% The results displayed in this documentation page were generated using version 
% 01.22 of the QMol-grid package.
%% 
% * |QMol_CI_conv| was introduced in version 01.22
##### SOURCE END #####
-->
</div></body></html>