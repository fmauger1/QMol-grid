<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2024a"><title>Ground-state density-functional theory (DFT)</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: center;  }
.S3 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S4 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.S5 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S6 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.S7 { margin: 10px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 15px; font-weight: 700; text-align: left;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block }
.S8 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0.555556px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S9 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S10 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0.555556px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S11 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S12 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0.555556px solid rgb(217, 217, 217); border-bottom: 0.555556px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span>Ground-state density-functional theory (DFT)</span></h1><div  class = 'S1'><span>The QMol-grid package uses the Kohn-Sham formulation of density functional theory (DFT) [</span><a href = "#M_9C827223"><span>Kohn 1965</span></a><span>], where the electronic structure of a polyelectronic atom or molecule is described, in atomic units, by the nonlinear system eigen-state problem</span></div><div  class = 'S2' id = 'M_B74423F2' ><span texencoding="\hat{\mathcal{H}}_{\rm DFT}\left[\{\phi_k\}_k\right]\  \phi_k({\bf x}) = E_k\ \phi_k({\bf x})
\quad {\rm for}\quad k=1,\ 2,\ \ldots
\quad\quad\quad (1)" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="384.5" height="24.5" alt="Self-consistent field DFT equation" /></span></div><div  class = 'S1'><span>often referred to as the self-consistent field (SCF) equation. Formally, the DFT Hamiltonian operator </span><span texencoding="\hat{\mathcal{H}}_{\rm DFT}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="38" height="24.5" /></span><span> is only functionally dependent on the one-body density </span><span style="font-family: STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">œÅ</span><span> but some DFT functionals still involve the Kohn-Sham orbitals in their definition. Traditionally, the DFT Hamiltonian is decomposed between the kinetic, external, Hartree, and exchange-correlation operators, each associated with an energy functional</span></div><div  class = 'S2' id = 'M_91A5C882' ><span texencoding="\hat{\mathcal{H}}_{\rm DFT} = -\frac{\Delta}{2} + \hat{\mathcal{V}}_{\rm ext} + \hat{\mathcal{V}}_{\rm H} + \hat{\mathcal{V}}_{\rm XC}.
\quad\quad\quad (2)" style="vertical-align:-15px"><img src="data:image/png;base64,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" width="273.5" height="35.5" alt="DFT Hamiltonian components" /></span></div><div  class = 'S1'><span>The QMol-grid package provides support both for spin-polarized, where the up- and down-spin electronic components may be different, and spin-polarized, where they are forced to be identical DFT models. </span></div><ul  class = 'S3'><li  class = 'S4'><a href = "./QMol_DFT_spinPol.html"><span style=' font-family: monospace;'>QMol_DFT_spinPol</span></a><span> specifically describes spin polarized DFT systems.</span></li><li  class = 'S4'><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span> specifically describes spin restricted DFT systems.</span></li></ul><div  class = 'S1'><span>The two classes share very similar interfaces to provide a consistent end-user experience -- see their respective documentation pages for a detailed desciption of the classes and features they support.</span></div><h2  class = 'S5'><span>DFT components</span></h2><div  class = 'S1'><span>For clarity and streamlined future development of DFT capabilities in the QMol-grid package, we sort DFT component (classes) into different topical groups. Each component is equally compatible with both spin-polarized and -restricted DFT models</span></div><h3  class = 'S6'><span>Model discretization</span></h3><div  class = 'S1'><span>The following classes are used to discretize DFT systems</span></div><ul  class = 'S3'><li  class = 'S4'><a href = "./QMol_DFT_density.html"><span style=' font-family: monospace;'>QMol_DFT_density</span></a><span> is the Cartesian-grid discretization of a one-body density. It also provides support for the computation of density gradient.</span></li><li  class = 'S4'><a href = "./QMol_DFT_orbital.html"><span style=' font-family: monospace;'>QMol_DFT_orbital</span></a><span> is the Cartesian-grid discretization of the Kohn-Sham orbitals.  </span></li><li  class = 'S4'><a href = "./QMol_DFT_Vks.html"><span style=' font-family: monospace;'>QMol_DFT_Vks</span></a><span> is the Cartesian-grid discretization of the explicit part of the Kohn-Sham potential. Implicit components are also supported and provide an interface for the computation of the action of the potential operator on arbitrary wave functions.</span></li><li  class = 'S4'><a href = "./QMol_DFT_Vks_grad.html"><span style=' font-family: monospace;'>QMol_DFT_Vks_grad</span></a><span> is the Cartesian-grid discretization of the explicit part of the Kohn-Sham potential gradient. Similar to the Kohn-Sham potential, it also handles implicit components and the computation of the action of the potential gradient operator on arbitrary wave functions.</span></li></ul><div  class = 'S1'><span>For basis-set discretization models, with </span><a href = "./QMol_disc_basis.html"><span style=' font-family: monospace;'>QMol_disc_basis</span></a><span>, some of the classes above are redefined (overloaded)</span></div><ul  class = 'S3'><li  class = 'S4'><a href = "./QMol_DFT_orbital_basis.html"><span style=' font-family: monospace;'>QMol_DFT_orbital_basis</span></a><span> for Kohn-Sham orbitals.</span></li><li  class = 'S4'><a href = "./QMol_DFT_Vks_basis.html"><span style=' font-family: monospace;'>QMol_DFT_Vks_basis</span></a><span> for the Kohn-Sham potential.</span></li></ul><h3  class = 'S6'><span>Model components</span></h3><div  class = 'S1'><span>The following functionals are currently available for DFT models and simulations in the QMol-grid package</span></div><ul  class = 'S3'><li  class = 'S4'><a href = "./QMol_DFT_Vext.html"><span style=' font-family: monospace;'>QMol_DFT_Vext</span></a><span> describes the external functional and potential </span><span texencoding="\hat{\mathcal{V}}_{\rm ext}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="29.5" height="24.5" /></span><span> of Eq. (</span><a href = "#M_91A5C882"><span>2</span></a><span>).</span></li><li  class = 'S4'><a href = "./QMol_DFT_Vh_conv.html"><span style=' font-family: monospace;'>QMol_DFT_Vh_conv</span></a><span> describes the Hartree functional and potential </span><span texencoding="\hat{\mathcal{V}}_{\rm H}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="24.5" height="24.5" /></span><span> of Eq. (</span><a href = "#M_91A5C882"><span>2</span></a><span>), using an explicit-convolution scheme.</span></li><li  class = 'S4'><a href = "./QMol_DFT_Vh_fft.html"><span style=' font-family: monospace;'>QMol_DFT_Vh_fft</span></a><span> describes the Hartree functional and potential </span><span texencoding="\hat{\mathcal{V}}_{\rm H}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="24.5" height="24.5" /></span><span> of Eq. (</span><a href = "#M_91A5C882"><span>2</span></a><span>), using a fast-Fourier-transform convolution scheme.</span></li><li  class = 'S4'><a href = "./QMol_DFT_Vx_LDA_exp.html"><span style=' font-family: monospace;'>QMol_DFT_Vx_LDA_exp</span></a><span> describes local-density-approximation Slater exchange </span><span texencoding="\hat{\mathcal{V}}_{\rm XC}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="31" height="24.5" /></span><span> of Eq. (</span><a href = "#M_91A5C882"><span>2</span></a><span>), for exponential electron-electron interaction potentials.</span></li><li  class = 'S4'><a href = "./QMol_DFT_Vx_LDA_soft.html"><span style=' font-family: monospace;'>QMol_DFT_Vx_LDA_soft</span></a><span> describes local-density-approximation Slater exchange </span><span texencoding="\hat{\mathcal{V}}_{\rm XC}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="31" height="24.5" /></span><span> of Eq. (</span><a href = "#M_91A5C882"><span>2</span></a><span>), for soft-Coulomb electron-electron interaction potentials.</span></li><li  class = 'S4'><a href = "./QMol_DFT_Vx_XX_conv.html"><span style=' font-family: monospace;'>QMol_DFT_Vx_XX_conv</span></a><span> describes the exact-exchange functional and potential of Eq. (</span><a href = "#M_91A5C882"><span>2</span></a><span>), using an explicit-convolution scheme.</span></li><li  class = 'S4'><a href = "./QMol_DFT_Vx_XX_fft.html"><span style=' font-family: monospace;'>QMol_DFT_Vx_XX_fft</span></a><span> describes the exact-exchange functional and potential of Eq. (</span><a href = "#M_91A5C882"><span>2</span></a><span>), using a fast-Fourier-transform convolution scheme.</span></li><li  class = 'S4'><a href = "./QMol_DFT_Vc_LDA_soft.html"><span style=' font-family: monospace;'>QMol_DFT_Vc_LDA_soft</span></a><span> describes local-density-approximation correlation </span><span texencoding="\hat{\mathcal{V}}_{\rm XC}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="31" height="24.5" /></span><span> of Eq. (</span><a href = "#M_91A5C882"><span>2</span></a><span>), for soft-Coulomb electron-electron interaction potentials.</span></li></ul><div  class = 'S1'><span>All DFT functionals can be used both for regular grid-based and basis-set deiscretization models, using the same end-user interfaces.</span></div><h3  class = 'S6'><span>Memory and execution-time profiler</span></h3><div  class = 'S1'><span>The choice of the domain discretization and DFT components can greatly affect the resources, both in terms of memory and execution time, required to carry out simulations.</span></div><ul  class = 'S3'><li  class = 'S4'><a href = "./QMol_DFT_profiler.html"><span style=' font-family: monospace;'>QMol_DFT_profiler</span></a><span> provides estimates of the memory and run-time requirements for a given DFT model or components.</span></li></ul><div  class = 'S1'><span>Keep in mind that differentiation and (some) convolutions are performed via fast-Fourier transforms. Thus, as a rule of thumb, domain discretization with small prime factor number of grid points tend to produce faster results -- for best performance, prime factors not greater than 7.</span></div><h3  class = 'S6'><span>Ground-state computation</span></h3><div  class = 'S1'><span>The DFT ground state, or more generally some DFT eigen state, is computed by numerically solving the SCF problem of Eq. (</span><a href = "#M_B74423F2"><span>1</span></a><span>). In the QMol-grid package, this can be achieved with</span></div><ul  class = 'S3'><li  class = 'S4'><a href = "./QMol_DFT_SCF_Anderson.html"><span style=' font-family: monospace;'>QMol_DFT_SCF_Anderson</span></a><span> performs SCF iterations for DFT ground/eigen-state calculations using an Anderson's mixing scheme.</span></li><li  class = 'S4'><a href = "./QMol_DFT_eigs.html"><span style=' font-family: monospace;'>QMol_DFT_eigs</span></a><span> is a linear eigen solver, to be used in combination with SCF iterations.</span></li><li  class = 'S4'><a href = "./QMol_DFT_eig_basis.html"><span style=' font-family: monospace;'>QMol_DFT_eig_basis</span></a><span> is a linear eigen solver for basis-set DFT models, to be used in combination with SCF iterations.</span></li></ul><h2  class = 'S5'><span>Self-interaction correction (SIC)</span></h2><div  class = 'S1'><span>Various approaches have been proposed to provide self-interaction correction to the DFT Eq. (</span><a href = "#M_B74423F2"><span>1</span></a><span>). Currently, the QMol-grid package supports:</span></div><h3  class = 'S6'><span>No self-interaction correction</span></h3><div  class = 'S1'><span>In this case, self-interaction is ignored and no SIC is provided. This is the default options for all DFT models in the QMol-grid package.</span></div><h3  class = 'S6'><span>Average-density self-interaction correction (ADSIC)</span></h3><div  class = 'S1'><span>ADSIC implements an average-density level of SIC [</span><a href = "#M_73E1880A"><span>Legrand 2002</span></a><span>] that is easy to implement in the general DFT framework of Eq. (</span><a href = "#M_B74423F2"><span>1</span></a><span>). Unless otherwise specified, all Hartree and exchange-correlation DFT functionals in the QMol-grid package support ADSIC.</span></div><h2  class = 'S5'><span>Notes for developers</span></h2><h3  class = 'S6'><span>DFT model implementation</span></h3><div  class = 'S1'><span>The </span><a href = "./QMol_DFT.html"><span style=' font-family: monospace;'>QMol_DFT</span></a><span> abstract class defines the common interface and run-time documentation for both spin-polarized (</span><a href = "./QMol_DFT_spinPol.html"><span style=' font-family: monospace;'>QMol_DFT_spinPol</span></a><span>) and spin-restricted (</span><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span>) DFT models.</span></div><div  class = 'S1'><span>Many DFT components and methods require convergence tolerance or thresholds in their implementation. Throughout, we parameterize these through class properties (generally named </span><span style=' font-family: monospace;'>tol</span><span>). The default configuration of the QMol-grid package roughly aims for </span><span texencoding="10^{-10}" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEcAAAAoCAYAAACsEueQAAAAAXNSR0IArs4c6QAABSdJREFUaEPtmWtoHFUUx/9nMruaxDdqJMbMndk1YHxgEa0ffAS1JaWh9VW1ERUf7YdooUUkVpR+8IGgiIIVtDZUxT6sVHxWUCEWK4jgA+mWxNnZmXWNgqKBFaOZ3Tlyw46MY7I7yU6UJjvflrn37D2/+Z/XDKFxzUiAGmxmJtCAU0UdDTgNOHNLHg3lLBblpNPpozzPu5aZ+xOJxO2jo6M/h31va2trbW1t3cDMVwH4EsCFAIY0Tds5PDxcCq5fEMqRUMrl8nIi2sTMlwD4IpFI9IXhdHd3HzMxMbEVgOZ53lrHcX5Ip9Nnl8vlfUS0u7Oz8+EgoAUBp6enRy0WizQ+Pn6i53nvAihPB8cwjAFm3srMa23b3l1RCem6/gCAQSK6xrKsj3z1LAg4vjNdXV0nu677jvwdhtPR0XGSqqp7iejMpqamFaZpHvL3GYZxJTN/CGBbc3PzPZlMZlLeWzRwNE1boijK+wByYXCapp2lKMp+AL+6rttXKBS+X1RwDMNYycxSVW8mk8lbRkZGir5yOjo6Tk8kEvJeu+d5vY7jyEQdWTmKEOIyItroed5mx3EO1+ocdF1vA7COmZcQUQ7Aucx8yPO8Z/P5vFVr/1zuVwsrwzDuYObtzLxzcnJy3djY2O/ThONSZu6xbfvjKHCmoAB4iIiuAOB4nreiBhyZ4PoAvADgFdd1txQKhQmZNG3bvpeIBpl5wLbtPQB4LhBm2vOfwdF1/Tz55AHkAVwP4KIocIQQlxPRGwBsRVFWZ7PZ7wKJ73gAO5hZrlkTrAyGYTzOzINRYQWfcJSEXC2sUqnUqZUq1xkprLq7u5N+1tZ1XUKSSqiqHFkREonELgDLATyYy+UeC6tDCHETEck1B5j5Rtu2f5TOpVKpc5j5tKhwFEX52jTNn4Lrqyln3hKyH6+14AgheonoLXlgZl7mx27QgUBl0EL9RlQuM66rBkcIcQIRvQagK5wa/FLOzEOqqg6YpvlnlJwzdZAocGROcRznKQAbABz2PG+l4zgyEf/jChxy2XTJsR5C1eBU/KjWBG5h5lW2bctyP3VF6nOiwAk6DeCg67qrCoXCL2Fn29vbW5LJ5DYi6gfwVbCvqAdMJTT93DFth1wJ+5cAHBseHwC8rWna/bMeH6LAMQxDyvU9IkrVUkQg+RYr4fdZPWDkbFUqlS4mopsrRcQF8AQR7VcU5XM/TOR/pNPp40ql0iYiutQfPJl5h6qqu4LrYlVOZYCTXeYZs4Ajc9PffUU9gOZjb5xhJcvzcCUZ/6vRCh4+WLaJ6E7Lsobmw7l6bcYJZykRfSDjeTbKAbAml8u9Xq8j87E/NjihEh1ZOYsirALD2/mzUI4rxxLLsj6Zjydfr83YlBO1lAshjiai5wHcWq0fqtexOPbHBkf2TEKIR4lo8yyawH0tLS23ZTKZ3+JwJm4bccJBYHz4Y6b+JdgPEdHdlmU9F7dTcdmLFY5hGP7UfTUzb7Rt+5nwQXVdlxP+XvluR1XV1aZpZuNyJm47scKRhwu8svgmOHVXZhsf3koAd+VyuZfjdihOezXhVAZKqYABAEVFUXqz2eynVQ4hc88NRPQ0gBebmpoekW25tJPP59czs3xvc58QYnv4O1GcjsVha0Y46XT6lFKp1E9E1wGQc4h/mUT0KhEdIKKD4XnEXySEEADWE9EFAL6V34oAjBHRk5ZlmXG/BYwDRthGTeXMx58eKTYbcKrlhyPlKf4f52wop6GcuemuoZyGchrKmRuBKrv+Ao/I7VarBdDxAAAAAElFTkSuQmCC" width="35.5" height="20" /></span><span> as the target tolerance/threshold. Changing the values for the </span><span style=' font-family: monospace;'>tol</span><span> parameters may have unintended side effects -- see the respective documentation pages for more details on these tolerance/threshold parameters.</span></div><h3  class = 'S6'><span>Exchange-correlation functionals</span></h3><div  class = 'S1'><span>To be compatible with other DFT components of the QMol-grid package, exchange-correlation functionals must fulfill the following requirements:</span></div><h4  class = 'S7'><span>Class definition</span></h4><div  class = 'S1'><span>Define exchange-correlation classes by overloading the </span><a href = "./QMol_suite.html"><span style=' font-family: monospace;'>QMol_suite</span></a><span> class. This will facilitate name-value pair assignment for property values in the constructor, </span><span style=' font-family: monospace;'>set</span><span>, and </span><span style=' font-family: monospace;'>clear</span><span> methods -- see the </span><a href = "./QMol_suite.html"><span style=' font-family: monospace;'>QMol_suite</span></a><span> documentation page for more details.</span></div><h4  class = 'S7'><span>Class properties</span></h4><div  class = 'S1'><span>Exchange-correlation classes should define the following member properties (with the specified attributes)</span></div><ul  class = 'S3' id = 'M_D741D66D' ><li  class = 'S4'><span>DFT: with recommended attributes </span><span style=' font-family: monospace;'>Transient,Hidden,GetAccess=?QMol_suite,SetAccess={?QMol_DFT_###,?QMol_DFT}</span><span>, where </span><span style=' font-family: monospace;'>QMol_DFT_###</span><span> is the name of the exchange-correlation class being implemented, and at minimum such that </span><span style=' font-family: monospace;'>QMol_DFT</span><span> can edit the value of </span><span style=' font-family: monospace;'>DFT</span><span>. This feature is used by </span><a href = "./QMol_DFT_profiler.html"><span style=' font-family: monospace;'>QMol_DFT_profiler</span></a><span> to estimate the memory footprint of DFT models without allocating its components.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>type</span><span>: as a </span><span style=' font-family: monospace;'>constant</span><span> character array with public access. This is used by </span><a href = "./TDDFT.html"><span>TDDFT propagators</span></a><span> to check that the DFT functionals used in the model are supported. Possible values are </span><span style=' font-family: monospace;'>'GGA_C'</span><span> (for GGA exchange), </span><span style=' font-family: monospace;'>'GGA_X'</span><span> (for GGA exchange), </span><span style=' font-family: monospace;'>'GGA_XC'</span><span> (for GGA exchange correlation), </span><span style=' font-family: monospace;'>'LDA_C'</span><span> (for LDA exchange), </span><span style=' font-family: monospace;'>'LDA_X'</span><span> (for LDA exchange), </span><span style=' font-family: monospace;'>'LDA_XC'</span><span> (for LDA exchange correlation), </span><span style=' font-family: monospace;'>'XX'</span><span> (for exact exchange).</span></li></ul><h4  class = 'S7'><span>Run-time documentation</span></h4><div  class = 'S1'><span>Implement run-time documentation with the follwing interface</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >methods (Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >ref = showDocumentation(obj)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%showDocumentation displays the documentation reflecting member property </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%   values</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Add run-time documentation</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><div  class = 'S11'><span>Each exchange-correlation functional class </span><span style=' text-decoration: underline;'>must</span><span> implement a run-time documentation as it is automatically called by </span><a href = "./QMol_DFT.html"><span style=' font-family: monospace;'>QMol_DFT</span></a><span> in its own run-time documentation.</span></div><ul  class = 'S3'><li  class = 'S4'><span>If no reference is cited, return </span><span style=' font-family: monospace;'>ref = {}</span><span> otherwise </span><span style=' font-family: monospace;'>ref = {'ref 1','ref 2',___}</span><span>, where each of the </span><span style=' font-family: monospace;'>ref</span><span> corresponds to the bibliographic code for the reference (generally of the form </span><span style=' font-family: monospace;'>'name_of_first_author publication_year'</span><span>) and is case insensitive -- see the </span><a href = "./Documentation.html"><span>documentation page</span></a><span> for a list of citable references.</span></li></ul><div  class = 'S1'><span>Additionally, exchange-correlation functional class </span><span style=' text-decoration: underline;'>should</span><span> implement an estimator of its memory footprint with the following interface</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >methods (Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >mem = getMemoryProfile(obj,opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%getMemoryProfile computes and returns an estimate of the total memory</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%   footprint (in bytes) of the DFT object with all its components</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%   initialized and used.</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Add memory footprint estimate</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span style=' font-family: monospace;'>getMemoryProfile</span><span> must be able to return the memory footprint estimate even if the object has not been initialized. To do so, it can rely on its internal copy of the parent </span><span style=' font-family: monospace;'>DFT</span><span> object, that is properly assigned by </span><a href = "./QMol_DFT_profiler.html"><span style=' font-family: monospace;'>QMol_DFT_profiler</span></a><span> before calling  </span><span style=' font-family: monospace;'>getMemoryProfile</span><span>.</span></li><li  class = 'S4'><span>Only properties with large memory footprint -- </span><span style=' font-style: italic;'>e.g.</span><span>, the discretization of internal properties on the domain discretization grid -- need to be listed. Other small properties (scalar, object handle, flags, etc.) can be ignored; if the class only uses such small properties, it may return </span><span style=' font-family: monospace;'>mem = 0</span><span>.</span></li><li  class = 'S4'><span>Use the </span><a href = "./QMol_DFT_profiler.html"><span style=' font-family: monospace;'>QMol_DFT_profiler</span></a><span style=' font-family: monospace;'>.getMemoryFootprint(N,'real')</span><span> and </span><a href = "./QMol_DFT_profiler.html"><span style=' font-family: monospace;'>QMol_DFT_profiler</span></a><span style=' font-family: monospace;'>.getMemoryFootprint(N,'imag')</span><span> methods to convert the size (number of elements N) of the memory components to the number of bytes they take in memory.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>opt = false</span><span> requests the memory footprint with no details printed out.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>opt = true</span><span> should additionally display the details of the memory estimate. Use </span><a href = "./QMol_DFT_profiler.html"><span style=' font-family: monospace;'>QMol_DFT_profiler</span></a><span style=' font-family: monospace;'>.showMemoryFootprint(msg,mem,lvl)</span><span> to do this, with msg (character array) the description of the component, </span><span style=' font-family: monospace;'>mem</span><span> the estimated number of bytes associated with it, and </span><span style=' font-family: monospace;'>lvl</span><span> the indentation level (optional, </span><span style=' font-family: monospace;'>lvl = 1</span><span> and </span><span style=' font-family: monospace;'>lvl = 2</span><span> are the only two levels supported).</span></li></ul><h4  class = 'S7'><span>Class initialization</span></h4><div  class = 'S1'><span>Initialize the class with the following interface</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >methods (Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >initialize(obj,DFT,SIC)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%initialize initializes the object</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Initialize the functional object</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>the input </span><span style=' font-family: monospace;'>DFT</span><span> is a </span><a href = "./QMol_DFT.html"><span style=' font-family: monospace;'>QMol_DFT</span></a><span> object containing the DFT model associated with the exchange-correlation functional object to be initialized. For run-time considerations it is often practical to keep a local copy of </span><span style=' font-family: monospace;'>DFT</span><span> in the object in the </span><a href = "#M_D741D66D"><span>DFT</span></a><span> member method.</span></li><li  class = 'S4'><span>The input </span><span style=' font-family: monospace;'>SIC</span><span> specifies the flavor of SIC to be used with the exchange-correlation functional. </span><span style=' font-family: monospace;'>'none'</span><span> notify to disable SIC while </span><span style=' font-family: monospace;'>'ADSIC'</span><span> specifies the ADSIC method [</span><a href = "#M_73E1880A"><span>Legrand 2002</span></a><span>].</span></li><li  class = 'S4'><span>Both </span><span style=' font-family: monospace;'>DFT</span><span> and </span><span style=' font-family: monospace;'>SIC</span><span> information are systematically passed along by the parent DFT model object when it initializes its exchange-correlation functional components.</span></li></ul><h4  class = 'S7'><span>Exchange-correlation functional kernel</span></h4><div  class = 'S1'><span>Implicit functionals may require specific initialization of the exchange-correlation functional object before they can compute the </span><a href = "#H_0E834206"><span>energy</span></a><span>, </span><a href = "#H_4E4742A9"><span>potential</span></a><span>, or </span><a href = "#H_35E6324E"><span>potential gradient</span></a><span>. This is done with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >methods (Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >setPotentialKernel(obj)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%setPotentialKernel sets the kernel to be used for the computation of </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%   exact-exchange potentials</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Proper initialization</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><div  class = 'S11'><span>This typically involves storing a local copy of the Kohn-Sham orbitals of the parent DFT model. If no kernel initialization is required, include the following block in the class definition</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >methods (Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >setPotentialKernel(~)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%setPotentialKernel no kernel to set</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><h4  class = 'S7' id = 'H_0E834206' ><span>Exchange-correlation energy</span></h4><div  class = 'S1'><span>Compute and return the exchange-correlation energy with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >methods (Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >E = getEnergy(obj,rho)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%getEnergy returns the exchange-correlation energy</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Exchange-correlation energy computation</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><div  class = 'S11'><span>The </span><span style=' font-family: monospace;'>getEnergy</span><span> method should support the following computation modes -- see one of the available exchange-correlation functional documentation page for more details.</span></div><div  class = 'S1'><span>Get the exchange-correlation energy for the parent DFT object</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >E = obj.getEnergy;</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>This computes the exchange energy associated with the Kohn-Sham orbitals in the parent DFT model. To do so, it should first compute the one-body density associated with the Kohn-Sham orbitals and their occupation parameters.</span></li><li  class = 'S4'><span>This should be equivalent to, but more efficient than, </span><span style=' font-family: monospace;'>obj.getEnergy(DFT.getDensity)</span><span>.</span></li></ul><div  class = 'S1'><span>Get the exchange-correlation energy for a specific one-body density</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >E = obj.getEnergy(rho);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>Same as above but with using the input </span><a href = "./QMol_DFT_density.html"><span>one-body-density object</span></a><span> </span><span style=' font-family: monospace;'>rho</span><span> in the numerical computation of the energy.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>rho</span><span> should be a </span><span style=' font-family: monospace;'>QMol_DFT_density</span><span> object defined over the same </span><a href = "./QMol_disc.html"><span>domain discretization</span></a><span> as the parent DFT model.</span></li></ul><h4  class = 'S7' id = 'H_4E4742A9' ><span>Exchange-correlation potential</span></h4><div  class = 'S1'><span>Compute and return the exchange-correlation potential with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >methods (Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >E = getPotential(obj,rho)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%getPotential returns the exchange-correlation potential</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Exchange-correlation potential computation</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><div  class = 'S11'><span>The </span><span style=' font-family: monospace;'>getPotential</span><span> method should support the following computation modes -- see one of the available exchange-correlation functional documentation page for more details.</span></div><div  class = 'S1'><span>Get the exchange-correlation potential for the parent DFT object with either</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >V = obj.getPotential;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >V = obj.getPotential([]);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>This computes the exchange-correlation potential associated with the Kohn-Sham orbitals in the parent DFT model. To do so, it should first compute the one-body density </span><span style="font-family: STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">œÅ</span><span> associated with the Kohn-Sham orbitals and their occupation parameters.</span></li><li  class = 'S4'><span>The output Kohn-Sham potential object contains the numerical evaluation of the exchange-correlation potential. </span></li><li  class = 'S4'><span>For implicit exchange-correlation functionals, it provides the proper function handle to the Kohn-Sham potential class.</span></li><li  class = 'S4'><span>This creates a new Kohn-Sham potential object </span><span style=' font-family: monospace;'>V</span><span> in which the exchange-correlation potential is stored.</span></li><li  class = 'S4'><span>Note that </span><span style=' font-family: monospace;'>getPotential</span><span> </span><span style=' text-decoration: underline;'>should not</span><span> </span><span style=' font-family: monospace;'>initialize</span><span> the output potential object </span><span style=' font-family: monospace;'>V</span><span>.</span></li></ul><div  class = 'S1'><span>Get the exchange-correlation potential for a specific one-body density</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >V = obj.getPotential(rho);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>Same as above but with using the input </span><a href = "./QMol_DFT_density.html"><span>one-body-density object</span></a><span> </span><span style=' font-family: monospace;'>rho</span><span> in the numerical computation of the potential.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>rho</span><span> should be a </span><span style=' font-family: monospace;'>QMol_DFT_density</span><span> object defined over the same </span><a href = "./QMol_disc.html"><span>domain discretization</span></a><span> as the parent DFT model.</span></li></ul><div  class = 'S1'><span>Overwrite the exchange-correlation potential in an existing Kohn-Sham potential object with any of</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.getPotential([],V);         </span><span style="color: #008013;">% use parent DFT density</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj.getPotential([],V,false);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj.getPotential(rho,V);        </span><span style="color: #008013;">% supply the density</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.getPotential(rho,V,false);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>This is similar to above without creating a new Kohn-Sham potential object.</span></li><li  class = 'S4'><span>Any content in the input object </span><span style=' font-family: monospace;'>V</span><span> is erased before assigning the external potential to it.</span></li></ul><div  class = 'S1'><span>Add the exchange-correlation potential to an existing Kohn-Sham potential object</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.getPotential([],V,true);    </span><span style="color: #008013;">% use parent DFT density</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.getPotential(rho,V,true);   </span><span style="color: #008013;">% supply the density</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>This is formally equivalent to the in-place addition </span><span texencoding="\mathcal{V}\leftarrow\mathcal{V}+\mathcal{V}_{\rm XC}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="98.5" height="19.5" /></span><span>.</span></li></ul><h4  class = 'S7' id = 'H_35E6324E' ><span>Exchange-correlation potential gradient</span></h4><div  class = 'S1'><span>Compute and return the exchange-correlation potential gradient with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >methods (Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >E = getPotentialDerivative(obj,rho)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%getPotentialDerivative returns the exchange-correlation potential</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%   gradient</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Exchange-correlation potential computation</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><div  class = 'S11'><span>The </span><span style=' font-family: monospace;'>getPotentialDerivative</span><span> method should support the following computation modes -- see one of the available exchange-correlation functional documentation page for more details.</span></div><div  class = 'S1'><span>Get the exchange-correlation potential gradient for the parent DFT object  with either</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >DV = obj.getPotentialDerivative(dim);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >DV = obj.getPotentialDerivative(dim,[]);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>This computes the exchange-correlation potential gradient, along the dimension dim (</span><span style=' font-family: monospace;'>1</span><span> for </span><span style=' font-family: monospace;'>x</span><span>, </span><span style=' font-family: monospace;'>2</span><span> for </span><span style=' font-family: monospace;'>y</span><span>, and </span><span style=' font-family: monospace;'>3</span><span> for </span><span style=' font-family: monospace;'>z</span><span>), associated with the Kohn-Sham orbitals in the parent DFT model. To do so, it should first compute the one-body density </span><span style="font-family: STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">œÅ</span><span> associated with the Kohn-Sham orbitals and their occupation parameters.</span></li><li  class = 'S4'><span>The output Kohn-Sham potential gradient object contains the numerical evaluation of the exchange-correlation potential gradient.</span></li><li  class = 'S4'><span>For implicit exchange-correlation functionals, it provides the proper function handle to the Kohn-Sham potential gradient class.</span></li><li  class = 'S4'><span>This creates a new Kohn-Sham potential gradient object </span><span style=' font-family: monospace;'>DV</span><span> in which the exchange potential gradient is stored.</span></li><li  class = 'S4'><span>Note that </span><span style=' font-family: monospace;'>getPotentialDerivative</span><span> </span><span style=' text-decoration: underline;'>does not</span><span> </span><span style=' font-family: monospace;'>initialize</span><span> the output potential gradient object </span><span style=' font-family: monospace;'>DV</span><span>.</span></li></ul><div  class = 'S1'><span>Get the exchange-correlation potential for a specific one-body density</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >V = obj.getPotentialDerivative(1,rho);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>Same as above but with using the input </span><a href = "./QMol_DFT_density.html"><span>one-body-density object</span></a><span> </span><span style=' font-family: monospace;'>rho</span><span> in the numerical computation of the potential gradient.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>rho</span><span> should be a </span><span style=' font-family: monospace;'>QMol_DFT_density</span><span> object defined over the same </span><a href = "./QMol_disc.html"><span>domain discretization</span></a><span> as the parent DFT model.</span></li></ul><div  class = 'S1'><span>Overwrite the exchange-correlation potential gradient in an existing Kohn-Sham potential gradient object with any of</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.getPotentialDerivative(1,[],DV);        </span><span style="color: #008013;">% use parent DFT density</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj.getPotentialDerivative(1,[],DV,false);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj.getPotentialDerivative(1,rho,DV);       </span><span style="color: #008013;">% supply the density</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.getPotentialDerivative(1,rho,DV,false);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>This is similar to above without creating a new Kohn-Sham potential gradient object.</span></li><li  class = 'S4'><span>Any content in the input object </span><span style=' font-family: monospace;'>DV</span><span> is ereased before assigning the exchange-correlation potential gradient to it.</span></li></ul><div  class = 'S1'><span>Add the exchange-correlation potential gradient to an existing Kohn-Sham potential gradient object with either</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.getPotentialDerivative(1,[],DV,true);   </span><span style="color: #008013;">% use parent DFT density</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.getPotentialDerivative(1,rho,DV,true);  </span><span style="color: #008013;">% supply the density</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>This is formally equivalent to the in-place addition </span><span texencoding="\nabla\mathcal{V}\leftarrow\nabla\mathcal{V}+\nabla\mathcal{V}_{\rm XC}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="131.5" height="19.5" /></span><span>.</span></li></ul><h2  class = 'S5'><span>References</span></h2><div  class = 'S1' id = 'M_9C827223' ><span>[Kohn 1965] W. Kohn and L.J. Sham, "Self-Consistent Equations Including Exchange and Correlation Effects," Physical Review 140, A1133 (1965).</span></div><div  class = 'S1' id = 'M_73E1880A' ><span>[Legrand 2002] C. Legrand, E. Suraud, and P.-G. Reinhard, "Comparison of self-interaction-corrections for metal clusters," Journal of Physics B: Atomic, Molecular and Optical Physics 35, 1115 (2002).</span></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Ground-state density-functional theory (DFT)
% The QMol-grid package uses the Kohn-Sham formulation of density functional 
% theory (DFT) [Kohn 1965], where the electronic structure of a polyelectronic 
% atom or molecule is described, in atomic units, by the nonlinear system eigen-state 
% problem
% 
% $$\hat{\mathcal{H}}_{\rm DFT}\left[\{\phi_k\}_k\right]\  \phi_k({\bf x}) = 
% E_k\ \phi_k({\bf x})\quad {\rm for}\quad k=1,\ 2,\ \ldots\quad\quad\quad (1)$$
% 
% often referred to as the self-consistent field (SCF) equation. Formally, the 
% DFT Hamiltonian operator $\hat{\mathcal{H}}_{\rm DFT}$ is only functionally 
% dependent on the one-body density $\rho$ but some DFT functionals still involve 
% the Kohn-Sham orbitals in their definition. Traditionally, the DFT Hamiltonian 
% is decomposed between the kinetic, external, Hartree, and exchange-correlation 
% operators, each associated with an energy functional
% 
% $$\hat{\mathcal{H}}_{\rm DFT} = -\frac{\Delta}{2} + \hat{\mathcal{V}}_{\rm 
% ext} + \hat{\mathcal{V}}_{\rm H} + \hat{\mathcal{V}}_{\rm XC}.\quad\quad\quad 
% (2)$$
% 
% The QMol-grid package provides support both for spin-polarized, where the 
% up- and down-spin electronic components may be different, and spin-polarized, 
% where they are forced to be identical DFT models. 
%% 
% * <./QMol_DFT_spinPol.html |QMol_DFT_spinPol|> specifically describes spin 
% polarized DFT systems.
% * <./QMol_DFT_spinRes.html |QMol_DFT_spinRes|> specifically describes spin 
% restricted DFT systems.
%% 
% The two classes share very similar interfaces to provide a consistent end-user 
% experience REPLACE_WITH_DASH_DASH see their respective documentation pages for a detailed desciption 
% of the classes and features they support.
%% DFT components
% For clarity and streamlined future development of DFT capabilities in the 
% QMol-grid package, we sort DFT component (classes) into different topical groups. 
% Each component is equally compatible with both spin-polarized and -restricted 
% DFT models
% Model discretization
% The following classes are used to discretize DFT systems
%% 
% * <./QMol_DFT_density.html |QMol_DFT_density|> is the Cartesian-grid discretization 
% of a one-body density. It also provides support for the computation of density 
% gradient.
% * <./QMol_DFT_orbital.html |QMol_DFT_orbital|> is the Cartesian-grid discretization 
% of the Kohn-Sham orbitals.  
% * <./QMol_DFT_Vks.html |QMol_DFT_Vks|> is the Cartesian-grid discretization 
% of the explicit part of the Kohn-Sham potential. Implicit components are also 
% supported and provide an interface for the computation of the action of the 
% potential operator on arbitrary wave functions.
% * <./QMol_DFT_Vks_grad.html |QMol_DFT_Vks_grad|> is the Cartesian-grid discretization 
% of the explicit part of the Kohn-Sham potential gradient. Similar to the Kohn-Sham 
% potential, it also handles implicit components and the computation of the action 
% of the potential gradient operator on arbitrary wave functions.
%% 
% For basis-set discretization models, with <./QMol_disc_basis.html |QMol_disc_basis|>, 
% some of the classes above are redefined (overloaded)
%% 
% * <./QMol_DFT_orbital_basis.html |QMol_DFT_orbital_basis|> for Kohn-Sham orbitals.
% * <./QMol_DFT_Vks_basis.html |QMol_DFT_Vks_basis|> for the Kohn-Sham potential.
% Model components
% The following functionals are currently available for DFT models and simulations 
% in the QMol-grid package
%% 
% * <./QMol_DFT_Vext.html |QMol_DFT_Vext|> describes the external functional 
% and potential $\hat{\mathcal{V}}_{\rm ext}$ of Eq. (2).
% * <./QMol_DFT_Vh_conv.html |QMol_DFT_Vh_conv|> describes the Hartree functional 
% and potential $\hat{\mathcal{V}}_{\rm H}$ of Eq. (2), using an explicit-convolution 
% scheme.
% * <./QMol_DFT_Vh_fft.html |QMol_DFT_Vh_fft|> describes the Hartree functional 
% and potential $\hat{\mathcal{V}}_{\rm H}$ of Eq. (2), using a fast-Fourier-transform 
% convolution scheme.
% * <./QMol_DFT_Vx_LDA_exp.html |QMol_DFT_Vx_LDA_exp|> describes local-density-approximation 
% Slater exchange $\hat{\mathcal{V}}_{\rm XC}$ of Eq. (2), for exponential electron-electron 
% interaction potentials.
% * <./QMol_DFT_Vx_LDA_soft.html |QMol_DFT_Vx_LDA_soft|> describes local-density-approximation 
% Slater exchange $\hat{\mathcal{V}}_{\rm XC}$ of Eq. (2), for soft-Coulomb electron-electron 
% interaction potentials.
% * <./QMol_DFT_Vx_XX_conv.html |QMol_DFT_Vx_XX_conv|> describes the exact-exchange 
% functional and potential of Eq. (2), using an explicit-convolution scheme.
% * <./QMol_DFT_Vx_XX_fft.html |QMol_DFT_Vx_XX_fft|> describes the exact-exchange 
% functional and potential of Eq. (2), using a fast-Fourier-transform convolution 
% scheme.
% * <./QMol_DFT_Vc_LDA_soft.html |QMol_DFT_Vc_LDA_soft|> describes local-density-approximation 
% correlation $\hat{\mathcal{V}}_{\rm XC}$ of Eq. (2), for soft-Coulomb electron-electron 
% interaction potentials.
%% 
% All DFT functionals can be used both for regular grid-based and basis-set 
% deiscretization models, using the same end-user interfaces.
% Memory and execution-time profiler
% The choice of the domain discretization and DFT components can greatly affect 
% the resources, both in terms of memory and execution time, required to carry 
% out simulations.
%% 
% * <./QMol_DFT_profiler.html |QMol_DFT_profiler|> provides estimates of the 
% memory and run-time requirements for a given DFT model or components.
%% 
% Keep in mind that differentiation and (some) convolutions are performed via 
% fast-Fourier transforms. Thus, as a rule of thumb, domain discretization with 
% small prime factor number of grid points tend to produce faster results REPLACE_WITH_DASH_DASH for 
% best performance, prime factors not greater than 7.
% Ground-state computation
% The DFT ground state, or more generally some DFT eigen state, is computed 
% by numerically solving the SCF problem of Eq. (1). In the QMol-grid package, 
% this can be achieved with
%% 
% * <./QMol_DFT_SCF_Anderson.html |QMol_DFT_SCF_Anderson|> performs SCF iterations 
% for DFT ground/eigen-state calculations using an Anderson's mixing scheme.
% * <./QMol_DFT_eigs.html |QMol_DFT_eigs|> is a linear eigen solver, to be used 
% in combination with SCF iterations.
% * <./QMol_DFT_eig_basis.html |QMol_DFT_eig_basis|> is a linear eigen solver 
% for basis-set DFT models, to be used in combination with SCF iterations.
%% Self-interaction correction (SIC)
% Various approaches have been proposed to provide self-interaction correction 
% to the DFT Eq. (1). Currently, the QMol-grid package supports:
% No self-interaction correction
% In this case, self-interaction is ignored and no SIC is provided. This is 
% the default options for all DFT models in the QMol-grid package.
% Average-density self-interaction correction (ADSIC)
% ADSIC implements an average-density level of SIC [Legrand 2002] that is easy 
% to implement in the general DFT framework of Eq. (1). Unless otherwise specified, 
% all Hartree and exchange-correlation DFT functionals in the QMol-grid package 
% support ADSIC.
%% Notes for developers
% DFT model implementation
% The <./QMol_DFT.html |QMol_DFT|> abstract class defines the common interface 
% and run-time documentation for both spin-polarized (<./QMol_DFT_spinPol.html 
% |QMol_DFT_spinPol|>) and spin-restricted (<./QMol_DFT_spinRes.html |QMol_DFT_spinRes|>) 
% DFT models.
% 
% Many DFT components and methods require convergence tolerance or thresholds 
% in their implementation. Throughout, we parameterize these through class properties 
% (generally named |tol|). The default configuration of the QMol-grid package 
% roughly aims for $10^{-10}$ as the target tolerance/threshold. Changing the 
% values for the |tol| parameters may have unintended side effects REPLACE_WITH_DASH_DASH see the 
% respective documentation pages for more details on these tolerance/threshold 
% parameters.
% Exchange-correlation functionals
% To be compatible with other DFT components of the QMol-grid package, exchange-correlation 
% functionals must fulfill the following requirements:
% Class definition
% Define exchange-correlation classes by overloading the <./QMol_suite.html 
% |QMol_suite|> class. This will facilitate name-value pair assignment for property 
% values in the constructor, |set|, and |clear| methods REPLACE_WITH_DASH_DASH see the <./QMol_suite.html 
% |QMol_suite|> documentation page for more details.
% Class properties
% Exchange-correlation classes should define the following member properties 
% (with the specified attributes)
%% 
% * DFT: with recommended attributes |Transient,Hidden,GetAccess=?QMol_suite,SetAccess={?QMol_DFT_###,?QMol_DFT}|, 
% where |QMol_DFT_###| is the name of the exchange-correlation class being implemented, 
% and at minimum such that |QMol_DFT| can edit the value of |DFT|. This feature 
% is used by <./QMol_DFT_profiler.html |QMol_DFT_profiler|> to estimate the memory 
% footprint of DFT models without allocating its components.
% * |type|: as a |constant| character array with public access. This is used 
% by <./TDDFT.html TDDFT propagators> to check that the DFT functionals used in 
% the model are supported. Possible values are |'GGA_C'| (for GGA exchange), |'GGA_X'| 
% (for GGA exchange), |'GGA_XC'| (for GGA exchange correlation), |'LDA_C'| (for 
% LDA exchange), |'LDA_X'| (for LDA exchange), |'LDA_XC'| (for LDA exchange correlation), 
% |'XX'| (for exact exchange).
% Run-time documentation
% Implement run-time documentation with the follwing interface

methods (Access=public)
function ref = showDocumentation(obj)
%showDocumentation displays the documentation reflecting member property 
%   values
    
    % Add run-time documentation

end
end
%% 
% Each exchange-correlation functional class must implement a run-time documentation 
% as it is automatically called by <./QMol_DFT.html |QMol_DFT|> in its own run-time 
% documentation.
%% 
% * If no reference is cited, return |ref = {}| otherwise |ref = {'ref 1','ref 
% 2',___}|, where each of the |ref| corresponds to the bibliographic code for 
% the reference (generally of the form |'name_of_first_author publication_year'|) 
% and is case insensitive REPLACE_WITH_DASH_DASH see the <./Documentation.html documentation page> 
% for a list of citable references.
%% 
% Additionally, exchange-correlation functional class should implement an estimator 
% of its memory footprint with the following interface

methods (Access=public)
function mem = getMemoryProfile(obj,opt)
%getMemoryProfile computes and returns an estimate of the total memory
%   footprint (in bytes) of the DFT object with all its components
%   initialized and used.
    
    % Add memory footprint estimate

end
end
%% 
% * |getMemoryProfile| must be able to return the memory footprint estimate 
% even if the object has not been initialized. To do so, it can rely on its internal 
% copy of the parent |DFT| object, that is properly assigned by <./QMol_DFT_profiler.html 
% |QMol_DFT_profiler|> before calling  |getMemoryProfile|.
% * Only properties with large memory footprint REPLACE_WITH_DASH_DASH _e.g._, the discretization 
% of internal properties on the domain discretization grid REPLACE_WITH_DASH_DASH need to be listed. 
% Other small properties (scalar, object handle, flags, etc.) can be ignored; 
% if the class only uses such small properties, it may return |mem = 0|.
% * Use the <./QMol_DFT_profiler.html |QMol_DFT_profiler|>|.getMemoryFootprint(N,'real')| 
% and <./QMol_DFT_profiler.html |QMol_DFT_profiler|>|.getMemoryFootprint(N,'imag')| 
% methods to convert the size (number of elements N) of the memory components 
% to the number of bytes they take in memory.
% * |opt = false| requests the memory footprint with no details printed out.
% * |opt = true| should additionally display the details of the memory estimate. 
% Use <./QMol_DFT_profiler.html |QMol_DFT_profiler|>|.showMemoryFootprint(msg,mem,lvl)| 
% to do this, with msg (character array) the description of the component, |mem| 
% the estimated number of bytes associated with it, and |lvl| the indentation 
% level (optional, |lvl = 1| and |lvl = 2| are the only two levels supported).
% Class initialization
% Initialize the class with the following interface

methods (Access=public)
function initialize(obj,DFT,SIC)
%initialize initializes the object
    
    % Initialize the functional object

end
end
%% 
% * the input |DFT| is a <./QMol_DFT.html |QMol_DFT|> object containing the 
% DFT model associated with the exchange-correlation functional object to be initialized. 
% For run-time considerations it is often practical to keep a local copy of |DFT| 
% in the object in the DFT member method.
% * The input |SIC| specifies the flavor of SIC to be used with the exchange-correlation 
% functional. |'none'| notify to disable SIC while |'ADSIC'| specifies the ADSIC 
% method [Legrand 2002].
% * Both |DFT| and |SIC| information are systematically passed along by the 
% parent DFT model object when it initializes its exchange-correlation functional 
% components.
% Exchange-correlation functional kernel
% Implicit functionals may require specific initialization of the exchange-correlation 
% functional object before they can compute the energy, potential, or potential 
% gradient. This is done with

methods (Access=public)
function setPotentialKernel(obj)
%setPotentialKernel sets the kernel to be used for the computation of 
%   exact-exchange potentials

    % Proper initialization
end
end
%% 
% This typically involves storing a local copy of the Kohn-Sham orbitals of 
% the parent DFT model. If no kernel initialization is required, include the following 
% block in the class definition

methods (Access=public)
function setPotentialKernel(~)
%setPotentialKernel no kernel to set
    
end
end
% Exchange-correlation energy
% Compute and return the exchange-correlation energy with

methods (Access=public)
function E = getEnergy(obj,rho)
%getEnergy returns the exchange-correlation energy
    
    % Exchange-correlation energy computation
end
end
%% 
% The |getEnergy| method should support the following computation modes REPLACE_WITH_DASH_DASH see 
% one of the available exchange-correlation functional documentation page for 
% more details.
% 
% Get the exchange-correlation energy for the parent DFT object

E = obj.getEnergy;
%% 
% * This computes the exchange energy associated with the Kohn-Sham orbitals 
% in the parent DFT model. To do so, it should first compute the one-body density 
% associated with the Kohn-Sham orbitals and their occupation parameters.
% * This should be equivalent to, but more efficient than, |obj.getEnergy(DFT.getDensity)|.
%% 
% Get the exchange-correlation energy for a specific one-body density

E = obj.getEnergy(rho);
%% 
% * Same as above but with using the input <./QMol_DFT_density.html one-body-density 
% object> |rho| in the numerical computation of the energy.
% * |rho| should be a |QMol_DFT_density| object defined over the same <./QMol_disc.html 
% domain discretization> as the parent DFT model.
% Exchange-correlation potential
% Compute and return the exchange-correlation potential with

methods (Access=public)
function E = getPotential(obj,rho)
%getPotential returns the exchange-correlation potential
    
    % Exchange-correlation potential computation
end
end
%% 
% The |getPotential| method should support the following computation modes REPLACE_WITH_DASH_DASH 
% see one of the available exchange-correlation functional documentation page 
% for more details.
% 
% Get the exchange-correlation potential for the parent DFT object with either

V = obj.getPotential;
V = obj.getPotential([]);
%% 
% * This computes the exchange-correlation potential associated with the Kohn-Sham 
% orbitals in the parent DFT model. To do so, it should first compute the one-body 
% density $\rho$ associated with the Kohn-Sham orbitals and their occupation parameters.
% * The output Kohn-Sham potential object contains the numerical evaluation 
% of the exchange-correlation potential. 
% * For implicit exchange-correlation functionals, it provides the proper function 
% handle to the Kohn-Sham potential class.
% * This creates a new Kohn-Sham potential object |V| in which the exchange-correlation 
% potential is stored.
% * Note that |getPotential| should not |initialize| the output potential object 
% |V|.
%% 
% Get the exchange-correlation potential for a specific one-body density

V = obj.getPotential(rho);
%% 
% * Same as above but with using the input <./QMol_DFT_density.html one-body-density 
% object> |rho| in the numerical computation of the potential.
% * |rho| should be a |QMol_DFT_density| object defined over the same <./QMol_disc.html 
% domain discretization> as the parent DFT model.
%% 
% Overwrite the exchange-correlation potential in an existing Kohn-Sham potential 
% object with any of

obj.getPotential([],V);         % use parent DFT density
obj.getPotential([],V,false);
obj.getPotential(rho,V);        % supply the density
obj.getPotential(rho,V,false);
%% 
% * This is similar to above without creating a new Kohn-Sham potential object.
% * Any content in the input object |V| is erased before assigning the external 
% potential to it.
%% 
% Add the exchange-correlation potential to an existing Kohn-Sham potential 
% object

obj.getPotential([],V,true);    % use parent DFT density
obj.getPotential(rho,V,true);   % supply the density
%% 
% * This is formally equivalent to the in-place addition $\mathcal{V}\leftarrow\mathcal{V}+\mathcal{V}_{\rm 
% XC}$.
% Exchange-correlation potential gradient
% Compute and return the exchange-correlation potential gradient with

methods (Access=public)
function E = getPotentialDerivative(obj,rho)
%getPotentialDerivative returns the exchange-correlation potential
%   gradient
    
    % Exchange-correlation potential computation
end
end
%% 
% The |getPotentialDerivative| method should support the following computation 
% modes REPLACE_WITH_DASH_DASH see one of the available exchange-correlation functional documentation 
% page for more details.
% 
% Get the exchange-correlation potential gradient for the parent DFT object  
% with either

DV = obj.getPotentialDerivative(dim);
DV = obj.getPotentialDerivative(dim,[]);
%% 
% * This computes the exchange-correlation potential gradient, along the dimension 
% dim (|1| for |x|, |2| for |y|, and |3| for |z|), associated with the Kohn-Sham 
% orbitals in the parent DFT model. To do so, it should first compute the one-body 
% density $\rho$ associated with the Kohn-Sham orbitals and their occupation parameters.
% * The output Kohn-Sham potential gradient object contains the numerical evaluation 
% of the exchange-correlation potential gradient.
% * For implicit exchange-correlation functionals, it provides the proper function 
% handle to the Kohn-Sham potential gradient class.
% * This creates a new Kohn-Sham potential gradient object |DV| in which the 
% exchange potential gradient is stored.
% * Note that |getPotentialDerivative| does not |initialize| the output potential 
% gradient object |DV|.
%% 
% Get the exchange-correlation potential for a specific one-body density

V = obj.getPotentialDerivative(1,rho);
%% 
% * Same as above but with using the input <./QMol_DFT_density.html one-body-density 
% object> |rho| in the numerical computation of the potential gradient.
% * |rho| should be a |QMol_DFT_density| object defined over the same <./QMol_disc.html 
% domain discretization> as the parent DFT model.
%% 
% Overwrite the exchange-correlation potential gradient in an existing Kohn-Sham 
% potential gradient object with any of

obj.getPotentialDerivative(1,[],DV);        % use parent DFT density
obj.getPotentialDerivative(1,[],DV,false);
obj.getPotentialDerivative(1,rho,DV);       % supply the density
obj.getPotentialDerivative(1,rho,DV,false);
%% 
% * This is similar to above without creating a new Kohn-Sham potential gradient 
% object.
% * Any content in the input object |DV| is ereased before assigning the exchange-correlation 
% potential gradient to it.
%% 
% Add the exchange-correlation potential gradient to an existing Kohn-Sham potential 
% gradient object with either

obj.getPotentialDerivative(1,[],DV,true);   % use parent DFT density
obj.getPotentialDerivative(1,rho,DV,true);  % supply the density
%% 
% * This is formally equivalent to the in-place addition $\nabla\mathcal{V}\leftarrow\nabla\mathcal{V}+\nabla\mathcal{V}_{\rm 
% XC}$.
%% References
% [Kohn 1965] W. Kohn and L.J. Sham, "Self-Consistent Equations Including Exchange 
% and Correlation Effects," Physical Review 140, A1133 (1965).
% 
% [Legrand 2002] C. Legrand, E. Suraud, and P.-G. Reinhard, "Comparison of self-interaction-corrections 
% for metal clusters," Journal of Physics B: Atomic, Molecular and Optical Physics 
% 35, 1115 (2002).
##### SOURCE END #####
-->
</div></body></html>