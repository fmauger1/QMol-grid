<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2024a"><title>Ground-state density-functional theory (DFT)</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: center;  }
.S3 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S4 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.S5 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S6 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.S7 { margin: 10px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 15px; font-weight: 700; text-align: left;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block }
.S8 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0.666667px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S9 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S10 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0.666667px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S11 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S12 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0.666667px solid rgb(217, 217, 217); border-bottom: 0.666667px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span>Ground-state density-functional theory (DFT)</span></h1><div  class = 'S1'><span>The QMol-grid package uses the Kohn-Sham formulation of density functional theory (DFT) [</span><a href = "#M_9C827223"><span>Kohn 1965</span></a><span>], where the electronic structure of a polyelectronic atom or molecule is described, in atomic units, by the nonlinear system eigen-state problem</span></div><div  class = 'S2' id = 'M_B74423F2' ><span texencoding="\hat{\mathcal{H}}_{\rm DFT}\left[\{\phi_k\}_k\right]\  \phi_k({\bf x}) = E_k\ \phi_k({\bf x})
\quad {\rm for}\quad k=1,\ 2,\ \ldots
\quad\quad\quad (1)" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="384.5" height="24.5" alt="Self-consistent field DFT equation" /></span></div><div  class = 'S1'><span>often referred to as the self-consistent field (SCF) equation. Formally, the DFT Hamiltonian operator </span><span texencoding="\hat{\mathcal{H}}_{\rm DFT}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="38" height="24.5" /></span><span> is only functionally dependent on the one-body density </span><span style="font-family: STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">ρ</span><span> but some DFT functionals still involve the Kohn-Sham orbitals in their definition. Traditionally, the DFT Hamiltonian is decomposed between the kinetic, external, Hartree, and exchange-correlation operators, each associated with an energy functional</span></div><div  class = 'S2' id = 'M_91A5C882' ><span texencoding="\hat{\mathcal{H}}_{\rm DFT} = -\frac{\Delta}{2} + \hat{\mathcal{V}}_{\rm ext} + \hat{\mathcal{V}}_{\rm H} + \hat{\mathcal{V}}_{\rm XC}.
\quad\quad\quad (2)" style="vertical-align:-15px"><img src="data:image/png;base64,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" width="273.5" height="35.5" alt="DFT Hamiltonian components" /></span></div><div  class = 'S1'><span>The QMol-grid package provides support both for spin-polarized, where the up- and down-spin electronic components may be different, and spin-polarized, where they are forced to be identical DFT models. </span></div><ul  class = 'S3'><li  class = 'S4'><a href = "./QMol_DFT_spinPol.html"><span style=' font-family: monospace;'>QMol_DFT_spinPol</span></a><span> specifically describes spin polarized DFT systems.</span></li><li  class = 'S4'><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span> specifically describes spin restricted DFT systems.</span></li></ul><div  class = 'S1'><span>The two classes share very similar interfaces to provide a consistent end-user experience -- see their respective documentation pages for a detailed desciption of the classes and features they support.</span></div><h2  class = 'S5'><span>DFT components</span></h2><div  class = 'S1'><span>For clarity and streamlined future development of DFT capabilities in the QMol-grid package, we sort DFT component (classes) into different topical groups. Each component is equally compatible with both spin-polarized and -restricted DFT models</span></div><h3  class = 'S6'><span>Model discretization</span></h3><div  class = 'S1'><span>The following classes are used to discretize DFT systems</span></div><ul  class = 'S3'><li  class = 'S4'><a href = "./QMol_DFT_density.html"><span style=' font-family: monospace;'>QMol_DFT_density</span></a><span> is the Cartesian-grid discretization of a one-body density. It also provides support for the computation of density gradient.</span></li><li  class = 'S4'><a href = "./QMol_DFT_orbital.html"><span style=' font-family: monospace;'>QMol_DFT_orbital</span></a><span> is the Cartesian-grid discretization of the Kohn-Sham orbitals.  </span></li><li  class = 'S4'><a href = "./QMol_DFT_Vks.html"><span style=' font-family: monospace;'>QMol_DFT_Vks</span></a><span> is the Cartesian-grid discretization of the explicit part of the Kohn-Sham potential. Implicit components are also supported and provide an interface for the computation of the action of the potential operator on arbitrary wave functions.</span></li><li  class = 'S4'><a href = "./QMol_DFT_Vks_grad.html"><span style=' font-family: monospace;'>QMol_DFT_Vks_grad</span></a><span> is the Cartesian-grid discretization of the explicit part of the Kohn-Sham potential gradient. Similar to the Kohn-Sham potential, it also handles implicit components and the computation of the action of the potential gradient operator on arbitrary wave functions.</span></li></ul><div  class = 'S1'><span>For basis-set discretization models, with </span><a href = "./QMol_disc_basis.html"><span style=' font-family: monospace;'>QMol_disc_basis</span></a><span>, some of the classes above are redefined (overloaded)</span></div><ul  class = 'S3'><li  class = 'S4'><a href = "./QMol_DFT_orbital_basis.html"><span style=' font-family: monospace;'>QMol_DFT_orbital_basis</span></a><span> for Kohn-Sham orbitals.</span></li><li  class = 'S4'><a href = "./QMol_DFT_Vks_basis.html"><span style=' font-family: monospace;'>QMol_DFT_Vks_basis</span></a><span> for the Kohn-Sham potential.</span></li></ul><h3  class = 'S6'><span>Model components</span></h3><div  class = 'S1'><span>The following functionals are currently available for DFT models and simulations in the QMol-grid package</span></div><ul  class = 'S3'><li  class = 'S4'><a href = "./QMol_DFT_Vext.html"><span style=' font-family: monospace;'>QMol_DFT_Vext</span></a><span> describes the external functional and potential </span><span texencoding="\hat{\mathcal{V}}_{\rm ext}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="29.5" height="24.5" /></span><span> of Eq. (</span><a href = "#M_91A5C882"><span>2</span></a><span>).</span></li><li  class = 'S4'><a href = "./QMol_DFT_Vh_conv.html"><span style=' font-family: monospace;'>QMol_DFT_Vh_conv</span></a><span> describes the Hartree functional and potential </span><span texencoding="\hat{\mathcal{V}}_{\rm H}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="24.5" height="24.5" /></span><span> of Eq. (</span><a href = "#M_91A5C882"><span>2</span></a><span>), using an explicit-convolution scheme.</span></li><li  class = 'S4'><a href = "./QMol_DFT_Vh_fft.html"><span style=' font-family: monospace;'>QMol_DFT_Vh_fft</span></a><span> describes the Hartree functional and potential </span><span texencoding="\hat{\mathcal{V}}_{\rm H}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="24.5" height="24.5" /></span><span> of Eq. (</span><a href = "#M_91A5C882"><span>2</span></a><span>), using a fast-Fourier-transform convolution scheme.</span></li><li  class = 'S4'><a href = "./QMol_DFT_Vx_LDA_exp.html"><span style=' font-family: monospace;'>QMol_DFT_Vx_LDA_exp</span></a><span> describes local-density-approximation Slater exchange </span><span texencoding="\hat{\mathcal{V}}_{\rm XC}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="31" height="24.5" /></span><span> of Eq. (</span><a href = "#M_91A5C882"><span>2</span></a><span>), for exponential electron-electron interaction potentials.</span></li><li  class = 'S4'><a href = "./QMol_DFT_Vx_LDA_soft.html"><span style=' font-family: monospace;'>QMol_DFT_Vx_LDA_soft</span></a><span> describes local-density-approximation Slater exchange </span><span texencoding="\hat{\mathcal{V}}_{\rm XC}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="31" height="24.5" /></span><span> of Eq. (</span><a href = "#M_91A5C882"><span>2</span></a><span>), for soft-Coulomb electron-electron interaction potentials.</span></li><li  class = 'S4'><a href = "./QMol_DFT_Vx_XX_conv.html"><span style=' font-family: monospace;'>QMol_DFT_Vx_XX_conv</span></a><span> describes the exact-exchange functional and potential of Eq. (</span><a href = "#M_91A5C882"><span>2</span></a><span>), using an explicit-convolution scheme.</span></li><li  class = 'S4'><a href = "./QMol_DFT_Vx_XX_fft.html"><span style=' font-family: monospace;'>QMol_DFT_Vx_XX_fft</span></a><span> describes the exact-exchange functional and potential of Eq. (</span><a href = "#M_91A5C882"><span>2</span></a><span>), using a fast-Fourier-transform convolution scheme.</span></li><li  class = 'S4'><a href = "./QMol_DFT_Vc_LDA_soft.html"><span style=' font-family: monospace;'>QMol_DFT_Vc_LDA_soft</span></a><span> describes local-density-approximation correlation </span><span texencoding="\hat{\mathcal{V}}_{\rm XC}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="31" height="24.5" /></span><span> of Eq. (</span><a href = "#M_91A5C882"><span>2</span></a><span>), for soft-Coulomb electron-electron interaction potentials.</span></li></ul><div  class = 'S1'><span>All DFT functionals can be used both for regular grid-based and basis-set deiscretization models, using the same end-user interfaces.</span></div><h3  class = 'S6'><span>Memory and execution-time profiler</span></h3><div  class = 'S1'><span>The choice of the domain discretization and DFT components can greatly affect the resources, both in terms of memory and execution time, required to carry out simulations.</span></div><ul  class = 'S3'><li  class = 'S4'><a href = "./QMol_DFT_profiler.html"><span style=' font-family: monospace;'>QMol_DFT_profiler</span></a><span> provides estimates of the memory and run-time requirements for a given DFT model or components.</span></li></ul><div  class = 'S1'><span>Keep in mind that differentiation and (some) convolutions are performed via fast-Fourier transforms. Thus, as a rule of thumb, domain discretization with small prime factor number of grid points tend to produce faster results -- for best performance, prime factors not greater than 7.</span></div><h3  class = 'S6'><span>Ground-state computation</span></h3><div  class = 'S1'><span>The DFT ground state, or more generally some DFT eigen state, is computed by numerically solving the SCF problem of Eq. (</span><a href = "#M_B74423F2"><span>1</span></a><span>). In the QMol-grid package, this can be achieved with</span></div><ul  class = 'S3'><li  class = 'S4'><a href = "./QMol_DFT_SCF_Anderson.html"><span style=' font-family: monospace;'>QMol_DFT_SCF_Anderson</span></a><span> performs SCF iterations for DFT ground/eigen-state calculations using an Anderson's mixing scheme.</span></li><li  class = 'S4'><a href = "./QMol_DFT_eigs.html"><span style=' font-family: monospace;'>QMol_DFT_eigs</span></a><span> is a linear eigen solver, to be used in combination with SCF iterations.</span></li><li  class = 'S4'><a href = "./QMol_DFT_eig_basis.html"><span style=' font-family: monospace;'>QMol_DFT_eig_basis</span></a><span> is a linear eigen solver for basis-set DFT models, to be used in combination with SCF iterations.</span></li></ul><h2  class = 'S5'><span>Self-interaction correction (SIC)</span></h2><div  class = 'S1'><span>Various approaches have been proposed to provide self-interaction correction to the DFT Eq. (</span><a href = "#M_B74423F2"><span>1</span></a><span>). Currently, the QMol-grid package supports:</span></div><h3  class = 'S6'><span>No self-interaction correction</span></h3><div  class = 'S1'><span>In this case, self-interaction is ignored and no SIC is provided. This is the default options for all DFT models in the QMol-grid package.</span></div><h3  class = 'S6'><span>Average-density self-interaction correction (ADSIC)</span></h3><div  class = 'S1'><span>ADSIC implements an average-density level of SIC [</span><a href = "#M_73E1880A"><span>Legrand 2002</span></a><span>] that is easy to implement in the general DFT framework of Eq. (</span><a href = "#M_B74423F2"><span>1</span></a><span>). Unless otherwise specified, all Hartree and exchange-correlation DFT functionals in the QMol-grid package support ADSIC.</span></div><h2  class = 'S5'><span>Notes for developers</span></h2><h3  class = 'S6'><span>DFT model implementation</span></h3><div  class = 'S1'><span>The </span><a href = "./QMol_DFT.html"><span style=' font-family: monospace;'>QMol_DFT</span></a><span> abstract class defines the common interface and run-time documentation for both spin-polarized (</span><a href = "./QMol_DFT_spinPol.html"><span style=' font-family: monospace;'>QMol_DFT_spinPol</span></a><span>) and spin-restricted (</span><a href = "./QMol_DFT_spinRes.html"><span style=' font-family: monospace;'>QMol_DFT_spinRes</span></a><span>) DFT models.</span></div><div  class = 'S1'><span>Many DFT components and methods require convergence tolerance or thresholds in their implementation. Throughout, we parameterize these through class properties (generally named </span><span style=' font-family: monospace;'>tol</span><span>). The default configuration of the QMol-grid package roughly aims for </span><span texencoding="10^{-10}" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEcAAAAoCAYAAACsEueQAAAAAXNSR0IArs4c6QAABSdJREFUaEPtmWtoHFUUx/9nMruaxDdqJMbMndk1YHxgEa0ffAS1JaWh9VW1ERUf7YdooUUkVpR+8IGgiIIVtDZUxT6sVHxWUCEWK4jgA+mWxNnZmXWNgqKBFaOZ3Tlyw46MY7I7yU6UJjvflrn37D2/+Z/XDKFxzUiAGmxmJtCAU0UdDTgNOHNLHg3lLBblpNPpozzPu5aZ+xOJxO2jo6M/h31va2trbW1t3cDMVwH4EsCFAIY0Tds5PDxcCq5fEMqRUMrl8nIi2sTMlwD4IpFI9IXhdHd3HzMxMbEVgOZ53lrHcX5Ip9Nnl8vlfUS0u7Oz8+EgoAUBp6enRy0WizQ+Pn6i53nvAihPB8cwjAFm3srMa23b3l1RCem6/gCAQSK6xrKsj3z1LAg4vjNdXV0nu677jvwdhtPR0XGSqqp7iejMpqamFaZpHvL3GYZxJTN/CGBbc3PzPZlMZlLeWzRwNE1boijK+wByYXCapp2lKMp+AL+6rttXKBS+X1RwDMNYycxSVW8mk8lbRkZGir5yOjo6Tk8kEvJeu+d5vY7jyEQdWTmKEOIyItroed5mx3EO1+ocdF1vA7COmZcQUQ7Aucx8yPO8Z/P5vFVr/1zuVwsrwzDuYObtzLxzcnJy3djY2O/ThONSZu6xbfvjKHCmoAB4iIiuAOB4nreiBhyZ4PoAvADgFdd1txQKhQmZNG3bvpeIBpl5wLbtPQB4LhBm2vOfwdF1/Tz55AHkAVwP4KIocIQQlxPRGwBsRVFWZ7PZ7wKJ73gAO5hZrlkTrAyGYTzOzINRYQWfcJSEXC2sUqnUqZUq1xkprLq7u5N+1tZ1XUKSSqiqHFkREonELgDLATyYy+UeC6tDCHETEck1B5j5Rtu2f5TOpVKpc5j5tKhwFEX52jTNn4Lrqyln3hKyH6+14AgheonoLXlgZl7mx27QgUBl0EL9RlQuM66rBkcIcQIRvQagK5wa/FLOzEOqqg6YpvlnlJwzdZAocGROcRznKQAbABz2PG+l4zgyEf/jChxy2XTJsR5C1eBU/KjWBG5h5lW2bctyP3VF6nOiwAk6DeCg67qrCoXCL2Fn29vbW5LJ5DYi6gfwVbCvqAdMJTT93DFth1wJ+5cAHBseHwC8rWna/bMeH6LAMQxDyvU9IkrVUkQg+RYr4fdZPWDkbFUqlS4mopsrRcQF8AQR7VcU5XM/TOR/pNPp40ql0iYiutQfPJl5h6qqu4LrYlVOZYCTXeYZs4Ajc9PffUU9gOZjb5xhJcvzcCUZ/6vRCh4+WLaJ6E7Lsobmw7l6bcYJZykRfSDjeTbKAbAml8u9Xq8j87E/NjihEh1ZOYsirALD2/mzUI4rxxLLsj6Zjydfr83YlBO1lAshjiai5wHcWq0fqtexOPbHBkf2TEKIR4lo8yyawH0tLS23ZTKZ3+JwJm4bccJBYHz4Y6b+JdgPEdHdlmU9F7dTcdmLFY5hGP7UfTUzb7Rt+5nwQXVdlxP+XvluR1XV1aZpZuNyJm47scKRhwu8svgmOHVXZhsf3koAd+VyuZfjdihOezXhVAZKqYABAEVFUXqz2eynVQ4hc88NRPQ0gBebmpoekW25tJPP59czs3xvc58QYnv4O1GcjsVha0Y46XT6lFKp1E9E1wGQc4h/mUT0KhEdIKKD4XnEXySEEADWE9EFAL6V34oAjBHRk5ZlmXG/BYwDRthGTeXMx58eKTYbcKrlhyPlKf4f52wop6GcuemuoZyGchrKmRuBKrv+Ao/I7VarBdDxAAAAAElFTkSuQmCC" width="35.5" height="20" /></span><span> as the target tolerance/threshold. Changing the values for the </span><span style=' font-family: monospace;'>tol</span><span> parameters may have unintended side effects -- see the respective documentation pages for more details on these tolerance/threshold parameters.</span></div><h3  class = 'S6'><span>Exchange-correlation functionals</span></h3><div  class = 'S1'><span>To be compatible with other DFT components of the QMol-grid package, exchange-correlation functionals must fulfill the following requirements:</span></div><h4  class = 'S7'><span>Class definition</span></h4><div  class = 'S1'><span>Define exchange-correlation classes by overloading the </span><a href = "./QMol_suite.html"><span style=' font-family: monospace;'>QMol_suite</span></a><span> class. This will facilitate name-value pair assignment for property values in the constructor, </span><span style=' font-family: monospace;'>set</span><span>, and </span><span style=' font-family: monospace;'>clear</span><span> methods -- see the </span><a href = "./QMol_suite.html"><span style=' font-family: monospace;'>QMol_suite</span></a><span> documentation page for more details.</span></div><h4  class = 'S7'><span>Class properties</span></h4><div  class = 'S1'><span>Exchange-correlation classes should define the following member properties (with the specified attributes)</span></div><ul  class = 'S3' id = 'M_D741D66D' ><li  class = 'S4'><span>DFT: with recommended attributes </span><span style=' font-family: monospace;'>Transient,Hidden,GetAccess=?QMol_suite,SetAccess={?QMol_DFT_###,?QMol_DFT}</span><span>, where </span><span style=' font-family: monospace;'>QMol_DFT_###</span><span> is the name of the exchange-correlation class being implemented, and at minimum such that </span><span style=' font-family: monospace;'>QMol_DFT</span><span> can edit the value of </span><span style=' font-family: monospace;'>DFT</span><span>. This feature is used by </span><a href = "./QMol_DFT_profiler.html"><span style=' font-family: monospace;'>QMol_DFT_profiler</span></a><span> to estimate the memory footprint of DFT models without allocating its components.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>type</span><span>: as a </span><span style=' font-family: monospace;'>constant</span><span> character array with public access. This is used by </span><a href = "./TDDFT.html"><span>TDDFT propagators</span></a><span> to check that the DFT functionals used in the model are supported. Possible values are </span><span style=' font-family: monospace;'>'GGA_C'</span><span> (for GGA exchange), </span><span style=' font-family: monospace;'>'GGA_X'</span><span> (for GGA exchange), </span><span style=' font-family: monospace;'>'GGA_XC'</span><span> (for GGA exchange correlation), </span><span style=' font-family: monospace;'>'LDA_C'</span><span> (for LDA exchange), </span><span style=' font-family: monospace;'>'LDA_X'</span><span> (for LDA exchange), </span><span style=' font-family: monospace;'>'LDA_XC'</span><span> (for LDA exchange correlation), </span><span style=' font-family: monospace;'>'XX'</span><span> (for exact exchange).</span></li></ul><h4  class = 'S7'><span>Run-time documentation</span></h4><div  class = 'S1'><span>Implement run-time documentation with the follwing interface</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >methods (Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >ref = showDocumentation(obj)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%showDocumentation displays the documentation reflecting member property </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%   values</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Add run-time documentation</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><div  class = 'S11'><span>Each exchange-correlation functional class </span><span style=' text-decoration: underline;'>must</span><span> implement a run-time documentation as it is automatically called by </span><a href = "./QMol_DFT.html"><span style=' font-family: monospace;'>QMol_DFT</span></a><span> in its own run-time documentation.</span></div><ul  class = 'S3'><li  class = 'S4'><span>If no reference is cited, return </span><span style=' font-family: monospace;'>ref = {}</span><span> otherwise </span><span style=' font-family: monospace;'>ref = {'ref 1','ref 2',___}</span><span>, where each of the </span><span style=' font-family: monospace;'>ref</span><span> corresponds to the bibliographic code for the reference (generally of the form </span><span style=' font-family: monospace;'>'name_of_first_author publication_year'</span><span>) and is case insensitive -- see the </span><a href = "./Documentation.html"><span>documentation page</span></a><span> for a list of citable references.</span></li></ul><div  class = 'S1'><span>Additionally, exchange-correlation functional class </span><span style=' text-decoration: underline;'>should</span><span> implement an estimator of its memory footprint with the following interface</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >methods (Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >mem = getMemoryProfile(obj,opt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%getMemoryProfile computes and returns an estimate of the total memory</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%   footprint (in bytes) of the DFT object with all its components</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%   initialized and used.</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Add memory footprint estimate</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span style=' font-family: monospace;'>getMemoryProfile</span><span> must be able to return the memory footprint estimate even if the object has not been initialized. To do so, it can rely on its internal copy of the parent </span><span style=' font-family: monospace;'>DFT</span><span> object, that is properly assigned by </span><a href = "./QMol_DFT_profiler.html"><span style=' font-family: monospace;'>QMol_DFT_profiler</span></a><span> before calling  </span><span style=' font-family: monospace;'>getMemoryProfile</span><span>.</span></li><li  class = 'S4'><span>Only properties with large memory footprint -- </span><span style=' font-style: italic;'>e.g.</span><span>, the discretization of internal properties on the domain discretization grid -- need to be listed. Other small properties (scalar, object handle, flags, etc.) can be ignored; if the class only uses such small properties, it may return </span><span style=' font-family: monospace;'>mem = 0</span><span>.</span></li><li  class = 'S4'><span>Use the </span><a href = "./QMol_DFT_profiler.html"><span style=' font-family: monospace;'>QMol_DFT_profiler</span></a><span style=' font-family: monospace;'>.getMemoryFootprint(N,'real')</span><span> and </span><a href = "./QMol_DFT_profiler.html"><span style=' font-family: monospace;'>QMol_DFT_profiler</span></a><span style=' font-family: monospace;'>.getMemoryFootprint(N,'imag')</span><span> methods to convert the size (number of elements N) of the memory components to the number of bytes they take in memory.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>opt = false</span><span> requests the memory footprint with no details printed out.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>opt = true</span><span> should additionally display the details of the memory estimate. Use </span><a href = "./QMol_DFT_profiler.html"><span style=' font-family: monospace;'>QMol_DFT_profiler</span></a><span style=' font-family: monospace;'>.showMemoryFootprint(msg,mem,lvl)</span><span> to do this, with msg (character array) the description of the component, </span><span style=' font-family: monospace;'>mem</span><span> the estimated number of bytes associated with it, and </span><span style=' font-family: monospace;'>lvl</span><span> the indentation level (optional, </span><span style=' font-family: monospace;'>lvl = 1</span><span> and </span><span style=' font-family: monospace;'>lvl = 2</span><span> are the only two levels supported).</span></li></ul><h4  class = 'S7'><span>Class initialization</span></h4><div  class = 'S1'><span>Initialize the class with the following interface</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >methods (Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >initialize(obj,DFT,SIC)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%initialize initializes the object</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Initialize the functional object</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>the input </span><span style=' font-family: monospace;'>DFT</span><span> is a </span><a href = "./QMol_DFT.html"><span style=' font-family: monospace;'>QMol_DFT</span></a><span> object containing the DFT model associated with the exchange-correlation functional object to be initialized. For run-time considerations it is often practical to keep a local copy of </span><span style=' font-family: monospace;'>DFT</span><span> in the object in the </span><a href = "#M_D741D66D"><span>DFT</span></a><span> member method.</span></li><li  class = 'S4'><span>The input </span><span style=' font-family: monospace;'>SIC</span><span> specifies the flavor of SIC to be used with the exchange-correlation functional. </span><span style=' font-family: monospace;'>'none'</span><span> notify to disable SIC while </span><span style=' font-family: monospace;'>'ADSIC'</span><span> specifies the ADSIC method [</span><a href = "#M_73E1880A"><span>Legrand 2002</span></a><span>].</span></li><li  class = 'S4'><span>Both </span><span style=' font-family: monospace;'>DFT</span><span> and </span><span style=' font-family: monospace;'>SIC</span><span> information are systematically passed along by the parent DFT model object when it initializes its exchange-correlation functional components.</span></li></ul><h4  class = 'S7'><span>Exchange-correlation functional kernel</span></h4><div  class = 'S1'><span>Implicit functionals may require specific initialization of the exchange-correlation functional object before they can compute the </span><a href = "#H_0E834206"><span>energy</span></a><span>, </span><a href = "#H_4E4742A9"><span>potential</span></a><span>, or </span><a href = "#H_35E6324E"><span>potential gradient</span></a><span>. This is done with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >methods (Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >setPotentialKernel(obj)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%setPotentialKernel sets the kernel to be used for the computation of </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%   exact-exchange potentials</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Proper initialization</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><div  class = 'S11'><span>This typically involves storing a local copy of the Kohn-Sham orbitals of the parent DFT model. If no kernel initialization is required, include the following block in the class definition</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >methods (Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >setPotentialKernel(~)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%setPotentialKernel no kernel to set</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><h4  class = 'S7' id = 'H_0E834206' ><span>Exchange-correlation energy</span></h4><div  class = 'S1'><span>Compute and return the exchange-correlation energy with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >methods (Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >E = getEnergy(obj,rho)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%getEnergy returns the exchange-correlation energy</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Exchange-correlation energy computation</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><div  class = 'S11'><span>The </span><span style=' font-family: monospace;'>getEnergy</span><span> method should support the following computation modes -- see one of the available exchange-correlation functional documentation page for more details.</span></div><div  class = 'S1'><span>Get the exchange-correlation energy for the parent DFT object</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >E = obj.getEnergy;</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>This computes the exchange energy associated with the Kohn-Sham orbitals in the parent DFT model. To do so, it should first compute the one-body density associated with the Kohn-Sham orbitals and their occupation parameters.</span></li><li  class = 'S4'><span>This should be equivalent to, but more efficient than, </span><span style=' font-family: monospace;'>obj.getEnergy(DFT.getDensity)</span><span>.</span></li></ul><div  class = 'S1'><span>Get the exchange-correlation energy for a specific one-body density</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >E = obj.getEnergy(rho);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>Same as above but with using the input </span><a href = "./QMol_DFT_density.html"><span>one-body-density object</span></a><span> </span><span style=' font-family: monospace;'>rho</span><span> in the numerical computation of the energy.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>rho</span><span> should be a </span><span style=' font-family: monospace;'>QMol_DFT_density</span><span> object defined over the same </span><a href = "./QMol_disc.html"><span>domain discretization</span></a><span> as the parent DFT model.</span></li></ul><h4  class = 'S7' id = 'H_4E4742A9' ><span>Exchange-correlation potential</span></h4><div  class = 'S1'><span>Compute and return the exchange-correlation potential with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >methods (Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >E = getPotential(obj,rho)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%getPotential returns the exchange-correlation potential</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Exchange-correlation potential computation</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><div  class = 'S11'><span>The </span><span style=' font-family: monospace;'>getPotential</span><span> method should support the following computation modes -- see one of the available exchange-correlation functional documentation page for more details.</span></div><div  class = 'S1'><span>Get the exchange-correlation potential for the parent DFT object with either</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >V = obj.getPotential;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >V = obj.getPotential([]);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>This computes the exchange-correlation potential associated with the Kohn-Sham orbitals in the parent DFT model. To do so, it should first compute the one-body density </span><span style="font-family: STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">ρ</span><span> associated with the Kohn-Sham orbitals and their occupation parameters.</span></li><li  class = 'S4'><span>The output Kohn-Sham potential object contains the numerical evaluation of the exchange-correlation potential. </span></li><li  class = 'S4'><span>For implicit exchange-correlation functionals, it provides the proper function handle to the Kohn-Sham potential class.</span></li><li  class = 'S4'><span>This creates a new Kohn-Sham potential object </span><span style=' font-family: monospace;'>V</span><span> in which the exchange-correlation potential is stored.</span></li><li  class = 'S4'><span>Note that </span><span style=' font-family: monospace;'>getPotential</span><span> </span><span style=' text-decoration: underline;'>should not</span><span> </span><span style=' font-family: monospace;'>initialize</span><span> the output potential object </span><span style=' font-family: monospace;'>V</span><span>.</span></li></ul><div  class = 'S1'><span>Get the exchange-correlation potential for a specific one-body density</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >V = obj.getPotential(rho);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>Same as above but with using the input </span><a href = "./QMol_DFT_density.html"><span>one-body-density object</span></a><span> </span><span style=' font-family: monospace;'>rho</span><span> in the numerical computation of the potential.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>rho</span><span> should be a </span><span style=' font-family: monospace;'>QMol_DFT_density</span><span> object defined over the same </span><a href = "./QMol_disc.html"><span>domain discretization</span></a><span> as the parent DFT model.</span></li></ul><div  class = 'S1'><span>Overwrite the exchange-correlation potential in an existing Kohn-Sham potential object with any of</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.getPotential([],V);         </span><span style="color: #008013;">% use parent DFT density</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj.getPotential([],V,false);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj.getPotential(rho,V);        </span><span style="color: #008013;">% supply the density</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.getPotential(rho,V,false);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>This is similar to above without creating a new Kohn-Sham potential object.</span></li><li  class = 'S4'><span>Any content in the input object </span><span style=' font-family: monospace;'>V</span><span> is erased before assigning the external potential to it.</span></li></ul><div  class = 'S1'><span>Add the exchange-correlation potential to an existing Kohn-Sham potential object</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.getPotential([],V,true);    </span><span style="color: #008013;">% use parent DFT density</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.getPotential(rho,V,true);   </span><span style="color: #008013;">% supply the density</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>This is formally equivalent to the in-place addition </span><span texencoding="\mathcal{V}\leftarrow\mathcal{V}+\mathcal{V}_{\rm XC}" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMUAAAAnCAYAAAC/tIx5AAAAAXNSR0IArs4c6QAADWhJREFUeF7tXHuUVVUZ/7597h3mDpmWFgoz9zzulVZTtlbiC82clUmIrzLBCBNCxQcoZgoqIIqgaL4FW6KZD0RLI0xTo2LRItIWQatUSpp7zrkXJKGHmTKvc+7+Wh/rHNaew4W5M3PvzKV15r9ZZ5999v729/h9v+/bFyH+iyUQS6CbBDCWRyyBWALdJRAbRawRsQQiEoiNIlaJWAKxUcQ6EEtg/xKII0WsIbEE4kgR60AsgX5Eiubm5rqurq4jpZRH+L6/3bKsLWvXrvX3N+WoUaOSGzdu5DEUHTds2LChQ4cO/aqU8iAAeNZ13f8c4AeE2Wz2MN/3m3kfvu+/sW3btn/3sCfR0tIi9iFHzGQynykWi+M0TVufy+V+V0qONSAzkc1mh3uedyQitjc0NLy5efPmD3tYlxY8L5YYJ0zTPImIRkspXyoUCpsHc48l4VNjY2Oqrq5uJhHNAoCPKQt8DwDuIaJHXdd9Nxp1TNM8GREvF0Jc1dra+g/1uWVZxxLRPAAYBQDDAWCh4zj8/wH5l8lkRhWLxTsR8UvqBohoDREtNE1zXVTxs9nsR33fv1kIscG27WfU9wKZzyaiMQAwmohyQohxtm1vqSEBoWEYYxDxewBwlLIuDwB+BgC3Oo7zBgBIdc1NTU3DE4nEHYj4sG3bv1WfjRgx4tC6urpbAOCLwZzrPc87uwznUjWx7GUUzc3NH2lvb18KAIcCwBzepGVZB0kpv4GIcwCgCQA6iOh2AFjmuu7OTCZjEdF3iahF07TzWltb31JXnM1m2ftNE0IsklKyIUxCxPG2bf+6ajur4sSWZZ1KRD9AxDsAYIVt2x+YpslKwns7GwCSALBOSjmfjWPnzp31u3btOk0IwUa0Ip1O36oaTEtLSyKfz88ioo0A8D4i/hQAVqdSqelleOAq7rTb1GhZ1hR2bIh4XVdX18vZbNZzHIcd4dzQOSDiKiK6mfWmsbHxkLq6uvOllHOEEPNs235cjXysax0dHQuJ6DFEPJKIliPinVH5DNQGw+9EjQJN05xBRGM1Tft2LpfbqS6I4U9DQ8NlAHAtABweWex7pRRd1/UjhBC3sIfcunXr9oHeYKW/l8lkmqSUK4noLtd1fxyBN6jr+ueFEAsA4IwS336yhKLvVjYAQNu2f1ijcAl0XT9aCMFKPd1xnHWRvTH8+TIA8L6Pj+4bERfswxFcT0QbXNf9RaXPqT/zdTMKwzAOQUQ+6GWO4zy/r4k512hra+PDZxyoA8C3EPHB6MaHDx/eMGTIkHt5zgM1KkRlYJrmeQAwjYgm7CcnwqampiMSicSJAPA5ADgBAHRN086NRlHDME5BxEmpVOqaSkcFwzBmIeLXAeAux3Ge64+imKZ5IwAYqVRqxubNm7v2MZfQdZ332UJEGQAYBwD/lVJOzOfzf1ffMU3zQiIyDcNY1FOe2p919+XdbkYxcuTIwzzPe4mIZruu+5vohPzc933Ttu0N/EyBWkcJIc7J5XJblXfCcDtC1/XFtbbxvgiL37Esa6qU8tSurq5Ltm/f3hadxzCME6SUbxcKBc6/eDxDLVbI+Y7jLFEjQRBF7yOi+a7r/rWva9rXe5ZlLeazRMSLbNt+rD/z81z8vm3b10fnYfjnuu5JiUTi9dbW1k6OegHUWoKIE2zb/rn6TgCn53HuGUUj/Vljpd7tZhQcAdrb2/ng8o7j3KYeoIJ717PB8P+FQmEeEd1USui1vvG+CtAwjOMRcVng9XPRw/Z9/6Kurq65bDCBDFYCwLtEdL5KTgSKNAcRHcdxnuzrevb3XiWNgiMkEV3u+/74aBLMhg8Ax6bT6bvY+YWOgIheiTqPwJEyWfN0KcdbDTn0ds69Eu3gIJdLKW/M5/OM9aRlWQdLKWcDwBbXdZ8IPCAnXQ8T0bqooIIE6kEp5ePV3DgzNslkcroQYlUul2vt7eb7Ml5xBpbneTMDBRGZTGZ0sViczoQDQ4UgCjDDdAoRTXRd91n1e4ZhfIWhTWdn59WlIk5f1hZ9p5JGoaCCrZ7nLdq2bVs7y8JxnLM0TRtTX19/HcM/xRFwLjk2oJXDpXHOOpWIRhiGcVutooeSlGw6nbaEEAsZDzMPDQDMvd/tOM6v2EgYIiDiy0zXIuJ027YfUmETbxwR09VkEULlBIB0R0fH9GopVinlzGazQ3zfnwgAMxBRMFwAgBcBYKnjODv4uZTyfiK6FAD+4Pv+OSrJwBRlMplcwoxMNMeohDGEc1TSKHjOoM50pZTygkAvJCI+u2vXrmU7duzY1djY+PFkMsmOYAwRrWxoaJis5kmZTOazRLSAnUc0x6jkvvs7V6/bPNSNc+TQNG1ca2vrHhjBG5dS3ub7/mXVYptY6YrFItOA2c7OzhnvvPPOv/oriEq+b5rmeAB4OqBm56pQNIBNCxAx5zgO4/y9ipyVWkuljaKHdXEewXUWpuohGh3DSENEK2qNbYruq9dGwYkmc/TBRPfouj47DIMhbAKA5dVim7gAViwWF3GhpxSrUSmF6us8hmEcjog/CopRTEGf7jjOn8P5Atg0PpVKXV1ptqma8Kkneei6/mkhxCvMspWIjrthU7XRQ09rLPd5r4wiqEy+AADHAMB2KeVZ+Xx+U/Cxqm88wKvfBwAuGF1j2/Z91fS05QpRHWdZ1hVExMVPQMT70+n0taHTGCjYVC34tC95BCQMFzKvCcZcpTJtvYVN7PiklJzY3wAA2WDOLczSEdHv8/m8w2iBiE6SUjIbdhoAtHLtKJFIrAy7KQKI3SKlvBwRmR7ntiKuvrcxCQAAbyPi1zgv3bJlyz/3JD69OXjDMLiqvbs9gUv2QoiZAQUHQZ5xved5UytdojdNcxgRzUTE7wBAfW/WXMbYvJTy9Hw+/5cyxu53CEPLRCLxXFDdfY+Ixrmu+zq/FOQZTL+u6W/NQFF6NWr3efncidAfQiSbzWaKxSLnmCOJ6K1EInFOCKkDuP0YES0OZVHuQoNC6VNMVgDAa5qm8bx72ocCY7wfAEYIIaap9K6u6yYiPoqIJ3P7CSI+YNv2+/ztwLlz3WUaAGxKJpNn9skoGBq1tbU9gYjnAkC3Aw/5dk3TFlQjcTxQjMIwjLGIyD1AyYjT2M3bSynTlSxWRaBsubq217j+GkUkOt5g2zZHDQppZyFEIdriUe5iVVIHAC5W8rCwFjKFSQ81f1WYvxMR8dJS31ZYxMlRp1g2fMpkMidKKV8FgINUWBBMzhh/dbXyiFCAtQyfAkbqIUScGoWW3CKBiBc3NDTMqnYeEYFyFSve7UuJI9Hxj2oR17KsM6SUx/TTEeyG5QDwKNfPhBBn5nK5N4O2k2cQ8QpV74LoMR8AmIhZBQBTwggR3UMQxZZxP56KFMoyChUzRsIjd01O5o8F9YuqMSmKYdRkom2aJrdzME4djoh7vCV7LU3TbioWiwsGmoYcCPZJiY58RJNCaMgOTEp5SX19/dz+OoKAwHmEiBi+r5JScq6xVAjBhE63JkMVypVRyedoc4bneZvUSFOWUSgH/okghHEFli34Aq4T6Lp+x0AWYkJKFgCOk1JOGWhli3qciNNYo2naRMa3QRi/nVvMB+OOQLWNQoXUiPh4WC9Kp9PNmqbNYuWt1NkEVP9LAbv1ASLeW6oOFvSm7e7z6iss7NEoIuEo7HYsGoYxgTtlDcNYOpAGESrkYBbvokah0JGdYdNfJpP5ZNAmv8RxnLfLxdCVHFdtowjaObjNfVNIj5um+Skuagohbq1wX1OYQzzMVxdKVMt3i07Js/pMoPRoFIqFrtM0bToAdPLdCO7ZCRq9qg6Z9oNnU4lEYpqU8sVCoWBXUqHKnUspxl0WFKxWZ7PZZt/3J3med/dgFharaRQKpDkaAMbz/Qm+ZAYAX/A8715uAylXhmWOU40iySxeGJEjeVTIyFXHKJR+l4OJiO9R6AHF9RS3M5S5mf/rYeGFIyJivvxVRLyAiP7muu4vozfQBloQVTSKPReOAGCy7/u5RCLxTURca9s2X5SquKNULnY9ELTPjCx1T6Oq8In7XFKpFPO7XBvgvp51xWLxJ4VCwanGpgdaYSrxvUwmw8Uj5tG5/+kFRFzd1dW1pgpesk/LrZJRcC7JdzSWMRsEAGz8L+q6/lq1YDTnZoi4PEisn7AsazI3owLAh9GLbSrhQURXu67LdYxe/fUIn3o1Wzy4piRQyUtGg7WxEK0gohsm1gqCuRAA1vu+PyFkj9RmTIZYpVrde9pLbBQ9SSh+PmgSUApsJ3ieN1HtlFDZqGg7jdK+XhJihRsKfkhisaZpy9UW99goBu3I4w/3IIEwb7k7KNjxz/2ofwzjuFWDrzh40cp1YBjchXxcWNswDKOVIR7fw9E0bawQgt9f4DgOU7178qDYKGLdrDkJZDKZLBFdQkRXAQD/XtSDAPCk4zh/4sUGHn40Il6p/EBEB/c3IeIj4YWzAErxrcCLuWYR/FxTBwBsIKLn6+rqVqg9T6EgYqOoOZWIFzTYEoiNYrBPIP5+zUkgNoqaO5J4QYMtgdgoBvsE4u/XnARio6i5I4kXNNgSiI1isE8g/n7NSSA2ipo7knhBgy2B/wGlmTygU9FvkQAAAABJRU5ErkJggg==" width="98.5" height="19.5" /></span><span>.</span></li></ul><h4  class = 'S7' id = 'H_35E6324E' ><span>Exchange-correlation potential gradient</span></h4><div  class = 'S1'><span>Compute and return the exchange-correlation potential gradient with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >methods (Access=public)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >E = getPotentialDerivative(obj,rho)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%getPotentialDerivative returns the exchange-correlation potential</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #008013;">%   gradient</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Exchange-correlation potential computation</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><div  class = 'S11'><span>The </span><span style=' font-family: monospace;'>getPotentialDerivative</span><span> method should support the following computation modes -- see one of the available exchange-correlation functional documentation page for more details.</span></div><div  class = 'S1'><span>Get the exchange-correlation potential gradient for the parent DFT object  with either</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >DV = obj.getPotentialDerivative(dim);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >DV = obj.getPotentialDerivative(dim,[]);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>This computes the exchange-correlation potential gradient, along the dimension dim (</span><span style=' font-family: monospace;'>1</span><span> for </span><span style=' font-family: monospace;'>x</span><span>, </span><span style=' font-family: monospace;'>2</span><span> for </span><span style=' font-family: monospace;'>y</span><span>, and </span><span style=' font-family: monospace;'>3</span><span> for </span><span style=' font-family: monospace;'>z</span><span>), associated with the Kohn-Sham orbitals in the parent DFT model. To do so, it should first compute the one-body density </span><span style="font-family: STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">ρ</span><span> associated with the Kohn-Sham orbitals and their occupation parameters.</span></li><li  class = 'S4'><span>The output Kohn-Sham potential gradient object contains the numerical evaluation of the exchange-correlation potential gradient.</span></li><li  class = 'S4'><span>For implicit exchange-correlation functionals, it provides the proper function handle to the Kohn-Sham potential gradient class.</span></li><li  class = 'S4'><span>This creates a new Kohn-Sham potential gradient object </span><span style=' font-family: monospace;'>DV</span><span> in which the exchange potential gradient is stored.</span></li><li  class = 'S4'><span>Note that </span><span style=' font-family: monospace;'>getPotentialDerivative</span><span> </span><span style=' text-decoration: underline;'>does not</span><span> </span><span style=' font-family: monospace;'>initialize</span><span> the output potential gradient object </span><span style=' font-family: monospace;'>DV</span><span>.</span></li></ul><div  class = 'S1'><span>Get the exchange-correlation potential for a specific one-body density</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >V = obj.getPotentialDerivative(1,rho);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>Same as above but with using the input </span><a href = "./QMol_DFT_density.html"><span>one-body-density object</span></a><span> </span><span style=' font-family: monospace;'>rho</span><span> in the numerical computation of the potential gradient.</span></li><li  class = 'S4'><span style=' font-family: monospace;'>rho</span><span> should be a </span><span style=' font-family: monospace;'>QMol_DFT_density</span><span> object defined over the same </span><a href = "./QMol_disc.html"><span>domain discretization</span></a><span> as the parent DFT model.</span></li></ul><div  class = 'S1'><span>Overwrite the exchange-correlation potential gradient in an existing Kohn-Sham potential gradient object with any of</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.getPotentialDerivative(1,[],DV);        </span><span style="color: #008013;">% use parent DFT density</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj.getPotentialDerivative(1,[],DV,false);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj.getPotentialDerivative(1,rho,DV);       </span><span style="color: #008013;">% supply the density</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.getPotentialDerivative(1,rho,DV,false);</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>This is similar to above without creating a new Kohn-Sham potential gradient object.</span></li><li  class = 'S4'><span>Any content in the input object </span><span style=' font-family: monospace;'>DV</span><span> is ereased before assigning the exchange-correlation potential gradient to it.</span></li></ul><div  class = 'S1'><span>Add the exchange-correlation potential gradient to an existing Kohn-Sham potential gradient object with either</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >obj.getPotentialDerivative(1,[],DV,true);   </span><span style="color: #008013;">% use parent DFT density</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.getPotentialDerivative(1,rho,DV,true);  </span><span style="color: #008013;">% supply the density</span></span></div></div></div><ul  class = 'S3'><li  class = 'S4'><span>This is formally equivalent to the in-place addition </span><span texencoding="\nabla\mathcal{V}\leftarrow\nabla\mathcal{V}+\nabla\mathcal{V}_{\rm XC}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="131.5" height="19.5" /></span><span>.</span></li></ul><h2  class = 'S5'><span>References</span></h2><div  class = 'S1' id = 'M_9C827223' ><span>[Kohn 1965] W. Kohn and L.J. Sham, "Self-Consistent Equations Including Exchange and Correlation Effects," Physical Review 140, A1133 (1965).</span></div><div  class = 'S1' id = 'M_73E1880A' ><span>[Legrand 2002] C. Legrand, E. Suraud, and P.-G. Reinhard, "Comparison of self-interaction-corrections for metal clusters," Journal of Physics B: Atomic, Molecular and Optical Physics 35, 1115 (2002).</span></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Ground-state density-functional theory (DFT)
% The QMol-grid package uses the Kohn-Sham formulation of density functional 
% theory (DFT) [Kohn 1965], where the electronic structure of a polyelectronic 
% atom or molecule is described, in atomic units, by the nonlinear system eigen-state 
% problem
% 
% $$\hat{\mathcal{H}}_{\rm DFT}\left[\{\phi_k\}_k\right]\  \phi_k({\bf x}) = 
% E_k\ \phi_k({\bf x})\quad {\rm for}\quad k=1,\ 2,\ \ldots\quad\quad\quad (1)$$
% 
% often referred to as the self-consistent field (SCF) equation. Formally, the 
% DFT Hamiltonian operator $\hat{\mathcal{H}}_{\rm DFT}$ is only functionally 
% dependent on the one-body density $\rho$ but some DFT functionals still involve 
% the Kohn-Sham orbitals in their definition. Traditionally, the DFT Hamiltonian 
% is decomposed between the kinetic, external, Hartree, and exchange-correlation 
% operators, each associated with an energy functional
% 
% $$\hat{\mathcal{H}}_{\rm DFT} = -\frac{\Delta}{2} + \hat{\mathcal{V}}_{\rm 
% ext} + \hat{\mathcal{V}}_{\rm H} + \hat{\mathcal{V}}_{\rm XC}.\quad\quad\quad 
% (2)$$
% 
% The QMol-grid package provides support both for spin-polarized, where the 
% up- and down-spin electronic components may be different, and spin-polarized, 
% where they are forced to be identical DFT models. 
%% 
% * <./QMol_DFT_spinPol.html |QMol_DFT_spinPol|> specifically describes spin 
% polarized DFT systems.
% * <./QMol_DFT_spinRes.html |QMol_DFT_spinRes|> specifically describes spin 
% restricted DFT systems.
%% 
% The two classes share very similar interfaces to provide a consistent end-user 
% experience REPLACE_WITH_DASH_DASH see their respective documentation pages for a detailed desciption 
% of the classes and features they support.
%% DFT components
% For clarity and streamlined future development of DFT capabilities in the 
% QMol-grid package, we sort DFT component (classes) into different topical groups. 
% Each component is equally compatible with both spin-polarized and -restricted 
% DFT models
% Model discretization
% The following classes are used to discretize DFT systems
%% 
% * <./QMol_DFT_density.html |QMol_DFT_density|> is the Cartesian-grid discretization 
% of a one-body density. It also provides support for the computation of density 
% gradient.
% * <./QMol_DFT_orbital.html |QMol_DFT_orbital|> is the Cartesian-grid discretization 
% of the Kohn-Sham orbitals.  
% * <./QMol_DFT_Vks.html |QMol_DFT_Vks|> is the Cartesian-grid discretization 
% of the explicit part of the Kohn-Sham potential. Implicit components are also 
% supported and provide an interface for the computation of the action of the 
% potential operator on arbitrary wave functions.
% * <./QMol_DFT_Vks_grad.html |QMol_DFT_Vks_grad|> is the Cartesian-grid discretization 
% of the explicit part of the Kohn-Sham potential gradient. Similar to the Kohn-Sham 
% potential, it also handles implicit components and the computation of the action 
% of the potential gradient operator on arbitrary wave functions.
%% 
% For basis-set discretization models, with <./QMol_disc_basis.html |QMol_disc_basis|>, 
% some of the classes above are redefined (overloaded)
%% 
% * <./QMol_DFT_orbital_basis.html |QMol_DFT_orbital_basis|> for Kohn-Sham orbitals.
% * <./QMol_DFT_Vks_basis.html |QMol_DFT_Vks_basis|> for the Kohn-Sham potential.
% Model components
% The following functionals are currently available for DFT models and simulations 
% in the QMol-grid package
%% 
% * <./QMol_DFT_Vext.html |QMol_DFT_Vext|> describes the external functional 
% and potential $\hat{\mathcal{V}}_{\rm ext}$ of Eq. (2).
% * <./QMol_DFT_Vh_conv.html |QMol_DFT_Vh_conv|> describes the Hartree functional 
% and potential $\hat{\mathcal{V}}_{\rm H}$ of Eq. (2), using an explicit-convolution 
% scheme.
% * <./QMol_DFT_Vh_fft.html |QMol_DFT_Vh_fft|> describes the Hartree functional 
% and potential $\hat{\mathcal{V}}_{\rm H}$ of Eq. (2), using a fast-Fourier-transform 
% convolution scheme.
% * <./QMol_DFT_Vx_LDA_exp.html |QMol_DFT_Vx_LDA_exp|> describes local-density-approximation 
% Slater exchange $\hat{\mathcal{V}}_{\rm XC}$ of Eq. (2), for exponential electron-electron 
% interaction potentials.
% * <./QMol_DFT_Vx_LDA_soft.html |QMol_DFT_Vx_LDA_soft|> describes local-density-approximation 
% Slater exchange $\hat{\mathcal{V}}_{\rm XC}$ of Eq. (2), for soft-Coulomb electron-electron 
% interaction potentials.
% * <./QMol_DFT_Vx_XX_conv.html |QMol_DFT_Vx_XX_conv|> describes the exact-exchange 
% functional and potential of Eq. (2), using an explicit-convolution scheme.
% * <./QMol_DFT_Vx_XX_fft.html |QMol_DFT_Vx_XX_fft|> describes the exact-exchange 
% functional and potential of Eq. (2), using a fast-Fourier-transform convolution 
% scheme.
% * <./QMol_DFT_Vc_LDA_soft.html |QMol_DFT_Vc_LDA_soft|> describes local-density-approximation 
% correlation $\hat{\mathcal{V}}_{\rm XC}$ of Eq. (2), for soft-Coulomb electron-electron 
% interaction potentials.
%% 
% All DFT functionals can be used both for regular grid-based and basis-set 
% deiscretization models, using the same end-user interfaces.
% Memory and execution-time profiler
% The choice of the domain discretization and DFT components can greatly affect 
% the resources, both in terms of memory and execution time, required to carry 
% out simulations.
%% 
% * <./QMol_DFT_profiler.html |QMol_DFT_profiler|> provides estimates of the 
% memory and run-time requirements for a given DFT model or components.
%% 
% Keep in mind that differentiation and (some) convolutions are performed via 
% fast-Fourier transforms. Thus, as a rule of thumb, domain discretization with 
% small prime factor number of grid points tend to produce faster results REPLACE_WITH_DASH_DASH for 
% best performance, prime factors not greater than 7.
% Ground-state computation
% The DFT ground state, or more generally some DFT eigen state, is computed 
% by numerically solving the SCF problem of Eq. (1). In the QMol-grid package, 
% this can be achieved with
%% 
% * <./QMol_DFT_SCF_Anderson.html |QMol_DFT_SCF_Anderson|> performs SCF iterations 
% for DFT ground/eigen-state calculations using an Anderson's mixing scheme.
% * <./QMol_DFT_eigs.html |QMol_DFT_eigs|> is a linear eigen solver, to be used 
% in combination with SCF iterations.
% * <./QMol_DFT_eig_basis.html |QMol_DFT_eig_basis|> is a linear eigen solver 
% for basis-set DFT models, to be used in combination with SCF iterations.
%% Self-interaction correction (SIC)
% Various approaches have been proposed to provide self-interaction correction 
% to the DFT Eq. (1). Currently, the QMol-grid package supports:
% No self-interaction correction
% In this case, self-interaction is ignored and no SIC is provided. This is 
% the default options for all DFT models in the QMol-grid package.
% Average-density self-interaction correction (ADSIC)
% ADSIC implements an average-density level of SIC [Legrand 2002] that is easy 
% to implement in the general DFT framework of Eq. (1). Unless otherwise specified, 
% all Hartree and exchange-correlation DFT functionals in the QMol-grid package 
% support ADSIC.
%% Notes for developers
% DFT model implementation
% The <./QMol_DFT.html |QMol_DFT|> abstract class defines the common interface 
% and run-time documentation for both spin-polarized (<./QMol_DFT_spinPol.html 
% |QMol_DFT_spinPol|>) and spin-restricted (<./QMol_DFT_spinRes.html |QMol_DFT_spinRes|>) 
% DFT models.
% 
% Many DFT components and methods require convergence tolerance or thresholds 
% in their implementation. Throughout, we parameterize these through class properties 
% (generally named |tol|). The default configuration of the QMol-grid package 
% roughly aims for $10^{-10}$ as the target tolerance/threshold. Changing the 
% values for the |tol| parameters may have unintended side effects REPLACE_WITH_DASH_DASH see the 
% respective documentation pages for more details on these tolerance/threshold 
% parameters.
% Exchange-correlation functionals
% To be compatible with other DFT components of the QMol-grid package, exchange-correlation 
% functionals must fulfill the following requirements:
% Class definition
% Define exchange-correlation classes by overloading the <./QMol_suite.html 
% |QMol_suite|> class. This will facilitate name-value pair assignment for property 
% values in the constructor, |set|, and |clear| methods REPLACE_WITH_DASH_DASH see the <./QMol_suite.html 
% |QMol_suite|> documentation page for more details.
% Class properties
% Exchange-correlation classes should define the following member properties 
% (with the specified attributes)
%% 
% * DFT: with recommended attributes |Transient,Hidden,GetAccess=?QMol_suite,SetAccess={?QMol_DFT_###,?QMol_DFT}|, 
% where |QMol_DFT_###| is the name of the exchange-correlation class being implemented, 
% and at minimum such that |QMol_DFT| can edit the value of |DFT|. This feature 
% is used by <./QMol_DFT_profiler.html |QMol_DFT_profiler|> to estimate the memory 
% footprint of DFT models without allocating its components.
% * |type|: as a |constant| character array with public access. This is used 
% by <./TDDFT.html TDDFT propagators> to check that the DFT functionals used in 
% the model are supported. Possible values are |'GGA_C'| (for GGA exchange), |'GGA_X'| 
% (for GGA exchange), |'GGA_XC'| (for GGA exchange correlation), |'LDA_C'| (for 
% LDA exchange), |'LDA_X'| (for LDA exchange), |'LDA_XC'| (for LDA exchange correlation), 
% |'XX'| (for exact exchange).
% Run-time documentation
% Implement run-time documentation with the follwing interface

methods (Access=public)
function ref = showDocumentation(obj)
%showDocumentation displays the documentation reflecting member property 
%   values
    
    % Add run-time documentation

end
end
%% 
% Each exchange-correlation functional class must implement a run-time documentation 
% as it is automatically called by <./QMol_DFT.html |QMol_DFT|> in its own run-time 
% documentation.
%% 
% * If no reference is cited, return |ref = {}| otherwise |ref = {'ref 1','ref 
% 2',___}|, where each of the |ref| corresponds to the bibliographic code for 
% the reference (generally of the form |'name_of_first_author publication_year'|) 
% and is case insensitive REPLACE_WITH_DASH_DASH see the <./Documentation.html documentation page> 
% for a list of citable references.
%% 
% Additionally, exchange-correlation functional class should implement an estimator 
% of its memory footprint with the following interface

methods (Access=public)
function mem = getMemoryProfile(obj,opt)
%getMemoryProfile computes and returns an estimate of the total memory
%   footprint (in bytes) of the DFT object with all its components
%   initialized and used.
    
    % Add memory footprint estimate

end
end
%% 
% * |getMemoryProfile| must be able to return the memory footprint estimate 
% even if the object has not been initialized. To do so, it can rely on its internal 
% copy of the parent |DFT| object, that is properly assigned by <./QMol_DFT_profiler.html 
% |QMol_DFT_profiler|> before calling  |getMemoryProfile|.
% * Only properties with large memory footprint REPLACE_WITH_DASH_DASH _e.g._, the discretization 
% of internal properties on the domain discretization grid REPLACE_WITH_DASH_DASH need to be listed. 
% Other small properties (scalar, object handle, flags, etc.) can be ignored; 
% if the class only uses such small properties, it may return |mem = 0|.
% * Use the <./QMol_DFT_profiler.html |QMol_DFT_profiler|>|.getMemoryFootprint(N,'real')| 
% and <./QMol_DFT_profiler.html |QMol_DFT_profiler|>|.getMemoryFootprint(N,'imag')| 
% methods to convert the size (number of elements N) of the memory components 
% to the number of bytes they take in memory.
% * |opt = false| requests the memory footprint with no details printed out.
% * |opt = true| should additionally display the details of the memory estimate. 
% Use <./QMol_DFT_profiler.html |QMol_DFT_profiler|>|.showMemoryFootprint(msg,mem,lvl)| 
% to do this, with msg (character array) the description of the component, |mem| 
% the estimated number of bytes associated with it, and |lvl| the indentation 
% level (optional, |lvl = 1| and |lvl = 2| are the only two levels supported).
% Class initialization
% Initialize the class with the following interface

methods (Access=public)
function initialize(obj,DFT,SIC)
%initialize initializes the object
    
    % Initialize the functional object

end
end
%% 
% * the input |DFT| is a <./QMol_DFT.html |QMol_DFT|> object containing the 
% DFT model associated with the exchange-correlation functional object to be initialized. 
% For run-time considerations it is often practical to keep a local copy of |DFT| 
% in the object in the DFT member method.
% * The input |SIC| specifies the flavor of SIC to be used with the exchange-correlation 
% functional. |'none'| notify to disable SIC while |'ADSIC'| specifies the ADSIC 
% method [Legrand 2002].
% * Both |DFT| and |SIC| information are systematically passed along by the 
% parent DFT model object when it initializes its exchange-correlation functional 
% components.
% Exchange-correlation functional kernel
% Implicit functionals may require specific initialization of the exchange-correlation 
% functional object before they can compute the energy, potential, or potential 
% gradient. This is done with

methods (Access=public)
function setPotentialKernel(obj)
%setPotentialKernel sets the kernel to be used for the computation of 
%   exact-exchange potentials

    % Proper initialization
end
end
%% 
% This typically involves storing a local copy of the Kohn-Sham orbitals of 
% the parent DFT model. If no kernel initialization is required, include the following 
% block in the class definition

methods (Access=public)
function setPotentialKernel(~)
%setPotentialKernel no kernel to set
    
end
end
% Exchange-correlation energy
% Compute and return the exchange-correlation energy with

methods (Access=public)
function E = getEnergy(obj,rho)
%getEnergy returns the exchange-correlation energy
    
    % Exchange-correlation energy computation
end
end
%% 
% The |getEnergy| method should support the following computation modes REPLACE_WITH_DASH_DASH see 
% one of the available exchange-correlation functional documentation page for 
% more details.
% 
% Get the exchange-correlation energy for the parent DFT object

E = obj.getEnergy;
%% 
% * This computes the exchange energy associated with the Kohn-Sham orbitals 
% in the parent DFT model. To do so, it should first compute the one-body density 
% associated with the Kohn-Sham orbitals and their occupation parameters.
% * This should be equivalent to, but more efficient than, |obj.getEnergy(DFT.getDensity)|.
%% 
% Get the exchange-correlation energy for a specific one-body density

E = obj.getEnergy(rho);
%% 
% * Same as above but with using the input <./QMol_DFT_density.html one-body-density 
% object> |rho| in the numerical computation of the energy.
% * |rho| should be a |QMol_DFT_density| object defined over the same <./QMol_disc.html 
% domain discretization> as the parent DFT model.
% Exchange-correlation potential
% Compute and return the exchange-correlation potential with

methods (Access=public)
function E = getPotential(obj,rho)
%getPotential returns the exchange-correlation potential
    
    % Exchange-correlation potential computation
end
end
%% 
% The |getPotential| method should support the following computation modes REPLACE_WITH_DASH_DASH 
% see one of the available exchange-correlation functional documentation page 
% for more details.
% 
% Get the exchange-correlation potential for the parent DFT object with either

V = obj.getPotential;
V = obj.getPotential([]);
%% 
% * This computes the exchange-correlation potential associated with the Kohn-Sham 
% orbitals in the parent DFT model. To do so, it should first compute the one-body 
% density $\rho$ associated with the Kohn-Sham orbitals and their occupation parameters.
% * The output Kohn-Sham potential object contains the numerical evaluation 
% of the exchange-correlation potential. 
% * For implicit exchange-correlation functionals, it provides the proper function 
% handle to the Kohn-Sham potential class.
% * This creates a new Kohn-Sham potential object |V| in which the exchange-correlation 
% potential is stored.
% * Note that |getPotential| should not |initialize| the output potential object 
% |V|.
%% 
% Get the exchange-correlation potential for a specific one-body density

V = obj.getPotential(rho);
%% 
% * Same as above but with using the input <./QMol_DFT_density.html one-body-density 
% object> |rho| in the numerical computation of the potential.
% * |rho| should be a |QMol_DFT_density| object defined over the same <./QMol_disc.html 
% domain discretization> as the parent DFT model.
%% 
% Overwrite the exchange-correlation potential in an existing Kohn-Sham potential 
% object with any of

obj.getPotential([],V);         % use parent DFT density
obj.getPotential([],V,false);
obj.getPotential(rho,V);        % supply the density
obj.getPotential(rho,V,false);
%% 
% * This is similar to above without creating a new Kohn-Sham potential object.
% * Any content in the input object |V| is erased before assigning the external 
% potential to it.
%% 
% Add the exchange-correlation potential to an existing Kohn-Sham potential 
% object

obj.getPotential([],V,true);    % use parent DFT density
obj.getPotential(rho,V,true);   % supply the density
%% 
% * This is formally equivalent to the in-place addition $\mathcal{V}\leftarrow\mathcal{V}+\mathcal{V}_{\rm 
% XC}$.
% Exchange-correlation potential gradient
% Compute and return the exchange-correlation potential gradient with

methods (Access=public)
function E = getPotentialDerivative(obj,rho)
%getPotentialDerivative returns the exchange-correlation potential
%   gradient
    
    % Exchange-correlation potential computation
end
end
%% 
% The |getPotentialDerivative| method should support the following computation 
% modes REPLACE_WITH_DASH_DASH see one of the available exchange-correlation functional documentation 
% page for more details.
% 
% Get the exchange-correlation potential gradient for the parent DFT object  
% with either

DV = obj.getPotentialDerivative(dim);
DV = obj.getPotentialDerivative(dim,[]);
%% 
% * This computes the exchange-correlation potential gradient, along the dimension 
% dim (|1| for |x|, |2| for |y|, and |3| for |z|), associated with the Kohn-Sham 
% orbitals in the parent DFT model. To do so, it should first compute the one-body 
% density $\rho$ associated with the Kohn-Sham orbitals and their occupation parameters.
% * The output Kohn-Sham potential gradient object contains the numerical evaluation 
% of the exchange-correlation potential gradient.
% * For implicit exchange-correlation functionals, it provides the proper function 
% handle to the Kohn-Sham potential gradient class.
% * This creates a new Kohn-Sham potential gradient object |DV| in which the 
% exchange potential gradient is stored.
% * Note that |getPotentialDerivative| does not |initialize| the output potential 
% gradient object |DV|.
%% 
% Get the exchange-correlation potential for a specific one-body density

V = obj.getPotentialDerivative(1,rho);
%% 
% * Same as above but with using the input <./QMol_DFT_density.html one-body-density 
% object> |rho| in the numerical computation of the potential gradient.
% * |rho| should be a |QMol_DFT_density| object defined over the same <./QMol_disc.html 
% domain discretization> as the parent DFT model.
%% 
% Overwrite the exchange-correlation potential gradient in an existing Kohn-Sham 
% potential gradient object with any of

obj.getPotentialDerivative(1,[],DV);        % use parent DFT density
obj.getPotentialDerivative(1,[],DV,false);
obj.getPotentialDerivative(1,rho,DV);       % supply the density
obj.getPotentialDerivative(1,rho,DV,false);
%% 
% * This is similar to above without creating a new Kohn-Sham potential gradient 
% object.
% * Any content in the input object |DV| is ereased before assigning the exchange-correlation 
% potential gradient to it.
%% 
% Add the exchange-correlation potential gradient to an existing Kohn-Sham potential 
% gradient object with either

obj.getPotentialDerivative(1,[],DV,true);   % use parent DFT density
obj.getPotentialDerivative(1,rho,DV,true);  % supply the density
%% 
% * This is formally equivalent to the in-place addition $\nabla\mathcal{V}\leftarrow\nabla\mathcal{V}+\nabla\mathcal{V}_{\rm 
% XC}$.
%% References
% [Kohn 1965] W. Kohn and L.J. Sham, "Self-Consistent Equations Including Exchange 
% and Correlation Effects," Physical Review 140, A1133 (1965).
% 
% [Legrand 2002] C. Legrand, E. Suraud, and P.-G. Reinhard, "Comparison of self-interaction-corrections 
% for metal clusters," Journal of Physics B: Atomic, Molecular and Optical Physics 
% 35, 1115 (2002).
##### SOURCE END #####
-->
</div></body></html>