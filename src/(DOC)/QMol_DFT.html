<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2024a"><title>QMol_DFT</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S3 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.S4 { margin: 10px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 15px; font-weight: 700; text-align: left;  }
.S5 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S6 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block }
.S7 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0.666667px solid rgb(217, 217, 217); border-bottom: 0.666667px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S9 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0.666667px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S10 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0.666667px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S11 { border-left: 0.666667px solid rgb(217, 217, 217); border-right: 0.666667px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span style=' font-family: monospace;'>QMol_DFT</span></h1><div  class = 'S1'><span>Parent class for density-functional theory (DFT) model objects.</span></div><h2  class = 'S2'><span>Description</span></h2><div  class = 'S1'><span style=' font-family: monospace;'>QMol_DFT</span><span> defines an abstract class for the description of DFT models. It is designed to be agnostic of (i) the model dimension, (ii) the chosen discretization (Cartesian grid or basis), and (ii) spin polarized or restricted configuration. These are to be handled by the specific DFT-implementation classes and their components.</span></div><h2  class = 'S2'><span>Class properties</span></h2><h3  class = 'S3' id = 'H_27AB3DA4' ><span>DFT model</span></h3><div  class = 'S1'><span>The </span><span style=' font-family: monospace;'>QMol_DFT</span><span> class defines the following public get-access properties; each can be changed using the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method:</span></div><h4  class = 'S4' id = 'H_6EFEF984' ><span style=' font-family: monospace;'>discretization (disc)</span></h4><div  class = 'S1'><a href = "./Discretization.html"><span>Domain discretization</span></a><span> object </span><span style=' font-family: monospace;'>[ handle object (default []) ]</span></div><h4  class = 'S4' id = 'H_25FA49BA' ><span style=' font-family: monospace;'>occupation (occ)</span></h4><div  class = 'S1'><span>Kohn-Sham orbital population parameters </span><span style=' font-family: monospace;'>[ vector | cell | (default []) ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>For spin-restricted DFT models, </span><span style=' font-family: monospace;'>occupation = [n1,n2,___]</span><span> with each of the </span><span texencoding="0\leq n\leq2" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="62.5" height="18" /></span><span> specifies the number of electrons associated with each of the Kohn-Sham </span><a href = "#M_1F9482EA"><span style=' font-family: monospace;'>orbital</span></a><span>s.</span></li><li  class = 'S6'><span>For spin-polarized DFT models, </span><span style=' font-family: monospace;'>occupation = {[n_up1,n_up2,___],[n_down1,n_down2,___]}</span><span> with each of the </span><span texencoding="0\leq n\leq1" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="62.5" height="18" /></span><span> specifies the number of electrons associated with the up- and down-spin Kohn-Sham </span><a href = "#M_1F9482EA"><span style=' font-family: monospace;'>orbital</span></a><span>s.</span></li></ul><h4  class = 'S4' id = 'M_1F9482EA' ><span style=' font-family: monospace;'>orbital (KSO)</span></h4><div  class = 'S1'><span>Kohn-Sham orbital object </span><span style=' font-family: monospace;'>[ handle object (default []) ]</span></div><h4  class = 'S4' id = 'H_726B4267' ><span style=' font-family: monospace;'>externalPotential (Vext)</span></h4><div  class = 'S1'><span>External functional object </span><span style=' font-family: monospace;'>[handle object (default []) ]</span></div><h4  class = 'S4' id = 'H_FE7D957E' ><span style=' font-family: monospace;'>HartreePotential (Vh)</span></h4><div  class = 'S1' id = 'M_46B2CD54' ><span>Hartree functional object </span><span style=' font-family: monospace;'>[handle object (default []) ]</span></div><h4  class = 'S4' id = 'H_C9D9F4E3' ><span style=' font-family: monospace;'>exchangeCorrelationPotential (Vxc)</span></h4><div  class = 'S1'><span>Exchange-correlation functional object(s) </span><span style=' font-family: monospace;'>[ [] (default) | handle object | cell ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>Empty </span><span style=' font-family: monospace;'>exchangeCorrelationPotential</span><span> ignores exchange-correlation effects altogether in the DFT model.</span></li><li  class = 'S6'><span>Provide multiple exchange-correlation functionals -- </span><span style=' font-style: italic;'>e.g.</span><span>, one exchange functional plus a separate correlation one -- grouped in a cell </span><span style=' font-family: monospace;'>{Vxc1,Vxc2,___}</span></li><li  class = 'S6'><span>If the DFT model includes a single exchange-correlation functional, it can be directly provided </span><span style=' font-family: monospace;'>exchangeCorrelationPotential = Vxc</span><span> or included in a cell </span><span style=' font-family: monospace;'>exchangeCorrelationPotential = {Vxc}</span><span>.</span></li></ul><h4  class = 'S4'><span style=' font-family: monospace;'>selfInteractionCorrection (SIC)</span></h4><div  class = 'S1'><span>Flavor of self-interaction correction (SIC) </span><span style=' font-family: monospace;'>[ 'none' (default) | 'ADSIC' | cell ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>If a single SIC flag is provided, the same flavor of SIC corresponding to the flag, is applied to the </span><a href = "#H_FE7D957E"><span>Hartree</span></a><span> and </span><a href = "#H_C9D9F4E3"><span>exchange-correlation</span></a><span> functionals.</span></li><li  class = 'S6'><span style=' font-family: monospace;'>selfInteractionCorrection = {SIC_H,SIC_XC}</span><span> independently specifies the flavor of SIC to use for the </span><a href = "#H_FE7D957E"><span>Hartree</span></a><span> and </span><a href = "#H_C9D9F4E3"><span>exchange-correlation</span></a><span> functionals, respectively.</span></li><li  class = 'S6'><span>If the DFT model uses several exchange-correlation functional, </span><span style=' font-family: monospace;'>selfInteractionCorrection = {SIC_H,SIC_XC_1,SIC_XC_1,___}</span><span> independently specifies the flavor of SIC for each of the exchange-correlation functionals, respectively.</span></li></ul><h3  class = 'S3' id = 'H_8DB4475D' ><span>Other properties</span></h3><div  class = 'S1'><span>To facilitate simulations, the </span><span style=' font-family: monospace;'>QMol_DFT</span><span> defines a handful of additional transient properties. These </span><span style=' text-decoration: underline;'>cannot</span><span> be edited with the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method.</span></div><h4  class = 'S4' id = 'H_0ED64D82' ><span style=' font-family: monospace;'>isInitialized (isInit)</span></h4><div  class = 'S1'><span>Whether the DFT-model object is properly initialized. This is used throughout the QMol-grid package to check that the DFT-model object holds meaningful information and is ready for use.</span></div><h4  class = 'S4'><span style=' font-family: monospace;'>totalCharge (Ntot)</span></h4><div  class = 'S1'><span>Total number of electrons in the DFT model </span><span style=' font-family: monospace;'>[ scalar | vector (default []) ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>For spin restricted DFT models, this is defined as </span><span style=' font-family: monospace;'>sum(obj.</span><a href = "#H_25FA49BA"><span style=' font-family: monospace;'>occupation</span></a><span style=' font-family: monospace;'>)</span></li><li  class = 'S6'><span>For spin restricted DFT models, this is defined as [</span><span style=' font-family: monospace;'>sum(obj.</span><a href = "#H_25FA49BA"><span style=' font-family: monospace;'>occupation</span></a><span style=' font-family: monospace;'>{1}),sum(obj.</span><a href = "#H_25FA49BA"><span style=' font-family: monospace;'>occupation</span></a><span style=' font-family: monospace;'>{2})]</span></li><li  class = 'S6'><span style=' font-family: monospace;'>totalCharge</span><span> is set by </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>; It is empty when the </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag is </span><span style=' font-family: monospace;'>false</span></li></ul><h4  class = 'S4' id = 'H_C4662A68' ><span>rho</span></h4><div  class = 'S1'><span>One-body density placeholder </span><span style=' font-family: monospace;'>[ density handle object (default []) ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>Some methods require local computation of the one-body density before performing their own computation. In such cases, they should use this local density placeholder and avoid the allocation of another density object.</span></li><li  class = 'S6'><span style=' font-family: monospace;'>rho</span><span> is up for grab by any class in the QMol-grid package (</span><span style=' font-family: monospace;'>Access=?QMol_suite</span><span>). One should not assume that it retains meaningful values outside of a given method where it is used.</span></li></ul><h4  class = 'S4' id = 'H_CB9C23AD' ><span style=' font-family: monospace;'>Vks</span></h4><div  class = 'S1'><span>Kohn-Sham potential placeholder </span><span style=' font-family: monospace;'>[ density handle object (default []) ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>Like for the </span><a href = "#H_C4662A68"><span>density</span></a><span>, use this placeholder when a local computation of the Kohn-Sham potential is required in some computation.</span></li><li  class = 'S6'><span style=' font-family: monospace;'>Vks</span><span> is up for grab by any class in the QMol-grid package (</span><span style=' font-family: monospace;'>Access=?QMol_suite</span><span>). One should not assume that it retains meaningful values outside of a given method where it is used.</span></li></ul><h4  class = 'S4' id = 'H_73741410' ><span style=' font-family: monospace;'>DVks</span></h4><div  class = 'S1'><span>Kohn-Sham potential gradient placeholder </span><span style=' font-family: monospace;'>[ density handle object (default []) ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>Like for the </span><a href = "#H_C4662A68"><span>density</span></a><span>, use this placeholder when a local computation of the Kohn-Sham potentia gradient is required in some computation.</span></li><li  class = 'S6'><span style=' font-family: monospace;'>DVks</span><span> is up for grab by any class in the QMol-grid package (</span><span style=' font-family: monospace;'>Access=?QMol_suite</span><span>). One should not assume that it retains meaningful values outside of a given method where it is used.</span></li></ul><h3  class = 'S3'><span>Constant properties</span></h3><h4  class = 'S4'><span style=' font-family: monospace;'>isSpinPol</span></h4><ul  class = 'S5'><li  class = 'S6'><span>Flags spin polarized (</span><span style=' font-family: monospace;'>isSpinPol = true</span><span>) from restricted (</span><span style=' font-family: monospace;'>isSpinPol = false</span><span>) models.</span></li></ul><h4  class = 'S4'><span style=' font-family: monospace;'>dim</span></h4><ul  class = 'S5'><li  class = 'S6'><span>Specifies the dimension of the DFT model</span></li></ul><h2  class = 'S2'><span>Class methods</span></h2><h3  class = 'S3'><span>Creation</span></h3><h4  class = 'S4' id = 'H_0783E8B1' ><span>constructor</span></h4><div  class = 'S1'><span>Create a DFT-model object with empty class properties.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj = QMol_DFT;</span></span></div></div></div><div  class = 'S8'><span>Create a DFT-model object with the </span><span style=' font-family: monospace;'>name</span><span> properties set to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_27AB3DA4"><span>DFT-model properties</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj = QMol_DFT(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj = QMol_DFT(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><h3  class = 'S3'><span>Changing class properties</span></h3><h4  class = 'S4' id = 'H_4405B79D' ><span style=' font-family: monospace;'>set</span></h4><div  class = 'S1'><span>Update the </span><span style=' font-family: monospace;'>name</span><span> properties of a DFT-model object to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_27AB3DA4"><span>DFT-model properties</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj.set(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.set(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S8'><span>This is the common name-value pair assignment method used throughout the QMol-grid package. The </span><span style=' font-family: monospace;'>set</span><span> method also </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the class. After running, the </span><span style=' font-family: monospace;'>set</span><span> property updates the </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to a </span><span style=' font-family: monospace;'>false</span><span> value.</span></div><h4  class = 'S4' id = 'H_BF84FCE7' ><span style=' font-family: monospace;'>reset</span></h4><div  class = 'S1'><span>Reset the object by deleting/re-initializing all run-time properties of the class and updating the </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to </span><span style=' font-family: monospace;'>false</span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.reset;</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>This is the common </span><span style=' font-family: monospace;'>reset</span><span> method available to all classes throughout the QMol-grid package.</span></li><li  class = 'S6'><span>To avoid any mismatch in the DFT component internal properties, this also </span><span style=' font-family: monospace;'>reset</span><span>s the </span><a href = "#H_6EFEF984"><span style=' font-family: monospace;'>discretization</span></a><span> (domain discretization), </span><a href = "#M_1F9482EA"><span style=' font-family: monospace;'>orbital</span></a><span> (Kohn-Sham orbitals), </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>externalPotential</span></a><span> (external functional and potential), </span><a href = "#H_FE7D957E"><span style=' font-family: monospace;'>HartreePotential</span></a><span> (Hartree functional and potential), and </span><a href = "#H_C9D9F4E3"><span style=' font-family: monospace;'>exchangeCorrelationPotential</span></a><span> (exchange-correlation functional and potential) components objects.</span></li></ul><h4  class = 'S4' id = 'H_C729A888' ><span style=' font-family: monospace;'>clear</span></h4><div  class = 'S1'><span>Clear all class properties</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.clear;</span></span></div></div></div><div  class = 'S8'><span>Clear a specific set of the class properties. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_27AB3DA4"><span>DFT-model properties</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.clear(name1,name2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S8'><span>This is the common </span><span style=' font-family: monospace;'>clear</span><span> method available to all classes throughout the QMol-grid package. The </span><span style=' font-family: monospace;'>clear</span><span> method also </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the class. The </span><span style=' font-family: monospace;'>clear</span><span> method can be used to delete specific properties before saving an instance of the </span><span style=' font-family: monospace;'>QMol_DFT</span><span> class.</span></div><h3  class = 'S3'><span>Initializing the object</span></h3><h4  class = 'S4' id = 'H_85EFED0A' ><span style=' font-family: monospace;'>initialize</span></h4><div  class = 'S1'><span>Initialize a DFT-model object in silent mode, i.e., without displaying any initialization status, and set the </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to </span><span style=' font-family: monospace;'>true</span><span> with either</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj.initialize;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.initialize(0)</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>This </span><span style=' font-family: monospace;'>initialize</span><span>s </span><a href = "#H_6EFEF984"><span style=' font-family: monospace;'>discretization</span></a><span> (domain discretization), </span><a href = "#M_1F9482EA"><span style=' font-family: monospace;'>orbital</span></a><span> (Kohn-Sham orbitals), </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>externalPotential</span></a><span> (external functional and potential), </span><a href = "#H_FE7D957E"><span style=' font-family: monospace;'>HartreePotential</span></a><span> (Hartree functional and potential), and </span><a href = "#H_C9D9F4E3"><span style=' font-family: monospace;'>exchangeCorrelationPotential</span></a><span> (exchange-correlation functional and potential) component objects.</span></li><li  class = 'S6'><span>To avoid any mismatch in internal properties, </span><span style=' font-family: monospace;'>initialize</span><span> first </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the object before performing the initialization</span></li></ul><div  class = 'S1'><span>To perform the same initialization but with displaying the status of the object initialization, including the QMol-grid package header and footer, </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.initialize(1);</span></span></div></div></div><div  class = 'S8'><span>To perform the initialization and display the status of the object initialization, without the QMol-grid package header and footer, </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.initialize(2);  </span><span style="color: #008013;">% 2 or any interger larger than 1</span></span></div></div></div><h3  class = 'S3'><span>Run-time documentation</span></h3><h4  class = 'S4' id = 'H_E3988947' ><span style=' font-family: monospace;'>getMemoryProfile</span></h4><div  class = 'S1'><span>Get an estimate of the memory help a </span><span style=' font-family: monospace;'>QMol_DFT</span><span> object with either</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >mem = obj.getMemoryProfile;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >mem = obj.getMemoryProfile(false);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>The object does not need to be </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d for the memory footprint evaluation.</span></li><li  class = 'S6'><span style=' font-family: monospace;'>getMemoryProfile</span><span> makes efforts to return the object in the same configuration as before the profiling but small side effects cannot be entirely excluded: all the </span><a href = "#H_27AB3DA4"><span>DFT-model properties</span></a><span> are left unchanged while the </span><a href = "#H_8DB4475D"><span>other properties</span></a><span> may be altered. Notably, if the object was not initialized (</span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span style=' font-family: monospace;'> = false</span><span>), </span><span style=' font-family: monospace;'>getMemoryProfile</span><span> </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span>s the object.</span></li><li  class = 'S6'><span>The estimate includes (1) the </span><a href = "#H_6EFEF984"><span>domain discretization</span></a><span>, (2) </span><a href = "#M_1F9482EA"><span>Kohn-Sham orbitals</span></a><span>, (3) </span><a href = "#H_C4662A68"><span>one body density</span></a><span>, (4) </span><a href = "#H_CB9C23AD"><span>Kohn-Sham potential</span></a><span>, (5) </span><a href = "#H_73741410"><span>Kohn-Sham potential gradient</span></a><span>, (6) </span><a href = "#H_726B4267"><span>External functional</span></a><span>, (7) </span><a href = "#H_FE7D957E"><span>Hartree functional</span></a><span>, and (8) </span><a href = "#H_C9D9F4E3"><span>exchange-correlation functional(s)</span></a><span>. Note that all these components may not be used in actual simulations and the memory estimate tries to be conservative. On the other hand, it only includes the discretization of member components on the domain grid and ignores other (small) properties.</span></li><li  class = 'S6'><span>The output </span><span style=' font-family: monospace;'>mem</span><span> is the estimated size in bytes.</span></li></ul><div  class = 'S1'><span>Additionally display the detail of the memory footprint with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >mem = obj.getMemoryProfile(true);</span></span></div></div></div><h4  class = 'S4' id = 'H_4D7CFC3D' ><span style=' font-family: monospace;'>showDocumentation</span></h4><div  class = 'S1'><span>Display the run-time documentation for the specific configuration of a </span><span style=' font-family: monospace;'>QMol_DFT</span><span> object, wich must have been </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d beforehand</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.showDocumentation;</span></span></div></div></div><div  class = 'S8'><span>The run-time documentation performs the following steps</span></div><ul  class = 'S5'><li  class = 'S6'><span>Display the QMol-grid package header (showing the kernel, external component versions)</span></li><li  class = 'S6'><span>Call the DFT-model implementation-specific run-time documentation with the propety </span><a href = "#H_9AAF0342"><span style=' font-family: monospace;'>showDoc</span></a><span>.</span></li><li  class = 'S6'><span>Display the </span><a href = "#H_6EFEF984"><span style=' font-family: monospace;'>discretization</span></a><span> (domain discretization) object run-time documentation</span></li><li  class = 'S6'><span>Display the </span><a href = "#H_FE7D957E"><span style=' font-family: monospace;'>HartreePotential</span></a><span> (Hartree functional and potential) object run-time documentation</span></li><li  class = 'S6'><span>Display the </span><a href = "#H_726B4267"><span style=' font-family: monospace;'>externalPotential</span></a><span> (external functional and potential) object run-time documentation</span></li><li  class = 'S6'><span>Display the </span><a href = "#H_C9D9F4E3"><span style=' font-family: monospace;'>exchangeCorrelationPotential</span></a><span> (exchange-correlation functional and potential) object run-time documentation</span></li><li  class = 'S6'><span>Display the electronic structure, with the occupation (number of electrons) in each Kohn-Sham orbital</span></li><li  class = 'S6'><span>Display the bibliography associated with the list of cited references (from the previous steps)</span></li><li  class = 'S6'><span>Display the funding information</span></li><li  class = 'S6'><span>Display the QMol-grid package footer</span></li></ul><h3  class = 'S3'><span>One-body density and Kohn-Sham potential</span></h3><div  class = 'S1'><span>All the following methods require the object to have been </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d.</span></div><h4  class = 'S4'><span style=' font-family: monospace;'>getDensity</span></h4><div  class = 'S1'><span>Compute and obtain the one-body density associated with the </span><a href = "#M_1F9482EA"><span>Kohn-Sham orbitals</span></a><span> and </span><a href = "#H_25FA49BA"><span>occupation</span></a><span> parameters</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >rho = obj.getDensity;</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>This creates a new one-body density object </span><span style=' font-family: monospace;'>rho</span><span> in which the result is stored.</span></li></ul><div  class = 'S1'><span>Alternatively, store the result in an existing one-body density object with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.getDensity(rho);</span></span></div></div></div><h4  class = 'S4'><span style=' font-family: monospace;'>setPotentialKernel</span></h4><div  class = 'S1'><span>Trigger the initialization of the kernels of implicit echange-correlation potentials/functionals</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.setPotentialKernel;</span></span></div></div></div><h4  class = 'S4'><span style=' font-family: monospace;'>getPotential</span></h4><div  class = 'S1'><span>Compute and obtain the total Kohn-Sham potential (sum of the </span><a href = "#H_726B4267"><span>external</span></a><span>, </span><a href = "#M_46B2CD54"><span>Hartree</span></a><span>, and </span><a href = "#H_C9D9F4E3"><span>exchange-correlation</span></a><span> potentials)</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >V = obj.getPotential;</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>Uses the one-body density associated with the </span><a href = "#M_1F9482EA"><span>Kohn-Sham orbitals</span></a><span> and </span><a href = "#H_25FA49BA"><span>occupation</span></a><span> parameters (this forces first the computation of the one-body density)</span></li></ul><div  class = 'S1'><span>Specify the one-body density to be used in the calculation of the Kohn-Sham potential with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >V = obj.getPotential(rho)</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span style=' font-family: monospace;'>rho</span><span> is compatible one-body density object</span></li></ul><div  class = 'S1'><span>Alternatively, store the results in an existing Kohn-Sham potential object respectively with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj.getPotential([],V);  </span><span style="color: #008013;">% Use current density (must be computed first)</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.getPotential(rho,V); </span><span style="color: #008013;">% Supply one-body density</span></span></div></div></div><h4  class = 'S4'><span style=' font-family: monospace;'>getPotentialGradient</span></h4><div  class = 'S1'><span>Compute and obtain the gradient of the total Kohn-Sham potential (sum of the </span><a href = "#H_726B4267"><span>external</span></a><span>, </span><a href = "#M_46B2CD54"><span>Hartree</span></a><span>, and </span><a href = "#H_C9D9F4E3"><span>exchange-correlation</span></a><span> potentials)</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >DV = obj.getPotentialGradient;</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>Uses the one-body density associated with the </span><a href = "#M_1F9482EA"><span>Kohn-Sham orbitals</span></a><span> and </span><a href = "#H_25FA49BA"><span>occupation</span></a><span> parameters (this forces first the computation of the one-body density)</span></li></ul><div  class = 'S1'><span>Specify the one-body density to be used in the calculation of the Kohn-Sham potential gradient with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >DV = obj.getPotentialGradient(rho)</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span style=' font-family: monospace;'>rho</span><span> is compatible one-body density object</span></li></ul><div  class = 'S1'><span>Alternatively, store the results in an existing Kohn-Sham potential object respectively with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj.getPotentialGradient([],DV);  </span><span style="color: #008013;">% Use current density (must be computed first)</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.getPotentialGradient(rho,DV); </span><span style="color: #008013;">% Supply one-body density</span></span></div></div></div><div  class = 'S8'><span>By default </span><span style=' font-family: monospace;'>getPotentialGradient</span><span> computes the gradient along all possible directions; Specify the directions along which the gradient should be computed with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >DV = obj.getPotentialGradient([],[],dim);  </span><span style="color: #008013;">% Use current density (must be computed first)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >obj.getPotentialGradient([],DV,dim); </span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >DV = obj.getPotentialGradient(rho,[],dim); </span><span style="color: #008013;">% Supply one-body density</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.getPotentialGradient(rho,DV,dim); </span></span></div></div></div><h4  class = 'S4'><span>DFT and orbital energies</span></h4><div  class = 'S1'><span>All the following methods require the object to have been </span><a href = "#H_85EFED0A"><span style=' font-family: monospace;'>initialize</span></a><span>d.</span></div><h4  class = 'S4' id = 'H_25FFD943' ><span style=' font-family: monospace;'>getEnergy</span></h4><div  class = 'S1'><span>Compute the DFT-component energies with either</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >[Etot,Ekin,Eext,Eh,Exc] = obj.getEnergy;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >[Etot,Ekin,Eext,Eh,Exc] = obj.getEnergy(</span><span style="color: #a709f5;">'DFT'</span><span >);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span style=' font-family: monospace;'>Etot</span><span> is the total (sum of the following components) energy; For spin-rstricted models </span><span style=' font-family: monospace;'>Ekin</span><span> is the total kinetic energy and for spin-polarized ones </span><span style=' font-family: monospace;'>Ekin = [Eup, Edown]</span><span> is the kinetic energy in the up- and down-spin channels, respectively; </span><span style=' font-family: monospace;'>Eext</span><span> is the external energy; </span><span style=' font-family: monospace;'>Eh</span><span> is the Hartree energy; </span><span style=' font-family: monospace;'>Exc</span><span> is the exchange-correlation energy (summed over all exchange-correlation functionals).</span></li><li  class = 'S6'><span>Uses the one-body density associated with the </span><a href = "#M_1F9482EA"><span>Kohn-Sham orbitals</span></a><span> and </span><a href = "#H_25FA49BA"><span>occupation</span></a><span> parameters (this forces first the computation of the one-body density)</span></li></ul><div  class = 'S1'><span>Compute the Kohn-Sham orbital energies and error</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >[E,DE] = obj.getEnergy(</span><span style="color: #a709f5;">'orbital'</span><span >);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>For each orbital </span><span texencoding="\left|\phi\right\rangle" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAAkCAYAAAD2IghRAAAAAXNSR0IArs4c6QAABRFJREFUWEftWG2IVFUYft6zdyd3WMVMRbbVe+/MZTdXiYwi6k/+yPKL9k+aVBZlJqyFIZWV/qoshYikEkKStLDoi0xLQQqDKIXK6Mfqysy957LTggVhWjvtzL3njROzcJtmZ+7MuhOS9+e9557znPd93vd5ziFcpA9dpLhxCXizM3cp4v/LiFuWdRURzSgWi9/mcrl8nCBUpEp3d/fkkZGRNUKItmKxuGdwcHAozmTRMY7jXKaUuh7AJGYmz/O+ABBWmiedTt+klDrMzA9JKd+Ns1ZF4F1dXdOLxeJBALOUUkt83z8ZZ7LoGNM05wohDgEwiWiN67q7x5qjp6enfXh4eI/+nkwm7+vv7/+91noTBty27TsAvA/gZ6XUYt/3T1QDY1nWKiLay8y3SykP/yfAFy5caPi+/xKARwAcYeaVUsqz1cB0dnZe2draepCZvzcMoy+TyYxUGz8hEXccZ0YYhvsB3MjML0gpNwPgakBKm90O4H5mXiqlPNZ04JZl3UBERwBMJqLlrut+Wiv1+vtokQLYZZrmpqNHjwZj/TchEbcsawMRvQzgpFJqme/7Xhzgo0VKRPNbWlqWZjKZbFOAd3R0JJPJ5LQwDF8EcCcRfQxgg1LqnJTyt1p00SBLRfoOgC2e5z0/1j/jjrju10EQLNELEZFO7ecAHgQwE4DewACA9QCu0GNM09xXjQKzZ8/uMAxD1weCIOgdS0PGBby0yE4AtxHRRiHEbqXULcysNeA8My+SUh53HGdeGIYfAbCJaJ3rum9WiT7Ztv00gOeIaL3runr+fz0NA7dtuxvAXgALImB0qrcS0VMAvmlpaenNZDK/1Nsebdu+GsAhZj4VBMGKXC73aznyhoB3dnZOa21t1Ty8lYh2zJkz5zGdfsuyphLRewAWAXjFNM2No7RIpVLbmHkTAL+WGpfot5OIVgO42/M8LWT/eBoBTqlUapPuz+UgTNNcIITQqqf5vcLzvA9KBTeJiF4HcC8zZ4UQS13XPV1DSRcT0SfMfKCSDagbuOM46TAMPwPQVV75qVTqAWZ+o3xD6XR6plJK9/Lr4iqpZVmzABwkoumVMlQ38FQq1cfMr0WLT0eup6cnkc/nXwWwFsD+RCKxemBg4HyZsEyOq6SWZV24iGu7WygU3gLQGy0+DW7UawC4BsDmUg/WnyhSsOeFEIuz2ezX1WhywTlumqYthNApn6s7CjOvk1L+WeLxzSWZR6kNfqnfa2oFQbCfiOZpngshNtQyUBe8q5R57O2u6z45GrlS790K4Idisbg8l8v9pKMdKeTTzNwrpTxVQ/6jfXxMH18Xx6OuT6ui53lPaCEpo9Cutra2h/v7+wumaV4rhDgAQBDRPa7ralWt+kyUckYjeEII0ZvNZgcrnXYiAgUhRF82m/2uFuioV9Ei5rqutrkV7XBdES9xdopS6hlm7gNwTAsQM2vOPwtgmIgeZ+apuoCZeXc+n3/7zJkzf8QB3RR3qJ1ge3t7slAoOES0BcAyAMeJaK1SajCuG4xuqKl+vJHTTqXoR05AqwAs8Tzvx2pZqpsq5ZM1etopn2dUkZn5q6acORs97ZQDLynytjgC9beqVUpH3HsVzfNEIrGLiO5i5n2FQmHt0NDQcJxCjI7RbtMwDO0Az47rXiXuTVZUSZn5USnljnpBl1qg9iUfEtHKuAfrcd3WamMVBMEUvbhhGOe06DQCPJ1Oz1dKXT7uu8NGFm/2P38Bm8ftUqxpU30AAAAASUVORK5CYII=" width="23" height="18" /></span><span>, the orbital energy is defined as the real </span><span texencoding="E = \langle\phi| \hat{\mathcal{H}}_{\rm DFT} |\phi\rangle" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="107.5" height="24.5" /></span><span> and the error is defined as the positive real </span><span texencoding="\left\| (\hat{\mathcal{H}}_{\rm DFT} - E) |\phi\rangle \right\|" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="111.5" height="24.5" /></span><span>. </span><span texencoding="\hat{\mathcal{H}}_{\rm DFT}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="38" height="24.5" /></span><span> is the total DFT Hamiltonian operator.</span></li><li  class = 'S6'><span>For spin-restricted models, </span><span style=' font-family: monospace;'>E</span><span> is a vector containing the respective orbital energies</span></li><li  class = 'S6'><span>For spin-polarized models, </span><span style=' font-family: monospace;'>E = {Eup,Edown}</span><span> are the orbital energies in the up- and down-spin channels, respectively.</span></li><li  class = 'S6'><span>For spin-restricted models, </span><span style=' font-family: monospace;'>DE</span><span> is a vector containing the respective orbital errors</span></li><li  class = 'S6'><span>For spin-polarized models, </span><span style=' font-family: monospace;'>DE = {DEup,DEdown}</span><span> are the orbital energy errors in the up- and down-spin channels, respectively.</span></li><li  class = 'S6'><span>This uses one-body density associated with the </span><a href = "#M_1F9482EA"><span>Kohn-Sham orbitals</span></a><span> and </span><a href = "#H_25FA49BA"><span>occupation</span></a><span> parameters and its corresponding Kohn-Sham potential (this forces first the computation of both the one-body density and the Kohn-Sham potential).</span></li></ul><div  class = 'S1'><span>Specify the one-body density (for the Kohn-Sham potential) for computing the Kohn-Sham orbital energies and error with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >[E,DE] = obj.getEnergy(</span><span style="color: #a709f5;">'orbital'</span><span >,rho);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span style=' font-family: monospace;'>rho</span><span> is a compatible one-body density object.</span></li><li  class = 'S6'><span>This forces the computation of the Kohn-Sham potential (for the input density).</span></li></ul><div  class = 'S1'><span>Specify the Kohn-Sham potential for computing the Kohn-Sham orbital energies and error with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >[E,DE] = obj.getEnergy(</span><span style="color: #a709f5;">'orbital'</span><span >,V);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span style=' font-family: monospace;'>V</span><span> is a compatible Kohn-Sham potential</span></li></ul><h4  class = 'S4'><span style=' font-family: monospace;'>showEnergy</span></h4><div  class = 'S1'><span>Display the DFT energy components with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.showEnergy(</span><span style="color: #a709f5;">'DFT'</span><span >);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>This forces the computation of the one-body density and its associated Kohn-Sham potential.</span></li></ul><div  class = 'S1'><span>Display the Kohn-Sham orbital energies and errors with either</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj.showEnergy;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.showEnergy(</span><span style="color: #a709f5;">'orbital'</span><span >);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>The energy and error the same as in </span><a href = "#H_25FFD943"><span style=' font-family: monospace;'>getEnergy</span></a><span style=' font-family: monospace;'>.</span></li><li  class = 'S6'><span>This also forces the computation of the one-body density and its associated Kohn-Sham potential.</span></li></ul><h2  class = 'S2'><span>Overloading the class</span></h2><div  class = 'S1'><span>To define a specific implementation of DFT models, overloading classes must define the following methods with the specified signature and attributes</span></div><h4  class = 'S4' id = 'H_884CFDF5' ><span style=' font-family: monospace;'>propertyNames</span></h4><div  class = 'S1'><span>To enable name-value pair </span><a href = "#H_0783E8B1"><span>constructor</span></a><span>, name-value pair </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span>, and the </span><a href = "#H_C729A888"><span style=' font-family: monospace;'>clear</span></a><span> methods</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >methods (Static=true,Access=?QMol_suite)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >[ClassName,PropNames] = propertyNames()</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #008013;">%propertyNames returns the names of member properties that can be set</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #008013;">%   through name-value assignment</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Parent-class components</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    [~,PropNames]       =   QMol_DFT.propertyNames;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    ClassName           =   </span><span style="color: #a709f5;">'QMol_child_class'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    PropNames           =   [PropNames,{</span><span style="color: #a709f5;">'property1'</span><span >,</span><span style="color: #a709f5;">'property2'</span><span >}];</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><h4  class = 'S4' id = 'H_D8A9FEA5' ><span style=' font-family: monospace;'>showDoc</span></h4><div  class = 'S1'><span>Display the r</span><a href = "#H_4D7CFC3D"><span>un-time documentation</span></a><span> for the specific implementation of the molecular potential.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >methods (Access=?QMol_DFT)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >ref = showDoc(obj)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #008013;">%showDoc displays the documentation reflecting the specific implementation</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #008013;">%   of the DFT model</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >    </span><span style="color: #008013;">% Add specific documentation here</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>If no reference is cited, return </span><span style=' font-family: monospace;'>ref = {}</span><span> otherwise </span><span style=' font-family: monospace;'>ref = {'ref 1','ref 2',___}</span><span>, where each of the </span><span style=' font-family: monospace;'>ref</span><span> corresponds to the bibliographic code for the reference (generally of the form </span><span style=' font-family: monospace;'>'name_of_first_author publication_year'</span><span>) and is case insensitive -- see the </span><a href = "./Documentation.html"><span>documentation page</span></a><span> for a list of citable references.</span></li><li  class = 'S6'><span>Note that only implementation-specific properties should be covered here. All properties common to all DFT models (e.g., electronic structure) are handled in the parent </span><span style=' font-family: monospace;'>QMol_DFT</span><span> class run-time documentation.</span></li></ul><h2  class = 'S2'><span>Test suite</span></h2><div  class = 'S1'><span>For consistency with the rest of the QMol-grid package, </span><span style=' font-family: monospace;'>QMol_DFT</span><span> defines an associated test suite. Run the test suite for the class in normal or </span><a href = "./Test_suite.html"><span>summary mode</span></a><span> respectively with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'DFT'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'-summary'</span><span >,</span><span style="color: #a709f5;">'DFT'</span><span >);</span></span></div></div></div><div  class = 'S8'><span>See </span><a href = "./QMol_test.html"><span style=' font-family: monospace;'>QMol_test</span></a><span> for details regarding how to create a test suite for new classes.</span></div><h2  class = 'S2'><span>Notes</span></h2><ul  class = 'S5'><li  class = 'S6'><span style=' font-family: monospace;'>QMol_DFT</span><span> was intorduced in version 01.00.</span></li><li  class = 'S6'><span>Version 01.10 moved handling of the one-body density spatial derivatives to </span><a href = "./QMol_DFT_density.html"><span style=' font-family: monospace;'>QMol_DFT_density</span></a></li><li  class = 'S6'><span>Version 01.10 introduced a separate class for the Kohn-Sham potential gradient </span><a href = "./QMol_DFT_Vks_grad.html"><span style=' font-family: monospace;'>QMol_DFT_Vks_grad</span></a></li><li  class = 'S6'><a href = "#H_E3988947"><span style=' font-family: monospace;'>getMemoryProfile</span></a><span> was introduced in version 01.10</span></li></ul>
<br>
<!-- 
##### SOURCE BEGIN #####
%% |QMol_DFT|
% Parent class for density-functional theory (DFT) model objects.
%% Description
% |QMol_DFT| defines an abstract class for the description of DFT models. It 
% is designed to be agnostic of (i) the model dimension, (ii) the chosen discretization 
% (Cartesian grid or basis), and (ii) spin polarized or restricted configuration. 
% These are to be handled by the specific DFT-implementation classes and their 
% components.
%% Class properties
% DFT model
% The |QMol_DFT| class defines the following public get-access properties; each 
% can be changed using the |set| method:
% |discretization (disc)|
% <./Discretization.html Domain discretization> object |[ handle object (default 
% []) ]|
% |occupation (occ)|
% Kohn-Sham orbital population parameters |[ vector | cell | (default []) ]|
%% 
% * For spin-restricted DFT models, |occupation = [n1,n2,___]| with each of 
% the $0\leq n\leq2$ specifies the number of electrons associated with each of 
% the Kohn-Sham |orbital|s.
% * For spin-polarized DFT models, |occupation = {[n_up1,n_up2,___],[n_down1,n_down2,___]}| 
% with each of the $0\leq n\leq1$ specifies the number of electrons associated 
% with the up- and down-spin Kohn-Sham |orbital|s.
% |orbital (KSO)|
% Kohn-Sham orbital object |[ handle object (default []) ]|
% |externalPotential (Vext)|
% External functional object |[handle object (default []) ]|
% |HartreePotential (Vh)|
% Hartree functional object |[handle object (default []) ]|
% |exchangeCorrelationPotential (Vxc)|
% Exchange-correlation functional object(s) |[ [] (default) | handle object 
% | cell ]|
%% 
% * Empty |exchangeCorrelationPotential| ignores exchange-correlation effects 
% altogether in the DFT model.
% * Provide multiple exchange-correlation functionals REPLACE_WITH_DASH_DASH _e.g._, one exchange 
% functional plus a separate correlation one REPLACE_WITH_DASH_DASH grouped in a cell |{Vxc1,Vxc2,___}|
% * If the DFT model includes a single exchange-correlation functional, it can 
% be directly provided |exchangeCorrelationPotential = Vxc| or included in a cell 
% |exchangeCorrelationPotential = {Vxc}|.
% |selfInteractionCorrection (SIC)|
% Flavor of self-interaction correction (SIC) |[ 'none' (default) | 'ADSIC' 
% | cell ]|
%% 
% * If a single SIC flag is provided, the same flavor of SIC corresponding to 
% the flag, is applied to the Hartree and exchange-correlation functionals.
% * |selfInteractionCorrection = {SIC_H,SIC_XC}| independently specifies the 
% flavor of SIC to use for the Hartree and exchange-correlation functionals, respectively.
% * If the DFT model uses several exchange-correlation functional, |selfInteractionCorrection 
% = {SIC_H,SIC_XC_1,SIC_XC_1,___}| independently specifies the flavor of SIC for 
% each of the exchange-correlation functionals, respectively.
% Other properties
% To facilitate simulations, the |QMol_DFT| defines a handful of additional 
% transient properties. These cannot be edited with the |set| method.
% |isInitialized (isInit)|
% Whether the DFT-model object is properly initialized. This is used throughout 
% the QMol-grid package to check that the DFT-model object holds meaningful information 
% and is ready for use.
% |totalCharge (Ntot)|
% Total number of electrons in the DFT model |[ scalar | vector (default []) 
% ]|
%% 
% * For spin restricted DFT models, this is defined as |sum(obj.||occupation||)|
% * For spin restricted DFT models, this is defined as [|sum(obj.||occupation||{1}),sum(obj.||occupation||{2})]|
% * |totalCharge| is set by |initialize|; It is empty when the |isInitialized| 
% flag is |false|
% rho
% One-body density placeholder |[ density handle object (default []) ]|
%% 
% * Some methods require local computation of the one-body density before performing 
% their own computation. In such cases, they should use this local density placeholder 
% and avoid the allocation of another density object.
% * |rho| is up for grab by any class in the QMol-grid package (|Access=?QMol_suite|). 
% One should not assume that it retains meaningful values outside of a given method 
% where it is used.
% |Vks|
% Kohn-Sham potential placeholder |[ density handle object (default []) ]|
%% 
% * Like for the density, use this placeholder when a local computation of the 
% Kohn-Sham potential is required in some computation.
% * |Vks| is up for grab by any class in the QMol-grid package (|Access=?QMol_suite|). 
% One should not assume that it retains meaningful values outside of a given method 
% where it is used.
% |DVks|
% Kohn-Sham potential gradient placeholder |[ density handle object (default 
% []) ]|
%% 
% * Like for the density, use this placeholder when a local computation of the 
% Kohn-Sham potentia gradient is required in some computation.
% * |DVks| is up for grab by any class in the QMol-grid package (|Access=?QMol_suite|). 
% One should not assume that it retains meaningful values outside of a given method 
% where it is used.
% Constant properties
% |isSpinPol|
%% 
% * Flags spin polarized (|isSpinPol = true|) from restricted (|isSpinPol = 
% false|) models.
% |dim|
%% 
% * Specifies the dimension of the DFT model
%% Class methods
% Creation
% constructor
% Create a DFT-model object with empty class properties.

obj = QMol_DFT;
%% 
% Create a DFT-model object with the |name| properties set to the specified 
% |value|. Several |name-value| pairs can be specified consecutively. Suitable 
% |name| is any of the DFT-model properties and is case insensitive.

obj = QMol_DFT(name1,value1);
obj = QMol_DFT(name1,value1,name2,value2,___);
% Changing class properties
% |set|
% Update the |name| properties of a DFT-model object to the specified |value|. 
% Several |name-value| pairs can be specified consecutively. Suitable |name| is 
% any of the DFT-model properties and is case insensitive.

obj.set(name1,value1);
obj.set(name1,value1,name2,value2,___);
%% 
% This is the common name-value pair assignment method used throughout the QMol-grid 
% package. The |set| method also |reset| the class. After running, the |set| property 
% updates the |isInitialized| flag to a |false| value.
% |reset|
% Reset the object by deleting/re-initializing all run-time properties of the 
% class and updating the |isInitialized| flag to |false|.

obj.reset;
%% 
% * This is the common |reset| method available to all classes throughout the 
% QMol-grid package.
% * To avoid any mismatch in the DFT component internal properties, this also 
% |reset|s the |discretization| (domain discretization), |orbital| (Kohn-Sham 
% orbitals), |externalPotential| (external functional and potential), |HartreePotential| 
% (Hartree functional and potential), and |exchangeCorrelationPotential| (exchange-correlation 
% functional and potential) components objects.
% |clear|
% Clear all class properties

obj.clear;
%% 
% Clear a specific set of the class properties. Suitable |name| is any of the 
% DFT-model properties and is case insensitive.

obj.clear(name1,name2,___);
%% 
% This is the common |clear| method available to all classes throughout the 
% QMol-grid package. The |clear| method also |reset| the class. The |clear| method 
% can be used to delete specific properties before saving an instance of the |QMol_DFT| 
% class.
% Initializing the object
% |initialize|
% Initialize a DFT-model object in silent mode, i.e., without displaying any 
% initialization status, and set the |isInitialized| flag to |true| with either

obj.initialize;
obj.initialize(0)
%% 
% * This |initialize|s |discretization| (domain discretization), |orbital| (Kohn-Sham 
% orbitals), |externalPotential| (external functional and potential), |HartreePotential| 
% (Hartree functional and potential), and |exchangeCorrelationPotential| (exchange-correlation 
% functional and potential) component objects.
% * To avoid any mismatch in internal properties, |initialize| first |reset| 
% the object before performing the initialization
%% 
% To perform the same initialization but with displaying the status of the object 
% initialization, including the QMol-grid package header and footer, 

obj.initialize(1);
%% 
% To perform the initialization and display the status of the object initialization, 
% without the QMol-grid package header and footer, 

obj.initialize(2);  % 2 or any interger larger than 1
% Run-time documentation
% |getMemoryProfile|
% Get an estimate of the memory help a |QMol_DFT| object with either

mem = obj.getMemoryProfile;
mem = obj.getMemoryProfile(false);
%% 
% * The object does not need to be |initialize|d for the memory footprint evaluation.
% * |getMemoryProfile| makes efforts to return the object in the same configuration 
% as before the profiling but small side effects cannot be entirely excluded: 
% all the DFT-model properties are left unchanged while the other properties may 
% be altered. Notably, if the object was not initialized (|isInitialized| |= false|), 
% |getMemoryProfile| |reset|s the object.
% * The estimate includes (1) the domain discretization, (2) Kohn-Sham orbitals, 
% (3) one body density, (4) Kohn-Sham potential, (5) Kohn-Sham potential gradient, 
% (6) External functional, (7) Hartree functional, and (8) exchange-correlation 
% functional(s). Note that all these components may not be used in actual simulations 
% and the memory estimate tries to be conservative. On the other hand, it only 
% includes the discretization of member components on the domain grid and ignores 
% other (small) properties.
% * The output |mem| is the estimated size in bytes.
%% 
% Additionally display the detail of the memory footprint with

mem = obj.getMemoryProfile(true);
% |showDocumentation|
% Display the run-time documentation for the specific configuration of a |QMol_DFT| 
% object, wich must have been |initialize|d beforehand

obj.showDocumentation;
%% 
% The run-time documentation performs the following steps
%% 
% * Display the QMol-grid package header (showing the kernel, external component 
% versions)
% * Call the DFT-model implementation-specific run-time documentation with the 
% propety |showDoc|.
% * Display the |discretization| (domain discretization) object run-time documentation
% * Display the |HartreePotential| (Hartree functional and potential) object 
% run-time documentation
% * Display the |externalPotential| (external functional and potential) object 
% run-time documentation
% * Display the |exchangeCorrelationPotential| (exchange-correlation functional 
% and potential) object run-time documentation
% * Display the electronic structure, with the occupation (number of electrons) 
% in each Kohn-Sham orbital
% * Display the bibliography associated with the list of cited references (from 
% the previous steps)
% * Display the funding information
% * Display the QMol-grid package footer
% One-body density and Kohn-Sham potential
% All the following methods require the object to have been |initialize|d.
% |getDensity|
% Compute and obtain the one-body density associated with the Kohn-Sham orbitals 
% and occupation parameters

rho = obj.getDensity;
%% 
% * This creates a new one-body density object |rho| in which the result is 
% stored.
%% 
% Alternatively, store the result in an existing one-body density object with

obj.getDensity(rho);
% |setPotentialKernel|
% Trigger the initialization of the kernels of implicit echange-correlation 
% potentials/functionals

obj.setPotentialKernel;
% |getPotential|
% Compute and obtain the total Kohn-Sham potential (sum of the external, Hartree, 
% and exchange-correlation potentials)

V = obj.getPotential;
%% 
% * Uses the one-body density associated with the Kohn-Sham orbitals and occupation 
% parameters (this forces first the computation of the one-body density)
%% 
% Specify the one-body density to be used in the calculation of the Kohn-Sham 
% potential with

V = obj.getPotential(rho)
%% 
% * |rho| is compatible one-body density object
%% 
% Alternatively, store the results in an existing Kohn-Sham potential object 
% respectively with

obj.getPotential([],V);  % Use current density (must be computed first)
obj.getPotential(rho,V); % Supply one-body density
% |getPotentialGradient|
% Compute and obtain the gradient of the total Kohn-Sham potential (sum of the 
% external, Hartree, and exchange-correlation potentials)

DV = obj.getPotentialGradient;
%% 
% * Uses the one-body density associated with the Kohn-Sham orbitals and occupation 
% parameters (this forces first the computation of the one-body density)
%% 
% Specify the one-body density to be used in the calculation of the Kohn-Sham 
% potential gradient with

DV = obj.getPotentialGradient(rho)
%% 
% * |rho| is compatible one-body density object
%% 
% Alternatively, store the results in an existing Kohn-Sham potential object 
% respectively with

obj.getPotentialGradient([],DV);  % Use current density (must be computed first)
obj.getPotentialGradient(rho,DV); % Supply one-body density
%% 
% By default |getPotentialGradient| computes the gradient along all possible 
% directions; Specify the directions along which the gradient should be computed 
% with

DV = obj.getPotentialGradient([],[],dim);  % Use current density (must be computed first)
obj.getPotentialGradient([],DV,dim); 
DV = obj.getPotentialGradient(rho,[],dim); % Supply one-body density
obj.getPotentialGradient(rho,DV,dim); 
% DFT and orbital energies
% All the following methods require the object to have been |initialize|d.
% |getEnergy|
% Compute the DFT-component energies with either

[Etot,Ekin,Eext,Eh,Exc] = obj.getEnergy;
[Etot,Ekin,Eext,Eh,Exc] = obj.getEnergy('DFT');
%% 
% * |Etot| is the total (sum of the following components) energy; For spin-rstricted 
% models |Ekin| is the total kinetic energy and for spin-polarized ones |Ekin 
% = [Eup, Edown]| is the kinetic energy in the up- and down-spin channels, respectively; 
% |Eext| is the external energy; |Eh| is the Hartree energy; |Exc| is the exchange-correlation 
% energy (summed over all exchange-correlation functionals).
% * Uses the one-body density associated with the Kohn-Sham orbitals and occupation 
% parameters (this forces first the computation of the one-body density)
%% 
% Compute the Kohn-Sham orbital energies and error

[E,DE] = obj.getEnergy('orbital');
%% 
% * For each orbital $\left|\phi\right\rangle$, the orbital energy is defined 
% as the real $E = \langle\phi| \hat{\mathcal{H}}_{\rm DFT} |\phi\rangle$ and 
% the error is defined as the positive real $\left\| (\hat{\mathcal{H}}_{\rm DFT} 
% - E) |\phi\rangle \right\|$. $\hat{\mathcal{H}}_{\rm DFT}$ is the total DFT 
% Hamiltonian operator.
% * For spin-restricted models, |E| is a vector containing the respective orbital 
% energies
% * For spin-polarized models, |E = {Eup,Edown}| are the orbital energies in 
% the up- and down-spin channels, respectively.
% * For spin-restricted models, |DE| is a vector containing the respective orbital 
% errors
% * For spin-polarized models, |DE = {DEup,DEdown}| are the orbital energy errors 
% in the up- and down-spin channels, respectively.
% * This uses one-body density associated with the Kohn-Sham orbitals and occupation 
% parameters and its corresponding Kohn-Sham potential (this forces first the 
% computation of both the one-body density and the Kohn-Sham potential).
%% 
% Specify the one-body density (for the Kohn-Sham potential) for computing the 
% Kohn-Sham orbital energies and error with

[E,DE] = obj.getEnergy('orbital',rho);
%% 
% * |rho| is a compatible one-body density object.
% * This forces the computation of the Kohn-Sham potential (for the input density).
%% 
% Specify the Kohn-Sham potential for computing the Kohn-Sham orbital energies 
% and error with

[E,DE] = obj.getEnergy('orbital',V);
%% 
% * |V| is a compatible Kohn-Sham potential
% |showEnergy|
% Display the DFT energy components with

obj.showEnergy('DFT');
%% 
% * This forces the computation of the one-body density and its associated Kohn-Sham 
% potential.
%% 
% Display the Kohn-Sham orbital energies and errors with either

obj.showEnergy;
obj.showEnergy('orbital');
%% 
% * The energy and error the same as in |getEnergy||.|
% * This also forces the computation of the one-body density and its associated 
% Kohn-Sham potential.
%% Overloading the class
% To define a specific implementation of DFT models, overloading classes must 
% define the following methods with the specified signature and attributes
% |propertyNames|
% To enable name-value pair constructor, name-value pair |set|, and the |clear| 
% methods

methods (Static=true,Access=?QMol_suite)
function [ClassName,PropNames] = propertyNames()
%propertyNames returns the names of member properties that can be set
%   through name-value assignment
    
    % Parent-class components
    [~,PropNames]       =   QMol_DFT.propertyNames;

    ClassName           =   'QMol_child_class';
    PropNames           =   [PropNames,{'property1','property2'}];
end
end
% |showDoc|
% Display the run-time documentation for the specific implementation of the 
% molecular potential.

methods (Access=?QMol_DFT)
function ref = showDoc(obj)
%showDoc displays the documentation reflecting the specific implementation
%   of the DFT model
    
    % Add specific documentation here

end
end
%% 
% * If no reference is cited, return |ref = {}| otherwise |ref = {'ref 1','ref 
% 2',___}|, where each of the |ref| corresponds to the bibliographic code for 
% the reference (generally of the form |'name_of_first_author publication_year'|) 
% and is case insensitive REPLACE_WITH_DASH_DASH see the <./Documentation.html documentation page> 
% for a list of citable references.
% * Note that only implementation-specific properties should be covered here. 
% All properties common to all DFT models (e.g., electronic structure) are handled 
% in the parent |QMol_DFT| class run-time documentation.
%% Test suite
% For consistency with the rest of the QMol-grid package, |QMol_DFT| defines 
% an associated test suite. Run the test suite for the class in normal or <./Test_suite.html 
% summary mode> respectively with

QMol_test.test('DFT');
QMol_test.test('-summary','DFT');
%% 
% See <./QMol_test.html |QMol_test|> for details regarding how to create a test 
% suite for new classes.
%% Notes
%% 
% * |QMol_DFT| was intorduced in version 01.00.
% * Version 01.10 moved handling of the one-body density spatial derivatives 
% to <./QMol_DFT_density.html |QMol_DFT_density|>
% * Version 01.10 introduced a separate class for the Kohn-Sham potential gradient 
% <./QMol_DFT_Vks_grad.html |QMol_DFT_Vks_grad|>
% * |getMemoryProfile| was introduced in version 01.10
##### SOURCE END #####
-->
</div></body></html>