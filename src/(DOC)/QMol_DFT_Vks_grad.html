<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2024a"><title>QMol_DFT_Vks_grad</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S3 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.S4 { margin: 10px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 15px; font-weight: 700; text-align: left;  }
.S5 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S6 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block }
.S7 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0.555556px solid rgb(217, 217, 217); border-bottom: 0.555556px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S9 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0.555556px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S10 { border-left: 0.555556px solid rgb(217, 217, 217); border-right: 0.555556px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0.555556px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span style=' font-family: monospace;'>QMol_DFT_Vks_grad</span></h1><div  class = 'S1'><span>Kohn-Sham-potential gradient operator object.</span></div><h2  class = 'S2'><span>Description</span></h2><div  class = 'S1'><span>Use </span><span style=' font-family: monospace;'>QMol_DFT_Vks_grad</span><span> to store the Kohn-Sham-potential gradient operator for (TD)DFT simulations. </span><span style=' font-family: monospace;'>QMol_DFT_Vks_grad</span><span> is a handle class.</span></div><h2  class = 'S2' id = 'H_4B2702F0' ><span>Class properties</span></h2><h3  class = 'S3' id = 'H_E0304EE8' ><span>Kohn-Sham potential gradient</span></h3><div  class = 'S1'><span>The </span><span style=' font-family: monospace;'>QMol_DFT_Vks</span><span> class defines the following public get-access properties; each can be changed using the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method:</span></div><h4  class = 'S4' id = 'H_1E867BF5' ><span style=' font-family: monospace;'>potentialGradient (DV)</span></h4><div  class = 'S1'><span>Discretization of the explicit part of the Kohn-Sham potential gradient </span><span style=' font-family: monospace;'>[ vector (default []) ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>For spin restricted DFT model; irrelevant for spin restricted ones.</span></li><li  class = 'S6'><span>Properly allocated </span><span style=' font-family: monospace;'>potentialGradient</span><span> is a </span><span style=' font-family: monospace;'>numel(</span><a href = "./QMol_disc.html"><span style=' font-family: monospace;'>disc</span></a><span style=' font-family: monospace;'>.xspan)-by-1</span><span> vector matching the </span><a href = "./Discretization.html"><span>domain discretization</span></a><span> of the associated (TD)DFT model.</span></li></ul><h4  class = 'S4' id = 'H_DEB46406' ><span style=' font-family: monospace;'>potentialGradientUp (DVup)</span></h4><div  class = 'S1'><span>Discretization of the explicit part of the up-spin channel Kohn-Sham potential gradient </span><span style=' font-family: monospace;'>[ vector (default []) ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>For spin polarized DFT model; irrelevant for spin restricted ones.</span></li><li  class = 'S6'><span>Properly allocated </span><span style=' font-family: monospace;'>potentialGradientUp</span><span> is a </span><span style=' font-family: monospace;'>numel(</span><a href = "./QMol_disc.html"><span style=' font-family: monospace;'>disc</span></a><span style=' font-family: monospace;'>.xspan)-by-1</span><span> vector matching the </span><a href = "./Discretization.html"><span>domain discretization</span></a><span> of the associated (TD)DFT model.</span></li></ul><h4  class = 'S4' id = 'H_690E6A35' ><span style=' font-family: monospace;'>potentialGradientDown (DVdw)</span></h4><div  class = 'S1'><span>Discretization of the explicit part of the down-spin channel Kohn-Sham potential gradient </span><span style=' font-family: monospace;'>[ vector (default []) ]</span></div><ul  class = 'S5'><li  class = 'S6'><span>For spin polarized DFT model; irrelevant for spin restricted ones.</span></li><li  class = 'S6'><span>Properly allocated </span><span style=' font-family: monospace;'>potentialGradientDown</span><span> is a </span><span style=' font-family: monospace;'>numel(</span><a href = "./QMol_disc.html"><span style=' font-family: monospace;'>disc</span></a><span style=' font-family: monospace;'>.xspan)-by-1</span><span> vector matching the </span><a href = "./Discretization.html"><span>domain discretization</span></a><span> of the associated (TD)DFT model.</span></li></ul><h4  class = 'S4' id = 'H_9FCFBD9C' ><span style=' font-family: monospace;'>potentialGradientImplicit (DVimp)</span></h4><div  class = 'S1'><span>Implicit components of the Kohn-Sham potential gradient </span><span style=' font-family: monospace;'>[ cell of hangle functions (default {}) ]</span><span> </span></div><ul  class = 'S5'><li  class = 'S6'><span>For both spin restricted and polarized models, holds the implicit components of the Kohn-Sham potential gradient. Implicit potential are defined through their action on orbitals instead of the value-at-grid-point their explicit counterparts.</span></li><li  class = 'S6'><span>Each component of </span><span style=' font-family: monospace;'>potentialGradientImplicit</span><span> contains a handle function describing one implicit-potential gradient component.</span></li><li  class = 'S6'><span>For spin resctricted models, the signature for implicit-potential gradient components is </span><span style=' font-family: monospace;'>Hp = funV(p)</span><span>. </span><span style=' font-family: monospace;'>p</span><span> and </span><span style=' font-family: monospace;'>Hp</span><span> are both </span><span style=' font-family: monospace;'>numel(</span><a href = "./QMol_disc.html"><span style=' font-family: monospace;'>disc</span></a><span style=' font-family: monospace;'>.xspan)-by-1</span><span> vectors respectively containing the discretization of the orbital to which the potential gradient should be applied and its result.</span></li><li  class = 'S6'><span>For spin polarized models, the signature for implicit-potential gradient components is </span><span style=' font-family: monospace;'>Hp = funV(p,isUp)</span><span>. </span><span style=' font-family: monospace;'>p</span><span> and </span><span style=' font-family: monospace;'>Hp</span><span> are both </span><span style=' font-family: monospace;'>numel(</span><a href = "./QMol_disc.html"><span style=' font-family: monospace;'>disc</span></a><span style=' font-family: monospace;'>.xspan)-by-1</span><span> vectors respectively containing the discretization of the orbital to which the potential gradient should be applied and its result. The second logical input </span><span style=' font-family: monospace;'>isUp</span><span> specifies whether applying the up- (</span><span style=' font-family: monospace;'>true</span><span>) or down-spin (</span><span style=' font-family: monospace;'>false</span><span>) potential gradient operator to the input orbital.</span></li></ul><h4  class = 'S4'><span style=' font-family: monospace;'>isSpinPol</span></h4><div  class = 'S1'><span>Whether the Kohn-Sham potential gradient is spin polarized (</span><span style=' font-family: monospace;'>true</span><span>) or spin restricted (</span><span style=' font-family: monospace;'>false</span><span>). </span><span style=' font-family: monospace;'>isSpinPol</span><span> is used by other classes to determine whether they should use the </span><span style=' font-family: monospace;'>potentialGradient</span><span> or </span><span style=' font-family: monospace;'>potentialGradientUp</span><span> and </span><span style=' font-family: monospace;'>potentialGradientDown</span><span> properties, and the proper interface for any </span><span style=' font-family: monospace;'>potentialGradientImplicit</span><span> component, in their calculations.</span></div><h3  class = 'S3'><span>Other properties</span></h3><div  class = 'S1'><span>These properties cannot be edited with the </span><a href = "#H_4405B79D"><span style=' font-family: monospace;'>set</span></a><span> method.</span></div><h4  class = 'S4' id = 'H_0ED64D82' ><span style=' font-family: monospace;'>isInitialized (isInit)</span></h4><div  class = 'S1'><span>Whether the Kohn-Sham-potential gradient operator object is properly initialized. This is used throughout the QMol-grid package to check that the potential gradient object holds meaningful information and is ready for use. Changing its </span><span style=' font-family: monospace;'>isSpinPol</span><span> may cause simulations to fail or produce erroneous results.</span></div><h2  class = 'S2'><span>Class methods</span></h2><h3  class = 'S3'><span>Creation</span></h3><h4  class = 'S4'><span>constructor</span></h4><div  class = 'S1'><span>Create a Kohn-Sham-potential gradient operator object with empty class properties.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj = QMol_DFT_Vks_grad;</span></span></div></div></div><div  class = 'S8'><span>Create a Kohn-Sham-potential gradient operator object with the </span><span style=' font-family: monospace;'>name</span><span> properties set to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_E0304EE8"><span>Kohn-Sham potential gradient properties</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj = QMol_DFT_Vks_grad(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj = QMol_DFT_Vks_grad(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S8'><span>Most often, Kohn-Sham-potential gradient operator objects are created through domain-discretization or DFT objects.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj = disc.DFT_allocatePotentialGradient;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj = DFT.getPotentialGradient;</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>Note: potential gradient property assignation is provided for extended support. Most end users will not need these as </span><span style=' text-decoration: underline;'>editing the potential gradient may cause simulations to produce erroneous results or fail altogether</span><span>.</span></li></ul><h3  class = 'S3'><span>Changing class properties</span></h3><h4  class = 'S4' id = 'H_4405B79D' ><span style=' font-family: monospace;'>set</span></h4><div  class = 'S1'><span>Update the </span><span style=' font-family: monospace;'>name</span><span> properties of a Kohn-Sham potential gradient object to the specified </span><span style=' font-family: monospace;'>value</span><span>. Several </span><span style=' font-family: monospace;'>name-value</span><span> pairs can be specified consecutively. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_E0304EE8"><span>Kohn-Sham potential gradient properties</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >obj.set(name1,value1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >obj.set(name1,value1,name2,value2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S8'><span>This is the common name-value pair assignment method used throughout the QMol-grid package. The </span><span style=' font-family: monospace;'>set</span><span> method also </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the class. After running, the </span><span style=' font-family: monospace;'>set</span><span> property updates the </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to </span><span style=' font-family: monospace;'>false</span><span>.</span></div><ul  class = 'S5'><li  class = 'S6'><span>Note: potential property assignation is provided for extended support. Most end users will not need these as </span><span style=' text-decoration: underline;'>editing the potential gradient may cause simulations to produce erroneous results or fail altogether</span><span>.</span></li></ul><h4  class = 'S4' id = 'H_BF84FCE7' ><span style=' font-family: monospace;'>reset</span></h4><div  class = 'S1'><span>Reset the object by deleting/re-initializing all run-time properties of the class and updating the </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to </span><span style=' font-family: monospace;'>false</span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.reset;</span></span></div></div></div><div  class = 'S8'><span>This is the common </span><span style=' font-family: monospace;'>reset</span><span> method available to all classes throughout the QMol-grid package.</span></div><h4  class = 'S4' id = 'H_C729A888' ><span style=' font-family: monospace;'>clear</span></h4><div  class = 'S1'><span>Clear all class properties.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.clear;</span></span></div></div></div><div  class = 'S8'><span>Clear a specific set of the class properties. Suitable </span><span style=' font-family: monospace;'>name</span><span> is any of the </span><a href = "#H_E0304EE8"><span>Kohn-Sham potential gradient properties</span></a><span> and is case insensitive.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.clear(name1,name2,</span><span style="color: rgb(225, 27, 20);">___</span><span >);</span></span></div></div></div><div  class = 'S8'><span>This is the common </span><span style=' font-family: monospace;'>clear</span><span> method available to all classes throughout the QMol-grid package. The </span><span style=' font-family: monospace;'>clear</span><span> method also </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the class. The </span><span style=' font-family: monospace;'>clear</span><span> method can be used to delete specific properties before saving an instance of the </span><span style=' font-family: monospace;'>QMol_DFT_Vks_grad</span><span> class.</span></div><h3  class = 'S3'><span>Initializing the object</span></h3><h4  class = 'S4' id = 'H_4F780A35' ><span style=' font-family: monospace;'>initialize</span></h4><div  class = 'S1'><span>Minimally initialize a Kohn-Sham-potential gradient operator object and sets the </span><a href = "#H_0ED64D82"><span style=' font-family: monospace;'>isInitialized</span></a><span> flag to </span><span style=' font-family: monospace;'>true</span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.initialize;</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>To avoid any mismatch in internal properties, </span><span style=' font-family: monospace;'>initialize</span><span> first </span><a href = "#H_BF84FCE7"><span style=' font-family: monospace;'>reset</span></a><span> the object before performing the initialization.</span></li><li  class = 'S6'><span>Minimal initialization is discouraged, instead the object should be initialized with its associated domain-discretization object (next).</span></li></ul><div  class = 'S1'><span>Initialize a Kohn-Sham-potential gradient operator object with its associated domain-discretization object.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.initialize(disc);</span></span></div></div></div><h3  class = 'S3'><span>Run-time documentation</span></h3><h4  class = 'S4' id = 'H_E3988947' ><span style=' font-family: monospace;'>getMemoryProfile</span></h4><div  class = 'S1'><span>Get an estimate of the memory help a </span><span style=' font-family: monospace;'>QMol_DFT_density</span><span> object with either</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >mem = obj.getMemoryProfile;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >mem = obj.getMemoryProfile(false);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>The object must be properly </span><a href = "#H_4F780A35"><span style=' font-family: monospace;'>initialize</span></a><span>d with a domain discretization.</span></li><li  class = 'S6'><span>The estimate only includes the discretization of the explicit part of the Kohn-Sham potential on the domain grid and ignores other (small) properties.</span></li><li  class = 'S6'><span>The output </span><span style=' font-family: monospace;'>mem</span><span> is the estimated size in bytes.</span></li></ul><div  class = 'S1'><span>Additionally display the detail of the memory footprint with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >mem = obj.getMemoryProfile(true);</span></span></div></div></div><h3  class = 'S3'><span>Arithmetic with potential gradients</span></h3><h4  class = 'S4'><span style=' font-family: monospace;'>add</span></h4><div  class = 'S1'><span>For spin restricted DFT models, add an explicit potential gradient component to a </span><span style=' font-family: monospace;'>QMol_DFT_Vks_grad</span><span> object.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.add(1,DV);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>This performs the in-place addition </span><a href = "#H_1E867BF5"><span style=' font-family: monospace;'>potentialGradient</span></a><span style=' font-family: monospace;'> = </span><a href = "#H_1E867BF5"><span style=' font-family: monospace;'>potentialGradient</span></a><span style=' font-family: monospace;'> + DV</span><span>.</span></li><li  class = 'S6'><span>The input </span><span style=' font-family: monospace;'>DV</span><span> should be a </span><span style=' font-family: monospace;'>numel(</span><a href = "./QMol_disc.html"><span style=' font-family: monospace;'>disc</span></a><span style=' font-family: monospace;'>.xspan)-by-1</span><span> vector matching the </span><a href = "./Discretization.html"><span>domain discretization</span></a><span> of the associated (TD)DFT model.</span></li><li  class = 'S6'><span>Note that </span><span style=' text-decoration: underline;'>the first input </span><span style=' text-decoration: underline; font-family: monospace;'>1</span><span style=' text-decoration: underline;'> is required</span><span>. This is to provide a nuiform signature with higher dimension where the dimension along which the gradient component is provided must be specified.</span></li></ul><div  class = 'S1'><span>For spin polarized DFT models, add the same explicit potential gradient components to both the up- and down-spin components of a </span><span style=' font-family: monospace;'>QMol_DFT_Vks_grad</span><span> object.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.add(1,DV);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>This performs the in-place additions </span><a href = "#H_DEB46406"><span style=' font-family: monospace;'>potentialGradientUp</span></a><span style=' font-family: monospace;'> = </span><a href = "#H_DEB46406"><span style=' font-family: monospace;'>potentialGradientUp</span></a><span style=' font-family: monospace;'> + DV</span><span> and </span><a href = "#H_690E6A35"><span style=' font-family: monospace;'>potentialGradientDown</span></a><span style=' font-family: monospace;'> = </span><a href = "#H_690E6A35"><span style=' font-family: monospace;'>potentialGradientDown</span></a><span style=' font-family: monospace;'> + DV</span><span>.</span></li><li  class = 'S6'><span>The input D</span><span style=' font-family: monospace;'>V</span><span> should be a </span><span style=' font-family: monospace;'>numel(</span><a href = "./QMol_disc.html"><span style=' font-family: monospace;'>disc</span></a><span style=' font-family: monospace;'>.xspan)-by-1</span><span> vector matching the </span><a href = "./Discretization.html"><span>domain discretization</span></a><span> of the associated (TD)DFT model.</span></li><li  class = 'S6'><span>Note that </span><span style=' text-decoration: underline;'>the first input </span><span style=' text-decoration: underline; font-family: monospace;'>1</span><span style=' text-decoration: underline;'> is required</span><span>. This is to provide a uniform signature with higher dimension where the dimension along which the gradient component is provided must be specified.</span></li></ul><div  class = 'S1'><span>For spin polarized DFT models, add different explicit potential gradient components to the up- and down-spin components of a </span><span style=' font-family: monospace;'>QMol_DFT_Vks_grad</span><span> object.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.add(1,DVup,DVdown);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>This performs the in-place additions </span><a href = "#H_DEB46406"><span style=' font-family: monospace;'>potentialGradientUp</span></a><span style=' font-family: monospace;'> = </span><a href = "#H_DEB46406"><span style=' font-family: monospace;'>potentialGradientUp</span></a><span style=' font-family: monospace;'> + DVup</span><span> and </span><a href = "#H_690E6A35"><span style=' font-family: monospace;'>potentialGradientDown</span></a><span style=' font-family: monospace;'> = </span><a href = "#H_690E6A35"><span style=' font-family: monospace;'>potentialGradientDown</span></a><span style=' font-family: monospace;'> + DVdown</span><span>.</span></li><li  class = 'S6'><span>The inputs </span><span style=' font-family: monospace;'>DVup</span><span> and </span><span style=' font-family: monospace;'>DVdown</span><span> should each be </span><span style=' font-family: monospace;'>numel(</span><a href = "./QMol_disc.html"><span style=' font-family: monospace;'>disc</span></a><span style=' font-family: monospace;'>.xspan)-by-1</span><span> vector matching the </span><a href = "./Discretization.html"><span>domain discretization</span></a><span> of the associated (TD)DFT model.</span></li><li  class = 'S6'><span>Replace any of </span><span style=' font-family: monospace;'>DVup</span><span> and </span><span style=' font-family: monospace;'>DVdown</span><span> by scalar </span><span style=' font-family: monospace;'>0</span><span> to add an explicit potential gradient component solely to the other spin channel.</span></li><li  class = 'S6'><span>Note that </span><span style=' text-decoration: underline;'>the first input </span><span style=' text-decoration: underline; font-family: monospace;'>1</span><span style=' text-decoration: underline;'> is required</span><span>. This is to provide a uniform signature with higher dimension where the dimension along which the gradient component is provided must be specified.</span></li></ul><div  class = 'S1'><span>For both spin restricted and polarized DFT models, add an implicit potential gradient component to a </span><span style=' font-family: monospace;'>QMol_DFT_Vks_grad</span><span> object.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >obj.add(1,funDV);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span style=' font-family: monospace;'>funDV</span><span> is a function handle describing the implicit-potential gradient component (which is then added to the </span><a href = "#H_9FCFBD9C"><span style=' font-family: monospace;'>potentialGradientImplicit</span></a><span> list).</span></li><li  class = 'S6'><span>For spin resctricted models, the signature for the input function handle is </span><span style=' font-family: monospace;'>Hp = funDV(p)</span><span>. </span><span style=' font-family: monospace;'>p</span><span> and </span><span style=' font-family: monospace;'>Hp</span><span> are both </span><span style=' font-family: monospace;'>numel(</span><a href = "./QMol_disc.html"><span style=' font-family: monospace;'>disc</span></a><span style=' font-family: monospace;'>.xspan)-by-1</span><span> vectors respectively containing the discretization of the orbital to which the potential gradient should be applied and its result.</span></li><li  class = 'S6'><span>For spin polarized models, the signature for the input function handle is </span><span style=' font-family: monospace;'>Hp = funDV(p,isUp)</span><span>. </span><span style=' font-family: monospace;'>p</span><span> and </span><span style=' font-family: monospace;'>Hp</span><span> are both </span><span style=' font-family: monospace;'>numel(</span><a href = "./QMol_disc.html"><span style=' font-family: monospace;'>disc</span></a><span style=' font-family: monospace;'>.xspan)-by-1</span><span> vectors respectively containing the discretization of the orbital to which the potential gradient should be applied and its result. The second logical input </span><span style=' font-family: monospace;'>isUp</span><span> specifies whether applying the up- (</span><span style=' font-family: monospace;'>true</span><span>) or down-spin (</span><span style=' font-family: monospace;'>false</span><span>) potential operator to the input orbital.</span></li><li  class = 'S6'><span>Note that </span><span style=' text-decoration: underline;'>the first input </span><span style=' text-decoration: underline; font-family: monospace;'>1</span><span style=' text-decoration: underline;'> is required</span><span>. This is to provide a uniform signature with higher dimension where the dimension along which the gradient component is provided must be specified.</span></li></ul><h4  class = 'S4'><span style=' font-family: monospace;'>applyPotential</span></h4><div  class = 'S1'><span>For spin-restricted models, apply the potential gradient operator to a wave function.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >Hp = obj.applyPotentialGradient(1,p);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>This computes the action of the entire -- including both explicit and implicit components -- Kohn-Sham potential gradient operator on the input wave function </span><span style=' font-family: monospace;'>p</span><span>. All implicit components require the associated functional object to have their potential kernels properly set beforehand (with </span><span style=' font-family: monospace;'>setPotentialKernel</span><span> -- see the functional documentation). </span><span style=' font-family: monospace;'>applyPotential</span><span> </span><span style=' text-decoration: underline;'>does not</span><span> perform or check for this initialization.</span></li><li  class = 'S6'><span style=' font-family: monospace;'>p</span><span> and </span><span style=' font-family: monospace;'>Hp</span><span> are both </span><span style=' font-family: monospace;'>numel(</span><a href = "./QMol_disc.html"><span style=' font-family: monospace;'>disc</span></a><span style=' font-family: monospace;'>.xspan)-by-1</span><span> vectors respectively containing the discretization of the orbital to which the potential gradient should be applied and its result.</span></li><li  class = 'S6'><span style=' font-family: monospace;'>applyPotentialGradient</span><span> requires the Kohn-Sham potential gradient object to have been </span><a href = "#H_4F780A35"><span>initialized</span></a><span> with a </span><a href = "./Discretization.html"><span>domain discretization</span></a><span>.</span></li><li  class = 'S6'><span>Note that </span><span style=' text-decoration: underline;'>the first input </span><span style=' text-decoration: underline; font-family: monospace;'>1</span><span style=' text-decoration: underline;'> is required</span><span>. This is to provide a uniform signature with higher dimension where the dimension along which the gradient component is applied must be specified.</span></li></ul><div  class = 'S1'><span>For spin-polarized models, apply the up- and down-spin Kohn-Sham potential gradient operators to a wave function respectively with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Hp = obj.applyPotentialGradient(1,p,true);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >Hp = obj.applyPotentialGradient(1,p,false);</span></span></div></div></div><ul  class = 'S5'><li  class = 'S6'><span>This computes the action of the entire -- including both explicit and implicit components -- Kohn-Sham potential gradient operator on the input wave function </span><span style=' font-family: monospace;'>p</span><span>. All implicit components require the associated functional object to have their potential kernels properly set beforehand (with </span><span style=' font-family: monospace;'>setPotentialKernel</span><span> -- see the functional documentation). </span><span style=' font-family: monospace;'>applyPotential</span><span> </span><span style=' text-decoration: underline;'>does not</span><span> perform or check for this initialization.</span></li><li  class = 'S6'><span style=' font-family: monospace;'>p</span><span> and </span><span style=' font-family: monospace;'>Hp</span><span> are both </span><span style=' font-family: monospace;'>numel(</span><a href = "./QMol_disc.html"><span style=' font-family: monospace;'>disc</span></a><span style=' font-family: monospace;'>.xspan)-by-1</span><span> vectors respectively containing the discretization of the orbital to which the potential gradient should be applied and its result.</span></li><li  class = 'S6'><span style=' font-family: monospace;'>applyPotentialGradient</span><span> requires the Kohn-Sham potential object to have been </span><a href = "#H_4F780A35"><span>initialized</span></a><span> with a </span><a href = "./Discretization.html"><span>domain discretization</span></a><span>.</span></li><li  class = 'S6'><span>Note that </span><span style=' text-decoration: underline;'>the first input </span><span style=' text-decoration: underline; font-family: monospace;'>1</span><span style=' text-decoration: underline;'> is required</span><span>. This is to provide a uniform signature with higher dimension where the dimension along which the gradient component is applied must be specified.</span></li></ul><h2  class = 'S2'><span>Examples</span></h2><div  class = 'S1'><span>Most users will not use Kohn-Sham potential gradient objects directly or will get them indirectly, through </span><a href = "./DFT.html"><span>DFT</span></a><span> and </span><a href = "./TDDFT.html"><span>TDDFT</span></a><span> simulations -- see their respective documentations for examples.</span></div><h2  class = 'S2'><span>Test suite</span></h2><div  class = 'S1'><span>Run the test suite for the class in normal or </span><a href = "./Test_suite.html"><span>summary mode</span></a><span> respectively with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'DFT_Vks_grad'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >QMol_test.test(</span><span style="color: #a709f5;">'-summary'</span><span >,</span><span style="color: #a709f5;">'DFT_Vks_grad'</span><span >);</span></span></div></div></div><h2  class = 'S2'><span>For developers</span></h2><div  class = 'S1'><span style=' font-family: monospace;'>QMol_DFT_Vks_grad</span><span> implements a streamlined version of the </span><a href = "#H_C729A888"><span style=' font-family: monospace;'>clear</span></a><span> all method, since it might be called frequently in </span><a href = "./DFT.html"><span>DFT</span></a><span> and </span><a href = "./TDDFT.html"><span>TDDFT</span></a><span> computations. If adding properties to the class, the streamlined </span><a href = "#H_C729A888"><span style=' font-family: monospace;'>clear</span></a><span> all must be updated accordingly.</span></div><div  class = 'S1'><span style=' font-family: monospace;'>QMol_DFT_Vks_grad</span><span> overloads </span><a href = "./QMol_suite.html"><span style=' font-family: monospace;'>QMol_suite</span></a><span>.</span></div><h2  class = 'S2'><span>Notes</span></h2><ul  class = 'S5'><li  class = 'S6'><span style=' font-family: monospace;'>QMol_DFT_Vks_grad</span><span> was introduced in version 01.10.</span></li></ul>
<br>
<!-- 
##### SOURCE BEGIN #####
%% |QMol_DFT_Vks_grad|
% Kohn-Sham-potential gradient operator object.
%% Description
% Use |QMol_DFT_Vks_grad| to store the Kohn-Sham-potential gradient operator 
% for (TD)DFT simulations. |QMol_DFT_Vks_grad| is a handle class.
%% Class properties
% Kohn-Sham potential gradient
% The |QMol_DFT_Vks| class defines the following public get-access properties; 
% each can be changed using the |set| method:
% |potentialGradient (DV)|
% Discretization of the explicit part of the Kohn-Sham potential gradient |[ 
% vector (default []) ]|
%% 
% * For spin restricted DFT model; irrelevant for spin restricted ones.
% * Properly allocated |potentialGradient| is a |numel(|<./QMol_disc.html |disc|>|.xspan)-by-1| 
% vector matching the <./Discretization.html domain discretization> of the associated 
% (TD)DFT model.
% |potentialGradientUp (DVup)|
% Discretization of the explicit part of the up-spin channel Kohn-Sham potential 
% gradient |[ vector (default []) ]|
%% 
% * For spin polarized DFT model; irrelevant for spin restricted ones.
% * Properly allocated |potentialGradientUp| is a |numel(|<./QMol_disc.html 
% |disc|>|.xspan)-by-1| vector matching the <./Discretization.html domain discretization> 
% of the associated (TD)DFT model.
% |potentialGradientDown (DVdw)|
% Discretization of the explicit part of the down-spin channel Kohn-Sham potential 
% gradient |[ vector (default []) ]|
%% 
% * For spin polarized DFT model; irrelevant for spin restricted ones.
% * Properly allocated |potentialGradientDown| is a |numel(|<./QMol_disc.html 
% |disc|>|.xspan)-by-1| vector matching the <./Discretization.html domain discretization> 
% of the associated (TD)DFT model.
% |potentialGradientImplicit (DVimp)|
% Implicit components of the Kohn-Sham potential gradient |[ cell of hangle 
% functions (default {}) ]| 
%% 
% * For both spin restricted and polarized models, holds the implicit components 
% of the Kohn-Sham potential gradient. Implicit potential are defined through 
% their action on orbitals instead of the value-at-grid-point their explicit counterparts.
% * Each component of |potentialGradientImplicit| contains a handle function 
% describing one implicit-potential gradient component.
% * For spin resctricted models, the signature for implicit-potential gradient 
% components is |Hp = funV(p)|. |p| and |Hp| are both |numel(|<./QMol_disc.html 
% |disc|>|.xspan)-by-1| vectors respectively containing the discretization of 
% the orbital to which the potential gradient should be applied and its result.
% * For spin polarized models, the signature for implicit-potential gradient 
% components is |Hp = funV(p,isUp)|. |p| and |Hp| are both |numel(|<./QMol_disc.html 
% |disc|>|.xspan)-by-1| vectors respectively containing the discretization of 
% the orbital to which the potential gradient should be applied and its result. 
% The second logical input |isUp| specifies whether applying the up- (|true|) 
% or down-spin (|false|) potential gradient operator to the input orbital.
% |isSpinPol|
% Whether the Kohn-Sham potential gradient is spin polarized (|true|) or spin 
% restricted (|false|). |isSpinPol| is used by other classes to determine whether 
% they should use the |potentialGradient| or |potentialGradientUp| and |potentialGradientDown| 
% properties, and the proper interface for any |potentialGradientImplicit| component, 
% in their calculations.
% Other properties
% These properties cannot be edited with the |set| method.
% |isInitialized (isInit)|
% Whether the Kohn-Sham-potential gradient operator object is properly initialized. 
% This is used throughout the QMol-grid package to check that the potential gradient 
% object holds meaningful information and is ready for use. Changing its |isSpinPol| 
% may cause simulations to fail or produce erroneous results.
%% Class methods
% Creation
% constructor
% Create a Kohn-Sham-potential gradient operator object with empty class properties.

obj = QMol_DFT_Vks_grad;
%% 
% Create a Kohn-Sham-potential gradient operator object with the |name| properties 
% set to the specified |value|. Several |name-value| pairs can be specified consecutively. 
% Suitable |name| is any of the Kohn-Sham potential gradient properties and is 
% case insensitive.

obj = QMol_DFT_Vks_grad(name1,value1);
obj = QMol_DFT_Vks_grad(name1,value1,name2,value2,___);
%% 
% Most often, Kohn-Sham-potential gradient operator objects are created through 
% domain-discretization or DFT objects.

obj = disc.DFT_allocatePotentialGradient;
obj = DFT.getPotentialGradient;
%% 
% * Note: potential gradient property assignation is provided for extended support. 
% Most end users will not need these as editing the potential gradient may cause 
% simulations to produce erroneous results or fail altogether.
% Changing class properties
% |set|
% Update the |name| properties of a Kohn-Sham potential gradient object to the 
% specified |value|. Several |name-value| pairs can be specified consecutively. 
% Suitable |name| is any of the Kohn-Sham potential gradient properties and is 
% case insensitive.

obj.set(name1,value1);
obj.set(name1,value1,name2,value2,___);
%% 
% This is the common name-value pair assignment method used throughout the QMol-grid 
% package. The |set| method also |reset| the class. After running, the |set| property 
% updates the |isInitialized| flag to |false|.
%% 
% * Note: potential property assignation is provided for extended support. Most 
% end users will not need these as editing the potential gradient may cause simulations 
% to produce erroneous results or fail altogether.
% |reset|
% Reset the object by deleting/re-initializing all run-time properties of the 
% class and updating the |isInitialized| flag to |false|.

obj.reset;
%% 
% This is the common |reset| method available to all classes throughout the 
% QMol-grid package.
% |clear|
% Clear all class properties.

obj.clear;
%% 
% Clear a specific set of the class properties. Suitable |name| is any of the 
% Kohn-Sham potential gradient properties and is case insensitive.

obj.clear(name1,name2,___);
%% 
% This is the common |clear| method available to all classes throughout the 
% QMol-grid package. The |clear| method also |reset| the class. The |clear| method 
% can be used to delete specific properties before saving an instance of the |QMol_DFT_Vks_grad| 
% class.
% Initializing the object
% |initialize|
% Minimally initialize a Kohn-Sham-potential gradient operator object and sets 
% the |isInitialized| flag to |true|.

obj.initialize;
%% 
% * To avoid any mismatch in internal properties, |initialize| first |reset| 
% the object before performing the initialization.
% * Minimal initialization is discouraged, instead the object should be initialized 
% with its associated domain-discretization object (next).
%% 
% Initialize a Kohn-Sham-potential gradient operator object with its associated 
% domain-discretization object.

obj.initialize(disc);
% Run-time documentation
% |getMemoryProfile|
% Get an estimate of the memory help a |QMol_DFT_density| object with either

mem = obj.getMemoryProfile;
mem = obj.getMemoryProfile(false);
%% 
% * The object must be properly |initialize|d with a domain discretization.
% * The estimate only includes the discretization of the explicit part of the 
% Kohn-Sham potential on the domain grid and ignores other (small) properties.
% * The output |mem| is the estimated size in bytes.
%% 
% Additionally display the detail of the memory footprint with

mem = obj.getMemoryProfile(true);
% Arithmetic with potential gradients
% |add|
% For spin restricted DFT models, add an explicit potential gradient component 
% to a |QMol_DFT_Vks_grad| object.

obj.add(1,DV);
%% 
% * This performs the in-place addition |potentialGradient| |=| |potentialGradient| 
% |+ DV|.
% * The input |DV| should be a |numel(|<./QMol_disc.html |disc|>|.xspan)-by-1| 
% vector matching the <./Discretization.html domain discretization> of the associated 
% (TD)DFT model.
% * Note that the first input |1| is required. This is to provide a nuiform 
% signature with higher dimension where the dimension along which the gradient 
% component is provided must be specified.
%% 
% For spin polarized DFT models, add the same explicit potential gradient components 
% to both the up- and down-spin components of a |QMol_DFT_Vks_grad| object.

obj.add(1,DV);
%% 
% * This performs the in-place additions |potentialGradientUp| |=| |potentialGradientUp| 
% |+ DV| and |potentialGradientDown| |=| |potentialGradientDown| |+ DV|.
% * The input D|V| should be a |numel(|<./QMol_disc.html |disc|>|.xspan)-by-1| 
% vector matching the <./Discretization.html domain discretization> of the associated 
% (TD)DFT model.
% * Note that the first input |1| is required. This is to provide a uniform 
% signature with higher dimension where the dimension along which the gradient 
% component is provided must be specified.
%% 
% For spin polarized DFT models, add different explicit potential gradient components 
% to the up- and down-spin components of a |QMol_DFT_Vks_grad| object.

obj.add(1,DVup,DVdown);
%% 
% * This performs the in-place additions |potentialGradientUp| |=| |potentialGradientUp| 
% |+ DVup| and |potentialGradientDown| |=| |potentialGradientDown| |+ DVdown|.
% * The inputs |DVup| and |DVdown| should each be |numel(|<./QMol_disc.html 
% |disc|>|.xspan)-by-1| vector matching the <./Discretization.html domain discretization> 
% of the associated (TD)DFT model.
% * Replace any of |DVup| and |DVdown| by scalar |0| to add an explicit potential 
% gradient component solely to the other spin channel.
% * Note that the first input |1| is required. This is to provide a uniform 
% signature with higher dimension where the dimension along which the gradient 
% component is provided must be specified.
%% 
% For both spin restricted and polarized DFT models, add an implicit potential 
% gradient component to a |QMol_DFT_Vks_grad| object.

obj.add(1,funDV);
%% 
% * |funDV| is a function handle describing the implicit-potential gradient 
% component (which is then added to the |potentialGradientImplicit| list).
% * For spin resctricted models, the signature for the input function handle 
% is |Hp = funDV(p)|. |p| and |Hp| are both |numel(|<./QMol_disc.html |disc|>|.xspan)-by-1| 
% vectors respectively containing the discretization of the orbital to which the 
% potential gradient should be applied and its result.
% * For spin polarized models, the signature for the input function handle is 
% |Hp = funDV(p,isUp)|. |p| and |Hp| are both |numel(|<./QMol_disc.html |disc|>|.xspan)-by-1| 
% vectors respectively containing the discretization of the orbital to which the 
% potential gradient should be applied and its result. The second logical input 
% |isUp| specifies whether applying the up- (|true|) or down-spin (|false|) potential 
% operator to the input orbital.
% * Note that the first input |1| is required. This is to provide a uniform 
% signature with higher dimension where the dimension along which the gradient 
% component is provided must be specified.
% |applyPotential|
% For spin-restricted models, apply the potential gradient operator to a wave 
% function.

Hp = obj.applyPotentialGradient(1,p);
%% 
% * This computes the action of the entire REPLACE_WITH_DASH_DASH including both explicit and implicit 
% components REPLACE_WITH_DASH_DASH Kohn-Sham potential gradient operator on the input wave function 
% |p|. All implicit components require the associated functional object to have 
% their potential kernels properly set beforehand (with |setPotentialKernel| REPLACE_WITH_DASH_DASH 
% see the functional documentation). |applyPotential| does not perform or check 
% for this initialization.
% * |p| and |Hp| are both |numel(|<./QMol_disc.html |disc|>|.xspan)-by-1| vectors 
% respectively containing the discretization of the orbital to which the potential 
% gradient should be applied and its result.
% * |applyPotentialGradient| requires the Kohn-Sham potential gradient object 
% to have been initialized with a <./Discretization.html domain discretization>.
% * Note that the first input |1| is required. This is to provide a uniform 
% signature with higher dimension where the dimension along which the gradient 
% component is applied must be specified.
%% 
% For spin-polarized models, apply the up- and down-spin Kohn-Sham potential 
% gradient operators to a wave function respectively with

Hp = obj.applyPotentialGradient(1,p,true);
Hp = obj.applyPotentialGradient(1,p,false);
%% 
% * This computes the action of the entire REPLACE_WITH_DASH_DASH including both explicit and implicit 
% components REPLACE_WITH_DASH_DASH Kohn-Sham potential gradient operator on the input wave function 
% |p|. All implicit components require the associated functional object to have 
% their potential kernels properly set beforehand (with |setPotentialKernel| REPLACE_WITH_DASH_DASH 
% see the functional documentation). |applyPotential| does not perform or check 
% for this initialization.
% * |p| and |Hp| are both |numel(|<./QMol_disc.html |disc|>|.xspan)-by-1| vectors 
% respectively containing the discretization of the orbital to which the potential 
% gradient should be applied and its result.
% * |applyPotentialGradient| requires the Kohn-Sham potential object to have 
% been initialized with a <./Discretization.html domain discretization>.
% * Note that the first input |1| is required. This is to provide a uniform 
% signature with higher dimension where the dimension along which the gradient 
% component is applied must be specified.
%% Examples
% Most users will not use Kohn-Sham potential gradient objects directly or will 
% get them indirectly, through <./DFT.html DFT> and <./TDDFT.html TDDFT> simulations 
% REPLACE_WITH_DASH_DASH see their respective documentations for examples.
%% Test suite
% Run the test suite for the class in normal or <./Test_suite.html summary mode> 
% respectively with

QMol_test.test('DFT_Vks_grad');
QMol_test.test('-summary','DFT_Vks_grad');
%% For developers
% |QMol_DFT_Vks_grad| implements a streamlined version of the |clear| all method, 
% since it might be called frequently in <./DFT.html DFT> and <./TDDFT.html TDDFT> 
% computations. If adding properties to the class, the streamlined |clear| all 
% must be updated accordingly.
% 
% |QMol_DFT_Vks_grad| overloads <./QMol_suite.html |QMol_suite|>.
%% Notes
%% 
% * |QMol_DFT_Vks_grad| was introduced in version 01.10.
##### SOURCE END #####
-->
</div></body></html>